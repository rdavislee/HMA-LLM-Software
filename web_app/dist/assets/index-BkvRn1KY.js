import{r as M,R as gn,j as u,S as Mr,u as Se,a as Nr,c as It,P as ue,b as Ot,d as me,e as Pe,f as Lt,g as Ts,h as vn,L as Sn,T as bn,C as yn,i as Br,k as Ir,l as Or,m as jr,n as Hr,O as zr,o as xn,p as wn,I as Cn,V as En,q as kn,s as Rn,t as Ln,G as An,v as Dn,w as Tn,x as Pn,y as Mn,z as Nn,A as Bn,D as In,B as On,E as jn,F as Hn,H as zn,J as Fn}from"./ui-zHZ4fQpc.js";import{a as Wn,r as $n}from"./react-DavUf6mE.js";import{t as Un,c as Fr}from"./utils-BJeS7sC5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))d(y);new MutationObserver(y=>{for(const k of y)if(k.type==="childList")for(const E of k.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&d(E)}).observe(document,{childList:!0,subtree:!0});function t(y){const k={};return y.integrity&&(k.integrity=y.integrity),y.referrerPolicy&&(k.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?k.credentials="include":y.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function d(y){if(y.ep)return;y.ep=!0;const k=t(y);fetch(y.href,k)}})();var mt={},Ys;function qn(){if(Ys)return mt;Ys=1;var r=Wn();return mt.createRoot=r.createRoot,mt.hydrateRoot=r.hydrateRoot,mt}var Kn=qn();/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gn=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,d)=>d?d.toUpperCase():t.toLowerCase()),Js=r=>{const e=Gn(r);return e.charAt(0).toUpperCase()+e.slice(1)},Wr=(...r)=>r.filter((e,t,d)=>!!e&&e.trim()!==""&&d.indexOf(e)===t).join(" ").trim(),Xn=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=M.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:d,className:y="",children:k,iconNode:E,...s},a)=>M.createElement("svg",{ref:a,...Yn,width:e,height:e,stroke:r,strokeWidth:d?Number(t)*24/Number(e):t,className:Wr("lucide",y),...!k&&!Xn(s)&&{"aria-hidden":"true"},...s},[...E.map(([f,m])=>M.createElement(f,m)),...Array.isArray(k)?k:[k]]));/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=(r,e)=>{const t=M.forwardRef(({className:d,...y},k)=>M.createElement(Jn,{ref:k,iconNode:e,className:Wr(`lucide-${Vn(Js(r))}`,`lucide-${r}`,d),...y}));return t.displayName=Js(r),t};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Qn=Q("bot",Zn);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],je=Q("check",eo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],jt=Q("chevron-down",to);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],us=Q("chevron-right",so);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],io=Q("chevron-up",ro);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ae=Q("circle-alert",no);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ao=Q("circle-check-big",oo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],$r=Q("clock",lo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],yt=Q("code",co);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],uo=Q("copy",ho);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],po=Q("database",fo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ur=Q("download",_o);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],go=Q("ellipsis",mo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],Zs=Q("file-code",vo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xt=Q("file-text",So);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Ps=Q("file",bo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],xo=Q("folder-open",yo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],qr=Q("folder",wo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Eo=Q("grip-vertical",Co);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ro=Q("image",ko);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Ao=Q("key",Lo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ht=Q("loader-circle",Do);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Po=Q("menu",To);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],No=Q("message-circle",Mo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],At=Q("message-square",Bo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}]],Oo=Q("panel-bottom-open",Io);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],Ho=Q("panel-left-open",jo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Fo=Q("paperclip",zo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Kr=Q("plus",Wo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Vr=Q("refresh-cw",$o);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],qo=Q("search",Uo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Vo=Q("send",Ko);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gr=Q("settings",Go);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Yo=Q("sparkles",Xo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Yt=Q("star",Jo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],Qo=Q("terminal",Zo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],Qs=Q("test-tube",ea);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],sa=Q("upload",ta);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ia=Q("user",ra);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],er=Q("wrench",na);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pt=Q("x",oa);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],la=Q("zap",aa),zt=M.createContext(null);zt.displayName="PanelGroupContext";const ae={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Ms=10,He=M.useLayoutEffect,tr=gn.useId,ca=typeof tr=="function"?tr:()=>null;let ha=0;function Ns(r=null){const e=ca(),t=M.useRef(r||e||null);return t.current===null&&(t.current=""+ha++),r??t.current}function Xr({children:r,className:e="",collapsedSize:t,collapsible:d,defaultSize:y,forwardedRef:k,id:E,maxSize:s,minSize:a,onCollapse:f,onExpand:m,onResize:c,order:h,style:_,tagName:S="div",...p}){const n=M.useContext(zt);if(n===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:o,expandPanel:i,getPanelSize:l,getPanelStyle:g,groupId:x,isPanelCollapsed:b,reevaluatePanelConstraints:w,registerPanel:v,resizePanel:C,unregisterPanel:T}=n,A=Ns(E),N=M.useRef({callbacks:{onCollapse:f,onExpand:m,onResize:c},constraints:{collapsedSize:t,collapsible:d,defaultSize:y,maxSize:s,minSize:a},id:A,idIsFromProps:E!==void 0,order:h});M.useRef({didLogMissingDefaultSizeWarning:!1}),He(()=>{const{callbacks:j,constraints:F}=N.current,U={...F};N.current.id=A,N.current.idIsFromProps=E!==void 0,N.current.order=h,j.onCollapse=f,j.onExpand=m,j.onResize=c,F.collapsedSize=t,F.collapsible=d,F.defaultSize=y,F.maxSize=s,F.minSize=a,(U.collapsedSize!==F.collapsedSize||U.collapsible!==F.collapsible||U.maxSize!==F.maxSize||U.minSize!==F.minSize)&&w(N.current,U)}),He(()=>{const j=N.current;return v(j),()=>{T(j)}},[h,A,v,T]),M.useImperativeHandle(k,()=>({collapse:()=>{o(N.current)},expand:j=>{i(N.current,j)},getId(){return A},getSize(){return l(N.current)},isCollapsed(){return b(N.current)},isExpanded(){return!b(N.current)},resize:j=>{C(N.current,j)}}),[o,i,l,b,A,C]);const D=g(N.current,y);return M.createElement(S,{...p,children:r,className:e,id:A,style:{...D,..._},[ae.groupId]:x,[ae.panel]:"",[ae.panelCollapsible]:d||void 0,[ae.panelId]:A,[ae.panelSize]:parseFloat(""+D.flexGrow).toFixed(1)})}const Yr=M.forwardRef((r,e)=>M.createElement(Xr,{...r,forwardedRef:e}));Xr.displayName="Panel";Yr.displayName="forwardRef(Panel)";let fs=null,wt=-1,Me=null;function da(r,e){if(e){const t=(e&ti)!==0,d=(e&si)!==0,y=(e&ri)!==0,k=(e&ii)!==0;if(t)return y?"se-resize":k?"ne-resize":"e-resize";if(d)return y?"sw-resize":k?"nw-resize":"w-resize";if(y)return"s-resize";if(k)return"n-resize"}switch(r){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function ua(){Me!==null&&(document.head.removeChild(Me),fs=null,Me=null,wt=-1)}function Jt(r,e){var t,d;const y=da(r,e);if(fs!==y){if(fs=y,Me===null&&(Me=document.createElement("style"),document.head.appendChild(Me)),wt>=0){var k;(k=Me.sheet)===null||k===void 0||k.removeRule(wt)}wt=(t=(d=Me.sheet)===null||d===void 0?void 0:d.insertRule(`*{cursor: ${y} !important;}`))!==null&&t!==void 0?t:-1}}function Jr(r){return r.type==="keydown"}function Zr(r){return r.type.startsWith("pointer")}function Qr(r){return r.type.startsWith("mouse")}function Ft(r){if(Zr(r)){if(r.isPrimary)return{x:r.clientX,y:r.clientY}}else if(Qr(r))return{x:r.clientX,y:r.clientY};return{x:1/0,y:1/0}}function fa(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function pa(r,e,t){return r.x<e.x+e.width&&r.x+r.width>e.x&&r.y<e.y+e.height&&r.y+r.height>e.y}function _a(r,e){if(r===e)throw new Error("Cannot compare node with itself");const t={a:ir(r),b:ir(e)};let d;for(;t.a.at(-1)===t.b.at(-1);)r=t.a.pop(),e=t.b.pop(),d=r;ee(d,"Stacking order can only be calculated for elements with a common ancestor");const y={a:rr(sr(t.a)),b:rr(sr(t.b))};if(y.a===y.b){const k=d.childNodes,E={a:t.a.at(-1),b:t.b.at(-1)};let s=k.length;for(;s--;){const a=k[s];if(a===E.a)return 1;if(a===E.b)return-1}}return Math.sign(y.a-y.b)}const ma=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function ga(r){var e;const t=getComputedStyle((e=ei(r))!==null&&e!==void 0?e:r).display;return t==="flex"||t==="inline-flex"}function va(r){const e=getComputedStyle(r);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||ga(r))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||ma.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function sr(r){let e=r.length;for(;e--;){const t=r[e];if(ee(t,"Missing node"),va(t))return t}return null}function rr(r){return r&&Number(getComputedStyle(r).zIndex)||0}function ir(r){const e=[];for(;r;)e.push(r),r=ei(r);return e}function ei(r){const{parentNode:e}=r;return e&&e instanceof ShadowRoot?e.host:e}const ti=1,si=2,ri=4,ii=8,Sa=fa()==="coarse";let xe=[],Ke=!1,Ne=new Map,Wt=new Map;const dt=new Set;function ba(r,e,t,d,y){var k;const{ownerDocument:E}=e,s={direction:t,element:e,hitAreaMargins:d,setResizeHandlerState:y},a=(k=Ne.get(E))!==null&&k!==void 0?k:0;return Ne.set(E,a+1),dt.add(s),Dt(),function(){var m;Wt.delete(r),dt.delete(s);const c=(m=Ne.get(E))!==null&&m!==void 0?m:1;if(Ne.set(E,c-1),Dt(),c===1&&Ne.delete(E),xe.includes(s)){const h=xe.indexOf(s);h>=0&&xe.splice(h,1),Is(),y("up",!0,null)}}}function ya(r){const{target:e}=r,{x:t,y:d}=Ft(r);Ke=!0,Bs({target:e,x:t,y:d}),Dt(),xe.length>0&&(Tt("down",r),r.preventDefault(),ni(e)||r.stopImmediatePropagation())}function Zt(r){const{x:e,y:t}=Ft(r);if(Ke&&r.buttons===0&&(Ke=!1,Tt("up",r)),!Ke){const{target:d}=r;Bs({target:d,x:e,y:t})}Tt("move",r),Is(),xe.length>0&&r.preventDefault()}function Qt(r){const{target:e}=r,{x:t,y:d}=Ft(r);Wt.clear(),Ke=!1,xe.length>0&&(r.preventDefault(),ni(e)||r.stopImmediatePropagation()),Tt("up",r),Bs({target:e,x:t,y:d}),Is(),Dt()}function ni(r){let e=r;for(;e;){if(e.hasAttribute(ae.resizeHandle))return!0;e=e.parentElement}return!1}function Bs({target:r,x:e,y:t}){xe.splice(0);let d=null;(r instanceof HTMLElement||r instanceof SVGElement)&&(d=r),dt.forEach(y=>{const{element:k,hitAreaMargins:E}=y,s=k.getBoundingClientRect(),{bottom:a,left:f,right:m,top:c}=s,h=Sa?E.coarse:E.fine;if(e>=f-h&&e<=m+h&&t>=c-h&&t<=a+h){if(d!==null&&document.contains(d)&&k!==d&&!k.contains(d)&&!d.contains(k)&&_a(d,k)>0){let S=d,p=!1;for(;S&&!S.contains(k);){if(pa(S.getBoundingClientRect(),s)){p=!0;break}S=S.parentElement}if(p)return}xe.push(y)}})}function es(r,e){Wt.set(r,e)}function Is(){let r=!1,e=!1;xe.forEach(d=>{const{direction:y}=d;y==="horizontal"?r=!0:e=!0});let t=0;Wt.forEach(d=>{t|=d}),r&&e?Jt("intersection",t):r?Jt("horizontal",t):e?Jt("vertical",t):ua()}let ts;function Dt(){var r;(r=ts)===null||r===void 0||r.abort(),ts=new AbortController;const e={capture:!0,signal:ts.signal};dt.size&&(Ke?(xe.length>0&&Ne.forEach((t,d)=>{const{body:y}=d;t>0&&(y.addEventListener("contextmenu",Qt,e),y.addEventListener("pointerleave",Zt,e),y.addEventListener("pointermove",Zt,e))}),Ne.forEach((t,d)=>{const{body:y}=d;y.addEventListener("pointerup",Qt,e),y.addEventListener("pointercancel",Qt,e)})):Ne.forEach((t,d)=>{const{body:y}=d;t>0&&(y.addEventListener("pointerdown",ya,e),y.addEventListener("pointermove",Zt,e))}))}function Tt(r,e){dt.forEach(t=>{const{setResizeHandlerState:d}=t,y=xe.includes(t);d(r,y,e)})}function xa(){const[r,e]=M.useState(0);return M.useCallback(()=>e(t=>t+1),[])}function ee(r,e){if(!r)throw console.error(e),Error(e)}function ze(r,e,t=Ms){return r.toFixed(t)===e.toFixed(t)?0:r>e?1:-1}function Le(r,e,t=Ms){return ze(r,e,t)===0}function _e(r,e,t){return ze(r,e,t)===0}function wa(r,e,t){if(r.length!==e.length)return!1;for(let d=0;d<r.length;d++){const y=r[d],k=e[d];if(!_e(y,k,t))return!1}return!0}function qe({panelConstraints:r,panelIndex:e,size:t}){const d=r[e];ee(d!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:y=0,collapsible:k,maxSize:E=100,minSize:s=0}=d;if(ze(t,s)<0)if(k){const a=(y+s)/2;ze(t,a)<0?t=y:t=s}else t=s;return t=Math.min(E,t),t=parseFloat(t.toFixed(Ms)),t}function lt({delta:r,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:y,trigger:k}){if(_e(r,0))return e;const E=[...e],[s,a]=d;ee(s!=null,"Invalid first pivot index"),ee(a!=null,"Invalid second pivot index");let f=0;if(k==="keyboard"){{const c=r<0?a:s,h=t[c];ee(h,`Panel constraints not found for index ${c}`);const{collapsedSize:_=0,collapsible:S,minSize:p=0}=h;if(S){const n=e[c];if(ee(n!=null,`Previous layout not found for panel index ${c}`),_e(n,_)){const o=p-n;ze(o,Math.abs(r))>0&&(r=r<0?0-o:o)}}}{const c=r<0?s:a,h=t[c];ee(h,`No panel constraints found for index ${c}`);const{collapsedSize:_=0,collapsible:S,minSize:p=0}=h;if(S){const n=e[c];if(ee(n!=null,`Previous layout not found for panel index ${c}`),_e(n,p)){const o=n-_;ze(o,Math.abs(r))>0&&(r=r<0?0-o:o)}}}}{const c=r<0?1:-1;let h=r<0?a:s,_=0;for(;;){const p=e[h];ee(p!=null,`Previous layout not found for panel index ${h}`);const o=qe({panelConstraints:t,panelIndex:h,size:100})-p;if(_+=o,h+=c,h<0||h>=t.length)break}const S=Math.min(Math.abs(r),Math.abs(_));r=r<0?0-S:S}{let h=r<0?s:a;for(;h>=0&&h<t.length;){const _=Math.abs(r)-Math.abs(f),S=e[h];ee(S!=null,`Previous layout not found for panel index ${h}`);const p=S-_,n=qe({panelConstraints:t,panelIndex:h,size:p});if(!_e(S,n)&&(f+=S-n,E[h]=n,f.toPrecision(3).localeCompare(Math.abs(r).toPrecision(3),void 0,{numeric:!0})>=0))break;r<0?h--:h++}}if(wa(y,E))return y;{const c=r<0?a:s,h=e[c];ee(h!=null,`Previous layout not found for panel index ${c}`);const _=h+f,S=qe({panelConstraints:t,panelIndex:c,size:_});if(E[c]=S,!_e(S,_)){let p=_-S,o=r<0?a:s;for(;o>=0&&o<t.length;){const i=E[o];ee(i!=null,`Previous layout not found for panel index ${o}`);const l=i+p,g=qe({panelConstraints:t,panelIndex:o,size:l});if(_e(i,g)||(p-=g-i,E[o]=g),_e(p,0))break;r>0?o--:o++}}}const m=E.reduce((c,h)=>h+c,0);return _e(m,100)?E:y}function Ca({layout:r,panelsArray:e,pivotIndices:t}){let d=0,y=100,k=0,E=0;const s=t[0];ee(s!=null,"No pivot index found"),e.forEach((c,h)=>{const{constraints:_}=c,{maxSize:S=100,minSize:p=0}=_;h===s?(d=p,y=S):(k+=p,E+=S)});const a=Math.min(y,100-k),f=Math.max(d,100-E),m=r[s];return{valueMax:a,valueMin:f,valueNow:m}}function ut(r,e=document){return Array.from(e.querySelectorAll(`[${ae.resizeHandleId}][data-panel-group-id="${r}"]`))}function oi(r,e,t=document){const y=ut(r,t).findIndex(k=>k.getAttribute(ae.resizeHandleId)===e);return y??null}function ai(r,e,t){const d=oi(r,e,t);return d!=null?[d,d+1]:[-1,-1]}function Ea(r){return r instanceof HTMLElement?!0:typeof r=="object"&&r!==null&&"tagName"in r&&"getAttribute"in r}function li(r,e=document){if(Ea(e)&&e.dataset.panelGroupId==r)return e;const t=e.querySelector(`[data-panel-group][data-panel-group-id="${r}"]`);return t||null}function $t(r,e=document){const t=e.querySelector(`[${ae.resizeHandleId}="${r}"]`);return t||null}function ka(r,e,t,d=document){var y,k,E,s;const a=$t(e,d),f=ut(r,d),m=a?f.indexOf(a):-1,c=(y=(k=t[m])===null||k===void 0?void 0:k.id)!==null&&y!==void 0?y:null,h=(E=(s=t[m+1])===null||s===void 0?void 0:s.id)!==null&&E!==void 0?E:null;return[c,h]}function Ra({committedValuesRef:r,eagerValuesRef:e,groupId:t,layout:d,panelDataArray:y,panelGroupElement:k,setLayout:E}){M.useRef({didWarnAboutMissingResizeHandle:!1}),He(()=>{if(!k)return;const s=ut(t,k);for(let a=0;a<y.length-1;a++){const{valueMax:f,valueMin:m,valueNow:c}=Ca({layout:d,panelsArray:y,pivotIndices:[a,a+1]}),h=s[a];if(h!=null){const _=y[a];ee(_,`No panel data found for index "${a}"`),h.setAttribute("aria-controls",_.id),h.setAttribute("aria-valuemax",""+Math.round(f)),h.setAttribute("aria-valuemin",""+Math.round(m)),h.setAttribute("aria-valuenow",c!=null?""+Math.round(c):"")}}return()=>{s.forEach((a,f)=>{a.removeAttribute("aria-controls"),a.removeAttribute("aria-valuemax"),a.removeAttribute("aria-valuemin"),a.removeAttribute("aria-valuenow")})}},[t,d,y,k]),M.useEffect(()=>{if(!k)return;const s=e.current;ee(s,"Eager values not found");const{panelDataArray:a}=s,f=li(t,k);ee(f!=null,`No group found for id "${t}"`);const m=ut(t,k);ee(m,`No resize handles found for group id "${t}"`);const c=m.map(h=>{const _=h.getAttribute(ae.resizeHandleId);ee(_,"Resize handle element has no handle id attribute");const[S,p]=ka(t,_,a,k);if(S==null||p==null)return()=>{};const n=o=>{if(!o.defaultPrevented)switch(o.key){case"Enter":{o.preventDefault();const i=a.findIndex(l=>l.id===S);if(i>=0){const l=a[i];ee(l,`No panel data found for index ${i}`);const g=d[i],{collapsedSize:x=0,collapsible:b,minSize:w=0}=l.constraints;if(g!=null&&b){const v=lt({delta:_e(g,x)?w-x:x-g,initialLayout:d,panelConstraints:a.map(C=>C.constraints),pivotIndices:ai(t,_,k),prevLayout:d,trigger:"keyboard"});d!==v&&E(v)}}break}}};return h.addEventListener("keydown",n),()=>{h.removeEventListener("keydown",n)}});return()=>{c.forEach(h=>h())}},[k,r,e,t,d,y,E])}function nr(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function ci(r,e){const t=r==="horizontal",{x:d,y}=Ft(e);return t?d:y}function La(r,e,t,d,y){const k=t==="horizontal",E=$t(e,y);ee(E,`No resize handle element found for id "${e}"`);const s=E.getAttribute(ae.groupId);ee(s,"Resize handle element has no group id attribute");let{initialCursorPosition:a}=d;const f=ci(t,r),m=li(s,y);ee(m,`No group element found for id "${s}"`);const c=m.getBoundingClientRect(),h=k?c.width:c.height;return(f-a)/h*100}function Aa(r,e,t,d,y,k){if(Jr(r)){const E=t==="horizontal";let s=0;r.shiftKey?s=100:y!=null?s=y:s=10;let a=0;switch(r.key){case"ArrowDown":a=E?0:s;break;case"ArrowLeft":a=E?-s:0;break;case"ArrowRight":a=E?s:0;break;case"ArrowUp":a=E?0:-s;break;case"End":a=100;break;case"Home":a=-100;break}return a}else return d==null?0:La(r,e,t,d,k)}function Da({panelDataArray:r}){const e=Array(r.length),t=r.map(k=>k.constraints);let d=0,y=100;for(let k=0;k<r.length;k++){const E=t[k];ee(E,`Panel constraints not found for index ${k}`);const{defaultSize:s}=E;s!=null&&(d++,e[k]=s,y-=s)}for(let k=0;k<r.length;k++){const E=t[k];ee(E,`Panel constraints not found for index ${k}`);const{defaultSize:s}=E;if(s!=null)continue;const a=r.length-d,f=y/a;d++,e[k]=f,y-=f}return e}function We(r,e,t){e.forEach((d,y)=>{const k=r[y];ee(k,`Panel data not found for index ${y}`);const{callbacks:E,constraints:s,id:a}=k,{collapsedSize:f=0,collapsible:m}=s,c=t[a];if(c==null||d!==c){t[a]=d;const{onCollapse:h,onExpand:_,onResize:S}=E;S&&S(d,c),m&&(h||_)&&(_&&(c==null||Le(c,f))&&!Le(d,f)&&_(),h&&(c==null||!Le(c,f))&&Le(d,f)&&h())}})}function gt(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t])return!1;return!0}function Ta({defaultSize:r,dragState:e,layout:t,panelData:d,panelIndex:y,precision:k=3}){const E=t[y];let s;return E==null?s=r!=null?r.toPrecision(k):"1":d.length===1?s="1":s=E.toPrecision(k),{flexBasis:0,flexGrow:s,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function Pa(r,e=10){let t=null;return(...y)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{r(...y)},e)}}function or(r){try{if(typeof localStorage<"u")r.getItem=e=>localStorage.getItem(e),r.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),r.getItem=()=>null,r.setItem=()=>{}}}function hi(r){return`react-resizable-panels:${r}`}function di(r){return r.map(e=>{const{constraints:t,id:d,idIsFromProps:y,order:k}=e;return y?d:k?`${k}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function ui(r,e){try{const t=hi(r),d=e.getItem(t);if(d){const y=JSON.parse(d);if(typeof y=="object"&&y!=null)return y}}catch{}return null}function Ma(r,e,t){var d,y;const k=(d=ui(r,t))!==null&&d!==void 0?d:{},E=di(e);return(y=k[E])!==null&&y!==void 0?y:null}function Na(r,e,t,d,y){var k;const E=hi(r),s=di(e),a=(k=ui(r,y))!==null&&k!==void 0?k:{};a[s]={expandToSizes:Object.fromEntries(t.entries()),layout:d};try{y.setItem(E,JSON.stringify(a))}catch(f){console.error(f)}}function ar({layout:r,panelConstraints:e}){const t=[...r],d=t.reduce((k,E)=>k+E,0);if(t.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${t.map(k=>`${k}%`).join(", ")}`);if(!_e(d,100)&&t.length>0)for(let k=0;k<e.length;k++){const E=t[k];ee(E!=null,`No layout data found for index ${k}`);const s=100/d*E;t[k]=s}let y=0;for(let k=0;k<e.length;k++){const E=t[k];ee(E!=null,`No layout data found for index ${k}`);const s=qe({panelConstraints:e,panelIndex:k,size:E});E!=s&&(y+=E-s,t[k]=s)}if(!_e(y,0))for(let k=0;k<e.length;k++){const E=t[k];ee(E!=null,`No layout data found for index ${k}`);const s=E+y,a=qe({panelConstraints:e,panelIndex:k,size:s});if(E!==a&&(y-=a-E,t[k]=a,_e(y,0)))break}return t}const Ba=100,ct={getItem:r=>(or(ct),ct.getItem(r)),setItem:(r,e)=>{or(ct),ct.setItem(r,e)}},lr={};function fi({autoSaveId:r=null,children:e,className:t="",direction:d,forwardedRef:y,id:k=null,onLayout:E=null,keyboardResizeBy:s=null,storage:a=ct,style:f,tagName:m="div",...c}){const h=Ns(k),_=M.useRef(null),[S,p]=M.useState(null),[n,o]=M.useState([]),i=xa(),l=M.useRef({}),g=M.useRef(new Map),x=M.useRef(0),b=M.useRef({autoSaveId:r,direction:d,dragState:S,id:h,keyboardResizeBy:s,onLayout:E,storage:a}),w=M.useRef({layout:n,panelDataArray:[],panelDataArrayChanged:!1});M.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),M.useImperativeHandle(y,()=>({getId:()=>b.current.id,getLayout:()=>{const{layout:H}=w.current;return H},setLayout:H=>{const{onLayout:W}=b.current,{layout:K,panelDataArray:V}=w.current,I=ar({layout:H,panelConstraints:V.map(L=>L.constraints)});nr(K,I)||(o(I),w.current.layout=I,W&&W(I),We(V,I,l.current))}}),[]),He(()=>{b.current.autoSaveId=r,b.current.direction=d,b.current.dragState=S,b.current.id=h,b.current.onLayout=E,b.current.storage=a}),Ra({committedValuesRef:b,eagerValuesRef:w,groupId:h,layout:n,panelDataArray:w.current.panelDataArray,setLayout:o,panelGroupElement:_.current}),M.useEffect(()=>{const{panelDataArray:H}=w.current;if(r){if(n.length===0||n.length!==H.length)return;let W=lr[r];W==null&&(W=Pa(Na,Ba),lr[r]=W);const K=[...H],V=new Map(g.current);W(r,K,V,n,a)}},[r,n,a]),M.useEffect(()=>{});const v=M.useCallback(H=>{const{onLayout:W}=b.current,{layout:K,panelDataArray:V}=w.current;if(H.constraints.collapsible){const I=V.map(Y=>Y.constraints),{collapsedSize:L=0,panelSize:z,pivotIndices:$}=Oe(V,H,K);if(ee(z!=null,`Panel size not found for panel "${H.id}"`),!Le(z,L)){g.current.set(H.id,z);const G=Ue(V,H)===V.length-1?z-L:L-z,J=lt({delta:G,initialLayout:K,panelConstraints:I,pivotIndices:$,prevLayout:K,trigger:"imperative-api"});gt(K,J)||(o(J),w.current.layout=J,W&&W(J),We(V,J,l.current))}}},[]),C=M.useCallback((H,W)=>{const{onLayout:K}=b.current,{layout:V,panelDataArray:I}=w.current;if(H.constraints.collapsible){const L=I.map(re=>re.constraints),{collapsedSize:z=0,panelSize:$=0,minSize:Y=0,pivotIndices:G}=Oe(I,H,V),J=W??Y;if(Le($,z)){const re=g.current.get(H.id),ne=re!=null&&re>=J?re:J,Z=Ue(I,H)===I.length-1?$-ne:ne-$,le=lt({delta:Z,initialLayout:V,panelConstraints:L,pivotIndices:G,prevLayout:V,trigger:"imperative-api"});gt(V,le)||(o(le),w.current.layout=le,K&&K(le),We(I,le,l.current))}}},[]),T=M.useCallback(H=>{const{layout:W,panelDataArray:K}=w.current,{panelSize:V}=Oe(K,H,W);return ee(V!=null,`Panel size not found for panel "${H.id}"`),V},[]),A=M.useCallback((H,W)=>{const{panelDataArray:K}=w.current,V=Ue(K,H);return Ta({defaultSize:W,dragState:S,layout:n,panelData:K,panelIndex:V})},[S,n]),N=M.useCallback(H=>{const{layout:W,panelDataArray:K}=w.current,{collapsedSize:V=0,collapsible:I,panelSize:L}=Oe(K,H,W);return ee(L!=null,`Panel size not found for panel "${H.id}"`),I===!0&&Le(L,V)},[]),D=M.useCallback(H=>{const{layout:W,panelDataArray:K}=w.current,{collapsedSize:V=0,collapsible:I,panelSize:L}=Oe(K,H,W);return ee(L!=null,`Panel size not found for panel "${H.id}"`),!I||ze(L,V)>0},[]),j=M.useCallback(H=>{const{panelDataArray:W}=w.current;W.push(H),W.sort((K,V)=>{const I=K.order,L=V.order;return I==null&&L==null?0:I==null?-1:L==null?1:I-L}),w.current.panelDataArrayChanged=!0,i()},[i]);He(()=>{if(w.current.panelDataArrayChanged){w.current.panelDataArrayChanged=!1;const{autoSaveId:H,onLayout:W,storage:K}=b.current,{layout:V,panelDataArray:I}=w.current;let L=null;if(H){const $=Ma(H,I,K);$&&(g.current=new Map(Object.entries($.expandToSizes)),L=$.layout)}L==null&&(L=Da({panelDataArray:I}));const z=ar({layout:L,panelConstraints:I.map($=>$.constraints)});nr(V,z)||(o(z),w.current.layout=z,W&&W(z),We(I,z,l.current))}}),He(()=>{const H=w.current;return()=>{H.layout=[]}},[]);const F=M.useCallback(H=>{let W=!1;const K=_.current;return K&&window.getComputedStyle(K,null).getPropertyValue("direction")==="rtl"&&(W=!0),function(I){I.preventDefault();const L=_.current;if(!L)return()=>null;const{direction:z,dragState:$,id:Y,keyboardResizeBy:G,onLayout:J}=b.current,{layout:re,panelDataArray:ne}=w.current,{initialLayout:he}=$??{},Z=ai(Y,H,L);let le=Aa(I,H,z,$,G,L);const Fe=z==="horizontal";Fe&&W&&(le=-le);const Ze=ne.map(pe=>pe.constraints),Re=lt({delta:le,initialLayout:he??re,panelConstraints:Ze,pivotIndices:Z,prevLayout:re,trigger:Jr(I)?"keyboard":"mouse-or-touch"}),Ie=!gt(re,Re);(Zr(I)||Qr(I))&&x.current!=le&&(x.current=le,!Ie&&le!==0?Fe?es(H,le<0?ti:si):es(H,le<0?ri:ii):es(H,0)),Ie&&(o(Re),w.current.layout=Re,J&&J(Re),We(ne,Re,l.current))}},[]),U=M.useCallback((H,W)=>{const{onLayout:K}=b.current,{layout:V,panelDataArray:I}=w.current,L=I.map(re=>re.constraints),{panelSize:z,pivotIndices:$}=Oe(I,H,V);ee(z!=null,`Panel size not found for panel "${H.id}"`);const G=Ue(I,H)===I.length-1?z-W:W-z,J=lt({delta:G,initialLayout:V,panelConstraints:L,pivotIndices:$,prevLayout:V,trigger:"imperative-api"});gt(V,J)||(o(J),w.current.layout=J,K&&K(J),We(I,J,l.current))},[]),X=M.useCallback((H,W)=>{const{layout:K,panelDataArray:V}=w.current,{collapsedSize:I=0,collapsible:L}=W,{collapsedSize:z=0,collapsible:$,maxSize:Y=100,minSize:G=0}=H.constraints,{panelSize:J}=Oe(V,H,K);J!=null&&(L&&$&&Le(J,I)?Le(I,z)||U(H,z):J<G?U(H,G):J>Y&&U(H,Y))},[U]),q=M.useCallback((H,W)=>{const{direction:K}=b.current,{layout:V}=w.current;if(!_.current)return;const I=$t(H,_.current);ee(I,`Drag handle element not found for id "${H}"`);const L=ci(K,W);p({dragHandleId:H,dragHandleRect:I.getBoundingClientRect(),initialCursorPosition:L,initialLayout:V})},[]),R=M.useCallback(()=>{p(null)},[]),P=M.useCallback(H=>{const{panelDataArray:W}=w.current,K=Ue(W,H);K>=0&&(W.splice(K,1),delete l.current[H.id],w.current.panelDataArrayChanged=!0,i())},[i]),B=M.useMemo(()=>({collapsePanel:v,direction:d,dragState:S,expandPanel:C,getPanelSize:T,getPanelStyle:A,groupId:h,isPanelCollapsed:N,isPanelExpanded:D,reevaluatePanelConstraints:X,registerPanel:j,registerResizeHandle:F,resizePanel:U,startDragging:q,stopDragging:R,unregisterPanel:P,panelGroupElement:_.current}),[v,S,d,C,T,A,h,N,D,X,j,F,U,q,R,P]),O={display:"flex",flexDirection:d==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return M.createElement(zt.Provider,{value:B},M.createElement(m,{...c,children:e,className:t,id:k,ref:_,style:{...O,...f},[ae.group]:"",[ae.groupDirection]:d,[ae.groupId]:h}))}const pi=M.forwardRef((r,e)=>M.createElement(fi,{...r,forwardedRef:e}));fi.displayName="PanelGroup";pi.displayName="forwardRef(PanelGroup)";function Ue(r,e){return r.findIndex(t=>t===e||t.id===e.id)}function Oe(r,e,t){const d=Ue(r,e),k=d===r.length-1?[d-1,d]:[d,d+1],E=t[d];return{...e.constraints,panelSize:E,pivotIndices:k}}function Ia({disabled:r,handleId:e,resizeHandler:t,panelGroupElement:d}){M.useEffect(()=>{if(r||t==null||d==null)return;const y=$t(e,d);if(y==null)return;const k=E=>{if(!E.defaultPrevented)switch(E.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{E.preventDefault(),t(E);break}case"F6":{E.preventDefault();const s=y.getAttribute(ae.groupId);ee(s,`No group element found for id "${s}"`);const a=ut(s,d),f=oi(s,e,d);ee(f!==null,`No resize element found for id "${e}"`);const m=E.shiftKey?f>0?f-1:a.length-1:f+1<a.length?f+1:0;a[m].focus();break}}};return y.addEventListener("keydown",k),()=>{y.removeEventListener("keydown",k)}},[d,r,e,t])}function _i({children:r=null,className:e="",disabled:t=!1,hitAreaMargins:d,id:y,onBlur:k,onClick:E,onDragging:s,onFocus:a,onPointerDown:f,onPointerUp:m,style:c={},tabIndex:h=0,tagName:_="div",...S}){var p,n;const o=M.useRef(null),i=M.useRef({onClick:E,onDragging:s,onPointerDown:f,onPointerUp:m});M.useEffect(()=>{i.current.onClick=E,i.current.onDragging=s,i.current.onPointerDown=f,i.current.onPointerUp=m});const l=M.useContext(zt);if(l===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:g,groupId:x,registerResizeHandle:b,startDragging:w,stopDragging:v,panelGroupElement:C}=l,T=Ns(y),[A,N]=M.useState("inactive"),[D,j]=M.useState(!1),[F,U]=M.useState(null),X=M.useRef({state:A});He(()=>{X.current.state=A}),M.useEffect(()=>{if(t)U(null);else{const B=b(T);U(()=>B)}},[t,T,b]);const q=(p=d?.coarse)!==null&&p!==void 0?p:15,R=(n=d?.fine)!==null&&n!==void 0?n:5;M.useEffect(()=>{if(t||F==null)return;const B=o.current;ee(B,"Element ref not attached");let O=!1;return ba(T,B,g,{coarse:q,fine:R},(W,K,V)=>{if(!K){N("inactive");return}switch(W){case"down":{N("drag"),O=!1,ee(V,'Expected event to be defined for "down" action'),w(T,V);const{onDragging:I,onPointerDown:L}=i.current;I?.(!0),L?.();break}case"move":{const{state:I}=X.current;O=!0,I!=="drag"&&N("hover"),ee(V,'Expected event to be defined for "move" action'),F(V);break}case"up":{N("hover"),v();const{onClick:I,onDragging:L,onPointerUp:z}=i.current;L?.(!1),z?.(),O||I?.();break}}})},[q,g,t,R,b,T,F,w,v]),Ia({disabled:t,handleId:T,resizeHandler:F,panelGroupElement:C});const P={touchAction:"none",userSelect:"none"};return M.createElement(_,{...S,children:r,className:e,id:y,onBlur:()=>{j(!1),k?.()},onFocus:()=>{j(!0),a?.()},ref:o,role:"separator",style:{...P,...c},tabIndex:h,[ae.groupDirection]:g,[ae.groupId]:x,[ae.resizeHandle]:"",[ae.resizeHandleActive]:A==="drag"?"pointer":D?"keyboard":void 0,[ae.resizeHandleEnabled]:!t,[ae.resizeHandleId]:T,[ae.resizeHandleState]:A})}_i.displayName="PanelResizeHandle";function te(...r){return Un(Fr(r))}function cr({className:r,...e}){return u.jsx(pi,{"data-slot":"resizable-panel-group",className:te("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",r),...e})}function vt({...r}){return u.jsx(Yr,{"data-slot":"resizable-panel",...r})}function hr({withHandle:r,className:e,...t}){return u.jsx(_i,{"data-slot":"resizable-handle",className:te("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",e),...t,children:r&&u.jsx("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:u.jsx(Eo,{className:"size-2.5"})})})}const dr=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,ur=Fr,Os=(r,e)=>t=>{var d;if(e?.variants==null)return ur(r,t?.class,t?.className);const{variants:y,defaultVariants:k}=e,E=Object.keys(y).map(f=>{const m=t?.[f],c=k?.[f];if(m===null)return null;const h=dr(m)||dr(c);return y[f][h]}),s=t&&Object.entries(t).reduce((f,m)=>{let[c,h]=m;return h===void 0||(f[c]=h),f},{}),a=e==null||(d=e.compoundVariants)===null||d===void 0?void 0:d.reduce((f,m)=>{let{class:c,className:h,..._}=m;return Object.entries(_).every(S=>{let[p,n]=S;return Array.isArray(n)?n.includes({...k,...s}[p]):{...k,...s}[p]===n})?[...f,c,h]:f},[]);return ur(r,E,a,t?.class,t?.className)},Oa=Os("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function ie({className:r,variant:e,size:t,asChild:d=!1,...y}){const k=d?Mr:"button";return u.jsx(k,{"data-slot":"button",className:te(Oa({variant:e,size:t,className:r})),...y})}function ja(r,e){return M.useReducer((t,d)=>e[t][d]??t,r)}var js="ScrollArea",[mi,jh]=It(js),[Ha,be]=mi(js),gi=M.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:d="hover",dir:y,scrollHideDelay:k=600,...E}=r,[s,a]=M.useState(null),[f,m]=M.useState(null),[c,h]=M.useState(null),[_,S]=M.useState(null),[p,n]=M.useState(null),[o,i]=M.useState(0),[l,g]=M.useState(0),[x,b]=M.useState(!1),[w,v]=M.useState(!1),C=Se(e,A=>a(A)),T=Nr(y);return u.jsx(Ha,{scope:t,type:d,dir:T,scrollHideDelay:k,scrollArea:s,viewport:f,onViewportChange:m,content:c,onContentChange:h,scrollbarX:_,onScrollbarXChange:S,scrollbarXEnabled:x,onScrollbarXEnabledChange:b,scrollbarY:p,onScrollbarYChange:n,scrollbarYEnabled:w,onScrollbarYEnabledChange:v,onCornerWidthChange:i,onCornerHeightChange:g,children:u.jsx(ue.div,{dir:T,...E,ref:C,style:{position:"relative","--radix-scroll-area-corner-width":o+"px","--radix-scroll-area-corner-height":l+"px",...r.style}})})});gi.displayName=js;var vi="ScrollAreaViewport",Si=M.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:d,nonce:y,...k}=r,E=be(vi,t),s=M.useRef(null),a=Se(e,s,E.onViewportChange);return u.jsxs(u.Fragment,{children:[u.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:y}),u.jsx(ue.div,{"data-radix-scroll-area-viewport":"",...k,ref:a,style:{overflowX:E.scrollbarXEnabled?"scroll":"hidden",overflowY:E.scrollbarYEnabled?"scroll":"hidden",...r.style},children:u.jsx("div",{ref:E.onContentChange,style:{minWidth:"100%",display:"table"},children:d})})]})});Si.displayName=vi;var ke="ScrollAreaScrollbar",bi=M.forwardRef((r,e)=>{const{forceMount:t,...d}=r,y=be(ke,r.__scopeScrollArea),{onScrollbarXEnabledChange:k,onScrollbarYEnabledChange:E}=y,s=r.orientation==="horizontal";return M.useEffect(()=>(s?k(!0):E(!0),()=>{s?k(!1):E(!1)}),[s,k,E]),y.type==="hover"?u.jsx(za,{...d,ref:e,forceMount:t}):y.type==="scroll"?u.jsx(Fa,{...d,ref:e,forceMount:t}):y.type==="auto"?u.jsx(yi,{...d,ref:e,forceMount:t}):y.type==="always"?u.jsx(Hs,{...d,ref:e}):null});bi.displayName=ke;var za=M.forwardRef((r,e)=>{const{forceMount:t,...d}=r,y=be(ke,r.__scopeScrollArea),[k,E]=M.useState(!1);return M.useEffect(()=>{const s=y.scrollArea;let a=0;if(s){const f=()=>{window.clearTimeout(a),E(!0)},m=()=>{a=window.setTimeout(()=>E(!1),y.scrollHideDelay)};return s.addEventListener("pointerenter",f),s.addEventListener("pointerleave",m),()=>{window.clearTimeout(a),s.removeEventListener("pointerenter",f),s.removeEventListener("pointerleave",m)}}},[y.scrollArea,y.scrollHideDelay]),u.jsx(Ot,{present:t||k,children:u.jsx(yi,{"data-state":k?"visible":"hidden",...d,ref:e})})}),Fa=M.forwardRef((r,e)=>{const{forceMount:t,...d}=r,y=be(ke,r.__scopeScrollArea),k=r.orientation==="horizontal",E=qt(()=>a("SCROLL_END"),100),[s,a]=ja("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return M.useEffect(()=>{if(s==="idle"){const f=window.setTimeout(()=>a("HIDE"),y.scrollHideDelay);return()=>window.clearTimeout(f)}},[s,y.scrollHideDelay,a]),M.useEffect(()=>{const f=y.viewport,m=k?"scrollLeft":"scrollTop";if(f){let c=f[m];const h=()=>{const _=f[m];c!==_&&(a("SCROLL"),E()),c=_};return f.addEventListener("scroll",h),()=>f.removeEventListener("scroll",h)}},[y.viewport,k,a,E]),u.jsx(Ot,{present:t||s!=="hidden",children:u.jsx(Hs,{"data-state":s==="hidden"?"hidden":"visible",...d,ref:e,onPointerEnter:me(r.onPointerEnter,()=>a("POINTER_ENTER")),onPointerLeave:me(r.onPointerLeave,()=>a("POINTER_LEAVE"))})})}),yi=M.forwardRef((r,e)=>{const t=be(ke,r.__scopeScrollArea),{forceMount:d,...y}=r,[k,E]=M.useState(!1),s=r.orientation==="horizontal",a=qt(()=>{if(t.viewport){const f=t.viewport.offsetWidth<t.viewport.scrollWidth,m=t.viewport.offsetHeight<t.viewport.scrollHeight;E(s?f:m)}},10);return Xe(t.viewport,a),Xe(t.content,a),u.jsx(Ot,{present:d||k,children:u.jsx(Hs,{"data-state":k?"visible":"hidden",...y,ref:e})})}),Hs=M.forwardRef((r,e)=>{const{orientation:t="vertical",...d}=r,y=be(ke,r.__scopeScrollArea),k=M.useRef(null),E=M.useRef(0),[s,a]=M.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=ki(s.viewport,s.content),m={...d,sizes:s,onSizesChange:a,hasThumb:f>0&&f<1,onThumbChange:h=>k.current=h,onThumbPointerUp:()=>E.current=0,onThumbPointerDown:h=>E.current=h};function c(h,_){return Va(h,E.current,s,_)}return t==="horizontal"?u.jsx(Wa,{...m,ref:e,onThumbPositionChange:()=>{if(y.viewport&&k.current){const h=y.viewport.scrollLeft,_=fr(h,s,y.dir);k.current.style.transform=`translate3d(${_}px, 0, 0)`}},onWheelScroll:h=>{y.viewport&&(y.viewport.scrollLeft=h)},onDragScroll:h=>{y.viewport&&(y.viewport.scrollLeft=c(h,y.dir))}}):t==="vertical"?u.jsx($a,{...m,ref:e,onThumbPositionChange:()=>{if(y.viewport&&k.current){const h=y.viewport.scrollTop,_=fr(h,s);k.current.style.transform=`translate3d(0, ${_}px, 0)`}},onWheelScroll:h=>{y.viewport&&(y.viewport.scrollTop=h)},onDragScroll:h=>{y.viewport&&(y.viewport.scrollTop=c(h))}}):null}),Wa=M.forwardRef((r,e)=>{const{sizes:t,onSizesChange:d,...y}=r,k=be(ke,r.__scopeScrollArea),[E,s]=M.useState(),a=M.useRef(null),f=Se(e,a,k.onScrollbarXChange);return M.useEffect(()=>{a.current&&s(getComputedStyle(a.current))},[a]),u.jsx(wi,{"data-orientation":"horizontal",...y,ref:f,sizes:t,style:{bottom:0,left:k.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:k.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ut(t)+"px",...r.style},onThumbPointerDown:m=>r.onThumbPointerDown(m.x),onDragScroll:m=>r.onDragScroll(m.x),onWheelScroll:(m,c)=>{if(k.viewport){const h=k.viewport.scrollLeft+m.deltaX;r.onWheelScroll(h),Li(h,c)&&m.preventDefault()}},onResize:()=>{a.current&&k.viewport&&E&&d({content:k.viewport.scrollWidth,viewport:k.viewport.offsetWidth,scrollbar:{size:a.current.clientWidth,paddingStart:Mt(E.paddingLeft),paddingEnd:Mt(E.paddingRight)}})}})}),$a=M.forwardRef((r,e)=>{const{sizes:t,onSizesChange:d,...y}=r,k=be(ke,r.__scopeScrollArea),[E,s]=M.useState(),a=M.useRef(null),f=Se(e,a,k.onScrollbarYChange);return M.useEffect(()=>{a.current&&s(getComputedStyle(a.current))},[a]),u.jsx(wi,{"data-orientation":"vertical",...y,ref:f,sizes:t,style:{top:0,right:k.dir==="ltr"?0:void 0,left:k.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ut(t)+"px",...r.style},onThumbPointerDown:m=>r.onThumbPointerDown(m.y),onDragScroll:m=>r.onDragScroll(m.y),onWheelScroll:(m,c)=>{if(k.viewport){const h=k.viewport.scrollTop+m.deltaY;r.onWheelScroll(h),Li(h,c)&&m.preventDefault()}},onResize:()=>{a.current&&k.viewport&&E&&d({content:k.viewport.scrollHeight,viewport:k.viewport.offsetHeight,scrollbar:{size:a.current.clientHeight,paddingStart:Mt(E.paddingTop),paddingEnd:Mt(E.paddingBottom)}})}})}),[Ua,xi]=mi(ke),wi=M.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:d,hasThumb:y,onThumbChange:k,onThumbPointerUp:E,onThumbPointerDown:s,onThumbPositionChange:a,onDragScroll:f,onWheelScroll:m,onResize:c,...h}=r,_=be(ke,t),[S,p]=M.useState(null),n=Se(e,C=>p(C)),o=M.useRef(null),i=M.useRef(""),l=_.viewport,g=d.content-d.viewport,x=Pe(m),b=Pe(a),w=qt(c,10);function v(C){if(o.current){const T=C.clientX-o.current.left,A=C.clientY-o.current.top;f({x:T,y:A})}}return M.useEffect(()=>{const C=T=>{const A=T.target;S?.contains(A)&&x(T,g)};return document.addEventListener("wheel",C,{passive:!1}),()=>document.removeEventListener("wheel",C,{passive:!1})},[l,S,g,x]),M.useEffect(b,[d,b]),Xe(S,w),Xe(_.content,w),u.jsx(Ua,{scope:t,scrollbar:S,hasThumb:y,onThumbChange:Pe(k),onThumbPointerUp:Pe(E),onThumbPositionChange:b,onThumbPointerDown:Pe(s),children:u.jsx(ue.div,{...h,ref:n,style:{position:"absolute",...h.style},onPointerDown:me(r.onPointerDown,C=>{C.button===0&&(C.target.setPointerCapture(C.pointerId),o.current=S.getBoundingClientRect(),i.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",_.viewport&&(_.viewport.style.scrollBehavior="auto"),v(C))}),onPointerMove:me(r.onPointerMove,v),onPointerUp:me(r.onPointerUp,C=>{const T=C.target;T.hasPointerCapture(C.pointerId)&&T.releasePointerCapture(C.pointerId),document.body.style.webkitUserSelect=i.current,_.viewport&&(_.viewport.style.scrollBehavior=""),o.current=null})})})}),Pt="ScrollAreaThumb",Ci=M.forwardRef((r,e)=>{const{forceMount:t,...d}=r,y=xi(Pt,r.__scopeScrollArea);return u.jsx(Ot,{present:t||y.hasThumb,children:u.jsx(qa,{ref:e,...d})})}),qa=M.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:d,...y}=r,k=be(Pt,t),E=xi(Pt,t),{onThumbPositionChange:s}=E,a=Se(e,c=>E.onThumbChange(c)),f=M.useRef(void 0),m=qt(()=>{f.current&&(f.current(),f.current=void 0)},100);return M.useEffect(()=>{const c=k.viewport;if(c){const h=()=>{if(m(),!f.current){const _=Ga(c,s);f.current=_,s()}};return s(),c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[k.viewport,m,s]),u.jsx(ue.div,{"data-state":E.hasThumb?"visible":"hidden",...y,ref:a,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...d},onPointerDownCapture:me(r.onPointerDownCapture,c=>{const _=c.target.getBoundingClientRect(),S=c.clientX-_.left,p=c.clientY-_.top;E.onThumbPointerDown({x:S,y:p})}),onPointerUp:me(r.onPointerUp,E.onThumbPointerUp)})});Ci.displayName=Pt;var zs="ScrollAreaCorner",Ei=M.forwardRef((r,e)=>{const t=be(zs,r.__scopeScrollArea),d=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&d?u.jsx(Ka,{...r,ref:e}):null});Ei.displayName=zs;var Ka=M.forwardRef((r,e)=>{const{__scopeScrollArea:t,...d}=r,y=be(zs,t),[k,E]=M.useState(0),[s,a]=M.useState(0),f=!!(k&&s);return Xe(y.scrollbarX,()=>{const m=y.scrollbarX?.offsetHeight||0;y.onCornerHeightChange(m),a(m)}),Xe(y.scrollbarY,()=>{const m=y.scrollbarY?.offsetWidth||0;y.onCornerWidthChange(m),E(m)}),f?u.jsx(ue.div,{...d,ref:e,style:{width:k,height:s,position:"absolute",right:y.dir==="ltr"?0:void 0,left:y.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function Mt(r){return r?parseInt(r,10):0}function ki(r,e){const t=r/e;return isNaN(t)?0:t}function Ut(r){const e=ki(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,d=(r.scrollbar.size-t)*e;return Math.max(d,18)}function Va(r,e,t,d="ltr"){const y=Ut(t),k=y/2,E=e||k,s=y-E,a=t.scrollbar.paddingStart+E,f=t.scrollbar.size-t.scrollbar.paddingEnd-s,m=t.content-t.viewport,c=d==="ltr"?[0,m]:[m*-1,0];return Ri([a,f],c)(r)}function fr(r,e,t="ltr"){const d=Ut(e),y=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,k=e.scrollbar.size-y,E=e.content-e.viewport,s=k-d,a=t==="ltr"?[0,E]:[E*-1,0],f=Ts(r,a);return Ri([0,E],[0,s])(f)}function Ri(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const d=(e[1]-e[0])/(r[1]-r[0]);return e[0]+d*(t-r[0])}}function Li(r,e){return r>0&&r<e}var Ga=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},d=0;return function y(){const k={left:r.scrollLeft,top:r.scrollTop},E=t.left!==k.left,s=t.top!==k.top;(E||s)&&e(),t=k,d=window.requestAnimationFrame(y)}(),()=>window.cancelAnimationFrame(d)};function qt(r,e){const t=Pe(r),d=M.useRef(0);return M.useEffect(()=>()=>window.clearTimeout(d.current),[]),M.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(t,e)},[t,e])}function Xe(r,e){const t=Pe(e);Lt(()=>{let d=0;if(r){const y=new ResizeObserver(()=>{cancelAnimationFrame(d),d=window.requestAnimationFrame(t)});return y.observe(r),()=>{window.cancelAnimationFrame(d),y.unobserve(r)}}},[r,t])}var Xa=gi,Ya=Si,Ja=Ei;function ft({className:r,children:e,...t}){return u.jsxs(Xa,{"data-slot":"scroll-area",className:te("relative",r),...t,children:[u.jsx(Ya,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:e}),u.jsx(Za,{}),u.jsx(Ja,{})]})}function Za({className:r,orientation:e="vertical",...t}){return u.jsx(bi,{"data-slot":"scroll-area-scrollbar",orientation:e,className:te("flex touch-none p-px transition-colors select-none",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",r),...t,children:u.jsx(Ci,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Ai({className:r,...e}){return u.jsx(vn,{"data-slot":"tabs",className:te("flex flex-col gap-2",r),...e})}function Qa({className:r,...e}){return u.jsx(Sn,{"data-slot":"tabs-list",className:te("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",r),...e})}function pr({className:r,...e}){return u.jsx(bn,{"data-slot":"tabs-trigger",className:te("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...e})}function _r({className:r,...e}){return u.jsx(yn,{"data-slot":"tabs-content",className:te("flex-1 outline-none",r),...e})}const el=Os("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Ve({className:r,variant:e,asChild:t=!1,...d}){const y=t?Mr:"span";return u.jsx(y,{"data-slot":"badge",className:te(el({variant:e}),r),...d})}function tl({...r}){return u.jsx(Br,{"data-slot":"sheet",...r})}function sl({...r}){return u.jsx(Hr,{"data-slot":"sheet-portal",...r})}function rl({className:r,...e}){return u.jsx(zr,{"data-slot":"sheet-overlay",className:te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",r),...e})}function il({className:r,children:e,side:t="right",...d}){return u.jsxs(sl,{children:[u.jsx(rl,{}),u.jsxs(Ir,{"data-slot":"sheet-content",className:te("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",t==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",t==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",t==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",t==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",r),...d,children:[e,u.jsxs(Or,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[u.jsx(pt,{className:"size-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function nl({className:r,...e}){return u.jsx("div",{"data-slot":"sheet-header",className:te("flex flex-col gap-1.5 p-4",r),...e})}function ol({className:r,...e}){return u.jsx(jr,{"data-slot":"sheet-title",className:te("text-foreground font-semibold",r),...e})}function al({className:r,...e}){return u.jsx("textarea",{"data-slot":"textarea",className:te("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...e})}function fe({className:r,...e}){return u.jsx("div",{"data-slot":"skeleton",className:te("bg-accent animate-pulse rounded-md",r),...e})}function ll({className:r}){return u.jsxs("div",{className:`p-4 space-y-4 ${r||""}`,children:[u.jsxs("div",{className:"flex gap-2 mb-4",children:[u.jsx(fe,{className:"h-8 w-12"}),u.jsx(fe,{className:"h-8 w-16"}),u.jsx(fe,{className:"h-8 w-20"})]}),[...Array(3)].map((e,t)=>u.jsxs("div",{className:"border border-border/30 rounded-lg p-3 space-y-2",children:[u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[u.jsx(fe,{className:"h-4 w-4 rounded mt-1"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx(fe,{className:"h-4 w-48"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(fe,{className:"h-5 w-16 rounded-full"}),u.jsx(fe,{className:"h-4 w-20"})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(fe,{className:"h-3 w-12"}),u.jsx(fe,{className:"h-3 w-16"}),u.jsx(fe,{className:"h-3 w-8"})]})]})]})}),t===0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("div",{className:"ml-6 p-2 rounded bg-primary/10",children:[u.jsx(fe,{className:"h-4 w-64 mb-1"}),u.jsx(fe,{className:"h-3 w-16"})]}),u.jsxs("div",{className:"mr-6 p-2 rounded bg-secondary/10",children:[u.jsx(fe,{className:"h-4 w-72 mb-1"}),u.jsx(fe,{className:"h-4 w-48 mb-1"}),u.jsx(fe,{className:"h-3 w-16"})]})]})]},t))]})}const Ee=Object.create(null);Ee.open="0";Ee.close="1";Ee.ping="2";Ee.pong="3";Ee.message="4";Ee.upgrade="5";Ee.noop="6";const Ct=Object.create(null);Object.keys(Ee).forEach(r=>{Ct[Ee[r]]=r});const ps={type:"error",data:"parser error"},Di=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ti=typeof ArrayBuffer=="function",Pi=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,Fs=({type:r,data:e},t,d)=>Di&&e instanceof Blob?t?d(e):mr(e,d):Ti&&(e instanceof ArrayBuffer||Pi(e))?t?d(e):mr(new Blob([e]),d):d(Ee[r]+(e||"")),mr=(r,e)=>{const t=new FileReader;return t.onload=function(){const d=t.result.split(",")[1];e("b"+(d||""))},t.readAsDataURL(r)};function gr(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let ss;function cl(r,e){if(Di&&r.data instanceof Blob)return r.data.arrayBuffer().then(gr).then(e);if(Ti&&(r.data instanceof ArrayBuffer||Pi(r.data)))return e(gr(r.data));Fs(r,!1,t=>{ss||(ss=new TextEncoder),e(ss.encode(t))})}const vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ht=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<vr.length;r++)ht[vr.charCodeAt(r)]=r;const hl=r=>{let e=r.length*.75,t=r.length,d,y=0,k,E,s,a;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);const f=new ArrayBuffer(e),m=new Uint8Array(f);for(d=0;d<t;d+=4)k=ht[r.charCodeAt(d)],E=ht[r.charCodeAt(d+1)],s=ht[r.charCodeAt(d+2)],a=ht[r.charCodeAt(d+3)],m[y++]=k<<2|E>>4,m[y++]=(E&15)<<4|s>>2,m[y++]=(s&3)<<6|a&63;return f},dl=typeof ArrayBuffer=="function",Ws=(r,e)=>{if(typeof r!="string")return{type:"message",data:Mi(r,e)};const t=r.charAt(0);return t==="b"?{type:"message",data:ul(r.substring(1),e)}:Ct[t]?r.length>1?{type:Ct[t],data:r.substring(1)}:{type:Ct[t]}:ps},ul=(r,e)=>{if(dl){const t=hl(r);return Mi(t,e)}else return{base64:!0,data:r}},Mi=(r,e)=>{switch(e){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Ni="",fl=(r,e)=>{const t=r.length,d=new Array(t);let y=0;r.forEach((k,E)=>{Fs(k,!1,s=>{d[E]=s,++y===t&&e(d.join(Ni))})})},pl=(r,e)=>{const t=r.split(Ni),d=[];for(let y=0;y<t.length;y++){const k=Ws(t[y],e);if(d.push(k),k.type==="error")break}return d};function _l(){return new TransformStream({transform(r,e){cl(r,t=>{const d=t.length;let y;if(d<126)y=new Uint8Array(1),new DataView(y.buffer).setUint8(0,d);else if(d<65536){y=new Uint8Array(3);const k=new DataView(y.buffer);k.setUint8(0,126),k.setUint16(1,d)}else{y=new Uint8Array(9);const k=new DataView(y.buffer);k.setUint8(0,127),k.setBigUint64(1,BigInt(d))}r.data&&typeof r.data!="string"&&(y[0]|=128),e.enqueue(y),e.enqueue(t)})}})}let rs;function St(r){return r.reduce((e,t)=>e+t.length,0)}function bt(r,e){if(r[0].length===e)return r.shift();const t=new Uint8Array(e);let d=0;for(let y=0;y<e;y++)t[y]=r[0][d++],d===r[0].length&&(r.shift(),d=0);return r.length&&d<r[0].length&&(r[0]=r[0].slice(d)),t}function ml(r,e){rs||(rs=new TextDecoder);const t=[];let d=0,y=-1,k=!1;return new TransformStream({transform(E,s){for(t.push(E);;){if(d===0){if(St(t)<1)break;const a=bt(t,1);k=(a[0]&128)===128,y=a[0]&127,y<126?d=3:y===126?d=1:d=2}else if(d===1){if(St(t)<2)break;const a=bt(t,2);y=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),d=3}else if(d===2){if(St(t)<8)break;const a=bt(t,8),f=new DataView(a.buffer,a.byteOffset,a.length),m=f.getUint32(0);if(m>Math.pow(2,21)-1){s.enqueue(ps);break}y=m*Math.pow(2,32)+f.getUint32(4),d=3}else{if(St(t)<y)break;const a=bt(t,y);s.enqueue(Ws(k?a:rs.decode(a),e)),d=0}if(y===0||y>r){s.enqueue(ps);break}}}})}const Bi=4;function ce(r){if(r)return gl(r)}function gl(r){for(var e in ce.prototype)r[e]=ce.prototype[e];return r}ce.prototype.on=ce.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};ce.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};ce.prototype.off=ce.prototype.removeListener=ce.prototype.removeAllListeners=ce.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var d,y=0;y<t.length;y++)if(d=t[y],d===e||d.fn===e){t.splice(y,1);break}return t.length===0&&delete this._callbacks["$"+r],this};ce.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],d=1;d<arguments.length;d++)e[d-1]=arguments[d];if(t){t=t.slice(0);for(var d=0,y=t.length;d<y;++d)t[d].apply(this,e)}return this};ce.prototype.emitReserved=ce.prototype.emit;ce.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};ce.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Kt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ge=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),vl="arraybuffer";function Ii(r,...e){return e.reduce((t,d)=>(r.hasOwnProperty(d)&&(t[d]=r[d]),t),{})}const Sl=ge.setTimeout,bl=ge.clearTimeout;function Vt(r,e){e.useNativeTimers?(r.setTimeoutFn=Sl.bind(ge),r.clearTimeoutFn=bl.bind(ge)):(r.setTimeoutFn=ge.setTimeout.bind(ge),r.clearTimeoutFn=ge.clearTimeout.bind(ge))}const yl=1.33;function xl(r){return typeof r=="string"?wl(r):Math.ceil((r.byteLength||r.size)*yl)}function wl(r){let e=0,t=0;for(let d=0,y=r.length;d<y;d++)e=r.charCodeAt(d),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(d++,t+=4);return t}function Oi(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Cl(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}function El(r){let e={},t=r.split("&");for(let d=0,y=t.length;d<y;d++){let k=t[d].split("=");e[decodeURIComponent(k[0])]=decodeURIComponent(k[1])}return e}class kl extends Error{constructor(e,t,d){super(e),this.description=t,this.context=d,this.type="TransportError"}}class $s extends ce{constructor(e){super(),this.writable=!1,Vt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,d){return super.emitReserved("error",new kl(e,t,d)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Ws(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Cl(e);return t.length?"?"+t:""}}class Rl extends $s{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let d=0;this._polling&&(d++,this.once("pollComplete",function(){--d||t()})),this.writable||(d++,this.once("drain",function(){--d||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=d=>{if(this.readyState==="opening"&&d.type==="open"&&this.onOpen(),d.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(d)};pl(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,fl(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Oi()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let ji=!1;try{ji=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Ll=ji;function Al(){}class Dl extends Rl{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let d=location.port;d||(d=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||d!==e.port}}doWrite(e,t){const d=this.request({method:"POST",data:e});d.on("success",t),d.on("error",(y,k)=>{this.onError("xhr post error",y,k)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,d)=>{this.onError("xhr poll error",t,d)}),this.pollXhr=e}}class Ce extends ce{constructor(e,t,d){super(),this.createRequest=e,Vt(this,d),this._opts=d,this._method=d.method||"GET",this._uri=t,this._data=d.data!==void 0?d.data:null,this._create()}_create(){var e;const t=Ii(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const d=this._xhr=this.createRequest(t);try{d.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){d.setDisableHeaderCheck&&d.setDisableHeaderCheck(!0);for(let y in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(y)&&d.setRequestHeader(y,this._opts.extraHeaders[y])}}catch{}if(this._method==="POST")try{d.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{d.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(d),"withCredentials"in d&&(d.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(d.timeout=this._opts.requestTimeout),d.onreadystatechange=()=>{var y;d.readyState===3&&((y=this._opts.cookieJar)===null||y===void 0||y.parseCookies(d.getResponseHeader("set-cookie"))),d.readyState===4&&(d.status===200||d.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof d.status=="number"?d.status:0)},0))},d.send(this._data)}catch(y){this.setTimeoutFn(()=>{this._onError(y)},0);return}typeof document<"u"&&(this._index=Ce.requestsCount++,Ce.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Al,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ce.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ce.requestsCount=0;Ce.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Sr);else if(typeof addEventListener=="function"){const r="onpagehide"in ge?"pagehide":"unload";addEventListener(r,Sr,!1)}}function Sr(){for(let r in Ce.requests)Ce.requests.hasOwnProperty(r)&&Ce.requests[r].abort()}const Tl=function(){const r=Hi({xdomain:!1});return r&&r.responseType!==null}();class Pl extends Dl{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Tl&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Ce(Hi,this.uri(),e)}}function Hi(r){const e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Ll))return new XMLHttpRequest}catch{}if(!e)try{return new ge[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const zi=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ml extends $s{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,d=zi?{}:Ii(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(d.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,d)}catch(y){return this.emitReserved("error",y)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const d=e[t],y=t===e.length-1;Fs(d,this.supportsBinary,k=>{try{this.doWrite(d,k)}catch{}y&&Kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Oi()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const is=ge.WebSocket||ge.MozWebSocket;class Nl extends Ml{createSocket(e,t,d){return zi?new is(e,t,d):t?new is(e,t):new is(e)}doWrite(e,t){this.ws.send(t)}}class Bl extends $s{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=ml(Number.MAX_SAFE_INTEGER,this.socket.binaryType),d=e.readable.pipeThrough(t).getReader(),y=_l();y.readable.pipeTo(e.writable),this._writer=y.writable.getWriter();const k=()=>{d.read().then(({done:s,value:a})=>{s||(this.onPacket(a),k())}).catch(s=>{})};k();const E={type:"open"};this.query.sid&&(E.data=`{"sid":"${this.query.sid}"}`),this._writer.write(E).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const d=e[t],y=t===e.length-1;this._writer.write(d).then(()=>{y&&Kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Il={websocket:Nl,webtransport:Bl,polling:Pl},Ol=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,jl=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _s(r){if(r.length>8e3)throw"URI too long";const e=r,t=r.indexOf("["),d=r.indexOf("]");t!=-1&&d!=-1&&(r=r.substring(0,t)+r.substring(t,d).replace(/:/g,";")+r.substring(d,r.length));let y=Ol.exec(r||""),k={},E=14;for(;E--;)k[jl[E]]=y[E]||"";return t!=-1&&d!=-1&&(k.source=e,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=!0),k.pathNames=Hl(k,k.path),k.queryKey=zl(k,k.query),k}function Hl(r,e){const t=/\/{2,9}/g,d=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&d.splice(0,1),e.slice(-1)=="/"&&d.splice(d.length-1,1),d}function zl(r,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(d,y,k){y&&(t[y]=k)}),t}const ms=typeof addEventListener=="function"&&typeof removeEventListener=="function",Et=[];ms&&addEventListener("offline",()=>{Et.forEach(r=>r())},!1);class Be extends ce{constructor(e,t){if(super(),this.binaryType=vl,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const d=_s(e);t.hostname=d.host,t.secure=d.protocol==="https"||d.protocol==="wss",t.port=d.port,d.query&&(t.query=d.query)}else t.host&&(t.hostname=_s(t.host).host);Vt(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(d=>{const y=d.prototype.name;this.transports.push(y),this._transportsByName[y]=d}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=El(this.opts.query)),ms&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Et.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Bi,t.transport=e,this.id&&(t.sid=this.id);const d=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](d)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Be.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Be.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let d=0;d<this.writeBuffer.length;d++){const y=this.writeBuffer[d].data;if(y&&(t+=xl(y)),d>0&&t>this._maxPayload)return this.writeBuffer.slice(0,d);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Kt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,d){return this._sendPacket("message",e,t,d),this}send(e,t,d){return this._sendPacket("message",e,t,d),this}_sendPacket(e,t,d,y){if(typeof t=="function"&&(y=t,t=void 0),typeof d=="function"&&(y=d,d=null),this.readyState==="closing"||this.readyState==="closed")return;d=d||{},d.compress=d.compress!==!1;const k={type:e,data:t,options:d};this.emitReserved("packetCreate",k),this.writeBuffer.push(k),y&&this.once("flush",y),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},d=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?d():e()}):this.upgrading?d():e()),this}_onError(e){if(Be.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ms&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const d=Et.indexOf(this._offlineEventListener);d!==-1&&Et.splice(d,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Be.protocol=Bi;class Fl extends Be{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),d=!1;Be.priorWebsocketSuccess=!1;const y=()=>{d||(t.send([{type:"ping",data:"probe"}]),t.once("packet",c=>{if(!d)if(c.type==="pong"&&c.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Be.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{d||this.readyState!=="closed"&&(m(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function k(){d||(d=!0,m(),t.close(),t=null)}const E=c=>{const h=new Error("probe error: "+c);h.transport=t.name,k(),this.emitReserved("upgradeError",h)};function s(){E("transport closed")}function a(){E("socket closed")}function f(c){t&&c.name!==t.name&&k()}const m=()=>{t.removeListener("open",y),t.removeListener("error",E),t.removeListener("close",s),this.off("close",a),this.off("upgrading",f)};t.once("open",y),t.once("error",E),t.once("close",s),this.once("close",a),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{d||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let d=0;d<e.length;d++)~this.transports.indexOf(e[d])&&t.push(e[d]);return t}}let Wl=class extends Fl{constructor(e,t={}){const d=typeof e=="object"?e:t;(!d.transports||d.transports&&typeof d.transports[0]=="string")&&(d.transports=(d.transports||["polling","websocket","webtransport"]).map(y=>Il[y]).filter(y=>!!y)),super(e,d)}};function $l(r,e="",t){let d=r;t=t||typeof location<"u"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(typeof t<"u"?r=t.protocol+"//"+r:r="https://"+r),d=_s(r)),d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/";const k=d.host.indexOf(":")!==-1?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+k+":"+d.port+e,d.href=d.protocol+"://"+k+(t&&t.port===d.port?"":":"+d.port),d}const Ul=typeof ArrayBuffer=="function",ql=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Fi=Object.prototype.toString,Kl=typeof Blob=="function"||typeof Blob<"u"&&Fi.call(Blob)==="[object BlobConstructor]",Vl=typeof File=="function"||typeof File<"u"&&Fi.call(File)==="[object FileConstructor]";function Us(r){return Ul&&(r instanceof ArrayBuffer||ql(r))||Kl&&r instanceof Blob||Vl&&r instanceof File}function kt(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,d=r.length;t<d;t++)if(kt(r[t]))return!0;return!1}if(Us(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return kt(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&kt(r[t]))return!0;return!1}function Gl(r){const e=[],t=r.data,d=r;return d.data=gs(t,e),d.attachments=e.length,{packet:d,buffers:e}}function gs(r,e){if(!r)return r;if(Us(r)){const t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){const t=new Array(r.length);for(let d=0;d<r.length;d++)t[d]=gs(r[d],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){const t={};for(const d in r)Object.prototype.hasOwnProperty.call(r,d)&&(t[d]=gs(r[d],e));return t}return r}function Xl(r,e){return r.data=vs(r.data,e),delete r.attachments,r}function vs(r,e){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=vs(r[t],e);else if(typeof r=="object")for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=vs(r[t],e));return r}const Yl=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Jl=5;var se;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(se||(se={}));class Zl{constructor(e){this.replacer=e}encode(e){return(e.type===se.EVENT||e.type===se.ACK)&&kt(e)?this.encodeAsBinary({type:e.type===se.EVENT?se.BINARY_EVENT:se.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===se.BINARY_EVENT||e.type===se.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Gl(e),d=this.encodeAsString(t.packet),y=t.buffers;return y.unshift(d),y}}function br(r){return Object.prototype.toString.call(r)==="[object Object]"}class qs extends ce{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const d=t.type===se.BINARY_EVENT;d||t.type===se.BINARY_ACK?(t.type=d?se.EVENT:se.ACK,this.reconstructor=new Ql(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Us(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const d={type:Number(e.charAt(0))};if(se[d.type]===void 0)throw new Error("unknown packet type "+d.type);if(d.type===se.BINARY_EVENT||d.type===se.BINARY_ACK){const k=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const E=e.substring(k,t);if(E!=Number(E)||e.charAt(t)!=="-")throw new Error("Illegal attachments");d.attachments=Number(E)}if(e.charAt(t+1)==="/"){const k=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););d.nsp=e.substring(k,t)}else d.nsp="/";const y=e.charAt(t+1);if(y!==""&&Number(y)==y){const k=t+1;for(;++t;){const E=e.charAt(t);if(E==null||Number(E)!=E){--t;break}if(t===e.length)break}d.id=Number(e.substring(k,t+1))}if(e.charAt(++t)){const k=this.tryParse(e.substr(t));if(qs.isPayloadValid(d.type,k))d.data=k;else throw new Error("invalid payload")}return d}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case se.CONNECT:return br(t);case se.DISCONNECT:return t===void 0;case se.CONNECT_ERROR:return typeof t=="string"||br(t);case se.EVENT:case se.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Yl.indexOf(t[0])===-1);case se.ACK:case se.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ql{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Xl(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ec=Object.freeze(Object.defineProperty({__proto__:null,Decoder:qs,Encoder:Zl,get PacketType(){return se},protocol:Jl},Symbol.toStringTag,{value:"Module"}));function ye(r,e,t){return r.on(e,t),function(){r.off(e,t)}}const tc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Wi extends ce{constructor(e,t,d){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,d&&d.auth&&(this.auth=d.auth),this._opts=Object.assign({},d),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ye(e,"open",this.onopen.bind(this)),ye(e,"packet",this.onpacket.bind(this)),ye(e,"error",this.onerror.bind(this)),ye(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var d,y,k;if(tc.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const E={type:se.EVENT,data:t};if(E.options={},E.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const m=this.ids++,c=t.pop();this._registerAckCallback(m,c),E.id=m}const s=(y=(d=this.io.engine)===null||d===void 0?void 0:d.transport)===null||y===void 0?void 0:y.writable,a=this.connected&&!(!((k=this.io.engine)===null||k===void 0)&&k._hasPingExpired());return this.flags.volatile&&!s||(a?(this.notifyOutgoingListeners(E),this.packet(E)):this.sendBuffer.push(E)),this.flags={},this}_registerAckCallback(e,t){var d;const y=(d=this.flags.timeout)!==null&&d!==void 0?d:this._opts.ackTimeout;if(y===void 0){this.acks[e]=t;return}const k=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);t.call(this,new Error("operation has timed out"))},y),E=(...s)=>{this.io.clearTimeoutFn(k),t.apply(this,s)};E.withError=!0,this.acks[e]=E}emitWithAck(e,...t){return new Promise((d,y)=>{const k=(E,s)=>E?y(E):d(s);k.withError=!0,t.push(k),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const d={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((y,...k)=>d!==this._queue[0]?void 0:(y!==null?d.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(y)):(this._queue.shift(),t&&t(null,...k)),d.pending=!1,this._drainQueue())),this._queue.push(d),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:se.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(d=>String(d.id)===e)){const d=this.acks[e];delete this.acks[e],d.withError&&d.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case se.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case se.EVENT:case se.BINARY_EVENT:this.onevent(e);break;case se.ACK:case se.BINARY_ACK:this.onack(e);break;case se.DISCONNECT:this.ondisconnect();break;case se.CONNECT_ERROR:this.destroy();const d=new Error(e.data.message);d.data=e.data.data,this.emitReserved("connect_error",d);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const d of t)d.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let d=!1;return function(...y){d||(d=!0,t.packet({type:se.ACK,id:e,data:y}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:se.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let d=0;d<t.length;d++)if(e===t[d])return t.splice(d,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let d=0;d<t.length;d++)if(e===t[d])return t.splice(d,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const d of t)d.apply(this,e.data)}}}function Ye(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Ye.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};Ye.prototype.reset=function(){this.attempts=0};Ye.prototype.setMin=function(r){this.ms=r};Ye.prototype.setMax=function(r){this.max=r};Ye.prototype.setJitter=function(r){this.jitter=r};class Ss extends ce{constructor(e,t){var d;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Vt(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((d=t.randomizationFactor)!==null&&d!==void 0?d:.5),this.backoff=new Ye({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const y=t.parser||ec;this.encoder=new y.Encoder,this.decoder=new y.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Wl(this.uri,this.opts);const t=this.engine,d=this;this._readyState="opening",this.skipReconnect=!1;const y=ye(t,"open",function(){d.onopen(),e&&e()}),k=s=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",s),e?e(s):this.maybeReconnectOnOpen()},E=ye(t,"error",k);if(this._timeout!==!1){const s=this._timeout,a=this.setTimeoutFn(()=>{y(),k(new Error("timeout")),t.close()},s);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(y),this.subs.push(E),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ye(e,"ping",this.onping.bind(this)),ye(e,"data",this.ondata.bind(this)),ye(e,"error",this.onerror.bind(this)),ye(e,"close",this.onclose.bind(this)),ye(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Kt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let d=this.nsps[e];return d?this._autoConnect&&!d.active&&d.connect():(d=new Wi(this,e,t),this.nsps[e]=d),d}_destroy(e){const t=Object.keys(this.nsps);for(const d of t)if(this.nsps[d].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let d=0;d<t.length;d++)this.engine.write(t[d],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var d;this.cleanup(),(d=this.engine)===null||d===void 0||d.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const d=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(y=>{y?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",y)):e.onreconnect()}))},t);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const st={};function Rt(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};const t=$l(r,e.path||"/socket.io"),d=t.source,y=t.id,k=t.path,E=st[y]&&k in st[y].nsps,s=e.forceNew||e["force new connection"]||e.multiplex===!1||E;let a;return s?a=new Ss(d,e):(st[y]||(st[y]=new Ss(d,e)),a=st[y]),t.query&&!e.query&&(e.query=t.queryKey),a.socket(t.path,e)}Object.assign(Rt,{Manager:Ss,Socket:Wi,io:Rt,connect:Rt});const sc={},rc=()=>sc?.VITE_WS_URL||"ws://localhost:8080";class ic{socket=null;eventListeners={};reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;messageQueue=[];isConnecting=!1;terminalSessions=new Map;connect(e){if(!(this.socket?.connected||this.isConnecting)){this.isConnecting=!0;try{const d=(e||rc()).replace("ws://","http://").replace("wss://","https://");console.log(`Connecting to WebSocket server: ${d}`),this.socket=Rt(d,{transports:["websocket"],path:"/ws",timeout:2e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:this.reconnectDelay}),this.setupEventListeners()}catch(t){console.error("Failed to connect to WebSocket server:",t),this.emit("error","Failed to connect to server"),this.isConnecting=!1}}}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{console.log("Connected to server"),this.isConnecting=!1,this.reconnectAttempts=0,this.processMessageQueue(),this.emit("connected")}),this.socket.on("disconnect",e=>{console.log("Disconnected from server:",e),this.emit("disconnected")}),this.socket.on("connect_error",e=>{console.error("Connection error:",e),this.handleReconnect()}),this.socket.on("message",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;switch(t.type){case"message":this.emit("message",t.payload);break;case"code_stream":this.emit("code_stream",t.payload);break;case"agent_update":this.emit("agent_update",t.payload);break;case"file_tree_update":this.emit("file_tree_update",t.payload);break;case"project_status":this.emit("project_status",t.payload);break;case"terminal_data":this.emit("terminal_data",t.payload);break;case"terminal_session":this.handleTerminalSession(t.payload);break;case"wave_progress":this.emit("wave_progress",t.payload);break;case"llm_config_update":this.emit("llm_config_update",t.payload);break;case"llm_stream":this.emit("llm_stream",t.payload);break;case"agent_hierarchy":this.emit("agent_hierarchy",t.payload);break;case"token_usage":this.emit("token_usage",t.payload);break;default:console.warn("Unknown message type:",t.type)}}catch(t){console.error("Error parsing message:",t)}}),this.socket.on("error",e=>{console.error("WebSocket error:",e),this.emit("error",e.message||"WebSocket error occurred")}))}handleReconnect(){if(this.isConnecting=!1,this.reconnectAttempts++,this.reconnectAttempts>=this.maxReconnectAttempts){this.emit("error","Failed to connect after multiple attempts");return}setTimeout(()=>{console.log(`Attempting to reconnect... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.connect()},this.reconnectDelay*this.reconnectAttempts)}processMessageQueue(){for(;this.messageQueue.length>0&&this.socket?.connected;){const e=this.messageQueue.shift();e&&this.socket.send(JSON.stringify(e))}}handleTerminalSession(e){this.terminalSessions.set(e.sessionId,e),this.emit("terminal_session",e)}sendPrompt(e,t="root"){const d={type:"prompt",payload:{prompt:e,agentId:t}};this.socket?.connected?this.socket.send(JSON.stringify(d)):(this.messageQueue.push({event:"prompt",data:d}),this.emit("error","Not connected to server. Message queued."))}selectFile(e){const t={type:"file_select",payload:{filePath:e}};this.socket?.connected&&this.socket.send(JSON.stringify(t))}createTerminalSession(e){const t={type:"terminal_create",payload:{projectId:e}};this.socket?.connected?this.socket.send(JSON.stringify(t)):this.messageQueue.push({event:"terminal_create",data:t})}sendTerminalData(e,t){const d={type:"terminal_data",payload:{sessionId:e,data:t}};this.socket?.connected&&this.socket.send(JSON.stringify(d))}resizeTerminal(e,t,d){const y={type:"terminal_resize",payload:{sessionId:e,cols:t,rows:d}};this.socket?.connected&&this.socket.send(JSON.stringify(y))}closeTerminal(e){const t={type:"terminal_close",payload:{sessionId:e}};this.socket?.connected&&this.socket.send(JSON.stringify(t)),this.terminalSessions.delete(e)}getTerminalSession(e){return this.terminalSessions.get(e)}configureLLM(e){try{const t={type:"llm_config",payload:e};this.socket?.connected?this.socket.send(JSON.stringify(t)):(this.messageQueue.push({event:"llm_config",data:t}),this.emit("error","Not connected to server. Configuration queued."))}catch(t){console.error("Error configuring LLM:",t),this.emit("error","Failed to configure LLM")}}setModel(e){try{const t={type:"set_model",payload:{model:e}};this.socket?.connected?this.socket.send(JSON.stringify(t)):this.emit("error","Not connected to server. Please connect first.")}catch(t){console.error("Error setting model:",t),this.emit("error","Failed to set model")}}setApiKey(e,t){try{if(!e||!t){this.emit("error","Invalid API key or provider");return}const d={type:"set_api_key",payload:{provider:e,apiKey:t}};this.socket?.connected?this.socket.send(JSON.stringify(d)):this.emit("error","Not connected to server. Please connect first.")}catch(d){console.error("Error setting API key:",d),this.emit("error","Failed to set API key")}}requestAgentHierarchy(){const e={type:"get_agent_hierarchy",payload:{}};this.socket?.connected&&this.socket.send(JSON.stringify(e))}on(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}off(e,t){if(this.eventListeners[e])if(t){const d=this.eventListeners[e].indexOf(t);d>-1&&this.eventListeners[e].splice(d,1)}else this.eventListeners[e]=[]}emit(e,...t){const d=this.eventListeners[e];d&&d.forEach(y=>{try{y(...t)}catch(k){console.error(`Error in event listener for ${e}:`,k)}})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.messageQueue=[],this.isConnecting=!1}isConnected(){return this.socket?.connected||!1}getConnectionStatus(){return this.socket?.connected?"connected":this.isConnecting?"connecting":"disconnected"}}const de=new ic;function nc({onNewChat:r,messages:e=[],isConnected:t=!1,onMessagesUpdate:d,isLoading:y=!1,onLoadingChange:k}){const[E,s]=M.useState([]),[a,f]=M.useState(null),[m,c]=M.useState(!1),[h,_]=M.useState(0),[S,p]=M.useState(""),[n,o]=M.useState(!0),i=M.useRef(null),l=M.useRef(new Map);M.useEffect(()=>{const A=new Map;e.forEach(N=>{if(!N.threadId)return;A.has(N.threadId)||A.set(N.threadId,{taskId:N.threadId,summary:`Task ${N.threadId}`,agentName:N.agentId||"Agent",agentState:"working",createdAt:new Date().toISOString(),lastActivity:N.timestamp,messageCount:0,errorCount:0,hasUnread:!1,isCollapsed:!0,messages:[]});const D=A.get(N.threadId);D.messages.push({id:N.id,threadId:N.threadId,text:N.text,timestamp:N.timestamp,sender:N.sender==="user"?"user":"assistant",type:"normal",isRead:!1}),D.messageCount++,D.lastActivity=N.timestamp}),s(Array.from(A.values())),o(!1)},[e]),M.useEffect(()=>{const A=localStorage.getItem("threadCollapseStates");if(A){const N=JSON.parse(A);s(D=>D.map(j=>({...j,isCollapsed:N[j.taskId]??j.isCollapsed})))}},[]);const g=M.useCallback(A=>{const N={};A.forEach(D=>{N[D.taskId]=D.isCollapsed}),localStorage.setItem("threadCollapseStates",JSON.stringify(N))},[]),x=A=>{const N={idle:"bg-gray-500/20 text-gray-300 border-gray-500/30",working:"bg-blue-500/20 text-blue-300 border-blue-500/30",error:"bg-red-500/20 text-red-300 border-red-500/30",complete:"bg-green-500/20 text-green-300 border-green-500/30"},j={idle:$r,working:Vr,error:Ae,complete:us}[A];return u.jsxs(Ve,{variant:"outline",className:`${N[A]} text-xs px-2 py-0.5 flex items-center gap-1`,children:[u.jsx(j,{className:`h-3 w-3 ${A==="working"?"animate-spin":""}`}),A]})},b=A=>{const N=new Date(A),j=new Date().getTime()-N.getTime(),F=Math.floor(j/6e4),U=Math.floor(j/36e5);return F<1?"now":F<60?`${F}m`:U<24?`${U}h`:N.toLocaleDateString()},w=M.useCallback(A=>{s(N=>{const D=N.map(j=>j.taskId===A?{...j,isCollapsed:!j.isCollapsed,hasUnread:!1}:j);return g(D),D})},[g]),v=M.useCallback(A=>{f(A),c(!0),p("")},[]);M.useEffect(()=>{const A=N=>{if(i.current?.contains(document.activeElement))switch(N.key){case"ArrowDown":N.preventDefault(),_(D=>Math.min(D+1,E.length-1));break;case"ArrowUp":N.preventDefault(),_(D=>Math.max(D-1,0));break;case"ArrowRight":N.preventDefault(),E[h]?.isCollapsed&&w(E[h].taskId);break;case"ArrowLeft":N.preventDefault(),E[h]&&!E[h].isCollapsed&&w(E[h].taskId);break;case"Enter":N.preventDefault(),E[h]&&v(E[h].taskId);break}};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[h,E,w,v]);const C=()=>{if(!S.trim()||!a)return;t&&de.sendPrompt(S,a||"root");const A={id:`msg-${Date.now()}`,text:S,timestamp:new Date().toISOString(),sender:"user",threadId:a};d&&d([...e,A]),s(N=>N.map(D=>D.taskId===a?{...D,messages:[...D.messages,{id:A.id,threadId:a,text:S,timestamp:A.timestamp,sender:"user",type:"normal",isRead:!0}],messageCount:D.messageCount+1,lastActivity:A.timestamp,agentState:"working"}:D)),p(""),c(!1)},T=E.find(A=>A.taskId===a);return n||y?u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"p-4 flex items-center gap-2",children:[u.jsx(Ht,{className:"h-4 w-4 animate-spin text-primary"}),u.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading tasks..."})]}),u.jsx(ll,{})]}):E.length===0?u.jsx("div",{className:"h-full flex items-center justify-center",children:u.jsxs("div",{className:"text-center text-muted-foreground",children:[u.jsx(At,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),u.jsx("p",{className:"text-sm",children:"No active tasks"})]})}):u.jsxs("div",{ref:i,className:"h-full flex flex-col",role:"tree","aria-label":"Task threads",tabIndex:0,children:[u.jsx("div",{className:"flex-1",children:u.jsx(ft,{className:"h-full",children:u.jsx("div",{className:"p-2 space-y-2",children:E.map((A,N)=>u.jsxs("div",{ref:D=>{D&&l.current.set(A.taskId,D)},role:"group","aria-expanded":!A.isCollapsed,"aria-label":`Task: ${A.summary}`,className:`border border-border/30 rounded-lg transition-all duration-200 ${N===h?"ring-2 ring-primary/50":""}`,children:[u.jsx("div",{className:"p-3 cursor-pointer hover:bg-secondary/10 transition-colors",onClick:()=>w(A.taskId),onDoubleClick:()=>v(A.taskId),role:"article",tabIndex:0,children:u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[u.jsx("div",{className:"flex-shrink-0 mt-1",children:A.isCollapsed?u.jsx(us,{className:"h-4 w-4 text-muted-foreground"}):u.jsx(jt,{className:"h-4 w-4 text-muted-foreground"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("h3",{className:"text-sm font-medium text-foreground truncate",children:A.summary}),A.hasUnread&&u.jsx("div",{className:"w-2 h-2 bg-primary rounded-full flex-shrink-0"})]}),u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x(A.agentState),u.jsx("span",{className:"text-xs text-muted-foreground",children:A.agentName})]}),u.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[u.jsxs("span",{className:"flex items-center gap-1",children:[u.jsx(At,{className:"h-3 w-3"}),A.messageCount," msgs"]}),A.errorCount>0&&u.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[u.jsx(Ae,{className:"h-3 w-3"}),A.errorCount," errors"]}),u.jsx("span",{children:b(A.lastActivity)})]})]})]})})}),!A.isCollapsed&&u.jsx("div",{className:"border-t border-border/20",children:u.jsx("div",{className:"p-3 space-y-2 max-h-64 overflow-y-auto",children:A.messages.map(D=>u.jsx("div",{className:`p-2 rounded text-sm ${D.sender==="user"?"bg-primary/10 text-primary-foreground ml-6":D.type==="error"?"bg-red-500/10 text-red-300 border border-red-500/20":"bg-secondary/10 text-secondary-foreground mr-6"}`,children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsx("p",{className:"flex-1",children:D.text}),u.jsx("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:b(D.timestamp)})]})},D.id))})})]},A.taskId))})})}),u.jsx(tl,{open:m,onOpenChange:c,children:u.jsxs(il,{side:"right",className:"w-[500px] sm:w-[600px]",children:[u.jsx(nl,{children:u.jsxs(ol,{className:"flex items-center gap-2",children:[T?.summary,T&&x(T.agentState)]})}),T&&u.jsxs("div",{className:"mt-6 space-y-4",children:[u.jsx("div",{className:"p-4 bg-secondary/10 rounded-lg",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-muted-foreground",children:"Agent:"}),u.jsx("span",{className:"ml-2",children:T.agentName})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-muted-foreground",children:"Created:"}),u.jsx("span",{className:"ml-2",children:b(T.createdAt)})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),u.jsx("span",{className:"ml-2",children:T.messageCount})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),u.jsx("span",{className:"ml-2 text-red-400",children:T.errorCount})]})]})}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium mb-2",children:"Full Conversation"}),u.jsx(ft,{className:"h-64 border border-border/30 rounded-lg",children:u.jsx("div",{className:"p-3 space-y-3",children:T.messages.map(A=>u.jsxs("div",{className:`p-3 rounded-lg ${A.sender==="user"?"bg-primary/10 text-primary-foreground":A.type==="error"?"bg-red-500/10 text-red-300 border border-red-500/20":"bg-secondary/10 text-secondary-foreground"}`,children:[u.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[u.jsx("span",{className:"text-xs font-medium",children:A.sender==="user"?"You":T.agentName}),u.jsx("span",{className:"text-xs text-muted-foreground",children:b(A.timestamp)})]}),u.jsx("p",{className:"text-sm",children:A.text})]},A.id))})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium mb-2",children:"Re-prompt"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(al,{value:S,onChange:A=>p(A.target.value),placeholder:"Add additional instructions or corrections...",className:"min-h-24 resize-none"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ie,{onClick:C,disabled:!S.trim(),className:"minimalist-button",children:"Send Re-prompt"}),u.jsx(ie,{variant:"outline",onClick:()=>c(!1),className:"minimalist-button",children:"Cancel"})]})]})]})]})]})})]})}function oc({messages:r,onNewChat:e,isConnected:t=!1,onMessagesUpdate:d,isLoading:y=!1,onLoadingChange:k}){const[E,s]=M.useState("chat"),a=M.useRef(null);M.useEffect(()=>{a.current?.scrollIntoView({behavior:"smooth"})},[r]);const f=_=>{const S=new Date(_),n=new Date().getTime()-S.getTime(),o=Math.floor(n/6e4),i=Math.floor(n/36e5);return o<1?"now":o<60?`${o}m`:i<24?`${i}h`:S.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},m=r.length;return u.jsx("div",{className:"h-full flex flex-col",children:u.jsxs(Ai,{value:E,onValueChange:s,className:"h-full flex flex-col",children:[u.jsx("div",{className:"flex-shrink-0 px-4 pt-4 pb-2 border-b border-border min-h-[60px]",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(ie,{variant:E==="chat"?"secondary":"ghost",size:"sm",onClick:()=>s("chat"),className:"h-8 px-3",children:[u.jsx(At,{className:"h-3 w-3 mr-2"}),"Chat",m>0&&u.jsx("span",{className:"bg-muted text-muted-foreground text-xs px-1.5 py-0.5 rounded ml-2",children:m})]}),u.jsxs(ie,{variant:E==="tasks"?"secondary":"ghost",size:"sm",onClick:()=>s("tasks"),className:"h-8 px-3",children:[u.jsx(xt,{className:"h-3 w-3 mr-2"}),"Tasks",u.jsx("span",{className:"bg-muted text-muted-foreground text-xs px-1.5 py-0.5 rounded ml-2",children:3})]}),u.jsxs(ie,{variant:E==="logs"?"secondary":"ghost",size:"sm",onClick:()=>s("logs"),className:"h-8 px-3",children:[u.jsx(Ae,{className:"h-3 w-3 mr-2"}),"Logs",u.jsx("span",{className:"bg-destructive/20 text-destructive text-xs px-1.5 py-0.5 rounded ml-2",children:2})]})]}),u.jsx(ie,{variant:"ghost",size:"sm",onClick:e,className:"minimalist-button",children:u.jsx(Kr,{className:"h-4 w-4"})})]})}),u.jsxs("div",{className:"flex-1 min-h-0",children:[E==="chat"&&u.jsx("div",{className:"h-full overflow-hidden",children:u.jsx(ft,{className:"h-full",children:u.jsx("div",{className:"px-4 py-2",children:r.length===0?u.jsx("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:u.jsxs("div",{className:"text-center",children:[u.jsx(At,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),u.jsx("p",{className:"text-body",children:"Start a conversation with Colony AI"})]})}):u.jsxs("div",{className:"space-y-4",children:[r.map(_=>u.jsxs("div",{className:"flex items-start gap-3 py-2",children:[u.jsx("div",{className:"flex-shrink-0 mt-1",children:_.sender==="user"?u.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center",children:u.jsx(ia,{className:"h-3 w-3 text-primary"})}):u.jsx("div",{className:"w-6 h-6 rounded-full bg-secondary/10 border border-border flex items-center justify-center",children:u.jsx(Qn,{className:"h-3 w-3 text-foreground"})})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"text-tab font-medium",children:_.sender==="user"?"You":"Colony AI"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:f(_.timestamp)})]}),u.jsx("div",{className:"text-body text-foreground leading-relaxed",children:_.text})]})]},_.id)),u.jsx("div",{ref:a})]})})})}),E==="tasks"&&u.jsx("div",{className:"h-full overflow-hidden",children:u.jsx(nc,{onNewChat:e,messages:r,isConnected:t,onMessagesUpdate:d,isLoading:y,onLoadingChange:k})}),E==="logs"&&u.jsx("div",{className:"h-full overflow-hidden",children:u.jsx(ft,{className:"h-full",children:u.jsxs("div",{className:"px-4 py-2 space-y-3",children:[u.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-destructive pl-3",children:[u.jsx(Ae,{className:"h-4 w-4 text-destructive mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"text-tab font-medium text-destructive",children:"Error"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"2m ago"})]}),u.jsx("p",{className:"text-body text-destructive",children:"Failed to connect to database: Connection timeout"})]})]}),u.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-yellow-500 pl-3",children:[u.jsx(Ae,{className:"h-4 w-4 text-yellow-500 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"text-tab font-medium text-yellow-500",children:"Warning"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"5m ago"})]}),u.jsx("p",{className:"text-body text-yellow-500",children:"API rate limit approaching: 80% of quota used"})]})]}),u.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-blue-500 pl-3",children:[u.jsx(xt,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"text-tab font-medium text-blue-500",children:"Info"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"8m ago"})]}),u.jsx("p",{className:"text-body text-blue-500",children:"Code generation completed successfully for Button.tsx"})]})]}),u.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-green-500 pl-3",children:[u.jsx(xt,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"text-tab font-medium text-green-500",children:"Success"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"12m ago"})]}),u.jsx("p",{className:"text-body text-green-500",children:"All tests passed for authentication module"})]})]})]})})})]})]})})}function ac({onSendMessage:r,isLoading:e=!1,disabled:t=!1,placeholder:d="Enter a prompt"}){const[y,k]=M.useState(""),[E,s]=M.useState([]),a=M.useRef(null),f=()=>{(y.trim()||E.length>0)&&(r(y,E),k(""),s([]))},m=M.useCallback(async _=>{const S=_.target.files;if(!S)return;const p=[];for(let n=0;n<S.length;n++){const o=S[n],i=`file-${Date.now()}-${n}`;if(o?.type.startsWith("text/")||o?.name.endsWith(".md")||o?.name.endsWith(".json")){const l=await o.text();p.push({id:i,name:o?.name||"unknown",size:o?.size||0,type:o?.type||"text/plain",content:l})}else p.push({id:i,name:o?.name||"unknown",size:o?.size||0,type:o?.type||"application/octet-stream"})}s(n=>[...n,...p]),a.current&&(a.current.value="")},[]),c=_=>{s(S=>S.filter(p=>p.id!==_))},h=_=>_<1024?_+" B":_<1024*1024?(_/1024).toFixed(1)+" KB":(_/(1024*1024)).toFixed(1)+" MB";return u.jsxs("div",{className:"relative flex flex-col min-h-[120px] max-h-[200px]",children:[E.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 p-2 border-b border-border",children:E.map(_=>u.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-muted/50 rounded-md text-sm",children:[u.jsx(Ps,{className:"h-3 w-3 text-muted-foreground"}),u.jsx("span",{className:"text-foreground",children:_.name}),u.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",h(_.size),")"]}),u.jsx(ie,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>c(_.id),children:u.jsx(pt,{className:"h-3 w-3"})})]},_.id))}),u.jsxs("div",{className:"minimalist-input flex-1 relative",children:[u.jsx("textarea",{placeholder:d,value:y,onChange:_=>k(_.target.value),onKeyPress:_=>{_.key==="Enter"&&!_.shiftKey&&!t&&!e&&(_.preventDefault(),f())},className:"w-full h-full bg-transparent resize-none text-foreground placeholder-muted-foreground focus:outline-none text-body leading-relaxed pr-24",style:{border:"none"},disabled:t||e}),u.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2",children:[u.jsx(ie,{variant:"ghost",size:"sm",className:"p-2 hover:bg-muted/50",onClick:()=>a.current?.click(),disabled:t||e,children:u.jsx(Fo,{className:"h-4 w-4"})}),u.jsx(ie,{onClick:f,className:"minimalist-button p-2",disabled:!y.trim()&&E.length===0||t||e,children:e?u.jsx(Ht,{className:"h-4 w-4 animate-spin"}):u.jsx(Vo,{className:"h-4 w-4"})})]}),u.jsx("input",{ref:a,type:"file",multiple:!0,onChange:m,className:"hidden",accept:"text/*,.md,.json,.js,.jsx,.ts,.tsx,.py,.java,.cpp,.c,.h,.cs,.go,.rb,.php,.html,.css,.xml,.yaml,.yml"})]})]})}function ve(r,e){M.useEffect(()=>(de.on(r,e),()=>{de.off(r,e)}),[r,e])}const lc={".js":"javascript",".jsx":"javascript",".ts":"typescript",".tsx":"typescript",".py":"python",".java":"java",".cpp":"cpp",".c":"c",".h":"c",".cs":"csharp",".go":"go",".rb":"ruby",".php":"php",".html":"html",".css":"css",".scss":"scss",".sass":"sass",".less":"less",".xml":"xml",".json":"json",".yaml":"yaml",".yml":"yaml",".md":"markdown",".mdx":"markdown",".sql":"sql",".sh":"bash",".bash":"bash",".zsh":"bash",".fish":"bash",".ps1":"powershell",".r":"r",".R":"r",".swift":"swift",".kt":"kotlin",".kts":"kotlin",".dart":"dart",".lua":"lua",".vim":"vim",".dockerfile":"dockerfile",".rs":"rust",".toml":"toml",".ini":"ini",".cfg":"ini",".conf":"ini",".env":"dotenv"},yr=10*1024*1024,xr=new Set([".jpg",".jpeg",".png",".gif",".bmp",".ico",".svg",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".zip",".rar",".tar",".gz",".7z",".exe",".dll",".so",".dylib",".mp3",".mp4",".avi",".mov",".wav",".ttf",".otf",".woff",".woff2",".db",".sqlite"]),wr=new Set(["node_modules",".git",".svn",".hg","dist","build","out","target","bin","obj",".idea",".vscode",".vs","__pycache__",".pytest_cache",".mypy_cache","venv","env",".env"]);class bs{static async importFile(e){try{if(e.size>yr)throw new Error(`File "${e.name}" exceeds the maximum size of 10MB`);const t=this.getFileExtension(e.name);if(xr.has(t.toLowerCase()))return console.warn(`Skipping binary file: ${e.name}`),null;const d=await this.readFileAsText(e);return{id:this.generateId(),name:e.name,path:e.name,content:d,type:"file",language:this.getLanguageFromExtension(t),size:e.size}}catch(t){return console.error(`Error importing file ${e.name}:`,t),null}}static async importFiles(e){const t=[];for(let d=0;d<e.length;d++){const y=e[d];if(!y)continue;const k=await this.importFile(y);k&&t.push(k)}return t}static async importFolder(){try{if(!("showDirectoryPicker"in window))throw new Error("Your browser does not support folder import. Please use Chrome, Edge, or another Chromium-based browser.");const e=await window.showDirectoryPicker({mode:"read"});return await this.readDirectory(e,e.name)}catch(e){if(e.name==="AbortError")return null;throw console.error("Error importing folder:",e),e}}static async readDirectory(e,t,d=0,y=10){const k={id:this.generateId(),name:e.name,path:t,type:"folder",children:[]};if(d>y)return console.warn(`Max depth reached for folder: ${t}`),k;if(wr.has(e.name))return console.log(`Skipping folder: ${e.name}`),k;try{for await(const E of e.values()){const s=`${t}/${E.name}`;if(E.kind==="file"){const a=await E.getFile();if(!a)continue;if(a.size>yr){console.warn(`Skipping large file: ${s} (${a.size} bytes)`);continue}const f=this.getFileExtension(a.name);if(xr.has(f.toLowerCase())){console.log(`Skipping binary file: ${s}`);continue}try{const m=await this.readFileAsText(a);k.children.push({id:this.generateId(),name:a.name,path:s,content:m,type:"file",language:this.getLanguageFromExtension(f),size:a.size})}catch(m){console.error(`Error reading file ${s}:`,m)}}else if(E.kind==="directory"&&!wr.has(E.name)){const a=await this.readDirectory(E,s,d+1,y);a.children.length>0&&k.children.push(a)}}}catch(E){console.error(`Error reading directory ${t}:`,E)}return k.children.sort((E,s)=>E.type!==s.type?E.type==="folder"?-1:1:E.name.localeCompare(s.name)),k}static async readFileAsText(e){return new Promise((t,d)=>{const y=new FileReader;y.onload=k=>t(k.target?.result),y.onerror=d,y.readAsText(e)})}static getFileExtension(e){const t=e.lastIndexOf(".");return t===-1?"":e.substring(t)}static getLanguageFromExtension(e){return lc[e.toLowerCase()]||"plaintext"}static generateId(){return`import-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}static convertToFileTreeNodes(e){return e.map(t=>this.convertNode(t))}static convertNode(e){return e.type==="file"?{id:e.id,name:e.name,path:e.path,type:"file",content:e.content,language:e.language}:{id:e.id,name:e.name,path:e.path,type:"folder",children:e.children.map(t=>this.convertNode(t)),isExpanded:!1}}}function cc({onFileSelect:r,importedProject:e=[]}){const[t,d]=M.useState([]),[y,k]=M.useState(null);M.useEffect(()=>{if(e.length>0){const h=bs.convertToFileTreeNodes(e);d(h)}},[e]),ve("file_tree_update",h=>{d(_=>{const S=[..._],p=h.filePath.split("/"),n=(o,i,l=0)=>{if(l===i.length-1){const b=o.findIndex(w=>w.name===i[l]);if(h.action==="delete")return o.filter(w=>w.name!==i[l]);if(h.action==="create"||h.action==="update"){const w={id:h.filePath,name:i[l]||"unknown",path:h.filePath,type:h.fileType,children:h.fileType==="folder"?[]:void 0};b>=0?o[b]={...o[b],...w}:o.push(w)}return o}const g=i[l]||"unknown";let x=o.find(b=>b.name===g&&b.type==="folder");return x||(x={id:i.slice(0,l+1).join("/"),name:g,path:i.slice(0,l+1).join("/"),type:"folder",children:[],isExpanded:!1},o.push(x)),x?.children&&(x.children=n(x.children,i,l+1)),o};return n(S,p)})});const E=h=>{const _=S=>S.map(p=>p.id===h?{...p,isExpanded:!p.isExpanded}:p.children?{...p,children:_(p.children)}:p);d(_(t))},s=h=>{h.type==="file"&&(k(h.id),h.content?r?.(h.path,h.content,h.language):(de.selectFile(h.path),r?.(h.path)))},a=h=>{switch(h.split(".").pop()?.toLowerCase()){case"tsx":case"jsx":case"ts":case"js":return u.jsx(yt,{className:"h-3 w-3 text-blue-400"});case"json":return u.jsx(po,{className:"h-3 w-3 text-yellow-400"});case"md":return u.jsx(xt,{className:"h-3 w-3 text-gray-400"});case"html":return u.jsx(yt,{className:"h-3 w-3 text-orange-400"});case"css":return u.jsx(yt,{className:"h-3 w-3 text-purple-400"});case"png":case"jpg":case"jpeg":case"svg":return u.jsx(Ro,{className:"h-3 w-3 text-green-400"});default:return u.jsx(Ps,{className:"h-3 w-3 text-gray-400"})}},f=()=>{const h={name:"project-export",timestamp:new Date().toISOString(),files:[]},_=o=>{o.forEach(i=>{i.type==="file"&&i.content?h.files.push({path:i.path,content:i.content,language:i.language}):i.type==="folder"&&i.children&&_(i.children)})};_(t);const S=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),p=URL.createObjectURL(S),n=document.createElement("a");n.href=p,n.download=`project-${Date.now()}.json`,n.click(),URL.revokeObjectURL(p)},m=()=>{d([]),k(null)},c=(h,_=0)=>{const S=y===h.id;return u.jsxs("div",{className:"file-tree-item",children:[u.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 cursor-pointer hover:bg-muted/20 file-tree-small ${S?"bg-primary/10 text-primary":"text-foreground"}`,style:{paddingLeft:`${8+_*12}px`,fontFamily:"Quicksand, sans-serif"},onClick:()=>{h.type==="folder"?E(h.id):s(h)},children:[h.type==="folder"&&u.jsxs(u.Fragment,{children:[h.isExpanded?u.jsx(jt,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}):u.jsx(us,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}),u.jsx("div",{className:"w-3 flex justify-center",children:h.isExpanded?u.jsx(xo,{className:"h-3 w-3 text-primary"}):u.jsx(qr,{className:"h-3 w-3 text-muted-foreground"})})]}),h.type==="file"&&u.jsx("div",{className:"w-3 flex justify-center ml-3",children:a(h.name)}),u.jsx("span",{className:"file-tree-node-name truncate text-xs",children:h.name})]}),h.type==="folder"&&h.isExpanded&&h.children&&u.jsx("div",{children:h.children.map(p=>c(p,_+1))})]},h.id)};return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx("div",{className:"p-4 border-b border-border min-h-[73px] flex items-center",children:u.jsx("div",{className:"flex items-center justify-between w-full",children:u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5 text-[13px]",onClick:m,title:"Clear all files",children:u.jsx(Kr,{className:"h-4 w-4"})}),u.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",onClick:f,title:"Download project",children:u.jsx(Ur,{className:"h-4 w-4"})})]})})}),u.jsx(ft,{className:"flex-1",children:u.jsx("div",{className:"p-2",children:t.map(h=>c(h))})})]})}const hc=r=>{const e=document.createElement("div");return e.textContent=r,e.innerHTML},Cr={typescript:["import","export","from","interface","type","class","function","const","let","var","if","else","for","while","return","extends","implements","public","private","protected","static","async","await","try","catch","finally","throw","new","this","super","null","undefined","true","false","as","in","of","typeof","instanceof","break","continue","switch","case","default","do","with","enum","namespace"],javascript:["import","export","from","class","function","const","let","var","if","else","for","while","return","extends","async","await","try","catch","finally","throw","new","this","super","null","undefined","true","false","in","of","typeof","instanceof","break","continue","switch","case","default","do","with"],python:["import","from","class","def","if","elif","else","for","while","return","try","except","finally","raise","pass","break","continue","lambda","with","as","yield","assert","del","global","nonlocal","in","is","not","and","or","None","True","False","self","async","await"],java:["import","package","class","interface","extends","implements","public","private","protected","static","final","abstract","void","int","long","float","double","boolean","char","byte","short","if","else","for","while","return","switch","case","default","break","continue","try","catch","finally","throw","throws","new","this","super","null","true","false","instanceof","synchronized","volatile"]},dc=(r,e)=>{if(!r)return"";let t=hc(r);const d=Cr[e]||Cr.typescript||[],y=[],k=(_,S,p)=>{y.push({start:_,end:S,replacement:p})},E=/(\/\/[^\n]*|\/\*[\s\S]*?\*\/)/g;let s;for(;(s=E.exec(t))!==null;)k(s.index,s.index+s[0].length,`<span class="syntax-comment">${s[0]}</span>`);const a=/(["'`])(?:(?=(\\?))\2[\s\S])*?\1/g;for(;(s=a.exec(t))!==null;)y.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-string">${s[0]}</span>`);const f=/\b(\d+\.?\d*)\b/g;for(;(s=f.exec(t))!==null;)y.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-number">${s[0]}</span>`);const m=new RegExp(`\\b(${d.join("|")})\\b`,"g");for(;(s=m.exec(t))!==null;)y.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-keyword">${s[0]}</span>`);const c=/\b([a-zA-Z_$][a-zA-Z0-9_$]*)\s*(?=\()/g;for(;(s=c.exec(t))!==null;){const _=y.some(p=>s.index>=p.start&&s.index<p.end),S=s[1]&&d.includes(s[1]);!_&&!S&&s[1]&&k(s.index,s.index+s[1].length,`<span class="syntax-function">${s[1]}</span>`)}const h=/\b([A-Z][a-zA-Z0-9_]*)\b(?!\s*\()/g;for(;(s=h.exec(t))!==null;)y.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-type">${s[0]}</span>`);y.sort((_,S)=>S.start-_.start);for(const{start:_,end:S,replacement:p}of y)t=t.substring(0,_)+p+t.substring(S);return t},uc=r=>{const e=Math.floor((r.length-r.trimStart().length)/4);let t=r;if(e>0){let d="",y=0;for(let k=0;k<r.length;k++)if(r[k]===" "&&y<e*4)(y+1)%4===0?(d+='<span class="indent-guide">│</span>   ',k+=3,y+=4):(d+=r[k],y++);else{d+=r.substring(k);break}t=d}return t};function fc({value:r,onChange:e,language:t,placeholder:d="Start typing your code here..."}){const[y,k]=M.useState(""),E=M.useRef(null),s=M.useRef(null),a=M.useRef(null);M.useEffect(()=>{if(r){const S=r.split(`
`).map(p=>{const n=uc(p);return dc(n,t)});k(S.join(`
`))}else k("")},[r,t]);const f=()=>{E.current&&s.current&&a.current&&(s.current.scrollTop=E.current.scrollTop,s.current.scrollLeft=E.current.scrollLeft,a.current.scrollTop=E.current.scrollTop)},m=_=>{e(_.target.value)},c=_=>{if(_.key==="Tab"){_.preventDefault();const S=_.currentTarget,p=S.selectionStart,n=S.selectionEnd,o=r.substring(0,p)+"    "+r.substring(n);e(o),setTimeout(()=>{S.selectionStart=S.selectionEnd=p+4},0)}},h=r?r.split(`
`).length:1;return u.jsxs("div",{className:"relative h-full w-full overflow-hidden bg-[#1e1e1e] flex",children:[u.jsx("div",{ref:a,className:"line-numbers overflow-hidden",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"13px",lineHeight:"1.5",padding:"1rem 0.5rem",paddingRight:"0.75rem",color:"#6e6e6e",backgroundColor:"#1a1a1a",borderRight:"1px solid #2d2d2d",userSelect:"none",minWidth:"3.5rem",textAlign:"right"},children:Array.from({length:h},(_,S)=>u.jsx("div",{style:{height:"19.5px"},children:S+1},S))}),u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{ref:s,className:"absolute inset-0 overflow-auto pointer-events-none syntax-highlighted-content",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"13px",lineHeight:"1.5",padding:"1rem",paddingLeft:"1rem",color:"#d4d4d4"},children:u.jsx("pre",{style:{margin:0,padding:0,background:"transparent",fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word"},dangerouslySetInnerHTML:{__html:y||"&nbsp;"}})}),u.jsx("textarea",{ref:E,value:r,onChange:m,onScroll:f,onKeyDown:c,placeholder:d,className:"absolute inset-0 w-full h-full resize-none bg-transparent border-0 outline-none code-editor-textarea",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"13px",lineHeight:"1.5",padding:"1rem",paddingLeft:"1rem",color:"transparent",caretColor:"#d4d4d4",WebkitTextFillColor:"transparent",whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word"},spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off"}),!r&&u.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"13px",lineHeight:"1.5",padding:"1rem",paddingLeft:"1rem",color:"#6e6e6e"},children:d})]}),u.jsx("style",{children:`
        .indent-guide {
          color: #3a3a3a;
          font-weight: 300;
          display: inline-block;
          width: 1ch;
          text-align: center;
        }
        
        .syntax-comment { color: #6A9955; }
        .syntax-string { color: #CE9178; }
        .syntax-number { color: #B5CEA8; }
        .syntax-keyword { color: #569CD6; }
        .syntax-function { color: #DCDCAA; }
        .syntax-type { color: #4EC9B0; }
        
        /* Hide scrollbar for line numbers */
        .line-numbers::-webkit-scrollbar {
          display: none;
        }
        .line-numbers {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
      `})]})}function pc({currentPhase:r="spec",selectedFile:e}){const[t,d]=M.useState(""),[y,k]=M.useState([]),E=M.useCallback(h=>{k(_=>{const S=_.filter(p=>p.id!==h);return t===h&&(S.length>0&&S[0]?d(S[0].id):d("")),S})},[t]);M.useEffect(()=>{const h=_=>{(_.ctrlKey||_.metaKey)&&_.key==="w"&&(_.preventDefault(),t&&E(t))};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,E]),M.useEffect(()=>{if(e&&e.content){const h=e.path.split("/").pop()||"untitled",_=`file-${e.path}`;y.find(p=>p.id===_)||k(p=>[...p,{id:_,name:h,path:e.path,language:e.language||"plaintext",code:e.content,isActive:!0}]),d(_)}},[e,y]);const s=(h,_)=>{k(S=>S.map(p=>p.id===h?{...p,code:_}:p))},a=()=>{const h=y.find(_=>_.id===t);h&&navigator.clipboard.writeText(h.code)},f=()=>{const h=y.find(_=>_.id===t);if(h){const _=new Blob([h.code],{type:"text/plain"}),S=URL.createObjectURL(_),p=document.createElement("a");p.href=S,p.download=h.name,p.click(),URL.revokeObjectURL(S)}},m=h=>{switch(h){case"spec":return"border-blue-500";case"test":return"border-yellow-500";case"impl":return"border-violet-500";default:return"border-blue-500"}},c=y.find(h=>h.id===t);return y.length===0?u.jsx("div",{className:"h-full flex items-center justify-center bg-[#1e1e1e]",children:u.jsxs("div",{className:"text-center text-muted-foreground px-8",children:[u.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-30"}),u.jsx("p",{className:"text-body mb-2",children:"No files open"}),u.jsx("p",{className:"text-sm mb-4",children:"Select a file from the file tree or import a project to start editing"}),u.jsxs("div",{className:"text-xs space-y-1",children:[u.jsx("p",{className:"opacity-60",children:"Keyboard shortcuts:"}),u.jsx("p",{className:"font-mono opacity-50",children:"Ctrl/Cmd + W - Close active tab"})]})]})}):u.jsxs("div",{className:"h-full flex flex-col bg-[#1e1e1e]",children:[u.jsx("div",{className:"p-4 border-b border-border bg-card min-h-[73px] flex items-center",children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("div",{className:"flex gap-0.5",children:y.map(h=>u.jsxs("div",{className:"relative flex items-center group",children:[t===h.id&&u.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-0.5 ${m(r)} rounded-full`}),u.jsxs("div",{className:`flex items-center rounded-md transition-all duration-200 ${t===h.id?"bg-primary/10 border border-primary/20":"bg-transparent border border-transparent hover:bg-muted/10"}`,style:{fontFamily:"Quicksand, sans-serif",fontSize:"13px",fontWeight:500,minWidth:"120px"},children:[u.jsx("button",{onClick:()=>d(h.id),className:`flex-1 px-3 py-2 text-left truncate transition-colors ${t===h.id?"text-primary":"text-muted-foreground hover:text-foreground"}`,children:h.name}),u.jsx("button",{onClick:_=>{_.stopPropagation(),_.preventDefault(),E(h.id)},onMouseDown:_=>{_.stopPropagation(),_.preventDefault()},className:"p-1.5 mr-1 rounded hover:bg-destructive/20 hover:text-destructive transition-all duration-150 opacity-50 hover:opacity-100 focus:opacity-100",title:"Close file (Ctrl/Cmd + W)",tabIndex:0,children:u.jsx(pt,{className:"h-3 w-3"})})]})]},h.id))}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",onClick:a,title:"Copy code",children:u.jsx(uo,{className:"h-4 w-4"})}),u.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",onClick:f,title:"Download file",children:u.jsx(Ur,{className:"h-4 w-4"})}),u.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",children:u.jsx(go,{className:"h-4 w-4"})})]})]})}),u.jsx("div",{className:"flex-1 overflow-hidden bg-[#1e1e1e]",children:c&&u.jsx(fc,{value:c.code,onChange:h=>s(c.id,h),language:c.language,placeholder:"Start typing your code here..."})})]})}var ns={exports:{}},Er;function _c(){return Er||(Er=1,function(r,e){(function(t,d){r.exports=d()})(globalThis,()=>(()=>{var t={4567:function(E,s,a){var f=this&&this.__decorate||function(i,l,g,x){var b,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(b=i[C])&&(v=(w<3?b(v):w>3?b(l,g,v):b(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},m=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const c=a(9042),h=a(9924),_=a(844),S=a(4725),p=a(2585),n=a(3656);let o=s.AccessibilityManager=class extends _.Disposable{constructor(i,l,g,x){super(),this._terminal=i,this._coreBrowserService=g,this._renderService=x,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let b=0;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);if(this._topBoundaryFocusListener=b=>this._handleBoundaryFocus(b,0),this._bottomBoundaryFocusListener=b=>this._handleBoundaryFocus(b,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new h.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(b=>this._handleResize(b.rows))),this.register(this._terminal.onRender(b=>this._refreshRows(b.start,b.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(b=>this._handleChar(b))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(b=>this._handleTab(b))),this.register(this._terminal.onKey(b=>this._handleKey(b.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,n.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,_.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(i){for(let l=0;l<i;l++)this._handleChar(" ")}_handleChar(i){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==i&&(this._charsToAnnounce+=i):this._charsToAnnounce+=i,i===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(i){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(i)||this._charsToConsume.push(i)}_refreshRows(i,l){this._liveRegionDebouncer.refresh(i,l,this._terminal.rows)}_renderRows(i,l){const g=this._terminal.buffer,x=g.lines.length.toString();for(let b=i;b<=l;b++){const w=g.lines.get(g.ydisp+b),v=[],C=w?.translateToString(!0,void 0,void 0,v)||"",T=(g.ydisp+b+1).toString(),A=this._rowElements[b];A&&(C.length===0?(A.innerText=" ",this._rowColumns.set(A,[0,1])):(A.textContent=C,this._rowColumns.set(A,v)),A.setAttribute("aria-posinset",T),A.setAttribute("aria-setsize",x))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(i,l){const g=i.target,x=this._rowElements[l===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(l===0?"1":`${this._terminal.buffer.lines.length}`)||i.relatedTarget!==x)return;let b,w;if(l===0?(b=g,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(b=this._rowElements.shift(),w=g,this._rowContainer.removeChild(b)),b.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),l===0){const v=this._createAccessibilityTreeNode();this._rowElements.unshift(v),this._rowContainer.insertAdjacentElement("afterbegin",v)}else{const v=this._createAccessibilityTreeNode();this._rowElements.push(v),this._rowContainer.appendChild(v)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(l===0?-1:1),this._rowElements[l===0?1:this._rowElements.length-2].focus(),i.preventDefault(),i.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;const i=document.getSelection();if(!i)return;if(i.isCollapsed)return void(this._rowContainer.contains(i.anchorNode)&&this._terminal.clearSelection());if(!i.anchorNode||!i.focusNode)return void console.error("anchorNode and/or focusNode are null");let l={node:i.anchorNode,offset:i.anchorOffset},g={node:i.focusNode,offset:i.focusOffset};if((l.node.compareDocumentPosition(g.node)&Node.DOCUMENT_POSITION_PRECEDING||l.node===g.node&&l.offset>g.offset)&&([l,g]=[g,l]),l.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(l={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(l.node))return;const x=this._rowElements.slice(-1)[0];if(g.node.compareDocumentPosition(x)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(g={node:x,offset:x.textContent?.length??0}),!this._rowContainer.contains(g.node))return;const b=({node:C,offset:T})=>{const A=C instanceof Text?C.parentNode:C;let N=parseInt(A?.getAttribute("aria-posinset"),10)-1;if(isNaN(N))return console.warn("row is invalid. Race condition?"),null;const D=this._rowColumns.get(A);if(!D)return console.warn("columns is null. Race condition?"),null;let j=T<D.length?D[T]:D.slice(-1)[0]+1;return j>=this._terminal.cols&&(++N,j=0),{row:N,column:j}},w=b(l),v=b(g);if(w&&v){if(w.row>v.row||w.row===v.row&&w.column>=v.column)throw new Error("invalid range");this._terminal.select(w.column,w.row,(v.row-w.row)*this._terminal.cols-w.column+v.column)}}_handleResize(i){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let l=this._rowContainer.children.length;l<this._terminal.rows;l++)this._rowElements[l]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[l]);for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const i=this._coreBrowserService.mainDocument.createElement("div");return i.setAttribute("role","listitem"),i.tabIndex=-1,this._refreshRowDimensions(i),i}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let i=0;i<this._terminal.rows;i++)this._refreshRowDimensions(this._rowElements[i])}}_refreshRowDimensions(i){i.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s.AccessibilityManager=o=f([m(1,p.IInstantiationService),m(2,S.ICoreBrowserService),m(3,S.IRenderService)],o)},3614:(E,s)=>{function a(h){return h.replace(/\r?\n/g,"\r")}function f(h,_){return _?"\x1B[200~"+h+"\x1B[201~":h}function m(h,_,S,p){h=f(h=a(h),S.decPrivateModes.bracketedPasteMode&&p.rawOptions.ignoreBracketedPasteMode!==!0),S.triggerDataEvent(h,!0),_.value=""}function c(h,_,S){const p=S.getBoundingClientRect(),n=h.clientX-p.left-10,o=h.clientY-p.top-10;_.style.width="20px",_.style.height="20px",_.style.left=`${n}px`,_.style.top=`${o}px`,_.style.zIndex="1000",_.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=a,s.bracketTextForPaste=f,s.copyHandler=function(h,_){h.clipboardData&&h.clipboardData.setData("text/plain",_.selectionText),h.preventDefault()},s.handlePasteEvent=function(h,_,S,p){h.stopPropagation(),h.clipboardData&&m(h.clipboardData.getData("text/plain"),_,S,p)},s.paste=m,s.moveTextAreaUnderMouseCursor=c,s.rightClickHandler=function(h,_,S,p,n){c(h,_,S),n&&p.rightClickSelect(h),_.value=p.selectionText,_.select()}},7239:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const f=a(1505);s.ColorContrastCache=class{constructor(){this._color=new f.TwoKeyMap,this._css=new f.TwoKeyMap}setCss(m,c,h){this._css.set(m,c,h)}getCss(m,c){return this._css.get(m,c)}setColor(m,c,h){this._color.set(m,c,h)}getColor(m,c){return this._color.get(m,c)}clear(){this._color.clear(),this._css.clear()}}},3656:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(a,f,m,c){a.addEventListener(f,m,c);let h=!1;return{dispose:()=>{h||(h=!0,a.removeEventListener(f,m,c))}}}},3551:function(E,s,a){var f=this&&this.__decorate||function(o,i,l,g){var x,b=arguments.length,w=b<3?i:g===null?g=Object.getOwnPropertyDescriptor(i,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,i,l,g);else for(var v=o.length-1;v>=0;v--)(x=o[v])&&(w=(b<3?x(w):b>3?x(i,l,w):x(i,l))||w);return b>3&&w&&Object.defineProperty(i,l,w),w},m=this&&this.__param||function(o,i){return function(l,g){i(l,g,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier=void 0;const c=a(3656),h=a(8460),_=a(844),S=a(2585),p=a(4725);let n=s.Linkifier=class extends _.Disposable{get currentLink(){return this._currentLink}constructor(o,i,l,g,x){super(),this._element=o,this._mouseService=i,this._renderService=l,this._bufferService=g,this._linkProviderService=x,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,_.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,_.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(o){this._lastMouseEvent=o;const i=this._positionFromMouseEvent(o,this._element,this._mouseService);if(!i)return;this._isMouseOut=!1;const l=o.composedPath();for(let g=0;g<l.length;g++){const x=l[g];if(x.classList.contains("xterm"))break;if(x.classList.contains("xterm-hover"))return}this._lastBufferCell&&i.x===this._lastBufferCell.x&&i.y===this._lastBufferCell.y||(this._handleHover(i),this._lastBufferCell=i)}_handleHover(o){if(this._activeLine!==o.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(o,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,o)||(this._clearCurrentLink(),this._askForLink(o,!0))}_askForLink(o,i){this._activeProviderReplies&&i||(this._activeProviderReplies?.forEach(g=>{g?.forEach(x=>{x.link.dispose&&x.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=o.y);let l=!1;for(const[g,x]of this._linkProviderService.linkProviders.entries())i?this._activeProviderReplies?.get(g)&&(l=this._checkLinkProviderResult(g,o,l)):x.provideLinks(o.y,b=>{if(this._isMouseOut)return;const w=b?.map(v=>({link:v}));this._activeProviderReplies?.set(g,w),l=this._checkLinkProviderResult(g,o,l),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(o.y,this._activeProviderReplies)})}_removeIntersectingLinks(o,i){const l=new Set;for(let g=0;g<i.size;g++){const x=i.get(g);if(x)for(let b=0;b<x.length;b++){const w=x[b],v=w.link.range.start.y<o?0:w.link.range.start.x,C=w.link.range.end.y>o?this._bufferService.cols:w.link.range.end.x;for(let T=v;T<=C;T++){if(l.has(T)){x.splice(b--,1);break}l.add(T)}}}}_checkLinkProviderResult(o,i,l){if(!this._activeProviderReplies)return l;const g=this._activeProviderReplies.get(o);let x=!1;for(let b=0;b<o;b++)this._activeProviderReplies.has(b)&&!this._activeProviderReplies.get(b)||(x=!0);if(!x&&g){const b=g.find(w=>this._linkAtPosition(w.link,i));b&&(l=!0,this._handleNewLink(b))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!l)for(let b=0;b<this._activeProviderReplies.size;b++){const w=this._activeProviderReplies.get(b)?.find(v=>this._linkAtPosition(v.link,i));if(w){l=!0,this._handleNewLink(w);break}}return l}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(o){if(!this._currentLink)return;const i=this._positionFromMouseEvent(o,this._element,this._mouseService);i&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,i)&&this._currentLink.link.activate(o,this._currentLink.link.text)}_clearCurrentLink(o,i){this._currentLink&&this._lastMouseEvent&&(!o||!i||this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=i)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,_.disposeArray)(this._linkCacheDisposables))}_handleNewLink(o){if(!this._lastMouseEvent)return;const i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(o.link,i)&&(this._currentLink=o,this._currentLink.state={decorations:{underline:o.link.decorations===void 0||o.link.decorations.underline,pointerCursor:o.link.decorations===void 0||o.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,o.link,this._lastMouseEvent),o.link.decorations={},Object.defineProperties(o.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:l=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==l&&(this._currentLink.state.decorations.pointerCursor=l,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",l))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:l=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==l&&(this._currentLink.state.decorations.underline=l,this._currentLink.state.isHovered&&this._fireUnderlineEvent(o.link,l))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(l=>{if(!this._currentLink)return;const g=l.start===0?0:l.start+1+this._bufferService.buffer.ydisp,x=this._bufferService.buffer.ydisp+1+l.end;if(this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=x&&(this._clearCurrentLink(g,x),this._lastMouseEvent)){const b=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);b&&this._askForLink(b,!1)}})))}_linkHover(o,i,l){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!0),this._currentLink.state.decorations.pointerCursor&&o.classList.add("xterm-cursor-pointer")),i.hover&&i.hover(l,i.text)}_fireUnderlineEvent(o,i){const l=o.range,g=this._bufferService.buffer.ydisp,x=this._createLinkUnderlineEvent(l.start.x-1,l.start.y-g-1,l.end.x,l.end.y-g-1,void 0);(i?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(x)}_linkLeave(o,i,l){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!1),this._currentLink.state.decorations.pointerCursor&&o.classList.remove("xterm-cursor-pointer")),i.leave&&i.leave(l,i.text)}_linkAtPosition(o,i){const l=o.range.start.y*this._bufferService.cols+o.range.start.x,g=o.range.end.y*this._bufferService.cols+o.range.end.x,x=i.y*this._bufferService.cols+i.x;return l<=x&&x<=g}_positionFromMouseEvent(o,i,l){const g=l.getCoords(o,i,this._bufferService.cols,this._bufferService.rows);if(g)return{x:g[0],y:g[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(o,i,l,g,x){return{x1:o,y1:i,x2:l,y2:g,cols:this._bufferService.cols,fg:x}}};s.Linkifier=n=f([m(1,p.IMouseService),m(2,p.IRenderService),m(3,S.IBufferService),m(4,p.ILinkProviderService)],n)},9042:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(E,s,a){var f=this&&this.__decorate||function(p,n,o,i){var l,g=arguments.length,x=g<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(p,n,o,i);else for(var b=p.length-1;b>=0;b--)(l=p[b])&&(x=(g<3?l(x):g>3?l(n,o,x):l(n,o))||x);return g>3&&x&&Object.defineProperty(n,o,x),x},m=this&&this.__param||function(p,n){return function(o,i){n(o,i,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const c=a(511),h=a(2585);let _=s.OscLinkProvider=class{constructor(p,n,o){this._bufferService=p,this._optionsService=n,this._oscLinkService=o}provideLinks(p,n){const o=this._bufferService.buffer.lines.get(p-1);if(!o)return void n(void 0);const i=[],l=this._optionsService.rawOptions.linkHandler,g=new c.CellData,x=o.getTrimmedLength();let b=-1,w=-1,v=!1;for(let C=0;C<x;C++)if(w!==-1||o.hasContent(C)){if(o.loadCell(C,g),g.hasExtendedAttrs()&&g.extended.urlId){if(w===-1){w=C,b=g.extended.urlId;continue}v=g.extended.urlId!==b}else w!==-1&&(v=!0);if(v||w!==-1&&C===x-1){const T=this._oscLinkService.getLinkData(b)?.uri;if(T){const A={start:{x:w+1,y:p},end:{x:C+(v||C!==x-1?0:1),y:p}};let N=!1;if(!l?.allowNonHttpProtocols)try{const D=new URL(T);["http:","https:"].includes(D.protocol)||(N=!0)}catch{N=!0}N||i.push({text:T,range:A,activate:(D,j)=>l?l.activate(D,j,A):S(0,j),hover:(D,j)=>l?.hover?.(D,j,A),leave:(D,j)=>l?.leave?.(D,j,A)})}v=!1,g.hasExtendedAttrs()&&g.extended.urlId?(w=C,b=g.extended.urlId):(w=-1,b=-1)}}n(i)}};function S(p,n){if(confirm(`Do you want to navigate to ${n}?

WARNING: This link could potentially be dangerous`)){const o=window.open();if(o){try{o.opener=null}catch{}o.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}}s.OscLinkProvider=_=f([m(0,h.IBufferService),m(1,h.IOptionsService),m(2,h.IOscLinkService)],_)},6193:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(a,f){this._renderCallback=a,this._coreBrowserService=f,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,f,m){this._rowCount=m,a=a!==void 0?a:0,f=f!==void 0?f:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,f):f,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const a=Math.max(this._rowStart,0),f=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,f),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},3236:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const f=a(3614),m=a(3656),c=a(3551),h=a(9042),_=a(3730),S=a(1680),p=a(3107),n=a(5744),o=a(2950),i=a(1296),l=a(428),g=a(4269),x=a(5114),b=a(8934),w=a(3230),v=a(9312),C=a(4725),T=a(6731),A=a(8055),N=a(8969),D=a(8460),j=a(844),F=a(6114),U=a(8437),X=a(2584),q=a(7399),R=a(5941),P=a(9074),B=a(2585),O=a(5435),H=a(4567),W=a(779);class K extends N.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(I={}){super(I),this.browser=F,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new j.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(P.DecorationService),this._instantiationService.setService(B.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(W.LinkProviderService),this._instantiationService.setService(C.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(_.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((L,z)=>this.refresh(L,z))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(L=>this._reportWindowsOptions(L))),this.register(this._inputHandler.onColor(L=>this._handleColorEvent(L))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(L=>this._afterResize(L.cols,L.rows))),this.register((0,j.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(I){if(this._themeService)for(const L of I){let z,$="";switch(L.index){case 256:z="foreground",$="10";break;case 257:z="background",$="11";break;case 258:z="cursor",$="12";break;default:z="ansi",$="4;"+L.index}switch(L.type){case 0:const Y=A.color.toColorRGB(z==="ansi"?this._themeService.colors.ansi[L.index]:this._themeService.colors[z]);this.coreService.triggerDataEvent(`${X.C0.ESC}]${$};${(0,R.toRgbString)(Y)}${X.C1_ESCAPED.ST}`);break;case 1:if(z==="ansi")this._themeService.modifyColors(G=>G.ansi[L.index]=A.channels.toColor(...L.color));else{const G=z;this._themeService.modifyColors(J=>J[G]=A.channels.toColor(...L.color))}break;case 2:this._themeService.restoreColor(L.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(I){I?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(H.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(I){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const I=this.buffer.ybase+this.buffer.y,L=this.buffer.lines.get(I);if(!L)return;const z=Math.min(this.buffer.x,this.cols-1),$=this._renderService.dimensions.css.cell.height,Y=L.getWidth(z),G=this._renderService.dimensions.css.cell.width*Y,J=this.buffer.y*this._renderService.dimensions.css.cell.height,re=z*this._renderService.dimensions.css.cell.width;this.textarea.style.left=re+"px",this.textarea.style.top=J+"px",this.textarea.style.width=G+"px",this.textarea.style.height=$+"px",this.textarea.style.lineHeight=$+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,m.addDisposableDomListener)(this.element,"copy",L=>{this.hasSelection()&&(0,f.copyHandler)(L,this._selectionService)}));const I=L=>(0,f.handlePasteEvent)(L,this.textarea,this.coreService,this.optionsService);this.register((0,m.addDisposableDomListener)(this.textarea,"paste",I)),this.register((0,m.addDisposableDomListener)(this.element,"paste",I)),F.isFirefox?this.register((0,m.addDisposableDomListener)(this.element,"mousedown",L=>{L.button===2&&(0,f.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,m.addDisposableDomListener)(this.element,"contextmenu",L=>{(0,f.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),F.isLinux&&this.register((0,m.addDisposableDomListener)(this.element,"auxclick",L=>{L.button===1&&(0,f.moveTextAreaUnderMouseCursor)(L,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,m.addDisposableDomListener)(this.textarea,"keyup",I=>this._keyUp(I),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keydown",I=>this._keyDown(I),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keypress",I=>this._keyPress(I),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionupdate",I=>this._compositionHelper.compositionupdate(I))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,m.addDisposableDomListener)(this.textarea,"input",I=>this._inputEvent(I),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(I){if(!I)throw new Error("Terminal requires a parent element.");if(I.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=I.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),I.appendChild(this.element);const L=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),L.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,m.addDisposableDomListener)(this.screenElement,"mousemove",z=>this.updateCursorStyle(z))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),L.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),F.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(x.CoreBrowserService,this.textarea,I.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(C.ICoreBrowserService,this._coreBrowserService),this.register((0,m.addDisposableDomListener)(this.textarea,"focus",z=>this._handleTextAreaFocus(z))),this.register((0,m.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(l.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(C.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(T.ThemeService),this._instantiationService.setService(C.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(g.CharacterJoinerService),this._instantiationService.setService(C.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(w.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(C.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(z=>this._onRender.fire(z))),this.onResize(z=>this._renderService.resize(z.cols,z.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(o.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(b.MouseService),this._instantiationService.setService(C.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(c.Linkifier,this.screenElement)),this.element.appendChild(L);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(S.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(z=>this.scrollLines(z.amount,z.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(C.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(z=>this.scrollLines(z.amount,z.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(z=>this._renderService.handleSelectionChanged(z.start,z.end,z.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(z=>{this.textarea.value=z,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(z=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,m.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(p.BufferDecorationRenderer,this.screenElement)),this.register((0,m.addDisposableDomListener)(this.element,"mousedown",z=>this._selectionService.handleMouseDown(z))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(H.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",z=>this._handleScreenReaderModeOptionChange(z))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",z=>{!this._overviewRulerRenderer&&z&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const I=this,L=this.element;function z(G){const J=I._mouseService.getMouseReportCoords(G,I.screenElement);if(!J)return!1;let re,ne;switch(G.overrideType||G.type){case"mousemove":ne=32,G.buttons===void 0?(re=3,G.button!==void 0&&(re=G.button<3?G.button:3)):re=1&G.buttons?0:4&G.buttons?1:2&G.buttons?2:3;break;case"mouseup":ne=0,re=G.button<3?G.button:3;break;case"mousedown":ne=1,re=G.button<3?G.button:3;break;case"wheel":if(I._customWheelEventHandler&&I._customWheelEventHandler(G)===!1||I.viewport.getLinesScrolled(G)===0)return!1;ne=G.deltaY<0?0:1,re=4;break;default:return!1}return!(ne===void 0||re===void 0||re>4)&&I.coreMouseService.triggerMouseEvent({col:J.col,row:J.row,x:J.x,y:J.y,button:re,action:ne,ctrl:G.ctrlKey,alt:G.altKey,shift:G.shiftKey})}const $={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Y={mouseup:G=>(z(G),G.buttons||(this._document.removeEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.removeEventListener("mousemove",$.mousedrag)),this.cancel(G)),wheel:G=>(z(G),this.cancel(G,!0)),mousedrag:G=>{G.buttons&&z(G)},mousemove:G=>{G.buttons||z(G)}};this.register(this.coreMouseService.onProtocolChange(G=>{G?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(G)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&G?$.mousemove||(L.addEventListener("mousemove",Y.mousemove),$.mousemove=Y.mousemove):(L.removeEventListener("mousemove",$.mousemove),$.mousemove=null),16&G?$.wheel||(L.addEventListener("wheel",Y.wheel,{passive:!1}),$.wheel=Y.wheel):(L.removeEventListener("wheel",$.wheel),$.wheel=null),2&G?$.mouseup||($.mouseup=Y.mouseup):(this._document.removeEventListener("mouseup",$.mouseup),$.mouseup=null),4&G?$.mousedrag||($.mousedrag=Y.mousedrag):(this._document.removeEventListener("mousemove",$.mousedrag),$.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,m.addDisposableDomListener)(L,"mousedown",G=>{if(G.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(G))return z(G),$.mouseup&&this._document.addEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.addEventListener("mousemove",$.mousedrag),this.cancel(G)})),this.register((0,m.addDisposableDomListener)(L,"wheel",G=>{if(!$.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(G)===!1)return!1;if(!this.buffer.hasScrollback){const J=this.viewport.getLinesScrolled(G);if(J===0)return;const re=X.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(G.deltaY<0?"A":"B");let ne="";for(let he=0;he<Math.abs(J);he++)ne+=re;return this.coreService.triggerDataEvent(ne,!0),this.cancel(G,!0)}return this.viewport.handleWheel(G)?this.cancel(G):void 0}},{passive:!1})),this.register((0,m.addDisposableDomListener)(L,"touchstart",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(G),this.cancel(G)},{passive:!0})),this.register((0,m.addDisposableDomListener)(L,"touchmove",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(G)?void 0:this.cancel(G)},{passive:!1}))}refresh(I,L){this._renderService?.refreshRows(I,L)}updateCursorStyle(I){this._selectionService?.shouldColumnSelect(I)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(I,L,z=0){z===1?(super.scrollLines(I,L,z),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(I)}paste(I){(0,f.paste)(I,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(I){this._customKeyEventHandler=I}attachCustomWheelEventHandler(I){this._customWheelEventHandler=I}registerLinkProvider(I){return this._linkProviderService.registerLinkProvider(I)}registerCharacterJoiner(I){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const L=this._characterJoinerService.register(I);return this.refresh(0,this.rows-1),L}deregisterCharacterJoiner(I){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(I)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(I){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+I)}registerDecoration(I){return this._decorationService.registerDecoration(I)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(I,L,z){this._selectionService.setSelection(I,L,z)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(I,L){this._selectionService?.selectLines(I,L)}_keyDown(I){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(I)===!1)return!1;const L=this.browser.isMac&&this.options.macOptionIsMeta&&I.altKey;if(!L&&!this._compositionHelper.keydown(I))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;L||I.key!=="Dead"&&I.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const z=(0,q.evaluateKeyboardEvent)(I,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(I),z.type===3||z.type===2){const $=this.rows-1;return this.scrollLines(z.type===2?-$:$),this.cancel(I,!0)}return z.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,I)||(z.cancel&&this.cancel(I,!0),!z.key||!!(I.key&&!I.ctrlKey&&!I.altKey&&!I.metaKey&&I.key.length===1&&I.key.charCodeAt(0)>=65&&I.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(z.key!==X.C0.ETX&&z.key!==X.C0.CR||(this.textarea.value=""),this._onKey.fire({key:z.key,domEvent:I}),this._showCursor(),this.coreService.triggerDataEvent(z.key,!0),!this.optionsService.rawOptions.screenReaderMode||I.altKey||I.ctrlKey?this.cancel(I,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(I,L){const z=I.isMac&&!this.options.macOptionIsMeta&&L.altKey&&!L.ctrlKey&&!L.metaKey||I.isWindows&&L.altKey&&L.ctrlKey&&!L.metaKey||I.isWindows&&L.getModifierState("AltGraph");return L.type==="keypress"?z:z&&(!L.keyCode||L.keyCode>47)}_keyUp(I){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(I)===!1||(function(L){return L.keyCode===16||L.keyCode===17||L.keyCode===18}(I)||this.focus(),this.updateCursorStyle(I),this._keyPressHandled=!1)}_keyPress(I){let L;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(I)===!1)return!1;if(this.cancel(I),I.charCode)L=I.charCode;else if(I.which===null||I.which===void 0)L=I.keyCode;else{if(I.which===0||I.charCode===0)return!1;L=I.which}return!(!L||(I.altKey||I.ctrlKey||I.metaKey)&&!this._isThirdLevelShift(this.browser,I)||(L=String.fromCharCode(L),this._onKey.fire({key:L,domEvent:I}),this._showCursor(),this.coreService.triggerDataEvent(L,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(I){if(I.data&&I.inputType==="insertText"&&(!I.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const L=I.data;return this.coreService.triggerDataEvent(L,!0),this.cancel(I),!0}return!1}resize(I,L){I!==this.cols||L!==this.rows?super.resize(I,L):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(I,L){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let I=1;I<this.rows;I++)this.buffer.lines.push(this.buffer.getBlankLine(U.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const I=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=I,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(X.C0.ESC+"[I"):this.coreService.triggerDataEvent(X.C0.ESC+"[O")}_reportWindowsOptions(I){if(this._renderService)switch(I){case O.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const L=this._renderService.dimensions.css.canvas.width.toFixed(0),z=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[4;${z};${L}t`);break;case O.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const $=this._renderService.dimensions.css.cell.width.toFixed(0),Y=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[6;${Y};${$}t`)}}cancel(I,L){if(this.options.cancelEvents||L)return I.preventDefault(),I.stopPropagation(),!1}}s.Terminal=K},9924:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(a,f=1e3){this._renderCallback=a,this._debounceThresholdMS=f,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,f,m){this._rowCount=m,a=a!==void 0?a:0,f=f!==void 0?f:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,f):f;const c=Date.now();if(c-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=c,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=c-this._lastRefreshMs,_=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},_)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const a=Math.max(this._rowStart,0),f=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,f)}}},1680:function(E,s,a){var f=this&&this.__decorate||function(o,i,l,g){var x,b=arguments.length,w=b<3?i:g===null?g=Object.getOwnPropertyDescriptor(i,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,i,l,g);else for(var v=o.length-1;v>=0;v--)(x=o[v])&&(w=(b<3?x(w):b>3?x(i,l,w):x(i,l))||w);return b>3&&w&&Object.defineProperty(i,l,w),w},m=this&&this.__param||function(o,i){return function(l,g){i(l,g,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const c=a(3656),h=a(4725),_=a(8460),S=a(844),p=a(2585);let n=s.Viewport=class extends S.Disposable{constructor(o,i,l,g,x,b,w,v){super(),this._viewportElement=o,this._scrollArea=i,this._bufferService=l,this._optionsService=g,this._charSizeService=x,this._renderService=b,this._coreBrowserService=w,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(o){this._viewportElement.style.backgroundColor=o.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(o){if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const i=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==i&&(this._lastRecordedBufferHeight=i,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const o=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==o&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=o),this._refreshAnimationFrame=null}syncScrollArea(o=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(o)}_handleScroll(o){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const i=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:i,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const o=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(o*(this._smoothScrollState.target-this._smoothScrollState.origin)),o<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(o,i){const l=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(i<0&&this._viewportElement.scrollTop!==0||i>0&&l<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)}handleWheel(o){const i=this._getPixelsScrolled(o);return i!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+i:this._smoothScrollState.target+=i,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=i,this._bubbleScroll(o,i))}scrollLines(o){if(o!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const i=o*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+i,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!1})}_getPixelsScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let i=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?i*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(i*=this._currentRowHeight*this._bufferService.rows),i}getBufferElements(o,i){let l,g="";const x=[],b=i??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let v=o;v<b;v++){const C=w.get(v);if(!C)continue;const T=w.get(v+1)?.isWrapped;if(g+=C.translateToString(!T),!T||v===w.length-1){const A=document.createElement("div");A.textContent=g,x.push(A),g.length>0&&(l=A),g=""}}return{bufferElements:x,cursorElement:l}}getLinesScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let i=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(i/=this._currentRowHeight+0,this._wheelPartialScroll+=i,i=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(i*=this._bufferService.rows),i}_applyScrollModifier(o,i){const l=this._optionsService.rawOptions.fastScrollModifier;return l==="alt"&&i.altKey||l==="ctrl"&&i.ctrlKey||l==="shift"&&i.shiftKey?o*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:o*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(o){this._lastTouchY=o.touches[0].pageY}handleTouchMove(o){const i=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,i!==0&&(this._viewportElement.scrollTop+=i,this._bubbleScroll(o,i))}};s.Viewport=n=f([m(2,p.IBufferService),m(3,p.IOptionsService),m(4,h.ICharSizeService),m(5,h.IRenderService),m(6,h.ICoreBrowserService),m(7,h.IThemeService)],n)},3107:function(E,s,a){var f=this&&this.__decorate||function(p,n,o,i){var l,g=arguments.length,x=g<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(p,n,o,i);else for(var b=p.length-1;b>=0;b--)(l=p[b])&&(x=(g<3?l(x):g>3?l(n,o,x):l(n,o))||x);return g>3&&x&&Object.defineProperty(n,o,x),x},m=this&&this.__param||function(p,n){return function(o,i){n(o,i,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const c=a(4725),h=a(844),_=a(2585);let S=s.BufferDecorationRenderer=class extends h.Disposable{constructor(p,n,o,i,l){super(),this._screenElement=p,this._bufferService=n,this._coreBrowserService=o,this._decorationService=i,this._renderService=l,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(g=>this._removeDecoration(g))),this.register((0,h.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const p of this._decorationService.decorations)this._renderDecoration(p);this._dimensionsChanged=!1}_renderDecoration(p){this._refreshStyle(p),this._dimensionsChanged&&this._refreshXPosition(p)}_createElement(p){const n=this._coreBrowserService.mainDocument.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer",p?.options?.layer==="top"),n.style.width=`${Math.round((p.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=(p.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(p.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const o=p.options.x??0;return o&&o>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(p,n),n}_refreshStyle(p){const n=p.marker.line-this._bufferService.buffers.active.ydisp;if(n<0||n>=this._bufferService.rows)p.element&&(p.element.style.display="none",p.onRenderEmitter.fire(p.element));else{let o=this._decorationElements.get(p);o||(o=this._createElement(p),p.element=o,this._decorationElements.set(p,o),this._container.appendChild(o),p.onDispose(()=>{this._decorationElements.delete(p),o.remove()})),o.style.top=n*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",p.onRenderEmitter.fire(o)}}_refreshXPosition(p,n=p.element){if(!n)return;const o=p.options.x??0;(p.options.anchor||"left")==="right"?n.style.right=o?o*this._renderService.dimensions.css.cell.width+"px":"":n.style.left=o?o*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(p){this._decorationElements.get(p)?.remove(),this._decorationElements.delete(p),p.dispose()}};s.BufferDecorationRenderer=S=f([m(1,_.IBufferService),m(2,c.ICoreBrowserService),m(3,_.IDecorationService),m(4,c.IRenderService)],S)},5871:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(const f of this._zones)if(f.color===a.options.overviewRulerOptions.color&&f.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(f,a.marker.line))return;if(this._lineAdjacentToZone(f,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(f,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,f){return f>=a.startBufferLine&&f<=a.endBufferLine}_lineAdjacentToZone(a,f,m){return f>=a.startBufferLine-this._linePadding[m||"full"]&&f<=a.endBufferLine+this._linePadding[m||"full"]}_addLineToZone(a,f){a.startBufferLine=Math.min(a.startBufferLine,f),a.endBufferLine=Math.max(a.endBufferLine,f)}}},5744:function(E,s,a){var f=this&&this.__decorate||function(l,g,x,b){var w,v=arguments.length,C=v<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,x):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,g,x,b);else for(var T=l.length-1;T>=0;T--)(w=l[T])&&(C=(v<3?w(C):v>3?w(g,x,C):w(g,x))||C);return v>3&&C&&Object.defineProperty(g,x,C),C},m=this&&this.__param||function(l,g){return function(x,b){g(x,b,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const c=a(5871),h=a(4725),_=a(844),S=a(2585),p={full:0,left:0,center:0,right:0},n={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let i=s.OverviewRulerRenderer=class extends _.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(l,g,x,b,w,v,C){super(),this._viewportElement=l,this._screenElement=g,this._bufferService=x,this._decorationService=b,this._renderService=w,this._optionsService=v,this._coreBrowserService=C,this._colorZoneStore=new c.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,_.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const l=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);n.full=this._canvas.width,n.left=l,n.center=g,n.right=l,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=n.left,o.right=n.left+n.center}_refreshDrawHeightConstants(){p.full=Math.round(2*this._coreBrowserService.dpr);const l=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(l,12),6)*this._coreBrowserService.dpr);p.left=g,p.center=g,p.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const l=this._colorZoneStore.zones;for(const g of l)g.position!=="full"&&this._renderColorZone(g);for(const g of l)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(l){this._ctx.fillStyle=l.color,this._ctx.fillRect(o[l.position||"full"],Math.round((this._canvas.height-1)*(l.startBufferLine/this._bufferService.buffers.active.lines.length)-p[l.position||"full"]/2),n[l.position||"full"],Math.round((this._canvas.height-1)*((l.endBufferLine-l.startBufferLine)/this._bufferService.buffers.active.lines.length)+p[l.position||"full"]))}_queueRefresh(l,g){this._shouldUpdateDimensions=l||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s.OverviewRulerRenderer=i=f([m(2,S.IBufferService),m(3,S.IDecorationService),m(4,h.IRenderService),m(5,S.IOptionsService),m(6,h.ICoreBrowserService)],i)},2950:function(E,s,a){var f=this&&this.__decorate||function(p,n,o,i){var l,g=arguments.length,x=g<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(p,n,o,i);else for(var b=p.length-1;b>=0;b--)(l=p[b])&&(x=(g<3?l(x):g>3?l(n,o,x):l(n,o))||x);return g>3&&x&&Object.defineProperty(n,o,x),x},m=this&&this.__param||function(p,n){return function(o,i){n(o,i,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const c=a(4725),h=a(2585),_=a(2584);let S=s.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(p,n,o,i,l,g){this._textarea=p,this._compositionView=n,this._bufferService=o,this._optionsService=i,this._coreService=l,this._renderService=g,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(p){this._compositionView.textContent=p.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(p){if(this._isComposing||this._isSendingComposition){if(p.keyCode===229||p.keyCode===16||p.keyCode===17||p.keyCode===18)return!1;this._finalizeComposition(!1)}return p.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(p){if(this._compositionView.classList.remove("active"),this._isComposing=!1,p){const n={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let o;this._isSendingComposition=!1,n.start+=this._dataAlreadySent.length,o=this._isComposing?this._textarea.value.substring(n.start,n.end):this._textarea.value.substring(n.start),o.length>0&&this._coreService.triggerDataEvent(o,!0)}},0)}else{this._isSendingComposition=!1;const n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}_handleAnyTextareaChanges(){const p=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const n=this._textarea.value,o=n.replace(p,"");this._dataAlreadySent=o,n.length>p.length?this._coreService.triggerDataEvent(o,!0):n.length<p.length?this._coreService.triggerDataEvent(`${_.C0.DEL}`,!0):n.length===p.length&&n!==p&&this._coreService.triggerDataEvent(n,!0)}},0)}updateCompositionElements(p){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),o=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,l=n*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=l+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=o+"px",this._compositionView.style.lineHeight=o+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const g=this._compositionView.getBoundingClientRect();this._textarea.style.left=l+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(g.width,1)+"px",this._textarea.style.height=Math.max(g.height,1)+"px",this._textarea.style.lineHeight=g.height+"px"}p||setTimeout(()=>this.updateCompositionElements(!0),0)}}};s.CompositionHelper=S=f([m(2,h.IBufferService),m(3,h.IOptionsService),m(4,h.ICoreService),m(5,c.IRenderService)],S)},9806:(E,s)=>{function a(f,m,c){const h=c.getBoundingClientRect(),_=f.getComputedStyle(c),S=parseInt(_.getPropertyValue("padding-left")),p=parseInt(_.getPropertyValue("padding-top"));return[m.clientX-h.left-S,m.clientY-h.top-p]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=a,s.getCoords=function(f,m,c,h,_,S,p,n,o){if(!S)return;const i=a(f,m,c);return i?(i[0]=Math.ceil((i[0]+(o?p/2:0))/p),i[1]=Math.ceil(i[1]/n),i[0]=Math.min(Math.max(i[0],1),h+(o?1:0)),i[1]=Math.min(Math.max(i[1],1),_),i):void 0}},9504:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const f=a(2584);function m(n,o,i,l){const g=n-c(n,i),x=o-c(o,i),b=Math.abs(g-x)-function(w,v,C){let T=0;const A=w-c(w,C),N=v-c(v,C);for(let D=0;D<Math.abs(A-N);D++){const j=h(w,v)==="A"?-1:1;C.buffer.lines.get(A+j*D)?.isWrapped&&T++}return T}(n,o,i);return p(b,S(h(n,o),l))}function c(n,o){let i=0,l=o.buffer.lines.get(n),g=l?.isWrapped;for(;g&&n>=0&&n<o.rows;)i++,l=o.buffer.lines.get(--n),g=l?.isWrapped;return i}function h(n,o){return n>o?"A":"B"}function _(n,o,i,l,g,x){let b=n,w=o,v="";for(;b!==i||w!==l;)b+=g?1:-1,g&&b>x.cols-1?(v+=x.buffer.translateBufferLineToString(w,!1,n,b),b=0,n=0,w++):!g&&b<0&&(v+=x.buffer.translateBufferLineToString(w,!1,0,n+1),b=x.cols-1,n=b,w--);return v+x.buffer.translateBufferLineToString(w,!1,n,b)}function S(n,o){const i=o?"O":"[";return f.C0.ESC+i+n}function p(n,o){n=Math.floor(n);let i="";for(let l=0;l<n;l++)i+=o;return i}s.moveToCellSequence=function(n,o,i,l){const g=i.buffer.x,x=i.buffer.y;if(!i.buffer.hasScrollback)return function(v,C,T,A,N,D){return m(C,A,N,D).length===0?"":p(_(v,C,v,C-c(C,N),!1,N).length,S("D",D))}(g,x,0,o,i,l)+m(x,o,i,l)+function(v,C,T,A,N,D){let j;j=m(C,A,N,D).length>0?A-c(A,N):C;const F=A,U=function(X,q,R,P,B,O){let H;return H=m(R,P,B,O).length>0?P-c(P,B):q,X<R&&H<=P||X>=R&&H<P?"C":"D"}(v,C,T,A,N,D);return p(_(v,j,T,F,U==="C",N).length,S(U,D))}(g,x,n,o,i,l);let b;if(x===o)return b=g>n?"D":"C",p(Math.abs(g-n),S(b,l));b=x>o?"D":"C";const w=Math.abs(x-o);return p(function(v,C){return C.cols-v}(x>o?n:g,i)+(w-1)*i.cols+1+((x>o?g:n)-1),S(b,l))}},1296:function(E,s,a){var f=this&&this.__decorate||function(D,j,F,U){var X,q=arguments.length,R=q<3?j:U===null?U=Object.getOwnPropertyDescriptor(j,F):U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(D,j,F,U);else for(var P=D.length-1;P>=0;P--)(X=D[P])&&(R=(q<3?X(R):q>3?X(j,F,R):X(j,F))||R);return q>3&&R&&Object.defineProperty(j,F,R),R},m=this&&this.__param||function(D,j){return function(F,U){j(F,U,D)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const c=a(3787),h=a(2550),_=a(2223),S=a(6171),p=a(6052),n=a(4725),o=a(8055),i=a(8460),l=a(844),g=a(2585),x="xterm-dom-renderer-owner-",b="xterm-rows",w="xterm-fg-",v="xterm-bg-",C="xterm-focus",T="xterm-selection";let A=1,N=s.DomRenderer=class extends l.Disposable{constructor(D,j,F,U,X,q,R,P,B,O,H,W,K){super(),this._terminal=D,this._document=j,this._element=F,this._screenElement=U,this._viewportElement=X,this._helperContainer=q,this._linkifier2=R,this._charSizeService=B,this._optionsService=O,this._bufferService=H,this._coreBrowserService=W,this._themeService=K,this._terminalClass=A++,this._rowElements=[],this._selectionRenderModel=(0,p.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new i.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(b),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(T),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,S.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(V=>this._injectCss(V))),this._injectCss(this._themeService.colors),this._rowFactory=P.createInstance(c.DomRendererRowFactory,document),this._element.classList.add(x+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(V=>this._handleLinkHover(V))),this.register(this._linkifier2.onHideLinkUnderline(V=>this._handleLinkLeave(V))),this.register((0,l.toDisposable)(()=>{this._element.classList.remove(x+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const D=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*D,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*D),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/D),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/D),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const F of this._rowElements)F.style.width=`${this.dimensions.css.canvas.width}px`,F.style.height=`${this.dimensions.css.cell.height}px`,F.style.lineHeight=`${this.dimensions.css.cell.height}px`,F.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const j=`${this._terminalSelector} .${b} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=j,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(D){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let j=`${this._terminalSelector} .${b} { color: ${D.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;j+=`${this._terminalSelector} .${b} .xterm-dim { color: ${o.color.multiplyOpacity(D.foreground,.5).css};}`,j+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const F=`blink_underline_${this._terminalClass}`,U=`blink_bar_${this._terminalClass}`,X=`blink_block_${this._terminalClass}`;j+=`@keyframes ${F} { 50% {  border-bottom-style: hidden; }}`,j+=`@keyframes ${U} { 50% {  box-shadow: none; }}`,j+=`@keyframes ${X} { 0% {  background-color: ${D.cursor.css};  color: ${D.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${D.cursor.css}; }}`,j+=`${this._terminalSelector} .${b}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${F} 1s step-end infinite;}${this._terminalSelector} .${b}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${U} 1s step-end infinite;}${this._terminalSelector} .${b}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block { background-color: ${D.cursor.css}; color: ${D.cursorAccent.css};}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${D.cursor.css} !important; color: ${D.cursorAccent.css} !important;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${D.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${D.cursor.css} inset;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${D.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,j+=`${this._terminalSelector} .${T} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${T} div { position: absolute; background-color: ${D.selectionBackgroundOpaque.css};}${this._terminalSelector} .${T} div { position: absolute; background-color: ${D.selectionInactiveBackgroundOpaque.css};}`;for(const[q,R]of D.ansi.entries())j+=`${this._terminalSelector} .${w}${q} { color: ${R.css}; }${this._terminalSelector} .${w}${q}.xterm-dim { color: ${o.color.multiplyOpacity(R,.5).css}; }${this._terminalSelector} .${v}${q} { background-color: ${R.css}; }`;j+=`${this._terminalSelector} .${w}${_.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(D.background).css}; }${this._terminalSelector} .${w}${_.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${o.color.multiplyOpacity(o.color.opaque(D.background),.5).css}; }${this._terminalSelector} .${v}${_.INVERTED_DEFAULT_COLOR} { background-color: ${D.foreground.css}; }`,this._themeStyleElement.textContent=j}_setDefaultSpacing(){const D=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${D}px`,this._rowFactory.defaultSpacing=D}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(D,j){for(let F=this._rowElements.length;F<=j;F++){const U=this._document.createElement("div");this._rowContainer.appendChild(U),this._rowElements.push(U)}for(;this._rowElements.length>j;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(D,j){this._refreshRowElements(D,j),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(C),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(C),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(D,j,F){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(D,j,F),this.renderRows(0,this._bufferService.rows-1),!D||!j)return;this._selectionRenderModel.update(this._terminal,D,j,F);const U=this._selectionRenderModel.viewportStartRow,X=this._selectionRenderModel.viewportEndRow,q=this._selectionRenderModel.viewportCappedStartRow,R=this._selectionRenderModel.viewportCappedEndRow;if(q>=this._bufferService.rows||R<0)return;const P=this._document.createDocumentFragment();if(F){const B=D[0]>j[0];P.appendChild(this._createSelectionElement(q,B?j[0]:D[0],B?D[0]:j[0],R-q+1))}else{const B=U===q?D[0]:0,O=q===X?j[0]:this._bufferService.cols;P.appendChild(this._createSelectionElement(q,B,O));const H=R-q-1;if(P.appendChild(this._createSelectionElement(q+1,0,this._bufferService.cols,H)),q!==R){const W=X===R?j[0]:this._bufferService.cols;P.appendChild(this._createSelectionElement(R,0,W))}}this._selectionContainer.appendChild(P)}_createSelectionElement(D,j,F,U=1){const X=this._document.createElement("div"),q=j*this.dimensions.css.cell.width;let R=this.dimensions.css.cell.width*(F-j);return q+R>this.dimensions.css.canvas.width&&(R=this.dimensions.css.canvas.width-q),X.style.height=U*this.dimensions.css.cell.height+"px",X.style.top=D*this.dimensions.css.cell.height+"px",X.style.left=`${q}px`,X.style.width=`${R}px`,X}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const D of this._rowElements)D.replaceChildren()}renderRows(D,j){const F=this._bufferService.buffer,U=F.ybase+F.y,X=Math.min(F.x,this._bufferService.cols-1),q=this._optionsService.rawOptions.cursorBlink,R=this._optionsService.rawOptions.cursorStyle,P=this._optionsService.rawOptions.cursorInactiveStyle;for(let B=D;B<=j;B++){const O=B+F.ydisp,H=this._rowElements[B],W=F.lines.get(O);if(!H||!W)break;H.replaceChildren(...this._rowFactory.createRow(W,O,O===U,R,P,X,q,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${x}${this._terminalClass}`}_handleLinkHover(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!0)}_handleLinkLeave(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!1)}_setCellUnderline(D,j,F,U,X,q){F<0&&(D=0),U<0&&(j=0);const R=this._bufferService.rows-1;F=Math.max(Math.min(F,R),0),U=Math.max(Math.min(U,R),0),X=Math.min(X,this._bufferService.cols);const P=this._bufferService.buffer,B=P.ybase+P.y,O=Math.min(P.x,X-1),H=this._optionsService.rawOptions.cursorBlink,W=this._optionsService.rawOptions.cursorStyle,K=this._optionsService.rawOptions.cursorInactiveStyle;for(let V=F;V<=U;++V){const I=V+P.ydisp,L=this._rowElements[V],z=P.lines.get(I);if(!L||!z)break;L.replaceChildren(...this._rowFactory.createRow(z,I,I===B,W,K,O,H,this.dimensions.css.cell.width,this._widthCache,q?V===F?D:0:-1,q?(V===U?j:X)-1:-1))}}};s.DomRenderer=N=f([m(7,g.IInstantiationService),m(8,n.ICharSizeService),m(9,g.IOptionsService),m(10,g.IBufferService),m(11,n.ICoreBrowserService),m(12,n.IThemeService)],N)},3787:function(E,s,a){var f=this&&this.__decorate||function(b,w,v,C){var T,A=arguments.length,N=A<3?w:C===null?C=Object.getOwnPropertyDescriptor(w,v):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(b,w,v,C);else for(var D=b.length-1;D>=0;D--)(T=b[D])&&(N=(A<3?T(N):A>3?T(w,v,N):T(w,v))||N);return A>3&&N&&Object.defineProperty(w,v,N),N},m=this&&this.__param||function(b,w){return function(v,C){w(v,C,b)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=void 0;const c=a(2223),h=a(643),_=a(511),S=a(2585),p=a(8055),n=a(4725),o=a(4269),i=a(6171),l=a(3734);let g=s.DomRendererRowFactory=class{constructor(b,w,v,C,T,A,N){this._document=b,this._characterJoinerService=w,this._optionsService=v,this._coreBrowserService=C,this._coreService=T,this._decorationService=A,this._themeService=N,this._workCell=new _.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(b,w,v){this._selectionStart=b,this._selectionEnd=w,this._columnSelectMode=v}createRow(b,w,v,C,T,A,N,D,j,F,U){const X=[],q=this._characterJoinerService.getJoinedCharacters(w),R=this._themeService.colors;let P,B=b.getNoBgTrimmedLength();v&&B<A+1&&(B=A+1);let O=0,H="",W=0,K=0,V=0,I=!1,L=0,z=!1,$=0;const Y=[],G=F!==-1&&U!==-1;for(let J=0;J<B;J++){b.loadCell(J,this._workCell);let re=this._workCell.getWidth();if(re===0)continue;let ne=!1,he=J,Z=this._workCell;if(q.length>0&&J===q[0][0]){ne=!0;const oe=q.shift();Z=new o.JoinedCellData(this._workCell,b.translateToString(!0,oe[0],oe[1]),oe[1]-oe[0]),he=oe[1]-1,re=Z.getWidth()}const le=this._isCellInSelection(J,w),Fe=v&&J===A,Ze=G&&J>=F&&J<=U;let Re=!1;this._decorationService.forEachDecorationAtCell(J,w,void 0,oe=>{Re=!0});let Ie=Z.getChars()||h.WHITESPACE_CELL_CHAR;if(Ie===" "&&(Z.isUnderline()||Z.isOverline())&&(Ie=" "),$=re*D-j.get(Ie,Z.isBold(),Z.isItalic()),P){if(O&&(le&&z||!le&&!z&&Z.bg===W)&&(le&&z&&R.selectionForeground||Z.fg===K)&&Z.extended.ext===V&&Ze===I&&$===L&&!Fe&&!ne&&!Re){Z.isInvisible()?H+=h.WHITESPACE_CELL_CHAR:H+=Ie,O++;continue}O&&(P.textContent=H),P=this._document.createElement("span"),O=0,H=""}else P=this._document.createElement("span");if(W=Z.bg,K=Z.fg,V=Z.extended.ext,I=Ze,L=$,z=le,ne&&A>=J&&A<=he&&(A=J),!this._coreService.isCursorHidden&&Fe&&this._coreService.isCursorInitialized){if(Y.push("xterm-cursor"),this._coreBrowserService.isFocused)N&&Y.push("xterm-cursor-blink"),Y.push(C==="bar"?"xterm-cursor-bar":C==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(T)switch(T){case"outline":Y.push("xterm-cursor-outline");break;case"block":Y.push("xterm-cursor-block");break;case"bar":Y.push("xterm-cursor-bar");break;case"underline":Y.push("xterm-cursor-underline")}}if(Z.isBold()&&Y.push("xterm-bold"),Z.isItalic()&&Y.push("xterm-italic"),Z.isDim()&&Y.push("xterm-dim"),H=Z.isInvisible()?h.WHITESPACE_CELL_CHAR:Z.getChars()||h.WHITESPACE_CELL_CHAR,Z.isUnderline()&&(Y.push(`xterm-underline-${Z.extended.underlineStyle}`),H===" "&&(H=" "),!Z.isUnderlineColorDefault()))if(Z.isUnderlineColorRGB())P.style.textDecorationColor=`rgb(${l.AttributeData.toColorRGB(Z.getUnderlineColor()).join(",")})`;else{let oe=Z.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Z.isBold()&&oe<8&&(oe+=8),P.style.textDecorationColor=R.ansi[oe].css}Z.isOverline()&&(Y.push("xterm-overline"),H===" "&&(H=" ")),Z.isStrikethrough()&&Y.push("xterm-strikethrough"),Ze&&(P.style.textDecoration="underline");let pe=Z.getFgColor(),Qe=Z.getFgColorMode(),we=Z.getBgColor(),et=Z.getBgColorMode();const Xt=!!Z.isInverse();if(Xt){const oe=pe;pe=we,we=oe;const mn=Qe;Qe=et,et=mn}let De,_t,Te,tt=!1;switch(this._decorationService.forEachDecorationAtCell(J,w,void 0,oe=>{oe.options.layer!=="top"&&tt||(oe.backgroundColorRGB&&(et=50331648,we=oe.backgroundColorRGB.rgba>>8&16777215,De=oe.backgroundColorRGB),oe.foregroundColorRGB&&(Qe=50331648,pe=oe.foregroundColorRGB.rgba>>8&16777215,_t=oe.foregroundColorRGB),tt=oe.options.layer==="top")}),!tt&&le&&(De=this._coreBrowserService.isFocused?R.selectionBackgroundOpaque:R.selectionInactiveBackgroundOpaque,we=De.rgba>>8&16777215,et=50331648,tt=!0,R.selectionForeground&&(Qe=50331648,pe=R.selectionForeground.rgba>>8&16777215,_t=R.selectionForeground)),tt&&Y.push("xterm-decoration-top"),et){case 16777216:case 33554432:Te=R.ansi[we],Y.push(`xterm-bg-${we}`);break;case 50331648:Te=p.channels.toColor(we>>16,we>>8&255,255&we),this._addStyle(P,`background-color:#${x((we>>>0).toString(16),"0",6)}`);break;default:Xt?(Te=R.foreground,Y.push(`xterm-bg-${c.INVERTED_DEFAULT_COLOR}`)):Te=R.background}switch(De||Z.isDim()&&(De=p.color.multiplyOpacity(Te,.5)),Qe){case 16777216:case 33554432:Z.isBold()&&pe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(pe+=8),this._applyMinimumContrast(P,Te,R.ansi[pe],Z,De,void 0)||Y.push(`xterm-fg-${pe}`);break;case 50331648:const oe=p.channels.toColor(pe>>16&255,pe>>8&255,255&pe);this._applyMinimumContrast(P,Te,oe,Z,De,_t)||this._addStyle(P,`color:#${x(pe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(P,Te,R.foreground,Z,De,_t)||Xt&&Y.push(`xterm-fg-${c.INVERTED_DEFAULT_COLOR}`)}Y.length&&(P.className=Y.join(" "),Y.length=0),Fe||ne||Re?P.textContent=H:O++,$!==this.defaultSpacing&&(P.style.letterSpacing=`${$}px`),X.push(P),J=he}return P&&O&&(P.textContent=H),X}_applyMinimumContrast(b,w,v,C,T,A){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,i.treatGlyphAsBackgroundColor)(C.getCode()))return!1;const N=this._getContrastCache(C);let D;if(T||A||(D=N.getColor(w.rgba,v.rgba)),D===void 0){const j=this._optionsService.rawOptions.minimumContrastRatio/(C.isDim()?2:1);D=p.color.ensureContrastRatio(T||w,A||v,j),N.setColor((T||w).rgba,(A||v).rgba,D??null)}return!!D&&(this._addStyle(b,`color:${D.css}`),!0)}_getContrastCache(b){return b.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(b,w){b.setAttribute("style",`${b.getAttribute("style")||""}${w};`)}_isCellInSelection(b,w){const v=this._selectionStart,C=this._selectionEnd;return!(!v||!C)&&(this._columnSelectMode?v[0]<=C[0]?b>=v[0]&&w>=v[1]&&b<C[0]&&w<=C[1]:b<v[0]&&w>=v[1]&&b>=C[0]&&w<=C[1]:w>v[1]&&w<C[1]||v[1]===C[1]&&w===v[1]&&b>=v[0]&&b<C[0]||v[1]<C[1]&&w===C[1]&&b<C[0]||v[1]<C[1]&&w===v[1]&&b>=v[0])}};function x(b,w,v){for(;b.length<v;)b=w+b;return b}s.DomRendererRowFactory=g=f([m(1,n.ICharacterJoinerService),m(2,S.IOptionsService),m(3,n.ICoreBrowserService),m(4,S.ICoreService),m(5,S.IDecorationService),m(6,n.IThemeService)],g)},2550:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WidthCache=void 0,s.WidthCache=class{constructor(a,f){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=a.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const m=a.createElement("span");m.classList.add("xterm-char-measure-element");const c=a.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontWeight="bold";const h=a.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontStyle="italic";const _=a.createElement("span");_.classList.add("xterm-char-measure-element"),_.style.fontWeight="bold",_.style.fontStyle="italic",this._measureElements=[m,c,h,_],this._container.appendChild(m),this._container.appendChild(c),this._container.appendChild(h),this._container.appendChild(_),f.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(a,f,m,c){a===this._font&&f===this._fontSize&&m===this._weight&&c===this._weightBold||(this._font=a,this._fontSize=f,this._weight=m,this._weightBold=c,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${m}`,this._measureElements[1].style.fontWeight=`${c}`,this._measureElements[2].style.fontWeight=`${m}`,this._measureElements[3].style.fontWeight=`${c}`,this.clear())}get(a,f,m){let c=0;if(!f&&!m&&a.length===1&&(c=a.charCodeAt(0))<256){if(this._flat[c]!==-9999)return this._flat[c];const S=this._measure(a,0);return S>0&&(this._flat[c]=S),S}let h=a;f&&(h+="B"),m&&(h+="I");let _=this._holey.get(h);if(_===void 0){let S=0;f&&(S|=1),m&&(S|=2),_=this._measure(a,S),_>0&&this._holey.set(h,_)}return _}_measure(a,f){const m=this._measureElements[f];return m.textContent=a.repeat(32),m.offsetWidth/32}}},2223:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const f=a(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=f.isFirefox||f.isLegacyEdge?"bottom":"ideographic"},6171:(E,s)=>{function a(m){return 57508<=m&&m<=57558}function f(m){return m>=128512&&m<=128591||m>=127744&&m<=128511||m>=128640&&m<=128767||m>=9728&&m<=9983||m>=9984&&m<=10175||m>=65024&&m<=65039||m>=129280&&m<=129535||m>=127462&&m<=127487}Object.defineProperty(s,"__esModule",{value:!0}),s.computeNextVariantOffset=s.createRenderDimensions=s.treatGlyphAsBackgroundColor=s.allowRescaling=s.isEmoji=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(m){if(!m)throw new Error("value must not be falsy");return m},s.isPowerlineGlyph=a,s.isRestrictedPowerlineGlyph=function(m){return 57520<=m&&m<=57527},s.isEmoji=f,s.allowRescaling=function(m,c,h,_){return c===1&&h>Math.ceil(1.5*_)&&m!==void 0&&m>255&&!f(m)&&!a(m)&&!function(S){return 57344<=S&&S<=63743}(m)},s.treatGlyphAsBackgroundColor=function(m){return a(m)||function(c){return 9472<=c&&c<=9631}(m)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},s.computeNextVariantOffset=function(m,c,h=0){return(m-(2*Math.round(c)-h))%(2*Math.round(c))}},6052:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createSelectionRenderModel=void 0;class a{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(m,c,h,_=!1){if(this.selectionStart=c,this.selectionEnd=h,!c||!h||c[0]===h[0]&&c[1]===h[1])return void this.clear();const S=m.buffers.active.ydisp,p=c[1]-S,n=h[1]-S,o=Math.max(p,0),i=Math.min(n,m.rows-1);o>=m.rows||i<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=_,this.viewportStartRow=p,this.viewportEndRow=n,this.viewportCappedStartRow=o,this.viewportCappedEndRow=i,this.startCol=c[0],this.endCol=h[0])}isCellSelected(m,c,h){return!!this.hasSelection&&(h-=m.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?c>=this.startCol&&h>=this.viewportCappedStartRow&&c<this.endCol&&h<=this.viewportCappedEndRow:c<this.startCol&&h>=this.viewportCappedStartRow&&c>=this.endCol&&h<=this.viewportCappedEndRow:h>this.viewportStartRow&&h<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&h===this.viewportStartRow&&c>=this.startCol&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&h===this.viewportEndRow&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&h===this.viewportStartRow&&c>=this.startCol)}}s.createSelectionRenderModel=function(){return new a}},456:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const a=this.selectionStart,f=this.selectionEnd;return!(!a||!f)&&(a[1]>f[1]||a[1]===f[1]&&a[0]>f[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(E,s,a){var f=this&&this.__decorate||function(i,l,g,x){var b,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(b=i[C])&&(v=(w<3?b(v):w>3?b(l,g,v):b(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},m=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const c=a(2585),h=a(8460),_=a(844);let S=s.CharSizeService=class extends _.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(i,l,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new o(this._optionsService))}catch{this._measureStrategy=this.register(new n(i,l,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const i=this._measureStrategy.measure();i.width===this.width&&i.height===this.height||(this.width=i.width,this.height=i.height,this._onCharSizeChange.fire())}};s.CharSizeService=S=f([m(2,c.IOptionsService)],S);class p extends _.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(l,g){l!==void 0&&l>0&&g!==void 0&&g>0&&(this._result.width=l,this._result.height=g)}}class n extends p{constructor(l,g,x){super(),this._document=l,this._parentElement=g,this._optionsService=x,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class o extends p{constructor(l){super(),this._optionsService=l,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const g=this._ctx.measureText("W");if(!("width"in g&&"fontBoundingBoxAscent"in g&&"fontBoundingBoxDescent"in g))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const l=this._ctx.measureText("W");return this._validateAndSet(l.width,l.fontBoundingBoxAscent+l.fontBoundingBoxDescent),this._result}}},4269:function(E,s,a){var f=this&&this.__decorate||function(o,i,l,g){var x,b=arguments.length,w=b<3?i:g===null?g=Object.getOwnPropertyDescriptor(i,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,i,l,g);else for(var v=o.length-1;v>=0;v--)(x=o[v])&&(w=(b<3?x(w):b>3?x(i,l,w):x(i,l))||w);return b>3&&w&&Object.defineProperty(i,l,w),w},m=this&&this.__param||function(o,i){return function(l,g){i(l,g,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const c=a(3734),h=a(643),_=a(511),S=a(2585);class p extends c.AttributeData{constructor(i,l,g){super(),this.content=0,this.combinedData="",this.fg=i.fg,this.bg=i.bg,this.combinedData=l,this._width=g}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(i){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=p;let n=s.CharacterJoinerService=class $i{constructor(i){this._bufferService=i,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new _.CellData}register(i){const l={id:this._nextCharacterJoinerId++,handler:i};return this._characterJoiners.push(l),l.id}deregister(i){for(let l=0;l<this._characterJoiners.length;l++)if(this._characterJoiners[l].id===i)return this._characterJoiners.splice(l,1),!0;return!1}getJoinedCharacters(i){if(this._characterJoiners.length===0)return[];const l=this._bufferService.buffer.lines.get(i);if(!l||l.length===0)return[];const g=[],x=l.translateToString(!0);let b=0,w=0,v=0,C=l.getFg(0),T=l.getBg(0);for(let A=0;A<l.getTrimmedLength();A++)if(l.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==T){if(A-b>1){const N=this._getJoinedRanges(x,v,w,l,b);for(let D=0;D<N.length;D++)g.push(N[D])}b=A,v=w,C=this._workCell.fg,T=this._workCell.bg}w+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-b>1){const A=this._getJoinedRanges(x,v,w,l,b);for(let N=0;N<A.length;N++)g.push(A[N])}return g}_getJoinedRanges(i,l,g,x,b){const w=i.substring(l,g);let v=[];try{v=this._characterJoiners[0].handler(w)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{const T=this._characterJoiners[C].handler(w);for(let A=0;A<T.length;A++)$i._mergeRanges(v,T[A])}catch(T){console.error(T)}return this._stringRangesToCellRanges(v,x,b),v}_stringRangesToCellRanges(i,l,g){let x=0,b=!1,w=0,v=i[x];if(v){for(let C=g;C<this._bufferService.cols;C++){const T=l.getWidth(C),A=l.getString(C).length||h.WHITESPACE_CELL_CHAR.length;if(T!==0){if(!b&&v[0]<=w&&(v[0]=C,b=!0),v[1]<=w){if(v[1]=C,v=i[++x],!v)break;v[0]<=w?(v[0]=C,b=!0):b=!1}w+=A}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(i,l){let g=!1;for(let x=0;x<i.length;x++){const b=i[x];if(g){if(l[1]<=b[0])return i[x-1][1]=l[1],i;if(l[1]<=b[1])return i[x-1][1]=Math.max(l[1],b[1]),i.splice(x,1),i;i.splice(x,1),x--}else{if(l[1]<=b[0])return i.splice(x,0,l),i;if(l[1]<=b[1])return b[0]=Math.min(l[0],b[0]),i;l[0]<b[1]&&(b[0]=Math.min(l[0],b[0]),g=!0)}}return g?i[i.length-1][1]=l[1]:i.push(l),i}};s.CharacterJoinerService=n=f([m(0,S.IBufferService)],n)},5114:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0;const f=a(844),m=a(8460),c=a(3656);class h extends f.Disposable{constructor(p,n,o){super(),this._textarea=p,this._window=n,this.mainDocument=o,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new _(this._window),this._onDprChange=this.register(new m.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new m.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(i=>this._screenDprMonitor.setWindow(i))),this.register((0,m.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(p){this._window!==p&&(this._window=p,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}s.CoreBrowserService=h;class _ extends f.Disposable{constructor(p){super(),this._parentWindow=p,this._windowResizeListener=this.register(new f.MutableDisposable),this._onDprChange=this.register(new m.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,f.toDisposable)(()=>this.clearListener()))}setWindow(p){this._parentWindow=p,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,c.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LinkProviderService=void 0;const f=a(844);class m extends f.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,f.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(h){return this.linkProviders.push(h),{dispose:()=>{const _=this.linkProviders.indexOf(h);_!==-1&&this.linkProviders.splice(_,1)}}}}s.LinkProviderService=m},8934:function(E,s,a){var f=this&&this.__decorate||function(S,p,n,o){var i,l=arguments.length,g=l<3?p:o===null?o=Object.getOwnPropertyDescriptor(p,n):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(S,p,n,o);else for(var x=S.length-1;x>=0;x--)(i=S[x])&&(g=(l<3?i(g):l>3?i(p,n,g):i(p,n))||g);return l>3&&g&&Object.defineProperty(p,n,g),g},m=this&&this.__param||function(S,p){return function(n,o){p(n,o,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const c=a(4725),h=a(9806);let _=s.MouseService=class{constructor(S,p){this._renderService=S,this._charSizeService=p}getCoords(S,p,n,o,i){return(0,h.getCoords)(window,S,p,n,o,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,i)}getMouseReportCoords(S,p){const n=(0,h.getCoordsRelativeToElement)(window,S,p);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};s.MouseService=_=f([m(0,c.IRenderService),m(1,c.ICharSizeService)],_)},3230:function(E,s,a){var f=this&&this.__decorate||function(i,l,g,x){var b,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(b=i[C])&&(v=(w<3?b(v):w>3?b(l,g,v):b(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},m=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const c=a(6193),h=a(4725),_=a(8460),S=a(844),p=a(7226),n=a(2585);let o=s.RenderService=class extends S.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(i,l,g,x,b,w,v,C){super(),this._rowCount=i,this._charSizeService=x,this._renderer=this.register(new S.MutableDisposable),this._pausedResizeTask=new p.DebouncedIdleTask,this._observerDisposable=this.register(new S.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new _.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new _.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new _.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new _.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new c.RenderDebouncer((T,A)=>this._renderRows(T,A),v),this.register(this._renderDebouncer),this.register(v.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(w.onResize(()=>this._fullRefresh())),this.register(w.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(b.onDecorationRegistered(()=>this._fullRefresh())),this.register(b.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(w.cols,w.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(w.buffer.y,w.buffer.y,!0))),this.register(C.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(v.window,l),this.register(v.onWindowChange(T=>this._registerIntersectionObserver(T,l)))}_registerIntersectionObserver(i,l){if("IntersectionObserver"in i){const g=new i.IntersectionObserver(x=>this._handleIntersectionChange(x[x.length-1]),{threshold:0});g.observe(l),this._observerDisposable.value=(0,S.toDisposable)(()=>g.disconnect())}}_handleIntersectionChange(i){this._isPaused=i.isIntersecting===void 0?i.intersectionRatio===0:!i.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(i,l,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(i,l,this._rowCount))}_renderRows(i,l){this._renderer.value&&(i=Math.min(i,this._rowCount-1),l=Math.min(l,this._rowCount-1),this._renderer.value.renderRows(i,l),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:i,end:l}),this._onRender.fire({start:i,end:l}),this._isNextRenderRedrawOnly=!0)}resize(i,l){this._rowCount=l,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(i){this._renderer.value=i,this._renderer.value&&(this._renderer.value.onRequestRedraw(l=>this.refreshRows(l.start,l.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(i){return this._renderDebouncer.addRefreshCallback(i)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(i,l){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(i,l)):this._renderer.value.handleResize(i,l),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(i,l,g){this._selectionState.start=i,this._selectionState.end=l,this._selectionState.columnSelectMode=g,this._renderer.value?.handleSelectionChanged(i,l,g)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};s.RenderService=o=f([m(2,n.IOptionsService),m(3,h.ICharSizeService),m(4,n.IDecorationService),m(5,n.IBufferService),m(6,h.ICoreBrowserService),m(7,h.IThemeService)],o)},9312:function(E,s,a){var f=this&&this.__decorate||function(v,C,T,A){var N,D=arguments.length,j=D<3?C:A===null?A=Object.getOwnPropertyDescriptor(C,T):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(v,C,T,A);else for(var F=v.length-1;F>=0;F--)(N=v[F])&&(j=(D<3?N(j):D>3?N(C,T,j):N(C,T))||j);return D>3&&j&&Object.defineProperty(C,T,j),j},m=this&&this.__param||function(v,C){return function(T,A){C(T,A,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const c=a(9806),h=a(9504),_=a(456),S=a(4725),p=a(8460),n=a(844),o=a(6114),i=a(4841),l=a(511),g=a(2585),x=" ",b=new RegExp(x,"g");let w=s.SelectionService=class extends n.Disposable{constructor(v,C,T,A,N,D,j,F,U){super(),this._element=v,this._screenElement=C,this._linkifier=T,this._bufferService=A,this._coreService=N,this._mouseService=D,this._optionsService=j,this._renderService=F,this._coreBrowserService=U,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new l.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new p.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new p.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new p.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new p.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=X=>this._handleMouseMove(X),this._mouseUpListener=X=>this._handleMouseUp(X),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(X=>this._handleTrim(X)),this.register(this._bufferService.buffers.onBufferActivate(X=>this._handleBufferActivate(X))),this.enable(),this._model=new _.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,n.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const v=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!v||!C||v[0]===C[0]&&v[1]===C[1])}get selectionText(){const v=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!v||!C)return"";const T=this._bufferService.buffer,A=[];if(this._activeSelectionMode===3){if(v[0]===C[0])return"";const N=v[0]<C[0]?v[0]:C[0],D=v[0]<C[0]?C[0]:v[0];for(let j=v[1];j<=C[1];j++){const F=T.translateBufferLineToString(j,!0,N,D);A.push(F)}}else{const N=v[1]===C[1]?C[0]:void 0;A.push(T.translateBufferLineToString(v[1],!0,v[0],N));for(let D=v[1]+1;D<=C[1]-1;D++){const j=T.lines.get(D),F=T.translateBufferLineToString(D,!0);j?.isWrapped?A[A.length-1]+=F:A.push(F)}if(v[1]!==C[1]){const D=T.lines.get(C[1]),j=T.translateBufferLineToString(C[1],!0,0,C[0]);D&&D.isWrapped?A[A.length-1]+=j:A.push(j)}}return A.map(N=>N.replace(b," ")).join(o.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),o.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){const C=this._getMouseBufferCoords(v),T=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!!(T&&A&&C)&&this._areCoordsInSelection(C,T,A)}isCellInSelection(v,C){const T=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!(!T||!A)&&this._areCoordsInSelection([v,C],T,A)}_areCoordsInSelection(v,C,T){return v[1]>C[1]&&v[1]<T[1]||C[1]===T[1]&&v[1]===C[1]&&v[0]>=C[0]&&v[0]<T[0]||C[1]<T[1]&&v[1]===T[1]&&v[0]<T[0]||C[1]<T[1]&&v[1]===C[1]&&v[0]>=C[0]}_selectWordAtCursor(v,C){const T=this._linkifier.currentLink?.link?.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,i.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const A=this._getMouseBufferCoords(v);return!!A&&(this._selectWordAt(A,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,C){this._model.clearSelection(),v=Math.max(v,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){const C=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(v){let C=(0,c.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1];const T=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=T?0:(C>T&&(C-=T),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(v){return o.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){const C=this._getMouseBufferCoords(v);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(v){return v.altKey&&!(o.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;const C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const T=this._bufferService.buffer;if(this._model.selectionEnd[1]<T.lines.length){const A=T.lines.get(this._model.selectionEnd[1]);A&&A.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){const C=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const T=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(T&&T[0]!==void 0&&T[1]!==void 0){const A=(0,h.moveToCellSequence)(T[0]-1,T[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(A,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const v=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,T=!(!v||!C||v[0]===C[0]&&v[1]===C[1]);T?v&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,C,T)):this._oldHasSelection&&this._fireOnSelectionChange(v,C,T)}_fireOnSelectionChange(v,C,T){this._oldSelectionStart=v,this._oldSelectionEnd=C,this._oldHasSelection=T,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(v,C){let T=C;for(let A=0;C>=A;A++){const N=v.loadCell(A,this._workCell).getChars().length;this._workCell.getWidth()===0?T--:N>1&&C!==A&&(T+=N-1)}return T}setSelection(v,C,T){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,C],this._model.selectionStartLength=T,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,C,T=!0,A=!0){if(v[0]>=this._bufferService.cols)return;const N=this._bufferService.buffer,D=N.lines.get(v[1]);if(!D)return;const j=N.translateBufferLineToString(v[1],!1);let F=this._convertViewportColToCharacterIndex(D,v[0]),U=F;const X=v[0]-F;let q=0,R=0,P=0,B=0;if(j.charAt(F)===" "){for(;F>0&&j.charAt(F-1)===" ";)F--;for(;U<j.length&&j.charAt(U+1)===" ";)U++}else{let W=v[0],K=v[0];D.getWidth(W)===0&&(q++,W--),D.getWidth(K)===2&&(R++,K++);const V=D.getString(K).length;for(V>1&&(B+=V-1,U+=V-1);W>0&&F>0&&!this._isCharWordSeparator(D.loadCell(W-1,this._workCell));){D.loadCell(W-1,this._workCell);const I=this._workCell.getChars().length;this._workCell.getWidth()===0?(q++,W--):I>1&&(P+=I-1,F-=I-1),F--,W--}for(;K<D.length&&U+1<j.length&&!this._isCharWordSeparator(D.loadCell(K+1,this._workCell));){D.loadCell(K+1,this._workCell);const I=this._workCell.getChars().length;this._workCell.getWidth()===2?(R++,K++):I>1&&(B+=I-1,U+=I-1),U++,K++}}U++;let O=F+X-q+P,H=Math.min(this._bufferService.cols,U-F+q+R-P-B);if(C||j.slice(F,U).trim()!==""){if(T&&O===0&&D.getCodePoint(0)!==32){const W=N.lines.get(v[1]-1);if(W&&D.isWrapped&&W.getCodePoint(this._bufferService.cols-1)!==32){const K=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(K){const V=this._bufferService.cols-K.start;O-=V,H+=V}}}if(A&&O+H===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const W=N.lines.get(v[1]+1);if(W?.isWrapped&&W.getCodePoint(0)!==32){const K=this._getWordAt([0,v[1]+1],!1,!1,!0);K&&(H+=K.length)}}return{start:O,length:H}}}_selectWordAt(v,C){const T=this._getWordAt(v,C);if(T){for(;T.start<0;)T.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[T.start,v[1]],this._model.selectionStartLength=T.length}}_selectToWordAt(v){const C=this._getWordAt(v,!0);if(C){let T=v[1];for(;C.start<0;)C.start+=this._bufferService.cols,T--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,T++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,T]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){const C=this._bufferService.buffer.getWrappedRangeForLine(v),T={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,i.getRangeLength)(T,this._bufferService.cols)}};s.SelectionService=w=f([m(3,g.IBufferService),m(4,g.ICoreService),m(5,S.IMouseService),m(6,g.IOptionsService),m(7,S.IRenderService),m(8,S.ICoreBrowserService)],w)},4725:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ILinkProviderService=s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const f=a(8343);s.ICharSizeService=(0,f.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,f.createDecorator)("CoreBrowserService"),s.IMouseService=(0,f.createDecorator)("MouseService"),s.IRenderService=(0,f.createDecorator)("RenderService"),s.ISelectionService=(0,f.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,f.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,f.createDecorator)("ThemeService"),s.ILinkProviderService=(0,f.createDecorator)("LinkProviderService")},6731:function(E,s,a){var f=this&&this.__decorate||function(w,v,C,T){var A,N=arguments.length,D=N<3?v:T===null?T=Object.getOwnPropertyDescriptor(v,C):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(w,v,C,T);else for(var j=w.length-1;j>=0;j--)(A=w[j])&&(D=(N<3?A(D):N>3?A(v,C,D):A(v,C))||D);return N>3&&D&&Object.defineProperty(v,C,D),D},m=this&&this.__param||function(w,v){return function(C,T){v(C,T,w)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const c=a(7239),h=a(8055),_=a(8460),S=a(844),p=a(2585),n=h.css.toColor("#ffffff"),o=h.css.toColor("#000000"),i=h.css.toColor("#ffffff"),l=h.css.toColor("#000000"),g={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const w=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let C=0;C<216;C++){const T=v[C/36%6|0],A=v[C/6%6|0],N=v[C%6];w.push({css:h.channels.toCss(T,A,N),rgba:h.channels.toRgba(T,A,N)})}for(let C=0;C<24;C++){const T=8+10*C;w.push({css:h.channels.toCss(T,T,T),rgba:h.channels.toRgba(T,T,T)})}return w})());let x=s.ThemeService=class extends S.Disposable{get colors(){return this._colors}constructor(w){super(),this._optionsService=w,this._contrastCache=new c.ColorContrastCache,this._halfContrastCache=new c.ColorContrastCache,this._onChangeColors=this.register(new _.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:n,background:o,cursor:i,cursorAccent:l,selectionForeground:void 0,selectionBackgroundTransparent:g,selectionBackgroundOpaque:h.color.blend(o,g),selectionInactiveBackgroundTransparent:g,selectionInactiveBackgroundOpaque:h.color.blend(o,g),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(w={}){const v=this._colors;if(v.foreground=b(w.foreground,n),v.background=b(w.background,o),v.cursor=b(w.cursor,i),v.cursorAccent=b(w.cursorAccent,l),v.selectionBackgroundTransparent=b(w.selectionBackground,g),v.selectionBackgroundOpaque=h.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=b(w.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=h.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=w.selectionForeground?b(w.selectionForeground,h.NULL_COLOR):void 0,v.selectionForeground===h.NULL_COLOR&&(v.selectionForeground=void 0),h.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=h.color.opacity(v.selectionBackgroundTransparent,.3)),h.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=h.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=s.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=b(w.black,s.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=b(w.red,s.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=b(w.green,s.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=b(w.yellow,s.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=b(w.blue,s.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=b(w.magenta,s.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=b(w.cyan,s.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=b(w.white,s.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=b(w.brightBlack,s.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=b(w.brightRed,s.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=b(w.brightGreen,s.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=b(w.brightYellow,s.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=b(w.brightBlue,s.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=b(w.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=b(w.brightCyan,s.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=b(w.brightWhite,s.DEFAULT_ANSI_COLORS[15]),w.extendedAnsi){const C=Math.min(v.ansi.length-16,w.extendedAnsi.length);for(let T=0;T<C;T++)v.ansi[T+16]=b(w.extendedAnsi[T],s.DEFAULT_ANSI_COLORS[T+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(w){this._restoreColor(w),this._onChangeColors.fire(this.colors)}_restoreColor(w){if(w!==void 0)switch(w){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[w]=this._restoreColors.ansi[w]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(w){w(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function b(w,v){if(w!==void 0)try{return h.css.toColor(w)}catch{}return v}s.ThemeService=x=f([m(0,p.IOptionsService)],x)},6349:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const f=a(8460),m=a(844);class c extends m.Disposable{constructor(_){super(),this._maxLength=_,this.onDeleteEmitter=this.register(new f.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new f.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new f.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(_){if(this._maxLength===_)return;const S=new Array(_);for(let p=0;p<Math.min(_,this.length);p++)S[p]=this._array[this._getCyclicIndex(p)];this._array=S,this._maxLength=_,this._startIndex=0}get length(){return this._length}set length(_){if(_>this._length)for(let S=this._length;S<_;S++)this._array[S]=void 0;this._length=_}get(_){return this._array[this._getCyclicIndex(_)]}set(_,S){this._array[this._getCyclicIndex(_)]=S}push(_){this._array[this._getCyclicIndex(this._length)]=_,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(_,S,...p){if(S){for(let n=_;n<this._length-S;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+S)];this._length-=S,this.onDeleteEmitter.fire({index:_,amount:S})}for(let n=this._length-1;n>=_;n--)this._array[this._getCyclicIndex(n+p.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<p.length;n++)this._array[this._getCyclicIndex(_+n)]=p[n];if(p.length&&this.onInsertEmitter.fire({index:_,amount:p.length}),this._length+p.length>this._maxLength){const n=this._length+p.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=p.length}trimStart(_){_>this._length&&(_=this._length),this._startIndex+=_,this._length-=_,this.onTrimEmitter.fire(_)}shiftElements(_,S,p){if(!(S<=0)){if(_<0||_>=this._length)throw new Error("start argument out of range");if(_+p<0)throw new Error("Cannot shift elements in list beyond index 0");if(p>0){for(let o=S-1;o>=0;o--)this.set(_+o+p,this.get(_+o));const n=_+S+p-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<S;n++)this.set(_+n+p,this.get(_+n))}}_getCyclicIndex(_){return(this._startIndex+_)%this._maxLength}}s.CircularList=c},1439:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function a(f,m=5){if(typeof f!="object")return f;const c=Array.isArray(f)?[]:{};for(const h in f)c[h]=m<=1?f[h]:f[h]&&a(f[h],m-1);return c}},8055:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;let a=0,f=0,m=0,c=0;var h,_,S,p,n;function o(l){const g=l.toString(16);return g.length<2?"0"+g:g}function i(l,g){return l<g?(g+.05)/(l+.05):(l+.05)/(g+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(l){l.toCss=function(g,x,b,w){return w!==void 0?`#${o(g)}${o(x)}${o(b)}${o(w)}`:`#${o(g)}${o(x)}${o(b)}`},l.toRgba=function(g,x,b,w=255){return(g<<24|x<<16|b<<8|w)>>>0},l.toColor=function(g,x,b,w){return{css:l.toCss(g,x,b,w),rgba:l.toRgba(g,x,b,w)}}}(h||(s.channels=h={})),function(l){function g(x,b){return c=Math.round(255*b),[a,f,m]=n.toChannels(x.rgba),{css:h.toCss(a,f,m,c),rgba:h.toRgba(a,f,m,c)}}l.blend=function(x,b){if(c=(255&b.rgba)/255,c===1)return{css:b.css,rgba:b.rgba};const w=b.rgba>>24&255,v=b.rgba>>16&255,C=b.rgba>>8&255,T=x.rgba>>24&255,A=x.rgba>>16&255,N=x.rgba>>8&255;return a=T+Math.round((w-T)*c),f=A+Math.round((v-A)*c),m=N+Math.round((C-N)*c),{css:h.toCss(a,f,m),rgba:h.toRgba(a,f,m)}},l.isOpaque=function(x){return(255&x.rgba)==255},l.ensureContrastRatio=function(x,b,w){const v=n.ensureContrastRatio(x.rgba,b.rgba,w);if(v)return h.toColor(v>>24&255,v>>16&255,v>>8&255)},l.opaque=function(x){const b=(255|x.rgba)>>>0;return[a,f,m]=n.toChannels(b),{css:h.toCss(a,f,m),rgba:b}},l.opacity=g,l.multiplyOpacity=function(x,b){return c=255&x.rgba,g(x,c*b/255)},l.toColorRGB=function(x){return[x.rgba>>24&255,x.rgba>>16&255,x.rgba>>8&255]}}(_||(s.color=_={})),function(l){let g,x;try{const b=document.createElement("canvas");b.width=1,b.height=1;const w=b.getContext("2d",{willReadFrequently:!0});w&&(g=w,g.globalCompositeOperation="copy",x=g.createLinearGradient(0,0,1,1))}catch{}l.toColor=function(b){if(b.match(/#[\da-f]{3,8}/i))switch(b.length){case 4:return a=parseInt(b.slice(1,2).repeat(2),16),f=parseInt(b.slice(2,3).repeat(2),16),m=parseInt(b.slice(3,4).repeat(2),16),h.toColor(a,f,m);case 5:return a=parseInt(b.slice(1,2).repeat(2),16),f=parseInt(b.slice(2,3).repeat(2),16),m=parseInt(b.slice(3,4).repeat(2),16),c=parseInt(b.slice(4,5).repeat(2),16),h.toColor(a,f,m,c);case 7:return{css:b,rgba:(parseInt(b.slice(1),16)<<8|255)>>>0};case 9:return{css:b,rgba:parseInt(b.slice(1),16)>>>0}}const w=b.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return a=parseInt(w[1]),f=parseInt(w[2]),m=parseInt(w[3]),c=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),h.toColor(a,f,m,c);if(!g||!x)throw new Error("css.toColor: Unsupported css format");if(g.fillStyle=x,g.fillStyle=b,typeof g.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(g.fillRect(0,0,1,1),[a,f,m,c]=g.getImageData(0,0,1,1).data,c!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:h.toRgba(a,f,m,c),css:b}}}(S||(s.css=S={})),function(l){function g(x,b,w){const v=x/255,C=b/255,T=w/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.0722*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))}l.relativeLuminance=function(x){return g(x>>16&255,x>>8&255,255&x)},l.relativeLuminance2=g}(p||(s.rgb=p={})),function(l){function g(b,w,v){const C=b>>24&255,T=b>>16&255,A=b>>8&255;let N=w>>24&255,D=w>>16&255,j=w>>8&255,F=i(p.relativeLuminance2(N,D,j),p.relativeLuminance2(C,T,A));for(;F<v&&(N>0||D>0||j>0);)N-=Math.max(0,Math.ceil(.1*N)),D-=Math.max(0,Math.ceil(.1*D)),j-=Math.max(0,Math.ceil(.1*j)),F=i(p.relativeLuminance2(N,D,j),p.relativeLuminance2(C,T,A));return(N<<24|D<<16|j<<8|255)>>>0}function x(b,w,v){const C=b>>24&255,T=b>>16&255,A=b>>8&255;let N=w>>24&255,D=w>>16&255,j=w>>8&255,F=i(p.relativeLuminance2(N,D,j),p.relativeLuminance2(C,T,A));for(;F<v&&(N<255||D<255||j<255);)N=Math.min(255,N+Math.ceil(.1*(255-N))),D=Math.min(255,D+Math.ceil(.1*(255-D))),j=Math.min(255,j+Math.ceil(.1*(255-j))),F=i(p.relativeLuminance2(N,D,j),p.relativeLuminance2(C,T,A));return(N<<24|D<<16|j<<8|255)>>>0}l.blend=function(b,w){if(c=(255&w)/255,c===1)return w;const v=w>>24&255,C=w>>16&255,T=w>>8&255,A=b>>24&255,N=b>>16&255,D=b>>8&255;return a=A+Math.round((v-A)*c),f=N+Math.round((C-N)*c),m=D+Math.round((T-D)*c),h.toRgba(a,f,m)},l.ensureContrastRatio=function(b,w,v){const C=p.relativeLuminance(b>>8),T=p.relativeLuminance(w>>8);if(i(C,T)<v){if(T<C){const D=g(b,w,v),j=i(C,p.relativeLuminance(D>>8));if(j<v){const F=x(b,w,v);return j>i(C,p.relativeLuminance(F>>8))?D:F}return D}const A=x(b,w,v),N=i(C,p.relativeLuminance(A>>8));if(N<v){const D=g(b,w,v);return N>i(C,p.relativeLuminance(D>>8))?A:D}return A}},l.reduceLuminance=g,l.increaseLuminance=x,l.toChannels=function(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]}}(n||(s.rgba=n={})),s.toPaddedHex=o,s.contrastRatio=i},8969:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const f=a(844),m=a(2585),c=a(4348),h=a(7866),_=a(744),S=a(7302),p=a(6975),n=a(8460),o=a(1753),i=a(1480),l=a(7994),g=a(9282),x=a(5435),b=a(5981),w=a(2660);let v=!1;class C extends f.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new n.EventEmitter),this._onScroll.event(A=>{this._onScrollApi?.fire(A.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(A){for(const N in A)this.optionsService.options[N]=A[N]}constructor(A){super(),this._windowsWrappingHeuristics=this.register(new f.MutableDisposable),this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new n.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new n.EventEmitter),this._instantiationService=new c.InstantiationService,this.optionsService=this.register(new S.OptionsService(A)),this._instantiationService.setService(m.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(_.BufferService)),this._instantiationService.setService(m.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(m.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(p.CoreService)),this._instantiationService.setService(m.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(o.CoreMouseService)),this._instantiationService.setService(m.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(i.UnicodeService)),this._instantiationService.setService(m.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(l.CharsetService),this._instantiationService.setService(m.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(w.OscLinkService),this._instantiationService.setService(m.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new x.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,n.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,n.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,n.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,n.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(N=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(N=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new b.WriteBuffer((N,D)=>this._inputHandler.parse(N,D))),this.register((0,n.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(A,N){this._writeBuffer.write(A,N)}writeSync(A,N){this._logService.logLevel<=m.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(A,N)}input(A,N=!0){this.coreService.triggerDataEvent(A,N)}resize(A,N){isNaN(A)||isNaN(N)||(A=Math.max(A,_.MINIMUM_COLS),N=Math.max(N,_.MINIMUM_ROWS),this._bufferService.resize(A,N))}scroll(A,N=!1){this._bufferService.scroll(A,N)}scrollLines(A,N,D){this._bufferService.scrollLines(A,N,D)}scrollPages(A){this.scrollLines(A*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(A){const N=A-this._bufferService.buffer.ydisp;N!==0&&this.scrollLines(N)}registerEscHandler(A,N){return this._inputHandler.registerEscHandler(A,N)}registerDcsHandler(A,N){return this._inputHandler.registerDcsHandler(A,N)}registerCsiHandler(A,N){return this._inputHandler.registerCsiHandler(A,N)}registerOscHandler(A,N){return this._inputHandler.registerOscHandler(A,N)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let A=!1;const N=this.optionsService.rawOptions.windowsPty;N&&N.buildNumber!==void 0&&N.buildNumber!==void 0?A=N.backend==="conpty"&&N.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(A=!0),A?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const A=[];A.push(this.onLineFeed(g.updateWindowsModeWrappedState.bind(null,this._bufferService))),A.push(this.registerCsiHandler({final:"H"},()=>((0,g.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,f.toDisposable)(()=>{for(const N of A)N.dispose()})}}}s.CoreTerminal=C},8460:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.runAndSubscribe=s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let f=0;f<this._listeners.length;f++)if(this._listeners[f]===a)return void this._listeners.splice(f,1)}}})),this._event}fire(a,f){const m=[];for(let c=0;c<this._listeners.length;c++)m.push(this._listeners[c]);for(let c=0;c<m.length;c++)m[c].call(void 0,a,f)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},s.forwardEvent=function(a,f){return a(m=>f.fire(m))},s.runAndSubscribe=function(a,f){return f(void 0),a(m=>f(m))}},5435:function(E,s,a){var f=this&&this.__decorate||function(q,R,P,B){var O,H=arguments.length,W=H<3?R:B===null?B=Object.getOwnPropertyDescriptor(R,P):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(q,R,P,B);else for(var K=q.length-1;K>=0;K--)(O=q[K])&&(W=(H<3?O(W):H>3?O(R,P,W):O(R,P))||W);return H>3&&W&&Object.defineProperty(R,P,W),W},m=this&&this.__param||function(q,R){return function(P,B){R(P,B,q)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const c=a(2584),h=a(7116),_=a(2015),S=a(844),p=a(482),n=a(8437),o=a(8460),i=a(643),l=a(511),g=a(3734),x=a(2585),b=a(1480),w=a(6242),v=a(6351),C=a(5941),T={"(":0,")":1,"*":2,"+":3,"-":1,".":2},A=131072;function N(q,R){if(q>24)return R.setWinLines||!1;switch(q){case 1:return!!R.restoreWin;case 2:return!!R.minimizeWin;case 3:return!!R.setWinPosition;case 4:return!!R.setWinSizePixels;case 5:return!!R.raiseWin;case 6:return!!R.lowerWin;case 7:return!!R.refreshWin;case 8:return!!R.setWinSizeChars;case 9:return!!R.maximizeWin;case 10:return!!R.fullscreenWin;case 11:return!!R.getWinState;case 13:return!!R.getWinPosition;case 14:return!!R.getWinSizePixels;case 15:return!!R.getScreenSizePixels;case 16:return!!R.getCellSizePixels;case 18:return!!R.getWinSizeChars;case 19:return!!R.getScreenSizeChars;case 20:return!!R.getIconTitle;case 21:return!!R.getWinTitle;case 22:return!!R.pushTitle;case 23:return!!R.popTitle;case 24:return!!R.setWinLines}return!1}var D;(function(q){q[q.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",q[q.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(D||(s.WindowsOptionsReportType=D={}));let j=0;class F extends S.Disposable{getAttrData(){return this._curAttrData}constructor(R,P,B,O,H,W,K,V,I=new _.EscapeSequenceParser){super(),this._bufferService=R,this._charsetService=P,this._coreService=B,this._logService=O,this._optionsService=H,this._oscLinkService=W,this._coreMouseService=K,this._unicodeService=V,this._parser=I,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new p.StringToUtf32,this._utf8Decoder=new p.Utf8ToUtf32,this._workCell=new l.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new o.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new o.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new o.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new o.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new o.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new o.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new o.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new o.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new o.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new o.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new o.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new U(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._parser.setCsiHandlerFallback((L,z)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(L),params:z.toArray()})}),this._parser.setEscHandlerFallback(L=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(L)})}),this._parser.setExecuteHandlerFallback(L=>{this._logService.debug("Unknown EXECUTE code: ",{code:L})}),this._parser.setOscHandlerFallback((L,z,$)=>{this._logService.debug("Unknown OSC code: ",{identifier:L,action:z,data:$})}),this._parser.setDcsHandlerFallback((L,z,$)=>{z==="HOOK"&&($=$.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(L),action:z,payload:$})}),this._parser.setPrintHandler((L,z,$)=>this.print(L,z,$)),this._parser.registerCsiHandler({final:"@"},L=>this.insertChars(L)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},L=>this.scrollLeft(L)),this._parser.registerCsiHandler({final:"A"},L=>this.cursorUp(L)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},L=>this.scrollRight(L)),this._parser.registerCsiHandler({final:"B"},L=>this.cursorDown(L)),this._parser.registerCsiHandler({final:"C"},L=>this.cursorForward(L)),this._parser.registerCsiHandler({final:"D"},L=>this.cursorBackward(L)),this._parser.registerCsiHandler({final:"E"},L=>this.cursorNextLine(L)),this._parser.registerCsiHandler({final:"F"},L=>this.cursorPrecedingLine(L)),this._parser.registerCsiHandler({final:"G"},L=>this.cursorCharAbsolute(L)),this._parser.registerCsiHandler({final:"H"},L=>this.cursorPosition(L)),this._parser.registerCsiHandler({final:"I"},L=>this.cursorForwardTab(L)),this._parser.registerCsiHandler({final:"J"},L=>this.eraseInDisplay(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},L=>this.eraseInDisplay(L,!0)),this._parser.registerCsiHandler({final:"K"},L=>this.eraseInLine(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},L=>this.eraseInLine(L,!0)),this._parser.registerCsiHandler({final:"L"},L=>this.insertLines(L)),this._parser.registerCsiHandler({final:"M"},L=>this.deleteLines(L)),this._parser.registerCsiHandler({final:"P"},L=>this.deleteChars(L)),this._parser.registerCsiHandler({final:"S"},L=>this.scrollUp(L)),this._parser.registerCsiHandler({final:"T"},L=>this.scrollDown(L)),this._parser.registerCsiHandler({final:"X"},L=>this.eraseChars(L)),this._parser.registerCsiHandler({final:"Z"},L=>this.cursorBackwardTab(L)),this._parser.registerCsiHandler({final:"`"},L=>this.charPosAbsolute(L)),this._parser.registerCsiHandler({final:"a"},L=>this.hPositionRelative(L)),this._parser.registerCsiHandler({final:"b"},L=>this.repeatPrecedingCharacter(L)),this._parser.registerCsiHandler({final:"c"},L=>this.sendDeviceAttributesPrimary(L)),this._parser.registerCsiHandler({prefix:">",final:"c"},L=>this.sendDeviceAttributesSecondary(L)),this._parser.registerCsiHandler({final:"d"},L=>this.linePosAbsolute(L)),this._parser.registerCsiHandler({final:"e"},L=>this.vPositionRelative(L)),this._parser.registerCsiHandler({final:"f"},L=>this.hVPosition(L)),this._parser.registerCsiHandler({final:"g"},L=>this.tabClear(L)),this._parser.registerCsiHandler({final:"h"},L=>this.setMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"h"},L=>this.setModePrivate(L)),this._parser.registerCsiHandler({final:"l"},L=>this.resetMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"l"},L=>this.resetModePrivate(L)),this._parser.registerCsiHandler({final:"m"},L=>this.charAttributes(L)),this._parser.registerCsiHandler({final:"n"},L=>this.deviceStatus(L)),this._parser.registerCsiHandler({prefix:"?",final:"n"},L=>this.deviceStatusPrivate(L)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},L=>this.softReset(L)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},L=>this.setCursorStyle(L)),this._parser.registerCsiHandler({final:"r"},L=>this.setScrollRegion(L)),this._parser.registerCsiHandler({final:"s"},L=>this.saveCursor(L)),this._parser.registerCsiHandler({final:"t"},L=>this.windowOptions(L)),this._parser.registerCsiHandler({final:"u"},L=>this.restoreCursor(L)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},L=>this.insertColumns(L)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},L=>this.deleteColumns(L)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},L=>this.selectProtected(L)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},L=>this.requestMode(L,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},L=>this.requestMode(L,!1)),this._parser.setExecuteHandler(c.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(c.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(c.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(c.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(c.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(c.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(c.C1.IND,()=>this.index()),this._parser.setExecuteHandler(c.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(c.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new w.OscHandler(L=>(this.setTitle(L),this.setIconName(L),!0))),this._parser.registerOscHandler(1,new w.OscHandler(L=>this.setIconName(L))),this._parser.registerOscHandler(2,new w.OscHandler(L=>this.setTitle(L))),this._parser.registerOscHandler(4,new w.OscHandler(L=>this.setOrReportIndexedColor(L))),this._parser.registerOscHandler(8,new w.OscHandler(L=>this.setHyperlink(L))),this._parser.registerOscHandler(10,new w.OscHandler(L=>this.setOrReportFgColor(L))),this._parser.registerOscHandler(11,new w.OscHandler(L=>this.setOrReportBgColor(L))),this._parser.registerOscHandler(12,new w.OscHandler(L=>this.setOrReportCursorColor(L))),this._parser.registerOscHandler(104,new w.OscHandler(L=>this.restoreIndexedColor(L))),this._parser.registerOscHandler(110,new w.OscHandler(L=>this.restoreFgColor(L))),this._parser.registerOscHandler(111,new w.OscHandler(L=>this.restoreBgColor(L))),this._parser.registerOscHandler(112,new w.OscHandler(L=>this.restoreCursorColor(L))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const L in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:L},()=>this.selectCharset("("+L)),this._parser.registerEscHandler({intermediates:")",final:L},()=>this.selectCharset(")"+L)),this._parser.registerEscHandler({intermediates:"*",final:L},()=>this.selectCharset("*"+L)),this._parser.registerEscHandler({intermediates:"+",final:L},()=>this.selectCharset("+"+L)),this._parser.registerEscHandler({intermediates:"-",final:L},()=>this.selectCharset("-"+L)),this._parser.registerEscHandler({intermediates:".",final:L},()=>this.selectCharset("."+L)),this._parser.registerEscHandler({intermediates:"/",final:L},()=>this.selectCharset("/"+L));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(L=>(this._logService.error("Parsing error: ",L),L)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new v.DcsHandler((L,z)=>this.requestStatusString(L,z)))}_preserveStack(R,P,B,O){this._parseStack.paused=!0,this._parseStack.cursorStartX=R,this._parseStack.cursorStartY=P,this._parseStack.decodedLength=B,this._parseStack.position=O}_logSlowResolvingAsync(R){this._logService.logLevel<=x.LogLevelEnum.WARN&&Promise.race([R,new Promise((P,B)=>setTimeout(()=>B("#SLOW_TIMEOUT"),5e3))]).catch(P=>{if(P!=="#SLOW_TIMEOUT")throw P;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(R,P){let B,O=this._activeBuffer.x,H=this._activeBuffer.y,W=0;const K=this._parseStack.paused;if(K){if(B=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,P))return this._logSlowResolvingAsync(B),B;O=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=!1,R.length>A&&(W=this._parseStack.position+A)}if(this._logService.logLevel<=x.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof R=="string"?` "${R}"`:` "${Array.prototype.map.call(R,L=>String.fromCharCode(L)).join("")}"`),typeof R=="string"?R.split("").map(L=>L.charCodeAt(0)):R),this._parseBuffer.length<R.length&&this._parseBuffer.length<A&&(this._parseBuffer=new Uint32Array(Math.min(R.length,A))),K||this._dirtyRowTracker.clearRange(),R.length>A)for(let L=W;L<R.length;L+=A){const z=L+A<R.length?L+A:R.length,$=typeof R=="string"?this._stringDecoder.decode(R.substring(L,z),this._parseBuffer):this._utf8Decoder.decode(R.subarray(L,z),this._parseBuffer);if(B=this._parser.parse(this._parseBuffer,$))return this._preserveStack(O,H,$,L),this._logSlowResolvingAsync(B),B}else if(!K){const L=typeof R=="string"?this._stringDecoder.decode(R,this._parseBuffer):this._utf8Decoder.decode(R,this._parseBuffer);if(B=this._parser.parse(this._parseBuffer,L))return this._preserveStack(O,H,L,0),this._logSlowResolvingAsync(B),B}this._activeBuffer.x===O&&this._activeBuffer.y===H||this._onCursorMove.fire();const V=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),I=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);I<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(I,this._bufferService.rows-1),Math.min(V,this._bufferService.rows-1))}print(R,P,B){let O,H;const W=this._charsetService.charset,K=this._optionsService.rawOptions.screenReaderMode,V=this._bufferService.cols,I=this._coreService.decPrivateModes.wraparound,L=this._coreService.modes.insertMode,z=this._curAttrData;let $=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&B-P>0&&$.getWidth(this._activeBuffer.x-1)===2&&$.setCellFromCodepoint(this._activeBuffer.x-1,0,1,z);let Y=this._parser.precedingJoinState;for(let G=P;G<B;++G){if(O=R[G],O<127&&W){const he=W[String.fromCharCode(O)];he&&(O=he.charCodeAt(0))}const J=this._unicodeService.charProperties(O,Y);H=b.UnicodeService.extractWidth(J);const re=b.UnicodeService.extractShouldJoin(J),ne=re?b.UnicodeService.extractWidth(Y):0;if(Y=J,K&&this._onA11yChar.fire((0,p.stringFromCodePoint)(O)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+H-ne>V){if(I){const he=$;let Z=this._activeBuffer.x-ne;for(this._activeBuffer.x=ne,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),$=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ne>0&&$ instanceof n.BufferLine&&$.copyCellsFrom(he,Z,0,ne,!1);Z<V;)he.setCellFromCodepoint(Z++,0,1,z)}else if(this._activeBuffer.x=V-1,H===2)continue}if(re&&this._activeBuffer.x){const he=$.getWidth(this._activeBuffer.x-1)?1:2;$.addCodepointToCell(this._activeBuffer.x-he,O,H);for(let Z=H-ne;--Z>=0;)$.setCellFromCodepoint(this._activeBuffer.x++,0,0,z)}else if(L&&($.insertCells(this._activeBuffer.x,H-ne,this._activeBuffer.getNullCell(z)),$.getWidth(V-1)===2&&$.setCellFromCodepoint(V-1,i.NULL_CELL_CODE,i.NULL_CELL_WIDTH,z)),$.setCellFromCodepoint(this._activeBuffer.x++,O,H,z),H>0)for(;--H;)$.setCellFromCodepoint(this._activeBuffer.x++,0,0,z)}this._parser.precedingJoinState=Y,this._activeBuffer.x<V&&B-P>0&&$.getWidth(this._activeBuffer.x)===0&&!$.hasContent(this._activeBuffer.x)&&$.setCellFromCodepoint(this._activeBuffer.x,0,1,z),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(R,P){return R.final!=="t"||R.prefix||R.intermediates?this._parser.registerCsiHandler(R,P):this._parser.registerCsiHandler(R,B=>!N(B.params[0],this._optionsService.rawOptions.windowOptions)||P(B))}registerDcsHandler(R,P){return this._parser.registerDcsHandler(R,new v.DcsHandler(P))}registerEscHandler(R,P){return this._parser.registerEscHandler(R,P)}registerOscHandler(R,P){return this._parser.registerOscHandler(R,new w.OscHandler(P))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);R.hasWidth(this._activeBuffer.x)&&!R.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const R=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-R),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(R=this._bufferService.cols-1){this._activeBuffer.x=Math.min(R,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(R,P){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=R,this._activeBuffer.y=this._activeBuffer.scrollTop+P):(this._activeBuffer.x=R,this._activeBuffer.y=P),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(R,P){this._restrictCursor(),this._setCursor(this._activeBuffer.x+R,this._activeBuffer.y+P)}cursorUp(R){const P=this._activeBuffer.y-this._activeBuffer.scrollTop;return P>=0?this._moveCursor(0,-Math.min(P,R.params[0]||1)):this._moveCursor(0,-(R.params[0]||1)),!0}cursorDown(R){const P=this._activeBuffer.scrollBottom-this._activeBuffer.y;return P>=0?this._moveCursor(0,Math.min(P,R.params[0]||1)):this._moveCursor(0,R.params[0]||1),!0}cursorForward(R){return this._moveCursor(R.params[0]||1,0),!0}cursorBackward(R){return this._moveCursor(-(R.params[0]||1),0),!0}cursorNextLine(R){return this.cursorDown(R),this._activeBuffer.x=0,!0}cursorPrecedingLine(R){return this.cursorUp(R),this._activeBuffer.x=0,!0}cursorCharAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(R){return this._setCursor(R.length>=2?(R.params[1]||1)-1:0,(R.params[0]||1)-1),!0}charPosAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(R){return this._moveCursor(R.params[0]||1,0),!0}linePosAbsolute(R){return this._setCursor(this._activeBuffer.x,(R.params[0]||1)-1),!0}vPositionRelative(R){return this._moveCursor(0,R.params[0]||1),!0}hVPosition(R){return this.cursorPosition(R),!0}tabClear(R){const P=R.params[0];return P===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:P===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let P=R.params[0]||1;for(;P--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let P=R.params[0]||1;for(;P--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(R){const P=R.params[0];return P===1&&(this._curAttrData.bg|=536870912),P!==2&&P!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(R,P,B,O=!1,H=!1){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);W.replaceCells(P,B,this._activeBuffer.getNullCell(this._eraseAttrData()),H),O&&(W.isWrapped=!1)}_resetBufferLine(R,P=!1){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);B&&(B.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),P),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+R),B.isWrapped=!1)}eraseInDisplay(R,P=!1){let B;switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:for(B=this._activeBuffer.y,this._dirtyRowTracker.markDirty(B),this._eraseInBufferLine(B++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,P);B<this._bufferService.rows;B++)this._resetBufferLine(B,P);this._dirtyRowTracker.markDirty(B);break;case 1:for(B=this._activeBuffer.y,this._dirtyRowTracker.markDirty(B),this._eraseInBufferLine(B,0,this._activeBuffer.x+1,!0,P),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(B+1).isWrapped=!1);B--;)this._resetBufferLine(B,P);this._dirtyRowTracker.markDirty(0);break;case 2:for(B=this._bufferService.rows,this._dirtyRowTracker.markDirty(B-1);B--;)this._resetBufferLine(B,P);this._dirtyRowTracker.markDirty(0);break;case 3:const O=this._activeBuffer.lines.length-this._bufferService.rows;O>0&&(this._activeBuffer.lines.trimStart(O),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-O,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-O,0),this._onScroll.fire(0))}return!0}eraseInLine(R,P=!1){switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,P);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,P);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,P)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(R){this._restrictCursor();let P=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=this._activeBuffer.ybase+this._activeBuffer.y,O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-O+1;for(;P--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(B,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(R){this._restrictCursor();let P=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=this._activeBuffer.ybase+this._activeBuffer.y;let O;for(O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,O=this._bufferService.rows-1+this._activeBuffer.ybase-O;P--;)this._activeBuffer.lines.splice(B,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(R){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.insertCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(R){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.deleteCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(R){let P=R.params[0]||1;for(;P--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(R){let P=R.params[0]||1;for(;P--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(n.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=R.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);O.deleteCells(0,P,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=R.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);O.insertCells(0,P,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=R.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);O.insertCells(this._activeBuffer.x,P,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=R.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);O.deleteCells(this._activeBuffer.x,P,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(R){this._restrictCursor();const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return P&&(P.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(R.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(R){const P=this._parser.precedingJoinState;if(!P)return!0;const B=R.params[0]||1,O=b.UnicodeService.extractWidth(P),H=this._activeBuffer.x-O,W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(H),K=new Uint32Array(W.length*B);let V=0;for(let L=0;L<W.length;){const z=W.codePointAt(L)||0;K[V++]=z,L+=z>65535?2:1}let I=V;for(let L=1;L<B;++L)K.copyWithin(I,0,V),I+=V;return this.print(K,0,I),!0}sendDeviceAttributesPrimary(R){return R.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(c.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(c.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(R){return R.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(c.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(c.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(R.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(c.C0.ESC+"[>83;40003;0c")),!0}_is(R){return(this._optionsService.rawOptions.termName+"").indexOf(R)===0}setMode(R){for(let P=0;P<R.length;P++)switch(R.params[P]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(R){for(let P=0;P<R.length;P++)switch(R.params[P]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(R){for(let P=0;P<R.length;P++)switch(R.params[P]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(R){for(let P=0;P<R.length;P++)switch(R.params[P]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),R.params[P]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(R,P){const B=this._coreService.decPrivateModes,{activeProtocol:O,activeEncoding:H}=this._coreMouseService,W=this._coreService,{buffers:K,cols:V}=this._bufferService,{active:I,alt:L}=K,z=this._optionsService.rawOptions,$=re=>re?1:2,Y=R.params[0];return G=Y,J=P?Y===2?4:Y===4?$(W.modes.insertMode):Y===12?3:Y===20?$(z.convertEol):0:Y===1?$(B.applicationCursorKeys):Y===3?z.windowOptions.setWinLines?V===80?2:V===132?1:0:0:Y===6?$(B.origin):Y===7?$(B.wraparound):Y===8?3:Y===9?$(O==="X10"):Y===12?$(z.cursorBlink):Y===25?$(!W.isCursorHidden):Y===45?$(B.reverseWraparound):Y===66?$(B.applicationKeypad):Y===67?4:Y===1e3?$(O==="VT200"):Y===1002?$(O==="DRAG"):Y===1003?$(O==="ANY"):Y===1004?$(B.sendFocus):Y===1005?4:Y===1006?$(H==="SGR"):Y===1015?4:Y===1016?$(H==="SGR_PIXELS"):Y===1048?1:Y===47||Y===1047||Y===1049?$(I===L):Y===2004?$(B.bracketedPasteMode):0,W.triggerDataEvent(`${c.C0.ESC}[${P?"":"?"}${G};${J}$y`),!0;var G,J}_updateAttrColor(R,P,B,O,H){return P===2?(R|=50331648,R&=-16777216,R|=g.AttributeData.fromColorRGB([B,O,H])):P===5&&(R&=-50331904,R|=33554432|255&B),R}_extractColor(R,P,B){const O=[0,0,-1,0,0,0];let H=0,W=0;do{if(O[W+H]=R.params[P+W],R.hasSubParams(P+W)){const K=R.getSubParams(P+W);let V=0;do O[1]===5&&(H=1),O[W+V+1+H]=K[V];while(++V<K.length&&V+W+1+H<O.length);break}if(O[1]===5&&W+H>=2||O[1]===2&&W+H>=5)break;O[1]&&(H=1)}while(++W+P<R.length&&W+H<O.length);for(let K=2;K<O.length;++K)O[K]===-1&&(O[K]=0);switch(O[0]){case 38:B.fg=this._updateAttrColor(B.fg,O[1],O[3],O[4],O[5]);break;case 48:B.bg=this._updateAttrColor(B.bg,O[1],O[3],O[4],O[5]);break;case 58:B.extended=B.extended.clone(),B.extended.underlineColor=this._updateAttrColor(B.extended.underlineColor,O[1],O[3],O[4],O[5])}return W}_processUnderline(R,P){P.extended=P.extended.clone(),(!~R||R>5)&&(R=1),P.extended.underlineStyle=R,P.fg|=268435456,R===0&&(P.fg&=-268435457),P.updateExtended()}_processSGR0(R){R.fg=n.DEFAULT_ATTR_DATA.fg,R.bg=n.DEFAULT_ATTR_DATA.bg,R.extended=R.extended.clone(),R.extended.underlineStyle=0,R.extended.underlineColor&=-67108864,R.updateExtended()}charAttributes(R){if(R.length===1&&R.params[0]===0)return this._processSGR0(this._curAttrData),!0;const P=R.length;let B;const O=this._curAttrData;for(let H=0;H<P;H++)B=R.params[H],B>=30&&B<=37?(O.fg&=-50331904,O.fg|=16777216|B-30):B>=40&&B<=47?(O.bg&=-50331904,O.bg|=16777216|B-40):B>=90&&B<=97?(O.fg&=-50331904,O.fg|=16777224|B-90):B>=100&&B<=107?(O.bg&=-50331904,O.bg|=16777224|B-100):B===0?this._processSGR0(O):B===1?O.fg|=134217728:B===3?O.bg|=67108864:B===4?(O.fg|=268435456,this._processUnderline(R.hasSubParams(H)?R.getSubParams(H)[0]:1,O)):B===5?O.fg|=536870912:B===7?O.fg|=67108864:B===8?O.fg|=1073741824:B===9?O.fg|=2147483648:B===2?O.bg|=134217728:B===21?this._processUnderline(2,O):B===22?(O.fg&=-134217729,O.bg&=-134217729):B===23?O.bg&=-67108865:B===24?(O.fg&=-268435457,this._processUnderline(0,O)):B===25?O.fg&=-536870913:B===27?O.fg&=-67108865:B===28?O.fg&=-1073741825:B===29?O.fg&=2147483647:B===39?(O.fg&=-67108864,O.fg|=16777215&n.DEFAULT_ATTR_DATA.fg):B===49?(O.bg&=-67108864,O.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):B===38||B===48||B===58?H+=this._extractColor(R,H,O):B===53?O.bg|=1073741824:B===55?O.bg&=-1073741825:B===59?(O.extended=O.extended.clone(),O.extended.underlineColor=-1,O.updateExtended()):B===100?(O.fg&=-67108864,O.fg|=16777215&n.DEFAULT_ATTR_DATA.fg,O.bg&=-67108864,O.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",B);return!0}deviceStatus(R){switch(R.params[0]){case 5:this._coreService.triggerDataEvent(`${c.C0.ESC}[0n`);break;case 6:const P=this._activeBuffer.y+1,B=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[${P};${B}R`)}return!0}deviceStatusPrivate(R){if(R.params[0]===6){const P=this._activeBuffer.y+1,B=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[?${P};${B}R`)}return!0}softReset(R){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(R){const P=R.params[0]||1;switch(P){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const B=P%2==1;return this._optionsService.options.cursorBlink=B,!0}setScrollRegion(R){const P=R.params[0]||1;let B;return(R.length<2||(B=R.params[1])>this._bufferService.rows||B===0)&&(B=this._bufferService.rows),B>P&&(this._activeBuffer.scrollTop=P-1,this._activeBuffer.scrollBottom=B-1,this._setCursor(0,0)),!0}windowOptions(R){if(!N(R.params[0],this._optionsService.rawOptions.windowOptions))return!0;const P=R.length>1?R.params[1]:0;switch(R.params[0]){case 14:P!==2&&this._onRequestWindowsOptionsReport.fire(D.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(D.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${c.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:P!==0&&P!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),P!==0&&P!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:P!==0&&P!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),P!==0&&P!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(R){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(R){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(R){return this._windowTitle=R,this._onTitleChange.fire(R),!0}setIconName(R){return this._iconName=R,!0}setOrReportIndexedColor(R){const P=[],B=R.split(";");for(;B.length>1;){const O=B.shift(),H=B.shift();if(/^\d+$/.exec(O)){const W=parseInt(O);if(X(W))if(H==="?")P.push({type:0,index:W});else{const K=(0,C.parseColor)(H);K&&P.push({type:1,index:W,color:K})}}}return P.length&&this._onColor.fire(P),!0}setHyperlink(R){const P=R.split(";");return!(P.length<2)&&(P[1]?this._createHyperlink(P[0],P[1]):!P[0]&&this._finishHyperlink())}_createHyperlink(R,P){this._getCurrentLinkId()&&this._finishHyperlink();const B=R.split(":");let O;const H=B.findIndex(W=>W.startsWith("id="));return H!==-1&&(O=B[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:O,uri:P}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(R,P){const B=R.split(";");for(let O=0;O<B.length&&!(P>=this._specialColors.length);++O,++P)if(B[O]==="?")this._onColor.fire([{type:0,index:this._specialColors[P]}]);else{const H=(0,C.parseColor)(B[O]);H&&this._onColor.fire([{type:1,index:this._specialColors[P],color:H}])}return!0}setOrReportFgColor(R){return this._setOrReportSpecialColor(R,0)}setOrReportBgColor(R){return this._setOrReportSpecialColor(R,1)}setOrReportCursorColor(R){return this._setOrReportSpecialColor(R,2)}restoreIndexedColor(R){if(!R)return this._onColor.fire([{type:2}]),!0;const P=[],B=R.split(";");for(let O=0;O<B.length;++O)if(/^\d+$/.exec(B[O])){const H=parseInt(B[O]);X(H)&&P.push({type:2,index:H})}return P.length&&this._onColor.fire(P),!0}restoreFgColor(R){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(R){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(R){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(R){return R.length!==2?(this.selectDefaultCharset(),!0):(R[0]==="/"||this._charsetService.setgCharset(T[R[0]],h.CHARSETS[R[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const R=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,R,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(R){return this._charsetService.setgLevel(R),!0}screenAlignmentPattern(){const R=new l.CellData;R.content=4194373,R.fg=this._curAttrData.fg,R.bg=this._curAttrData.bg,this._setCursor(0,0);for(let P=0;P<this._bufferService.rows;++P){const B=this._activeBuffer.ybase+this._activeBuffer.y+P,O=this._activeBuffer.lines.get(B);O&&(O.fill(R),O.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(R,P){const B=this._bufferService.buffer,O=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${c.C0.ESC}${H}${c.C0.ESC}\\`),!0))(R==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:R==='"p'?'P1$r61;1"p':R==="r"?`P1$r${B.scrollTop+1};${B.scrollBottom+1}r`:R==="m"?"P1$r0m":R===" q"?`P1$r${{block:2,underline:4,bar:6}[O.cursorStyle]-(O.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(R,P){this._dirtyRowTracker.markRangeDirty(R,P)}}s.InputHandler=F;let U=class{constructor(q){this._bufferService=q,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(q){q<this.start?this.start=q:q>this.end&&(this.end=q)}markRangeDirty(q,R){q>R&&(j=q,q=R,R=j),q<this.start&&(this.start=q),R>this.end&&(this.end=R)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function X(q){return 0<=q&&q<256}U=f([m(0,x.IBufferService)],U)},844:(E,s)=>{function a(f){for(const m of f)m.dispose();f.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.MutableDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const f of this._disposables)f.dispose();this._disposables.length=0}register(f){return this._disposables.push(f),f}unregister(f){const m=this._disposables.indexOf(f);m!==-1&&this._disposables.splice(m,1)}},s.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(f){this._isDisposed||f===this._value||(this._value?.dispose(),this._value=f)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},s.toDisposable=function(f){return{dispose:f}},s.disposeArray=a,s.getDisposeArrayDisposable=function(f){return{dispose:()=>a(f)}}},1505:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(m,c,h){this._data[m]||(this._data[m]={}),this._data[m][c]=h}get(m,c){return this._data[m]?this._data[m][c]:void 0}clear(){this._data={}}}s.TwoKeyMap=a,s.FourKeyMap=class{constructor(){this._data=new a}set(f,m,c,h,_){this._data.get(f,m)||this._data.set(f,m,new a),this._data.get(f,m).set(c,h,_)}get(f,m,c,h){return this._data.get(f,m)?.get(c,h)}clear(){this._data.clear()}}},6114:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof process<"u"&&"title"in process;const a=s.isNode?"node":navigator.userAgent,f=s.isNode?"node":navigator.platform;s.isFirefox=a.includes("Firefox"),s.isLegacyEdge=a.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(a),s.getSafariVersion=function(){if(!s.isSafari)return 0;const m=a.match(/Version\/(\d+)/);return m===null||m.length<2?0:parseInt(m[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(f),s.isIpad=f==="iPad",s.isIphone=f==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(f),s.isLinux=f.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(a)},6106:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let a=0;s.SortedList=class{constructor(f){this._getKey=f,this._array=[]}clear(){this._array.length=0}insert(f){this._array.length!==0?(a=this._search(this._getKey(f)),this._array.splice(a,0,f)):this._array.push(f)}delete(f){if(this._array.length===0)return!1;const m=this._getKey(f);if(m===void 0||(a=this._search(m),a===-1)||this._getKey(this._array[a])!==m)return!1;do if(this._array[a]===f)return this._array.splice(a,1),!0;while(++a<this._array.length&&this._getKey(this._array[a])===m);return!1}*getKeyIterator(f){if(this._array.length!==0&&(a=this._search(f),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===f))do yield this._array[a];while(++a<this._array.length&&this._getKey(this._array[a])===f)}forEachByKey(f,m){if(this._array.length!==0&&(a=this._search(f),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===f))do m(this._array[a]);while(++a<this._array.length&&this._getKey(this._array[a])===f)}values(){return[...this._array].values()}_search(f){let m=0,c=this._array.length-1;for(;c>=m;){let h=m+c>>1;const _=this._getKey(this._array[h]);if(_>f)c=h-1;else{if(!(_<f)){for(;h>0&&this._getKey(this._array[h-1])===f;)h--;return h}m=h+1}}return m}}},7226:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const f=a(6114);class m{constructor(){this._tasks=[],this._i=0}enqueue(_){this._tasks.push(_),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(_){this._idleCallback=void 0;let S=0,p=0,n=_.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(S=Date.now(),this._tasks[this._i]()||this._i++,S=Math.max(1,Date.now()-S),p=Math.max(S,p),o=_.timeRemaining(),1.5*p>o)return n-S<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-S))}ms`),void this._start();n=o}this.clear()}}class c extends m{_requestCallback(_){return setTimeout(()=>_(this._createDeadline(16)))}_cancelCallback(_){clearTimeout(_)}_createDeadline(_){const S=Date.now()+_;return{timeRemaining:()=>Math.max(0,S-Date.now())}}}s.PriorityTaskQueue=c,s.IdleTaskQueue=!f.isNode&&"requestIdleCallback"in window?class extends m{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:c,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const f=a(643);s.updateWindowsModeWrappedState=function(m){const c=m.buffer.lines.get(m.buffer.ybase+m.buffer.y-1),h=c?.get(m.cols-1),_=m.buffer.lines.get(m.buffer.ybase+m.buffer.y);_&&h&&(_.isWrapped=h[f.CHAR_DATA_CODE_INDEX]!==f.NULL_CELL_CODE&&h[f.CHAR_DATA_CODE_INDEX]!==f.WHITESPACE_CELL_CODE)}},3734:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new f}static toColorRGB(c){return[c>>>16&255,c>>>8&255,255&c]}static fromColorRGB(c){return(255&c[0])<<16|(255&c[1])<<8|255&c[2]}clone(){const c=new a;return c.fg=this.fg,c.bg=this.bg,c.extended=this.extended.clone(),c}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}s.AttributeData=a;class f{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(c){this._ext=c}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(c){this._ext&=-469762049,this._ext|=c<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(c){this._ext&=-67108864,this._ext|=67108863&c}get urlId(){return this._urlId}set urlId(c){this._urlId=c}get underlineVariantOffset(){const c=(3758096384&this._ext)>>29;return c<0?4294967288^c:c}set underlineVariantOffset(c){this._ext&=536870911,this._ext|=c<<29&3758096384}constructor(c=0,h=0){this._ext=0,this._urlId=0,this._ext=c,this._urlId=h}clone(){return new f(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=f},9092:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const f=a(6349),m=a(7226),c=a(3734),h=a(8437),_=a(4634),S=a(511),p=a(643),n=a(4863),o=a(7116);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(i,l,g){this._hasScrollback=i,this._optionsService=l,this._bufferService=g,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=S.CellData.fromCharData([0,p.NULL_CELL_CHAR,p.NULL_CELL_WIDTH,p.NULL_CELL_CODE]),this._whitespaceCell=S.CellData.fromCharData([0,p.WHITESPACE_CELL_CHAR,p.WHITESPACE_CELL_WIDTH,p.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new m.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new f.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(i){return i?(this._nullCell.fg=i.fg,this._nullCell.bg=i.bg,this._nullCell.extended=i.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(i){return i?(this._whitespaceCell.fg=i.fg,this._whitespaceCell.bg=i.bg,this._whitespaceCell.extended=i.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(i,l){return new h.BufferLine(this._bufferService.cols,this.getNullCell(i),l)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const i=this.ybase+this.y-this.ydisp;return i>=0&&i<this._rows}_getCorrectBufferLength(i){if(!this._hasScrollback)return i;const l=i+this._optionsService.rawOptions.scrollback;return l>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:l}fillViewportRows(i){if(this.lines.length===0){i===void 0&&(i=h.DEFAULT_ATTR_DATA);let l=this._rows;for(;l--;)this.lines.push(this.getBlankLine(i))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new f.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(i,l){const g=this.getNullCell(h.DEFAULT_ATTR_DATA);let x=0;const b=this._getCorrectBufferLength(l);if(b>this.lines.maxLength&&(this.lines.maxLength=b),this.lines.length>0){if(this._cols<i)for(let v=0;v<this.lines.length;v++)x+=+this.lines.get(v).resize(i,g);let w=0;if(this._rows<l)for(let v=this._rows;v<l;v++)this.lines.length<l+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(i,g)):this.ybase>0&&this.lines.length<=this.ybase+this.y+w+1?(this.ybase--,w++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(i,g)));else for(let v=this._rows;v>l;v--)this.lines.length>l+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(b<this.lines.maxLength){const v=this.lines.length-b;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=b}this.x=Math.min(this.x,i-1),this.y=Math.min(this.y,l-1),w&&(this.y+=w),this.savedX=Math.min(this.savedX,i-1),this.scrollTop=0}if(this.scrollBottom=l-1,this._isReflowEnabled&&(this._reflow(i,l),this._cols>i))for(let w=0;w<this.lines.length;w++)x+=+this.lines.get(w).resize(i,g);this._cols=i,this._rows=l,this._memoryCleanupQueue.clear(),x>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let i=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,i=!1);let l=0;for(;this._memoryCleanupPosition<this.lines.length;)if(l+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),l>100)return!0;return i}get _isReflowEnabled(){const i=this._optionsService.rawOptions.windowsPty;return i&&i.buildNumber?this._hasScrollback&&i.backend==="conpty"&&i.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(i,l){this._cols!==i&&(i>this._cols?this._reflowLarger(i,l):this._reflowSmaller(i,l))}_reflowLarger(i,l){const g=(0,_.reflowLargerGetLinesToRemove)(this.lines,this._cols,i,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(g.length>0){const x=(0,_.reflowLargerCreateNewLayout)(this.lines,g);(0,_.reflowLargerApplyNewLayout)(this.lines,x.layout),this._reflowLargerAdjustViewport(i,l,x.countRemoved)}}_reflowLargerAdjustViewport(i,l,g){const x=this.getNullCell(h.DEFAULT_ATTR_DATA);let b=g;for(;b-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<l&&this.lines.push(new h.BufferLine(i,x))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-g,0)}_reflowSmaller(i,l){const g=this.getNullCell(h.DEFAULT_ATTR_DATA),x=[];let b=0;for(let w=this.lines.length-1;w>=0;w--){let v=this.lines.get(w);if(!v||!v.isWrapped&&v.getTrimmedLength()<=i)continue;const C=[v];for(;v.isWrapped&&w>0;)v=this.lines.get(--w),C.unshift(v);const T=this.ybase+this.y;if(T>=w&&T<w+C.length)continue;const A=C[C.length-1].getTrimmedLength(),N=(0,_.reflowSmallerGetNewLineLengths)(C,this._cols,i),D=N.length-C.length;let j;j=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const F=[];for(let B=0;B<D;B++){const O=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);F.push(O)}F.length>0&&(x.push({start:w+C.length+b,newLines:F}),b+=F.length),C.push(...F);let U=N.length-1,X=N[U];X===0&&(U--,X=N[U]);let q=C.length-D-1,R=A;for(;q>=0;){const B=Math.min(R,X);if(C[U]===void 0)break;if(C[U].copyCellsFrom(C[q],R-B,X-B,B,!0),X-=B,X===0&&(U--,X=N[U]),R-=B,R===0){q--;const O=Math.max(q,0);R=(0,_.getWrappedLineTrimmedLength)(C,O,this._cols)}}for(let B=0;B<C.length;B++)N[B]<i&&C[B].setCell(N[B],g);let P=D-j;for(;P-- >0;)this.ybase===0?this.y<l-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+b)-l&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+l-1)}if(x.length>0){const w=[],v=[];for(let U=0;U<this.lines.length;U++)v.push(this.lines.get(U));const C=this.lines.length;let T=C-1,A=0,N=x[A];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+b);let D=0;for(let U=Math.min(this.lines.maxLength-1,C+b-1);U>=0;U--)if(N&&N.start>T+D){for(let X=N.newLines.length-1;X>=0;X--)this.lines.set(U--,N.newLines[X]);U++,w.push({index:T+1,amount:N.newLines.length}),D+=N.newLines.length,N=x[++A]}else this.lines.set(U,v[T--]);let j=0;for(let U=w.length-1;U>=0;U--)w[U].index+=j,this.lines.onInsertEmitter.fire(w[U]),j+=w[U].amount;const F=Math.max(0,C+b-this.lines.maxLength);F>0&&this.lines.onTrimEmitter.fire(F)}}translateBufferLineToString(i,l,g=0,x){const b=this.lines.get(i);return b?b.translateToString(l,g,x):""}getWrappedRangeForLine(i){let l=i,g=i;for(;l>0&&this.lines.get(l).isWrapped;)l--;for(;g+1<this.lines.length&&this.lines.get(g+1).isWrapped;)g++;return{first:l,last:g}}setupTabStops(i){for(i!=null?this.tabs[i]||(i=this.prevStop(i)):(this.tabs={},i=0);i<this._cols;i+=this._optionsService.rawOptions.tabStopWidth)this.tabs[i]=!0}prevStop(i){for(i==null&&(i=this.x);!this.tabs[--i]&&i>0;);return i>=this._cols?this._cols-1:i<0?0:i}nextStop(i){for(i==null&&(i=this.x);!this.tabs[++i]&&i<this._cols;);return i>=this._cols?this._cols-1:i<0?0:i}clearMarkers(i){this._isClearing=!0;for(let l=0;l<this.markers.length;l++)this.markers[l].line===i&&(this.markers[l].dispose(),this.markers.splice(l--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].dispose(),this.markers.splice(i--,1);this._isClearing=!1}addMarker(i){const l=new n.Marker(i);return this.markers.push(l),l.register(this.lines.onTrim(g=>{l.line-=g,l.line<0&&l.dispose()})),l.register(this.lines.onInsert(g=>{l.line>=g.index&&(l.line+=g.amount)})),l.register(this.lines.onDelete(g=>{l.line>=g.index&&l.line<g.index+g.amount&&l.dispose(),l.line>g.index&&(l.line-=g.amount)})),l.register(l.onDispose(()=>this._removeMarker(l))),l}_removeMarker(i){this._isClearing||this.markers.splice(this.markers.indexOf(i),1)}}},8437:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const f=a(3734),m=a(511),c=a(643),h=a(482);s.DEFAULT_ATTR_DATA=Object.freeze(new f.AttributeData);let _=0;class S{constructor(n,o,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*n);const l=o||m.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]);for(let g=0;g<n;++g)this.setCell(g,l);this.length=n}get(n){const o=this._data[3*n+0],i=2097151&o;return[this._data[3*n+1],2097152&o?this._combined[n]:i?(0,h.stringFromCodePoint)(i):"",o>>22,2097152&o?this._combined[n].charCodeAt(this._combined[n].length-1):i]}set(n,o){this._data[3*n+1]=o[c.CHAR_DATA_ATTR_INDEX],o[c.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[n]=o[1],this._data[3*n+0]=2097152|n|o[c.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*n+0]=o[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|o[c.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(n){return this._data[3*n+0]>>22}hasWidth(n){return 12582912&this._data[3*n+0]}getFg(n){return this._data[3*n+1]}getBg(n){return this._data[3*n+2]}hasContent(n){return 4194303&this._data[3*n+0]}getCodePoint(n){const o=this._data[3*n+0];return 2097152&o?this._combined[n].charCodeAt(this._combined[n].length-1):2097151&o}isCombined(n){return 2097152&this._data[3*n+0]}getString(n){const o=this._data[3*n+0];return 2097152&o?this._combined[n]:2097151&o?(0,h.stringFromCodePoint)(2097151&o):""}isProtected(n){return 536870912&this._data[3*n+2]}loadCell(n,o){return _=3*n,o.content=this._data[_+0],o.fg=this._data[_+1],o.bg=this._data[_+2],2097152&o.content&&(o.combinedData=this._combined[n]),268435456&o.bg&&(o.extended=this._extendedAttrs[n]),o}setCell(n,o){2097152&o.content&&(this._combined[n]=o.combinedData),268435456&o.bg&&(this._extendedAttrs[n]=o.extended),this._data[3*n+0]=o.content,this._data[3*n+1]=o.fg,this._data[3*n+2]=o.bg}setCellFromCodepoint(n,o,i,l){268435456&l.bg&&(this._extendedAttrs[n]=l.extended),this._data[3*n+0]=o|i<<22,this._data[3*n+1]=l.fg,this._data[3*n+2]=l.bg}addCodepointToCell(n,o,i){let l=this._data[3*n+0];2097152&l?this._combined[n]+=(0,h.stringFromCodePoint)(o):2097151&l?(this._combined[n]=(0,h.stringFromCodePoint)(2097151&l)+(0,h.stringFromCodePoint)(o),l&=-2097152,l|=2097152):l=o|4194304,i&&(l&=-12582913,l|=i<<22),this._data[3*n+0]=l}insertCells(n,o,i){if((n%=this.length)&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),o<this.length-n){const l=new m.CellData;for(let g=this.length-n-o-1;g>=0;--g)this.setCell(n+o+g,this.loadCell(n+g,l));for(let g=0;g<o;++g)this.setCell(n+g,i)}else for(let l=n;l<this.length;++l)this.setCell(l,i);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,i)}deleteCells(n,o,i){if(n%=this.length,o<this.length-n){const l=new m.CellData;for(let g=0;g<this.length-n-o;++g)this.setCell(n+g,this.loadCell(n+o+g,l));for(let g=this.length-o;g<this.length;++g)this.setCell(g,i)}else for(let l=n;l<this.length;++l)this.setCell(l,i);n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),this.getWidth(n)!==0||this.hasContent(n)||this.setCellFromCodepoint(n,0,1,i)}replaceCells(n,o,i,l=!1){if(l)for(n&&this.getWidth(n-1)===2&&!this.isProtected(n-1)&&this.setCellFromCodepoint(n-1,0,1,i),o<this.length&&this.getWidth(o-1)===2&&!this.isProtected(o)&&this.setCellFromCodepoint(o,0,1,i);n<o&&n<this.length;)this.isProtected(n)||this.setCell(n,i),n++;else for(n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),o<this.length&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o,0,1,i);n<o&&n<this.length;)this.setCell(n++,i)}resize(n,o){if(n===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const i=3*n;if(n>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{const l=new Uint32Array(i);l.set(this._data),this._data=l}for(let l=this.length;l<n;++l)this.setCell(l,o)}else{this._data=this._data.subarray(0,i);const l=Object.keys(this._combined);for(let x=0;x<l.length;x++){const b=parseInt(l[x],10);b>=n&&delete this._combined[b]}const g=Object.keys(this._extendedAttrs);for(let x=0;x<g.length;x++){const b=parseInt(g[x],10);b>=n&&delete this._extendedAttrs[b]}}return this.length=n,4*i*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const n=new Uint32Array(this._data.length);return n.set(this._data),this._data=n,1}return 0}fill(n,o=!1){if(o)for(let i=0;i<this.length;++i)this.isProtected(i)||this.setCell(i,n);else{this._combined={},this._extendedAttrs={};for(let i=0;i<this.length;++i)this.setCell(i,n)}}copyFrom(n){this.length!==n.length?this._data=new Uint32Array(n._data):this._data.set(n._data),this.length=n.length,this._combined={};for(const o in n._combined)this._combined[o]=n._combined[o];this._extendedAttrs={};for(const o in n._extendedAttrs)this._extendedAttrs[o]=n._extendedAttrs[o];this.isWrapped=n.isWrapped}clone(){const n=new S(0);n._data=new Uint32Array(this._data),n.length=this.length;for(const o in this._combined)n._combined[o]=this._combined[o];for(const o in this._extendedAttrs)n._extendedAttrs[o]=this._extendedAttrs[o];return n.isWrapped=this.isWrapped,n}getTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0])return n+(this._data[3*n+0]>>22);return 0}getNoBgTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0]||50331648&this._data[3*n+2])return n+(this._data[3*n+0]>>22);return 0}copyCellsFrom(n,o,i,l,g){const x=n._data;if(g)for(let w=l-1;w>=0;w--){for(let v=0;v<3;v++)this._data[3*(i+w)+v]=x[3*(o+w)+v];268435456&x[3*(o+w)+2]&&(this._extendedAttrs[i+w]=n._extendedAttrs[o+w])}else for(let w=0;w<l;w++){for(let v=0;v<3;v++)this._data[3*(i+w)+v]=x[3*(o+w)+v];268435456&x[3*(o+w)+2]&&(this._extendedAttrs[i+w]=n._extendedAttrs[o+w])}const b=Object.keys(n._combined);for(let w=0;w<b.length;w++){const v=parseInt(b[w],10);v>=o&&(this._combined[v-o+i]=n._combined[v])}}translateToString(n,o,i,l){o=o??0,i=i??this.length,n&&(i=Math.min(i,this.getTrimmedLength())),l&&(l.length=0);let g="";for(;o<i;){const x=this._data[3*o+0],b=2097151&x,w=2097152&x?this._combined[o]:b?(0,h.stringFromCodePoint)(b):c.WHITESPACE_CELL_CHAR;if(g+=w,l)for(let v=0;v<w.length;++v)l.push(o);o+=x>>22||1}return l&&l.push(o),g}}s.BufferLine=S},4841:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(a,f){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return f*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(E,s)=>{function a(f,m,c){if(m===f.length-1)return f[m].getTrimmedLength();const h=!f[m].hasContent(c-1)&&f[m].getWidth(c-1)===1,_=f[m+1].getWidth(0)===2;return h&&_?c-1:c}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(f,m,c,h,_){const S=[];for(let p=0;p<f.length-1;p++){let n=p,o=f.get(++n);if(!o.isWrapped)continue;const i=[f.get(p)];for(;n<f.length&&o.isWrapped;)i.push(o),o=f.get(++n);if(h>=p&&h<n){p+=i.length-1;continue}let l=0,g=a(i,l,m),x=1,b=0;for(;x<i.length;){const v=a(i,x,m),C=v-b,T=c-g,A=Math.min(C,T);i[l].copyCellsFrom(i[x],b,g,A,!1),g+=A,g===c&&(l++,g=0),b+=A,b===v&&(x++,b=0),g===0&&l!==0&&i[l-1].getWidth(c-1)===2&&(i[l].copyCellsFrom(i[l-1],c-1,g++,1,!1),i[l-1].setCell(c-1,_))}i[l].replaceCells(g,c,_);let w=0;for(let v=i.length-1;v>0&&(v>l||i[v].getTrimmedLength()===0);v--)w++;w>0&&(S.push(p+i.length-w),S.push(w)),p+=i.length-1}return S},s.reflowLargerCreateNewLayout=function(f,m){const c=[];let h=0,_=m[h],S=0;for(let p=0;p<f.length;p++)if(_===p){const n=m[++h];f.onDeleteEmitter.fire({index:p-S,amount:n}),p+=n-1,S+=n,_=m[++h]}else c.push(p);return{layout:c,countRemoved:S}},s.reflowLargerApplyNewLayout=function(f,m){const c=[];for(let h=0;h<m.length;h++)c.push(f.get(m[h]));for(let h=0;h<c.length;h++)f.set(h,c[h]);f.length=m.length},s.reflowSmallerGetNewLineLengths=function(f,m,c){const h=[],_=f.map((o,i)=>a(f,i,m)).reduce((o,i)=>o+i);let S=0,p=0,n=0;for(;n<_;){if(_-n<c){h.push(_-n);break}S+=c;const o=a(f,p,m);S>o&&(S-=o,p++);const i=f[p].getWidth(S-1)===2;i&&S--;const l=i?c-1:c;h.push(l),n+=l}return h},s.getWrappedLineTrimmedLength=a},5295:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const f=a(8460),m=a(844),c=a(9092);class h extends m.Disposable{constructor(S,p){super(),this._optionsService=S,this._bufferService=p,this._onBufferActivate=this.register(new f.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(S){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(S),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(S,p){this._normal.resize(S,p),this._alt.resize(S,p),this.setupTabStops(S)}setupTabStops(S){this._normal.setupTabStops(S),this._alt.setupTabStops(S)}}s.BufferSet=h},511:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const f=a(482),m=a(643),c=a(3734);class h extends c.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new c.ExtendedAttrs,this.combinedData=""}static fromCharData(S){const p=new h;return p.setFromCharData(S),p}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,f.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(S){this.fg=S[m.CHAR_DATA_ATTR_INDEX],this.bg=0;let p=!1;if(S[m.CHAR_DATA_CHAR_INDEX].length>2)p=!0;else if(S[m.CHAR_DATA_CHAR_INDEX].length===2){const n=S[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const o=S[m.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(n-55296)+o-56320+65536|S[m.CHAR_DATA_WIDTH_INDEX]<<22:p=!0}else p=!0}else this.content=S[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|S[m.CHAR_DATA_WIDTH_INDEX]<<22;p&&(this.combinedData=S[m.CHAR_DATA_CHAR_INDEX],this.content=2097152|S[m.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=h},643:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const f=a(8460),m=a(844);class c{get id(){return this._id}constructor(_){this.line=_,this.isDisposed=!1,this._disposables=[],this._id=c._nextId++,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,m.disposeArray)(this._disposables),this._disposables.length=0)}register(_){return this._disposables.push(_),_}}s.Marker=c,c._nextId=1},7116:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},s.CHARSETS.A={"#":"£"},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},s.CHARSETS.C=s.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},s.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},s.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},s.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},s.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},s.CHARSETS.E=s.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},s.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},s.CHARSETS.H=s.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},s.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(E,s)=>{var a,f,m;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(c){c.NUL="\0",c.SOH="",c.STX="",c.ETX="",c.EOT="",c.ENQ="",c.ACK="",c.BEL="\x07",c.BS="\b",c.HT="	",c.LF=`
`,c.VT="\v",c.FF="\f",c.CR="\r",c.SO="",c.SI="",c.DLE="",c.DC1="",c.DC2="",c.DC3="",c.DC4="",c.NAK="",c.SYN="",c.ETB="",c.CAN="",c.EM="",c.SUB="",c.ESC="\x1B",c.FS="",c.GS="",c.RS="",c.US="",c.SP=" ",c.DEL=""}(a||(s.C0=a={})),function(c){c.PAD="",c.HOP="",c.BPH="",c.NBH="",c.IND="",c.NEL="",c.SSA="",c.ESA="",c.HTS="",c.HTJ="",c.VTS="",c.PLD="",c.PLU="",c.RI="",c.SS2="",c.SS3="",c.DCS="",c.PU1="",c.PU2="",c.STS="",c.CCH="",c.MW="",c.SPA="",c.EPA="",c.SOS="",c.SGCI="",c.SCI="",c.CSI="",c.ST="",c.OSC="",c.PM="",c.APC=""}(f||(s.C1=f={})),function(c){c.ST=`${a.ESC}\\`}(m||(s.C1_ESCAPED=m={}))},7399:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const f=a(2584),m={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(c,h,_,S){const p={type:0,cancel:!1,key:void 0},n=(c.shiftKey?1:0)|(c.altKey?2:0)|(c.ctrlKey?4:0)|(c.metaKey?8:0);switch(c.keyCode){case 0:c.key==="UIKeyInputUpArrow"?p.key=h?f.C0.ESC+"OA":f.C0.ESC+"[A":c.key==="UIKeyInputLeftArrow"?p.key=h?f.C0.ESC+"OD":f.C0.ESC+"[D":c.key==="UIKeyInputRightArrow"?p.key=h?f.C0.ESC+"OC":f.C0.ESC+"[C":c.key==="UIKeyInputDownArrow"&&(p.key=h?f.C0.ESC+"OB":f.C0.ESC+"[B");break;case 8:p.key=c.ctrlKey?"\b":f.C0.DEL,c.altKey&&(p.key=f.C0.ESC+p.key);break;case 9:if(c.shiftKey){p.key=f.C0.ESC+"[Z";break}p.key=f.C0.HT,p.cancel=!0;break;case 13:p.key=c.altKey?f.C0.ESC+f.C0.CR:f.C0.CR,p.cancel=!0;break;case 27:p.key=f.C0.ESC,c.altKey&&(p.key=f.C0.ESC+f.C0.ESC),p.cancel=!0;break;case 37:if(c.metaKey)break;n?(p.key=f.C0.ESC+"[1;"+(n+1)+"D",p.key===f.C0.ESC+"[1;3D"&&(p.key=f.C0.ESC+(_?"b":"[1;5D"))):p.key=h?f.C0.ESC+"OD":f.C0.ESC+"[D";break;case 39:if(c.metaKey)break;n?(p.key=f.C0.ESC+"[1;"+(n+1)+"C",p.key===f.C0.ESC+"[1;3C"&&(p.key=f.C0.ESC+(_?"f":"[1;5C"))):p.key=h?f.C0.ESC+"OC":f.C0.ESC+"[C";break;case 38:if(c.metaKey)break;n?(p.key=f.C0.ESC+"[1;"+(n+1)+"A",_||p.key!==f.C0.ESC+"[1;3A"||(p.key=f.C0.ESC+"[1;5A")):p.key=h?f.C0.ESC+"OA":f.C0.ESC+"[A";break;case 40:if(c.metaKey)break;n?(p.key=f.C0.ESC+"[1;"+(n+1)+"B",_||p.key!==f.C0.ESC+"[1;3B"||(p.key=f.C0.ESC+"[1;5B")):p.key=h?f.C0.ESC+"OB":f.C0.ESC+"[B";break;case 45:c.shiftKey||c.ctrlKey||(p.key=f.C0.ESC+"[2~");break;case 46:p.key=n?f.C0.ESC+"[3;"+(n+1)+"~":f.C0.ESC+"[3~";break;case 36:p.key=n?f.C0.ESC+"[1;"+(n+1)+"H":h?f.C0.ESC+"OH":f.C0.ESC+"[H";break;case 35:p.key=n?f.C0.ESC+"[1;"+(n+1)+"F":h?f.C0.ESC+"OF":f.C0.ESC+"[F";break;case 33:c.shiftKey?p.type=2:c.ctrlKey?p.key=f.C0.ESC+"[5;"+(n+1)+"~":p.key=f.C0.ESC+"[5~";break;case 34:c.shiftKey?p.type=3:c.ctrlKey?p.key=f.C0.ESC+"[6;"+(n+1)+"~":p.key=f.C0.ESC+"[6~";break;case 112:p.key=n?f.C0.ESC+"[1;"+(n+1)+"P":f.C0.ESC+"OP";break;case 113:p.key=n?f.C0.ESC+"[1;"+(n+1)+"Q":f.C0.ESC+"OQ";break;case 114:p.key=n?f.C0.ESC+"[1;"+(n+1)+"R":f.C0.ESC+"OR";break;case 115:p.key=n?f.C0.ESC+"[1;"+(n+1)+"S":f.C0.ESC+"OS";break;case 116:p.key=n?f.C0.ESC+"[15;"+(n+1)+"~":f.C0.ESC+"[15~";break;case 117:p.key=n?f.C0.ESC+"[17;"+(n+1)+"~":f.C0.ESC+"[17~";break;case 118:p.key=n?f.C0.ESC+"[18;"+(n+1)+"~":f.C0.ESC+"[18~";break;case 119:p.key=n?f.C0.ESC+"[19;"+(n+1)+"~":f.C0.ESC+"[19~";break;case 120:p.key=n?f.C0.ESC+"[20;"+(n+1)+"~":f.C0.ESC+"[20~";break;case 121:p.key=n?f.C0.ESC+"[21;"+(n+1)+"~":f.C0.ESC+"[21~";break;case 122:p.key=n?f.C0.ESC+"[23;"+(n+1)+"~":f.C0.ESC+"[23~";break;case 123:p.key=n?f.C0.ESC+"[24;"+(n+1)+"~":f.C0.ESC+"[24~";break;default:if(!c.ctrlKey||c.shiftKey||c.altKey||c.metaKey)if(_&&!S||!c.altKey||c.metaKey)!_||c.altKey||c.ctrlKey||c.shiftKey||!c.metaKey?c.key&&!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.keyCode>=48&&c.key.length===1?p.key=c.key:c.key&&c.ctrlKey&&(c.key==="_"&&(p.key=f.C0.US),c.key==="@"&&(p.key=f.C0.NUL)):c.keyCode===65&&(p.type=1);else{const o=m[c.keyCode],i=o?.[c.shiftKey?1:0];if(i)p.key=f.C0.ESC+i;else if(c.keyCode>=65&&c.keyCode<=90){const l=c.ctrlKey?c.keyCode-64:c.keyCode+32;let g=String.fromCharCode(l);c.shiftKey&&(g=g.toUpperCase()),p.key=f.C0.ESC+g}else if(c.keyCode===32)p.key=f.C0.ESC+(c.ctrlKey?f.C0.NUL:" ");else if(c.key==="Dead"&&c.code.startsWith("Key")){let l=c.code.slice(3,4);c.shiftKey||(l=l.toLowerCase()),p.key=f.C0.ESC+l,p.cancel=!0}}else c.keyCode>=65&&c.keyCode<=90?p.key=String.fromCharCode(c.keyCode-64):c.keyCode===32?p.key=f.C0.NUL:c.keyCode>=51&&c.keyCode<=55?p.key=String.fromCharCode(c.keyCode-51+27):c.keyCode===56?p.key=f.C0.DEL:c.keyCode===219?p.key=f.C0.ESC:c.keyCode===220?p.key=f.C0.FS:c.keyCode===221&&(p.key=f.C0.GS)}return p}},482:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},s.utf32ToString=function(a,f=0,m=a.length){let c="";for(let h=f;h<m;++h){let _=a[h];_>65535?(_-=65536,c+=String.fromCharCode(55296+(_>>10))+String.fromCharCode(_%1024+56320)):c+=String.fromCharCode(_)}return c},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,f){const m=a.length;if(!m)return 0;let c=0,h=0;if(this._interim){const _=a.charCodeAt(h++);56320<=_&&_<=57343?f[c++]=1024*(this._interim-55296)+_-56320+65536:(f[c++]=this._interim,f[c++]=_),this._interim=0}for(let _=h;_<m;++_){const S=a.charCodeAt(_);if(55296<=S&&S<=56319){if(++_>=m)return this._interim=S,c;const p=a.charCodeAt(_);56320<=p&&p<=57343?f[c++]=1024*(S-55296)+p-56320+65536:(f[c++]=S,f[c++]=p)}else S!==65279&&(f[c++]=S)}return c}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,f){const m=a.length;if(!m)return 0;let c,h,_,S,p=0,n=0,o=0;if(this.interim[0]){let g=!1,x=this.interim[0];x&=(224&x)==192?31:(240&x)==224?15:7;let b,w=0;for(;(b=63&this.interim[++w])&&w<4;)x<<=6,x|=b;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=v-w;for(;o<C;){if(o>=m)return 0;if(b=a[o++],(192&b)!=128){o--,g=!0;break}this.interim[w++]=b,x<<=6,x|=63&b}g||(v===2?x<128?o--:f[p++]=x:v===3?x<2048||x>=55296&&x<=57343||x===65279||(f[p++]=x):x<65536||x>1114111||(f[p++]=x)),this.interim.fill(0)}const i=m-4;let l=o;for(;l<m;){for(;!(!(l<i)||128&(c=a[l])||128&(h=a[l+1])||128&(_=a[l+2])||128&(S=a[l+3]));)f[p++]=c,f[p++]=h,f[p++]=_,f[p++]=S,l+=4;if(c=a[l++],c<128)f[p++]=c;else if((224&c)==192){if(l>=m)return this.interim[0]=c,p;if(h=a[l++],(192&h)!=128){l--;continue}if(n=(31&c)<<6|63&h,n<128){l--;continue}f[p++]=n}else if((240&c)==224){if(l>=m)return this.interim[0]=c,p;if(h=a[l++],(192&h)!=128){l--;continue}if(l>=m)return this.interim[0]=c,this.interim[1]=h,p;if(_=a[l++],(192&_)!=128){l--;continue}if(n=(15&c)<<12|(63&h)<<6|63&_,n<2048||n>=55296&&n<=57343||n===65279)continue;f[p++]=n}else if((248&c)==240){if(l>=m)return this.interim[0]=c,p;if(h=a[l++],(192&h)!=128){l--;continue}if(l>=m)return this.interim[0]=c,this.interim[1]=h,p;if(_=a[l++],(192&_)!=128){l--;continue}if(l>=m)return this.interim[0]=c,this.interim[1]=h,this.interim[2]=_,p;if(S=a[l++],(192&S)!=128){l--;continue}if(n=(7&c)<<18|(63&h)<<12|(63&_)<<6|63&S,n<65536||n>1114111)continue;f[p++]=n}}return p}}},225:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const f=a(1480),m=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let h;s.UnicodeV6=class{constructor(){if(this.version="6",!h){h=new Uint8Array(65536),h.fill(1),h[0]=0,h.fill(0,1,32),h.fill(0,127,160),h.fill(2,4352,4448),h[9001]=2,h[9002]=2,h.fill(2,11904,42192),h[12351]=1,h.fill(2,44032,55204),h.fill(2,63744,64256),h.fill(2,65040,65050),h.fill(2,65072,65136),h.fill(2,65280,65377),h.fill(2,65504,65511);for(let _=0;_<m.length;++_)h.fill(0,m[_][0],m[_][1]+1)}}wcwidth(_){return _<32?0:_<127?1:_<65536?h[_]:function(S,p){let n,o=0,i=p.length-1;if(S<p[0][0]||S>p[i][1])return!1;for(;i>=o;)if(n=o+i>>1,S>p[n][1])o=n+1;else{if(!(S<p[n][0]))return!0;i=n-1}return!1}(_,c)?0:_>=131072&&_<=196605||_>=196608&&_<=262141?2:1}charProperties(_,S){let p=this.wcwidth(_),n=p===0&&S!==0;if(n){const o=f.UnicodeService.extractWidth(S);o===0?n=!1:o>p&&(p=o)}return f.UnicodeService.createPropertyValue(0,p,n)}}},5981:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const f=a(8460),m=a(844);class c extends m.Disposable{constructor(_){super(),this._action=_,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new f.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(_,S){if(S!==void 0&&this._syncCalls>S)return void(this._syncCalls=0);if(this._pendingData+=_.length,this._writeBuffer.push(_),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let p;for(this._isSyncWriting=!0;p=this._writeBuffer.shift();){this._action(p);const n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(_,S){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=_.length,this._writeBuffer.push(_),this._callbacks.push(S),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=_.length,this._writeBuffer.push(_),this._callbacks.push(S)}_innerWrite(_=0,S=!0){const p=_||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const n=this._writeBuffer[this._bufferOffset],o=this._action(n,S);if(o){const l=g=>Date.now()-p>=12?setTimeout(()=>this._innerWrite(0,g)):this._innerWrite(p,g);return void o.catch(g=>(queueMicrotask(()=>{throw g}),Promise.resolve(!1))).then(l)}const i=this._callbacks[this._bufferOffset];if(i&&i(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-p>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=c},5941:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,f=/^[\da-f]+$/;function m(c,h){const _=c.toString(16),S=_.length<2?"0"+_:_;switch(h){case 4:return _[0];case 8:return S;case 12:return(S+S).slice(0,3);default:return S+S}}s.parseColor=function(c){if(!c)return;let h=c.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const _=a.exec(h);if(_){const S=_[1]?15:_[4]?255:_[7]?4095:65535;return[Math.round(parseInt(_[1]||_[4]||_[7]||_[10],16)/S*255),Math.round(parseInt(_[2]||_[5]||_[8]||_[11],16)/S*255),Math.round(parseInt(_[3]||_[6]||_[9]||_[12],16)/S*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),f.exec(h)&&[3,6,9,12].includes(h.length))){const _=h.length/3,S=[0,0,0];for(let p=0;p<3;++p){const n=parseInt(h.slice(_*p,_*p+_),16);S[p]=_===1?n<<4:_===2?n:_===3?n>>4:n>>8}return S}},s.toRgbString=function(c,h=16){const[_,S,p]=c;return`rgb:${m(_,h)}/${m(S,h)}/${m(p,h)}`}},5770:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const f=a(482),m=a(8742),c=a(5770),h=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(S,p){this._handlers[S]===void 0&&(this._handlers[S]=[]);const n=this._handlers[S];return n.push(p),{dispose:()=>{const o=n.indexOf(p);o!==-1&&n.splice(o,1)}}}clearHandler(S){this._handlers[S]&&delete this._handlers[S]}setHandlerFallback(S){this._handlerFb=S}reset(){if(this._active.length)for(let S=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;S>=0;--S)this._active[S].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(S,p){if(this.reset(),this._ident=S,this._active=this._handlers[S]||h,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(p);else this._handlerFb(this._ident,"HOOK",p)}put(S,p,n){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(S,p,n);else this._handlerFb(this._ident,"PUT",(0,f.utf32ToString)(S,p,n))}unhook(S,p=!0){if(this._active.length){let n=!1,o=this._active.length-1,i=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,n=p,i=this._stack.fallThrough,this._stack.paused=!1),!i&&n===!1){for(;o>=0&&(n=this._active[o].unhook(S),n!==!0);o--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,n;o--}for(;o>=0;o--)if(n=this._active[o].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,n}else this._handlerFb(this._ident,"UNHOOK",S);this._active=h,this._ident=0}};const _=new m.Params;_.addParam(0),s.DcsHandler=class{constructor(S){this._handler=S,this._data="",this._params=_,this._hitLimit=!1}hook(S){this._params=S.length>1||S.params[0]?S.clone():_,this._data="",this._hitLimit=!1}put(S,p,n){this._hitLimit||(this._data+=(0,f.utf32ToString)(S,p,n),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(S){let p=!1;if(this._hitLimit)p=!1;else if(S&&(p=this._handler(this._data,this._params),p instanceof Promise))return p.then(n=>(this._params=_,this._data="",this._hitLimit=!1,n));return this._params=_,this._data="",this._hitLimit=!1,p}}},2015:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const f=a(844),m=a(8742),c=a(6242),h=a(6351);class _{constructor(o){this.table=new Uint8Array(o)}setDefault(o,i){this.table.fill(o<<4|i)}add(o,i,l,g){this.table[i<<8|o]=l<<4|g}addMany(o,i,l,g){for(let x=0;x<o.length;x++)this.table[i<<8|o[x]]=l<<4|g}}s.TransitionTable=_;const S=160;s.VT500_TRANSITION_TABLE=function(){const n=new _(4095),o=Array.apply(null,Array(256)).map((w,v)=>v),i=(w,v)=>o.slice(w,v),l=i(32,127),g=i(0,24);g.push(25),g.push.apply(g,i(28,32));const x=i(0,14);let b;for(b in n.setDefault(1,0),n.addMany(l,0,2,0),x)n.addMany([24,26,153,154],b,3,0),n.addMany(i(128,144),b,3,0),n.addMany(i(144,152),b,3,0),n.add(156,b,0,0),n.add(27,b,11,1),n.add(157,b,4,8),n.addMany([152,158,159],b,0,7),n.add(155,b,11,3),n.add(144,b,11,9);return n.addMany(g,0,3,0),n.addMany(g,1,3,1),n.add(127,1,0,1),n.addMany(g,8,0,8),n.addMany(g,3,3,3),n.add(127,3,0,3),n.addMany(g,4,3,4),n.add(127,4,0,4),n.addMany(g,6,3,6),n.addMany(g,5,3,5),n.add(127,5,0,5),n.addMany(g,2,3,2),n.add(127,2,0,2),n.add(93,1,4,8),n.addMany(l,8,5,8),n.add(127,8,5,8),n.addMany([156,27,24,26,7],8,6,0),n.addMany(i(28,32),8,0,8),n.addMany([88,94,95],1,0,7),n.addMany(l,7,0,7),n.addMany(g,7,0,7),n.add(156,7,0,0),n.add(127,7,0,7),n.add(91,1,11,3),n.addMany(i(64,127),3,7,0),n.addMany(i(48,60),3,8,4),n.addMany([60,61,62,63],3,9,4),n.addMany(i(48,60),4,8,4),n.addMany(i(64,127),4,7,0),n.addMany([60,61,62,63],4,0,6),n.addMany(i(32,64),6,0,6),n.add(127,6,0,6),n.addMany(i(64,127),6,0,0),n.addMany(i(32,48),3,9,5),n.addMany(i(32,48),5,9,5),n.addMany(i(48,64),5,0,6),n.addMany(i(64,127),5,7,0),n.addMany(i(32,48),4,9,5),n.addMany(i(32,48),1,9,2),n.addMany(i(32,48),2,9,2),n.addMany(i(48,127),2,10,0),n.addMany(i(48,80),1,10,0),n.addMany(i(81,88),1,10,0),n.addMany([89,90,92],1,10,0),n.addMany(i(96,127),1,10,0),n.add(80,1,11,9),n.addMany(g,9,0,9),n.add(127,9,0,9),n.addMany(i(28,32),9,0,9),n.addMany(i(32,48),9,9,12),n.addMany(i(48,60),9,8,10),n.addMany([60,61,62,63],9,9,10),n.addMany(g,11,0,11),n.addMany(i(32,128),11,0,11),n.addMany(i(28,32),11,0,11),n.addMany(g,10,0,10),n.add(127,10,0,10),n.addMany(i(28,32),10,0,10),n.addMany(i(48,60),10,8,10),n.addMany([60,61,62,63],10,0,11),n.addMany(i(32,48),10,9,12),n.addMany(g,12,0,12),n.add(127,12,0,12),n.addMany(i(28,32),12,0,12),n.addMany(i(32,48),12,9,12),n.addMany(i(48,64),12,0,11),n.addMany(i(64,127),12,12,13),n.addMany(i(64,127),10,12,13),n.addMany(i(64,127),9,12,13),n.addMany(g,13,13,13),n.addMany(l,13,13,13),n.add(127,13,0,13),n.addMany([27,156,24,26],13,14,0),n.add(S,0,2,0),n.add(S,8,5,8),n.add(S,6,0,6),n.add(S,11,0,11),n.add(S,13,13,13),n}();class p extends f.Disposable{constructor(o=s.VT500_TRANSITION_TABLE){super(),this._transitions=o,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new m.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(i,l,g)=>{},this._executeHandlerFb=i=>{},this._csiHandlerFb=(i,l)=>{},this._escHandlerFb=i=>{},this._errorHandlerFb=i=>i,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,f.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new c.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(o,i=[64,126]){let l=0;if(o.prefix){if(o.prefix.length>1)throw new Error("only one byte as prefix supported");if(l=o.prefix.charCodeAt(0),l&&60>l||l>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(o.intermediates){if(o.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let x=0;x<o.intermediates.length;++x){const b=o.intermediates.charCodeAt(x);if(32>b||b>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");l<<=8,l|=b}}if(o.final.length!==1)throw new Error("final must be a single byte");const g=o.final.charCodeAt(0);if(i[0]>g||g>i[1])throw new Error(`final must be in range ${i[0]} .. ${i[1]}`);return l<<=8,l|=g,l}identToString(o){const i=[];for(;o;)i.push(String.fromCharCode(255&o)),o>>=8;return i.reverse().join("")}setPrintHandler(o){this._printHandler=o}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(o,i){const l=this._identifier(o,[48,126]);this._escHandlers[l]===void 0&&(this._escHandlers[l]=[]);const g=this._escHandlers[l];return g.push(i),{dispose:()=>{const x=g.indexOf(i);x!==-1&&g.splice(x,1)}}}clearEscHandler(o){this._escHandlers[this._identifier(o,[48,126])]&&delete this._escHandlers[this._identifier(o,[48,126])]}setEscHandlerFallback(o){this._escHandlerFb=o}setExecuteHandler(o,i){this._executeHandlers[o.charCodeAt(0)]=i}clearExecuteHandler(o){this._executeHandlers[o.charCodeAt(0)]&&delete this._executeHandlers[o.charCodeAt(0)]}setExecuteHandlerFallback(o){this._executeHandlerFb=o}registerCsiHandler(o,i){const l=this._identifier(o);this._csiHandlers[l]===void 0&&(this._csiHandlers[l]=[]);const g=this._csiHandlers[l];return g.push(i),{dispose:()=>{const x=g.indexOf(i);x!==-1&&g.splice(x,1)}}}clearCsiHandler(o){this._csiHandlers[this._identifier(o)]&&delete this._csiHandlers[this._identifier(o)]}setCsiHandlerFallback(o){this._csiHandlerFb=o}registerDcsHandler(o,i){return this._dcsParser.registerHandler(this._identifier(o),i)}clearDcsHandler(o){this._dcsParser.clearHandler(this._identifier(o))}setDcsHandlerFallback(o){this._dcsParser.setHandlerFallback(o)}registerOscHandler(o,i){return this._oscParser.registerHandler(o,i)}clearOscHandler(o){this._oscParser.clearHandler(o)}setOscHandlerFallback(o){this._oscParser.setHandlerFallback(o)}setErrorHandler(o){this._errorHandler=o}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(o,i,l,g,x){this._parseStack.state=o,this._parseStack.handlers=i,this._parseStack.handlerPos=l,this._parseStack.transition=g,this._parseStack.chunkPos=x}parse(o,i,l){let g,x=0,b=0,w=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,w=this._parseStack.chunkPos+1;else{if(l===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const v=this._parseStack.handlers;let C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(l===!1&&C>-1){for(;C>=0&&(g=v[C](this._params),g!==!0);C--)if(g instanceof Promise)return this._parseStack.handlerPos=C,g}this._parseStack.handlers=[];break;case 4:if(l===!1&&C>-1){for(;C>=0&&(g=v[C](),g!==!0);C--)if(g instanceof Promise)return this._parseStack.handlerPos=C,g}this._parseStack.handlers=[];break;case 6:if(x=o[this._parseStack.chunkPos],g=this._dcsParser.unhook(x!==24&&x!==26,l),g)return g;x===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(x=o[this._parseStack.chunkPos],g=this._oscParser.end(x!==24&&x!==26,l),g)return g;x===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,w=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let v=w;v<i;++v){switch(x=o[v],b=this._transitions.table[this.currentState<<8|(x<160?x:S)],b>>4){case 2:for(let D=v+1;;++D){if(D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}if(++D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}if(++D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}if(++D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}}break;case 3:this._executeHandlers[x]?this._executeHandlers[x]():this._executeHandlerFb(x),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:x,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const C=this._csiHandlers[this._collect<<8|x];let T=C?C.length-1:-1;for(;T>=0&&(g=C[T](this._params),g!==!0);T--)if(g instanceof Promise)return this._preserveStack(3,C,T,b,v),g;T<0&&this._csiHandlerFb(this._collect<<8|x,this._params),this.precedingJoinState=0;break;case 8:do switch(x){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(x-48)}while(++v<i&&(x=o[v])>47&&x<60);v--;break;case 9:this._collect<<=8,this._collect|=x;break;case 10:const A=this._escHandlers[this._collect<<8|x];let N=A?A.length-1:-1;for(;N>=0&&(g=A[N](),g!==!0);N--)if(g instanceof Promise)return this._preserveStack(4,A,N,b,v),g;N<0&&this._escHandlerFb(this._collect<<8|x),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|x,this._params);break;case 13:for(let D=v+1;;++D)if(D>=i||(x=o[D])===24||x===26||x===27||x>127&&x<S){this._dcsParser.put(o,v,D),v=D-1;break}break;case 14:if(g=this._dcsParser.unhook(x!==24&&x!==26),g)return this._preserveStack(6,[],0,b,v),g;x===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let D=v+1;;D++)if(D>=i||(x=o[D])<32||x>127&&x<S){this._oscParser.put(o,v,D),v=D-1;break}break;case 6:if(g=this._oscParser.end(x!==24&&x!==26),g)return this._preserveStack(5,[],0,b,v),g;x===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&b}}}s.EscapeSequenceParser=p},6242:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const f=a(5770),m=a(482),c=[];s.OscParser=class{constructor(){this._state=0,this._active=c,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,_){this._handlers[h]===void 0&&(this._handlers[h]=[]);const S=this._handlers[h];return S.push(_),{dispose:()=>{const p=S.indexOf(_);p!==-1&&S.splice(p,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=c,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||c,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,_,S){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(h,_,S);else this._handlerFb(this._id,"PUT",(0,m.utf32ToString)(h,_,S))}start(){this.reset(),this._state=1}put(h,_,S){if(this._state!==3){if(this._state===1)for(;_<S;){const p=h[_++];if(p===59){this._state=2,this._start();break}if(p<48||57<p)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+p-48}this._state===2&&S-_>0&&this._put(h,_,S)}}end(h,_=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let S=!1,p=this._active.length-1,n=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,S=_,n=this._stack.fallThrough,this._stack.paused=!1),!n&&S===!1){for(;p>=0&&(S=this._active[p].end(h),S!==!0);p--)if(S instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,S;p--}for(;p>=0;p--)if(S=this._active[p].end(!1),S instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,S}else this._handlerFb(this._id,"END",h);this._active=c,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,_,S){this._hitLimit||(this._data+=(0,m.utf32ToString)(h,_,S),this._data.length>f.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let _=!1;if(this._hitLimit)_=!1;else if(h&&(_=this._handler(this._data),_ instanceof Promise))return _.then(S=>(this._data="",this._hitLimit=!1,S));return this._data="",this._hitLimit=!1,_}}},8742:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const a=2147483647;class f{static fromArray(c){const h=new f;if(!c.length)return h;for(let _=Array.isArray(c[0])?1:0;_<c.length;++_){const S=c[_];if(Array.isArray(S))for(let p=0;p<S.length;++p)h.addSubParam(S[p]);else h.addParam(S)}return h}constructor(c=32,h=32){if(this.maxLength=c,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(c),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(c),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const c=new f(this.maxLength,this.maxSubParamsLength);return c.params.set(this.params),c.length=this.length,c._subParams.set(this._subParams),c._subParamsLength=this._subParamsLength,c._subParamsIdx.set(this._subParamsIdx),c._rejectDigits=this._rejectDigits,c._rejectSubDigits=this._rejectSubDigits,c._digitIsSub=this._digitIsSub,c}toArray(){const c=[];for(let h=0;h<this.length;++h){c.push(this.params[h]);const _=this._subParamsIdx[h]>>8,S=255&this._subParamsIdx[h];S-_>0&&c.push(Array.prototype.slice.call(this._subParams,_,S))}return c}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(c){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=c>a?a:c}}addSubParam(c){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=c>a?a:c,this._subParamsIdx[this.length-1]++}}hasSubParams(c){return(255&this._subParamsIdx[c])-(this._subParamsIdx[c]>>8)>0}getSubParams(c){const h=this._subParamsIdx[c]>>8,_=255&this._subParamsIdx[c];return _-h>0?this._subParams.subarray(h,_):null}getSubParamsAll(){const c={};for(let h=0;h<this.length;++h){const _=this._subParamsIdx[h]>>8,S=255&this._subParamsIdx[h];S-_>0&&(c[h]=this._subParams.slice(_,S))}return c}addDigit(c){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const _=this._digitIsSub?this._subParams:this.params,S=_[h-1];_[h-1]=~S?Math.min(10*S+c,a):c}}s.Params=f},5741:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,f){const m={instance:f,dispose:f.dispose,isDisposed:!1};this._addons.push(m),f.dispose=()=>this._wrappedAddonDispose(m),f.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let f=-1;for(let m=0;m<this._addons.length;m++)if(this._addons[m]===a){f=m;break}if(f===-1)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(f,1)}}},8771:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const f=a(3785),m=a(511);s.BufferApiView=class{constructor(c,h){this._buffer=c,this.type=h}init(c){return this._buffer=c,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(c){const h=this._buffer.lines.get(c);if(h)return new f.BufferLineApiView(h)}getNullCell(){return new m.CellData}}},3785:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const f=a(511);s.BufferLineApiView=class{constructor(m){this._line=m}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(m,c){if(!(m<0||m>=this._line.length))return c?(this._line.loadCell(m,c),c):this._line.loadCell(m,new f.CellData)}translateToString(m,c,h){return this._line.translateToString(m,c,h)}}},8285:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const f=a(8771),m=a(8460),c=a(844);class h extends c.Disposable{constructor(S){super(),this._core=S,this._onBufferChange=this.register(new m.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new f.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new f.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}s.BufferNamespaceApi=h},7975:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,f){return this._core.registerCsiHandler(a,m=>f(m.toArray()))}addCsiHandler(a,f){return this.registerCsiHandler(a,f)}registerDcsHandler(a,f){return this._core.registerDcsHandler(a,(m,c)=>f(m,c.toArray()))}addDcsHandler(a,f){return this.registerDcsHandler(a,f)}registerEscHandler(a,f){return this._core.registerEscHandler(a,f)}addEscHandler(a,f){return this.registerEscHandler(a,f)}registerOscHandler(a,f){return this._core.registerOscHandler(a,f)}addOscHandler(a,f){return this.registerOscHandler(a,f)}}},7090:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(E,s,a){var f=this&&this.__decorate||function(n,o,i,l){var g,x=arguments.length,b=x<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,i):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(n,o,i,l);else for(var w=n.length-1;w>=0;w--)(g=n[w])&&(b=(x<3?g(b):x>3?g(o,i,b):g(o,i))||b);return x>3&&b&&Object.defineProperty(o,i,b),b},m=this&&this.__param||function(n,o){return function(i,l){o(i,l,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const c=a(8460),h=a(844),_=a(5295),S=a(2585);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let p=s.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(n){super(),this.isUserScrolling=!1,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new c.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(n.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(n.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new _.BufferSet(n,this))}resize(n,o){this.cols=n,this.rows=o,this.buffers.resize(n,o),this._onResize.fire({cols:n,rows:o})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(n,o=!1){const i=this.buffer;let l;l=this._cachedBlankLine,l&&l.length===this.cols&&l.getFg(0)===n.fg&&l.getBg(0)===n.bg||(l=i.getBlankLine(n,o),this._cachedBlankLine=l),l.isWrapped=o;const g=i.ybase+i.scrollTop,x=i.ybase+i.scrollBottom;if(i.scrollTop===0){const b=i.lines.isFull;x===i.lines.length-1?b?i.lines.recycle().copyFrom(l):i.lines.push(l.clone()):i.lines.splice(x+1,0,l.clone()),b?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{const b=x-g+1;i.lines.shiftElements(g+1,b-1,-1),i.lines.set(x,l.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(n,o,i){const l=this.buffer;if(n<0){if(l.ydisp===0)return;this.isUserScrolling=!0}else n+l.ydisp>=l.ybase&&(this.isUserScrolling=!1);const g=l.ydisp;l.ydisp=Math.max(Math.min(l.ydisp+n,l.ybase),0),g!==l.ydisp&&(o||this._onScroll.fire(l.ydisp))}};s.BufferService=p=f([m(0,S.IOptionsService)],p)},7994:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,f){this._charsets[a]=f,this.glevel===a&&(this.charset=f)}}},1753:function(E,s,a){var f=this&&this.__decorate||function(l,g,x,b){var w,v=arguments.length,C=v<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,x):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,g,x,b);else for(var T=l.length-1;T>=0;T--)(w=l[T])&&(C=(v<3?w(C):v>3?w(g,x,C):w(g,x))||C);return v>3&&C&&Object.defineProperty(g,x,C),C},m=this&&this.__param||function(l,g){return function(x,b){g(x,b,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const c=a(2585),h=a(8460),_=a(844),S={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:l=>l.button!==4&&l.action===1&&(l.ctrl=!1,l.alt=!1,l.shift=!1,!0)},VT200:{events:19,restrict:l=>l.action!==32},DRAG:{events:23,restrict:l=>l.action!==32||l.button!==3},ANY:{events:31,restrict:l=>!0}};function p(l,g){let x=(l.ctrl?16:0)|(l.shift?4:0)|(l.alt?8:0);return l.button===4?(x|=64,x|=l.action):(x|=3&l.button,4&l.button&&(x|=64),8&l.button&&(x|=128),l.action===32?x|=32:l.action!==0||g||(x|=3)),x}const n=String.fromCharCode,o={DEFAULT:l=>{const g=[p(l,!1)+32,l.col+32,l.row+32];return g[0]>255||g[1]>255||g[2]>255?"":`\x1B[M${n(g[0])}${n(g[1])}${n(g[2])}`},SGR:l=>{const g=l.action===0&&l.button!==4?"m":"M";return`\x1B[<${p(l,!0)};${l.col};${l.row}${g}`},SGR_PIXELS:l=>{const g=l.action===0&&l.button!==4?"m":"M";return`\x1B[<${p(l,!0)};${l.x};${l.y}${g}`}};let i=s.CoreMouseService=class extends _.Disposable{constructor(l,g){super(),this._bufferService=l,this._coreService=g,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const x of Object.keys(S))this.addProtocol(x,S[x]);for(const x of Object.keys(o))this.addEncoding(x,o[x]);this.reset()}addProtocol(l,g){this._protocols[l]=g}addEncoding(l,g){this._encodings[l]=g}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(l){if(!this._protocols[l])throw new Error(`unknown protocol "${l}"`);this._activeProtocol=l,this._onProtocolChange.fire(this._protocols[l].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(l){if(!this._encodings[l])throw new Error(`unknown encoding "${l}"`);this._activeEncoding=l}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(l){if(l.col<0||l.col>=this._bufferService.cols||l.row<0||l.row>=this._bufferService.rows||l.button===4&&l.action===32||l.button===3&&l.action!==32||l.button!==4&&(l.action===2||l.action===3)||(l.col++,l.row++,l.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,l,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(l))return!1;const g=this._encodings[this._activeEncoding](l);return g&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(g):this._coreService.triggerDataEvent(g,!0)),this._lastEvent=l,!0}explainEvents(l){return{down:!!(1&l),up:!!(2&l),drag:!!(4&l),move:!!(8&l),wheel:!!(16&l)}}_equalEvents(l,g,x){if(x){if(l.x!==g.x||l.y!==g.y)return!1}else if(l.col!==g.col||l.row!==g.row)return!1;return l.button===g.button&&l.action===g.action&&l.ctrl===g.ctrl&&l.alt===g.alt&&l.shift===g.shift}};s.CoreMouseService=i=f([m(0,c.IBufferService),m(1,c.ICoreService)],i)},6975:function(E,s,a){var f=this&&this.__decorate||function(i,l,g,x){var b,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(b=i[C])&&(v=(w<3?b(v):w>3?b(l,g,v):b(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},m=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const c=a(1439),h=a(8460),_=a(844),S=a(2585),p=Object.freeze({insertMode:!1}),n=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let o=s.CoreService=class extends _.Disposable{constructor(i,l,g){super(),this._bufferService=i,this._logService=l,this._optionsService=g,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,c.clone)(p),this.decPrivateModes=(0,c.clone)(n)}reset(){this.modes=(0,c.clone)(p),this.decPrivateModes=(0,c.clone)(n)}triggerDataEvent(i,l=!1){if(this._optionsService.rawOptions.disableStdin)return;const g=this._bufferService.buffer;l&&this._optionsService.rawOptions.scrollOnUserInput&&g.ybase!==g.ydisp&&this._onRequestScrollToBottom.fire(),l&&this._onUserInput.fire(),this._logService.debug(`sending data "${i}"`,()=>i.split("").map(x=>x.charCodeAt(0))),this._onData.fire(i)}triggerBinaryEvent(i){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${i}"`,()=>i.split("").map(l=>l.charCodeAt(0))),this._onBinary.fire(i))}};s.CoreService=o=f([m(0,S.IBufferService),m(1,S.ILogService),m(2,S.IOptionsService)],o)},9074:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const f=a(8055),m=a(8460),c=a(844),h=a(6106);let _=0,S=0;class p extends c.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(i=>i?.marker.line),this._onDecorationRegistered=this.register(new m.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new m.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,c.toDisposable)(()=>this.reset()))}registerDecoration(i){if(i.marker.isDisposed)return;const l=new n(i);if(l){const g=l.marker.onDispose(()=>l.dispose());l.onDispose(()=>{l&&(this._decorations.delete(l)&&this._onDecorationRemoved.fire(l),g.dispose())}),this._decorations.insert(l),this._onDecorationRegistered.fire(l)}return l}reset(){for(const i of this._decorations.values())i.dispose();this._decorations.clear()}*getDecorationsAtCell(i,l,g){let x=0,b=0;for(const w of this._decorations.getKeyIterator(l))x=w.options.x??0,b=x+(w.options.width??1),i>=x&&i<b&&(!g||(w.options.layer??"bottom")===g)&&(yield w)}forEachDecorationAtCell(i,l,g,x){this._decorations.forEachByKey(l,b=>{_=b.options.x??0,S=_+(b.options.width??1),i>=_&&i<S&&(!g||(b.options.layer??"bottom")===g)&&x(b)})}}s.DecorationService=p;class n extends c.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=f.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=f.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(i){super(),this.options=i,this.onRenderEmitter=this.register(new m.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new m.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=i.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const f=a(2585),m=a(8343);class c{constructor(..._){this._entries=new Map;for(const[S,p]of _)this.set(S,p)}set(_,S){const p=this._entries.get(_);return this._entries.set(_,S),p}forEach(_){for(const[S,p]of this._entries.entries())_(S,p)}has(_){return this._entries.has(_)}get(_){return this._entries.get(_)}}s.ServiceCollection=c,s.InstantiationService=class{constructor(){this._services=new c,this._services.set(f.IInstantiationService,this)}setService(h,_){this._services.set(h,_)}getService(h){return this._services.get(h)}createInstance(h,..._){const S=(0,m.getServiceDependencies)(h).sort((o,i)=>o.index-i.index),p=[];for(const o of S){const i=this._services.get(o.id);if(!i)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${o.id}.`);p.push(i)}const n=S.length>0?S[0].index:_.length;if(_.length!==n)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${n+1} conflicts with ${_.length} static arguments`);return new h(..._,...p)}}},7866:function(E,s,a){var f=this&&this.__decorate||function(n,o,i,l){var g,x=arguments.length,b=x<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,i):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(n,o,i,l);else for(var w=n.length-1;w>=0;w--)(g=n[w])&&(b=(x<3?g(b):x>3?g(o,i,b):g(o,i))||b);return x>3&&b&&Object.defineProperty(o,i,b),b},m=this&&this.__param||function(n,o){return function(i,l){o(i,l,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.traceCall=s.setTraceLogger=s.LogService=void 0;const c=a(844),h=a(2585),_={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let S,p=s.LogService=class extends c.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),S=this}_updateLogLevel(){this._logLevel=_[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let o=0;o<n.length;o++)typeof n[o]=="function"&&(n[o]=n[o]())}_log(n,o,i){this._evalLazyOptionalParams(i),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...i)}trace(n,...o){this._logLevel<=h.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,n,o)}debug(n,...o){this._logLevel<=h.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,n,o)}info(n,...o){this._logLevel<=h.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,n,o)}warn(n,...o){this._logLevel<=h.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,n,o)}error(n,...o){this._logLevel<=h.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,n,o)}};s.LogService=p=f([m(0,h.IOptionsService)],p),s.setTraceLogger=function(n){S=n},s.traceCall=function(n,o,i){if(typeof i.value!="function")throw new Error("not supported");const l=i.value;i.value=function(...g){if(S.logLevel!==h.LogLevelEnum.TRACE)return l.apply(this,g);S.trace(`GlyphRenderer#${l.name}(${g.map(b=>JSON.stringify(b)).join(", ")})`);const x=l.apply(this,g);return S.trace(`GlyphRenderer#${l.name} return`,x),x}}},7302:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const f=a(8460),m=a(844),c=a(6114);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:c.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class _ extends m.Disposable{constructor(p){super(),this._onOptionChange=this.register(new f.EventEmitter),this.onOptionChange=this._onOptionChange.event;const n={...s.DEFAULT_OPTIONS};for(const o in p)if(o in n)try{const i=p[o];n[o]=this._sanitizeAndValidateOption(o,i)}catch(i){console.error(i)}this.rawOptions=n,this.options={...n},this._setupOptions(),this.register((0,m.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(p,n){return this.onOptionChange(o=>{o===p&&n(this.rawOptions[p])})}onMultipleOptionChange(p,n){return this.onOptionChange(o=>{p.indexOf(o)!==-1&&n()})}_setupOptions(){const p=o=>{if(!(o in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);return this.rawOptions[o]},n=(o,i)=>{if(!(o in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);i=this._sanitizeAndValidateOption(o,i),this.rawOptions[o]!==i&&(this.rawOptions[o]=i,this._onOptionChange.fire(o))};for(const o in this.rawOptions){const i={get:p.bind(this,o),set:n.bind(this,o)};Object.defineProperty(this.options,o,i)}}_sanitizeAndValidateOption(p,n){switch(p){case"cursorStyle":if(n||(n=s.DEFAULT_OPTIONS[p]),!function(o){return o==="block"||o==="underline"||o==="bar"}(n))throw new Error(`"${n}" is not a valid value for ${p}`);break;case"wordSeparator":n||(n=s.DEFAULT_OPTIONS[p]);break;case"fontWeight":case"fontWeightBold":if(typeof n=="number"&&1<=n&&n<=1e3)break;n=h.includes(n)?n:s.DEFAULT_OPTIONS[p];break;case"cursorWidth":n=Math.floor(n);case"lineHeight":case"tabStopWidth":if(n<1)throw new Error(`${p} cannot be less than 1, value: ${n}`);break;case"minimumContrastRatio":n=Math.max(1,Math.min(21,Math.round(10*n)/10));break;case"scrollback":if((n=Math.min(n,4294967295))<0)throw new Error(`${p} cannot be less than 0, value: ${n}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(n<=0)throw new Error(`${p} cannot be less than or equal to 0, value: ${n}`);break;case"rows":case"cols":if(!n&&n!==0)throw new Error(`${p} must be numeric, value: ${n}`);break;case"windowsPty":n=n??{}}return n}}s.OptionsService=_},2660:function(E,s,a){var f=this&&this.__decorate||function(_,S,p,n){var o,i=arguments.length,l=i<3?S:n===null?n=Object.getOwnPropertyDescriptor(S,p):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(_,S,p,n);else for(var g=_.length-1;g>=0;g--)(o=_[g])&&(l=(i<3?o(l):i>3?o(S,p,l):o(S,p))||l);return i>3&&l&&Object.defineProperty(S,p,l),l},m=this&&this.__param||function(_,S){return function(p,n){S(p,n,_)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const c=a(2585);let h=s.OscLinkService=class{constructor(_){this._bufferService=_,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(_){const S=this._bufferService.buffer;if(_.id===void 0){const g=S.addMarker(S.ybase+S.y),x={data:_,id:this._nextId++,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(x,g)),this._dataByLinkId.set(x.id,x),x.id}const p=_,n=this._getEntryIdKey(p),o=this._entriesWithId.get(n);if(o)return this.addLineToLink(o.id,S.ybase+S.y),o.id;const i=S.addMarker(S.ybase+S.y),l={id:this._nextId++,key:this._getEntryIdKey(p),data:p,lines:[i]};return i.onDispose(()=>this._removeMarkerFromLink(l,i)),this._entriesWithId.set(l.key,l),this._dataByLinkId.set(l.id,l),l.id}addLineToLink(_,S){const p=this._dataByLinkId.get(_);if(p&&p.lines.every(n=>n.line!==S)){const n=this._bufferService.buffer.addMarker(S);p.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(p,n))}}getLinkData(_){return this._dataByLinkId.get(_)?.data}_getEntryIdKey(_){return`${_.id};;${_.uri}`}_removeMarkerFromLink(_,S){const p=_.lines.indexOf(S);p!==-1&&(_.lines.splice(p,1),_.lines.length===0&&(_.data.id!==void 0&&this._entriesWithId.delete(_.key),this._dataByLinkId.delete(_.id)))}};s.OscLinkService=h=f([m(0,c.IBufferService)],h)},8343:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0;const a="di$target",f="di$dependencies";s.serviceRegistry=new Map,s.getServiceDependencies=function(m){return m[f]||[]},s.createDecorator=function(m){if(s.serviceRegistry.has(m))return s.serviceRegistry.get(m);const c=function(h,_,S){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(p,n,o){n[a]===n?n[f].push({id:p,index:o}):(n[f]=[{id:p,index:o}],n[a]=n)})(c,h,S)};return c.toString=()=>m,s.serviceRegistry.set(m,c),c}},2585:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const f=a(8343);var m;s.IBufferService=(0,f.createDecorator)("BufferService"),s.ICoreMouseService=(0,f.createDecorator)("CoreMouseService"),s.ICoreService=(0,f.createDecorator)("CoreService"),s.ICharsetService=(0,f.createDecorator)("CharsetService"),s.IInstantiationService=(0,f.createDecorator)("InstantiationService"),function(c){c[c.TRACE=0]="TRACE",c[c.DEBUG=1]="DEBUG",c[c.INFO=2]="INFO",c[c.WARN=3]="WARN",c[c.ERROR=4]="ERROR",c[c.OFF=5]="OFF"}(m||(s.LogLevelEnum=m={})),s.ILogService=(0,f.createDecorator)("LogService"),s.IOptionsService=(0,f.createDecorator)("OptionsService"),s.IOscLinkService=(0,f.createDecorator)("OscLinkService"),s.IUnicodeService=(0,f.createDecorator)("UnicodeService"),s.IDecorationService=(0,f.createDecorator)("DecorationService")},1480:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const f=a(8460),m=a(225);class c{static extractShouldJoin(_){return(1&_)!=0}static extractWidth(_){return _>>1&3}static extractCharKind(_){return _>>3}static createPropertyValue(_,S,p=!1){return(16777215&_)<<3|(3&S)<<1|(p?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new f.EventEmitter,this.onChange=this._onChange.event;const _=new m.UnicodeV6;this.register(_),this._active=_.version,this._activeProvider=_}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(_){if(!this._providers[_])throw new Error(`unknown Unicode version "${_}"`);this._active=_,this._activeProvider=this._providers[_],this._onChange.fire(_)}register(_){this._providers[_.version]=_}wcwidth(_){return this._activeProvider.wcwidth(_)}getStringCellWidth(_){let S=0,p=0;const n=_.length;for(let o=0;o<n;++o){let i=_.charCodeAt(o);if(55296<=i&&i<=56319){if(++o>=n)return S+this.wcwidth(i);const x=_.charCodeAt(o);56320<=x&&x<=57343?i=1024*(i-55296)+x-56320+65536:S+=this.wcwidth(x)}const l=this.charProperties(i,p);let g=c.extractWidth(l);c.extractShouldJoin(l)&&(g-=c.extractWidth(p)),S+=g,p=l}return S}charProperties(_,S){return this._activeProvider.charProperties(_,S)}}s.UnicodeService=c}},d={};function y(E){var s=d[E];if(s!==void 0)return s.exports;var a=d[E]={exports:{}};return t[E].call(a.exports,a,a.exports,y),a.exports}var k={};return(()=>{var E=k;Object.defineProperty(E,"__esModule",{value:!0}),E.Terminal=void 0;const s=y(9042),a=y(3236),f=y(844),m=y(5741),c=y(8285),h=y(7975),_=y(7090),S=["cols","rows"];class p extends f.Disposable{constructor(o){super(),this._core=this.register(new a.Terminal(o)),this._addonManager=this.register(new m.AddonManager),this._publicOptions={...this._core.options};const i=g=>this._core.options[g],l=(g,x)=>{this._checkReadonlyOptions(g),this._core.options[g]=x};for(const g in this._core.options){const x={get:i.bind(this,g),set:l.bind(this,g)};Object.defineProperty(this._publicOptions,g,x)}}_checkReadonlyOptions(o){if(S.includes(o))throw new Error(`Option "${o}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new _.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new c.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const o=this._core.coreService.decPrivateModes;let i="none";switch(this._core.coreMouseService.activeProtocol){case"X10":i="x10";break;case"VT200":i="vt200";break;case"DRAG":i="drag";break;case"ANY":i="any"}return{applicationCursorKeysMode:o.applicationCursorKeys,applicationKeypadMode:o.applicationKeypad,bracketedPasteMode:o.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:i,originMode:o.origin,reverseWraparoundMode:o.reverseWraparound,sendFocusMode:o.sendFocus,wraparoundMode:o.wraparound}}get options(){return this._publicOptions}set options(o){for(const i in o)this._publicOptions[i]=o[i]}blur(){this._core.blur()}focus(){this._core.focus()}input(o,i=!0){this._core.input(o,i)}resize(o,i){this._verifyIntegers(o,i),this._core.resize(o,i)}open(o){this._core.open(o)}attachCustomKeyEventHandler(o){this._core.attachCustomKeyEventHandler(o)}attachCustomWheelEventHandler(o){this._core.attachCustomWheelEventHandler(o)}registerLinkProvider(o){return this._core.registerLinkProvider(o)}registerCharacterJoiner(o){return this._checkProposedApi(),this._core.registerCharacterJoiner(o)}deregisterCharacterJoiner(o){this._checkProposedApi(),this._core.deregisterCharacterJoiner(o)}registerMarker(o=0){return this._verifyIntegers(o),this._core.registerMarker(o)}registerDecoration(o){return this._checkProposedApi(),this._verifyPositiveIntegers(o.x??0,o.width??0,o.height??0),this._core.registerDecoration(o)}hasSelection(){return this._core.hasSelection()}select(o,i,l){this._verifyIntegers(o,i,l),this._core.select(o,i,l)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(o,i){this._verifyIntegers(o,i),this._core.selectLines(o,i)}dispose(){super.dispose()}scrollLines(o){this._verifyIntegers(o),this._core.scrollLines(o)}scrollPages(o){this._verifyIntegers(o),this._core.scrollPages(o)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(o){this._verifyIntegers(o),this._core.scrollToLine(o)}clear(){this._core.clear()}write(o,i){this._core.write(o,i)}writeln(o,i){this._core.write(o),this._core.write(`\r
`,i)}paste(o){this._core.paste(o)}refresh(o,i){this._verifyIntegers(o,i),this._core.refresh(o,i)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(o){this._addonManager.loadAddon(this,o)}static get strings(){return s}_verifyIntegers(...o){for(const i of o)if(i===1/0||isNaN(i)||i%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...o){for(const i of o)if(i&&(i===1/0||isNaN(i)||i%1!=0||i<0))throw new Error("This API only accepts positive integers")}}E.Terminal=p})(),k})())}(ns)),ns.exports}var mc=_c(),os={exports:{}},kr;function gc(){return kr||(kr=1,function(r,e){(function(t,d){r.exports=d()})(self,()=>(()=>{var t={};return(()=>{var d=t;Object.defineProperty(d,"__esModule",{value:!0}),d.FitAddon=void 0,d.FitAddon=class{activate(y){this._terminal=y}dispose(){}fit(){const y=this.proposeDimensions();if(!y||!this._terminal||isNaN(y.cols)||isNaN(y.rows))return;const k=this._terminal._core;this._terminal.rows===y.rows&&this._terminal.cols===y.cols||(k._renderService.clear(),this._terminal.resize(y.cols,y.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const y=this._terminal._core,k=y._renderService.dimensions;if(k.css.cell.width===0||k.css.cell.height===0)return;const E=this._terminal.options.scrollback===0?0:y.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(s.getPropertyValue("height")),f=Math.max(0,parseInt(s.getPropertyValue("width"))),m=window.getComputedStyle(this._terminal.element),c=a-(parseInt(m.getPropertyValue("padding-top"))+parseInt(m.getPropertyValue("padding-bottom"))),h=f-(parseInt(m.getPropertyValue("padding-right"))+parseInt(m.getPropertyValue("padding-left")))-E;return{cols:Math.max(2,Math.floor(h/k.css.cell.width)),rows:Math.max(1,Math.floor(c/k.css.cell.height))}}}})(),t})())}(os)),os.exports}var vc=gc(),as={exports:{}},Rr;function Sc(){return Rr||(Rr=1,function(r,e){(function(t,d){r.exports=d()})(self,()=>(()=>{var t={6:(E,s)=>{function a(m){try{const c=new URL(m),h=c.password&&c.username?`${c.protocol}//${c.username}:${c.password}@${c.host}`:c.username?`${c.protocol}//${c.username}@${c.host}`:`${c.protocol}//${c.host}`;return m.toLocaleLowerCase().startsWith(h.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.LinkComputer=s.WebLinkProvider=void 0,s.WebLinkProvider=class{constructor(m,c,h,_={}){this._terminal=m,this._regex=c,this._handler=h,this._options=_}provideLinks(m,c){const h=f.computeLink(m,this._regex,this._terminal,this._handler);c(this._addCallbacks(h))}_addCallbacks(m){return m.map(c=>(c.leave=this._options.leave,c.hover=(h,_)=>{if(this._options.hover){const{range:S}=c;this._options.hover(h,_,S)}},c))}};class f{static computeLink(c,h,_,S){const p=new RegExp(h.source,(h.flags||"")+"g"),[n,o]=f._getWindowedLineStrings(c-1,_),i=n.join("");let l;const g=[];for(;l=p.exec(i);){const x=l[0];if(!a(x))continue;const[b,w]=f._mapStrIdx(_,o,0,l.index),[v,C]=f._mapStrIdx(_,b,w,x.length);if(b===-1||w===-1||v===-1||C===-1)continue;const T={start:{x:w+1,y:b+1},end:{x:C,y:v+1}};g.push({range:T,text:x,activate:S})}return g}static _getWindowedLineStrings(c,h){let _,S=c,p=c,n=0,o="";const i=[];if(_=h.buffer.active.getLine(c)){const l=_.translateToString(!0);if(_.isWrapped&&l[0]!==" "){for(n=0;(_=h.buffer.active.getLine(--S))&&n<2048&&(o=_.translateToString(!0),n+=o.length,i.push(o),_.isWrapped&&o.indexOf(" ")===-1););i.reverse()}for(i.push(l),n=0;(_=h.buffer.active.getLine(++p))&&_.isWrapped&&n<2048&&(o=_.translateToString(!0),n+=o.length,i.push(o),o.indexOf(" ")===-1););}return[i,S]}static _mapStrIdx(c,h,_,S){const p=c.buffer.active,n=p.getNullCell();let o=_;for(;S;){const i=p.getLine(h);if(!i)return[-1,-1];for(let l=o;l<i.length;++l){i.getCell(l,n);const g=n.getChars();if(n.getWidth()&&(S-=g.length||1,l===i.length-1&&g==="")){const x=p.getLine(h+1);x&&x.isWrapped&&(x.getCell(0,n),n.getWidth()===2&&(S+=1))}if(S<0)return[h,l]}h++,o=0}return[h,o]}}s.LinkComputer=f}},d={};function y(E){var s=d[E];if(s!==void 0)return s.exports;var a=d[E]={exports:{}};return t[E](a,a.exports,y),a.exports}var k={};return(()=>{var E=k;Object.defineProperty(E,"__esModule",{value:!0}),E.WebLinksAddon=void 0;const s=y(6),a=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function f(m,c){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=c}else console.warn("Opening link blocked as opener could not be cleared")}E.WebLinksAddon=class{constructor(m=f,c={}){this._handler=m,this._options=c}activate(m){this._terminal=m;const c=this._options,h=c.urlRegex||a;this._linkProvider=this._terminal.registerLinkProvider(new s.WebLinkProvider(this._terminal,h,this._handler,c))}dispose(){this._linkProvider?.dispose()}}})(),k})())}(as)),as.exports}var bc=Sc();function yc({projectId:r="default"}){const[e,t]=M.useState(null),[d,y]=M.useState(null),[k,E]=M.useState(!1),s=M.useRef(null),a=M.useRef(null),f=M.useRef(null),m=M.useRef(null);ve("terminal_session",h=>{h.sessionId===e&&(y(h),E(!1),h.status==="error"&&a.current&&a.current.write(`\r
\x1B[31mError: ${h.error||"Failed to start terminal"}\x1B[0m\r
`))}),ve("terminal_data",h=>{h.sessionId===e&&a.current&&a.current.write(h.data)});const c=M.useCallback(()=>{f.current&&a.current&&setTimeout(()=>{if(f.current&&a.current)try{f.current.fit();const{cols:h,rows:_}=a.current;m.current&&clearTimeout(m.current),m.current=window.setTimeout(()=>{e&&de.resizeTerminal(e,h,_)},200)}catch(h){console.warn("Terminal resize error:",h)}},100)},[e]);return M.useEffect(()=>{if(!s.current||a.current)return;const h=new mc.Terminal({cursorBlink:!0,fontSize:13,fontFamily:"'JetBrains Mono', 'Consolas', 'Monaco', monospace",fontWeight:500,lineHeight:1.4,allowTransparency:!1,convertEol:!0,rows:24,cols:80,theme:{background:"#000000",foreground:"#ffffff",cursor:"hsl(var(--primary))",selectionBackground:"hsl(var(--primary) / 0.3)",black:"#000000",red:"#ff5555",green:"#50fa7b",yellow:"#f1fa8c",blue:"#6272a4",magenta:"#ff79c6",cyan:"#8be9fd",white:"#f8f8f2",brightBlack:"#6272a4",brightRed:"#ff6e6e",brightGreen:"#69ff94",brightYellow:"#ffffa5",brightBlue:"#8be9fd",brightMagenta:"#ff92df",brightCyan:"#a4ffff",brightWhite:"#ffffff"},allowProposedApi:!0}),_=new vc.FitAddon,S=new bc.WebLinksAddon;return h.loadAddon(_),h.loadAddon(S),h.open(s.current),a.current=h,f.current=_,c(),h.write(`Welcome to Colony AI Terminal\r
`),h.write(`Connecting to server...\r
\r
`),h.onData(p=>{e&&d?.status==="running"&&de.sendTerminalData(e,p)}),h.onResize(({cols:p,rows:n})=>{e&&de.resizeTerminal(e,p,n)}),E(!0),de.createTerminalSession(r),()=>{e&&de.closeTerminal(e),h.dispose(),a.current=null,f.current=null}},[r]),ve("terminal_session",h=>{h.projectId===r&&!e&&t(h.sessionId)}),M.useEffect(()=>{const h=new ResizeObserver(()=>{c()});return s.current&&h.observe(s.current),window.addEventListener("resize",c),()=>{h.disconnect(),window.removeEventListener("resize",c),m.current&&clearTimeout(m.current)}},[c]),u.jsx("div",{className:"h-full border border-border rounded-lg bg-card",children:u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Qo,{className:"h-4 w-4 text-primary"}),u.jsx("span",{className:"text-sm font-medium",children:"Terminal"}),k&&u.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[u.jsx(Ht,{className:"h-3 w-3 animate-spin"}),u.jsx("span",{className:"text-xs",children:"Initializing..."})]})]}),d&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${d.status==="running"?"bg-green-500":d.status==="error"?"bg-red-500":"bg-yellow-500"}`}),u.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:d.status})]})]}),u.jsx("div",{ref:s,className:"flex-1",style:{backgroundColor:"#000000",padding:"8px"}})]})})}function xc({currentPhase:r}){const e=()=>{switch(r){case"spec":return u.jsx(Zs,{className:"h-4 w-4"});case"test":return u.jsx(Qs,{className:"h-4 w-4"});case"impl":return u.jsx(er,{className:"h-4 w-4"})}},t=()=>{switch(r){case"spec":return"text-blue-500 bg-blue-500/10 border-blue-500/20";case"test":return"text-amber-500 bg-amber-500/10 border-amber-500/20";case"impl":return"text-violet-500 bg-violet-500/10 border-violet-500/20"}},d=()=>{switch(r){case"spec":return"Specification Phase";case"test":return"Testing Phase";case"impl":return"Implementation Phase"}},y=()=>{switch(r){case"spec":return"Defining project structure and requirements";case"test":return"Writing test cases and validation logic";case"impl":return"Implementing the actual code and features"}},k=[{key:"spec",label:"Specification",icon:u.jsx(Zs,{className:"h-3 w-3"})},{key:"test",label:"Testing",icon:u.jsx(Qs,{className:"h-3 w-3"})},{key:"impl",label:"Implementation",icon:u.jsx(er,{className:"h-3 w-3"})}];return u.jsx("div",{className:"mb-3",children:u.jsxs("div",{className:`rounded-lg border p-3 transition-all duration-300 ${t()}`,children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[e(),u.jsx("span",{className:"font-medium text-sm",children:d()})]}),u.jsx("span",{className:"text-xs opacity-75",children:y()})]}),u.jsx(Yo,{className:"h-3 w-3 opacity-50"})]}),u.jsx("div",{className:"flex items-center gap-1 mt-2",children:k.map((E,s)=>u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:`h-1.5 w-1.5 rounded-full transition-all duration-300 ${E.key===r?"bg-current w-8":k.indexOf(k.find(a=>a.key===r))>s?"bg-current opacity-50":"bg-current opacity-20"}`}),s<k.length-1&&u.jsx("div",{className:`h-0.5 w-4 mx-1 bg-current transition-opacity duration-300 ${k.indexOf(k.find(a=>a.key===r))>s?"opacity-50":"opacity-20"}`})]},E.key))})]})})}function wc({messages:r,onSendMessage:e,onNewChat:t,currentPhase:d="spec",isConnected:y=!1,onMessagesUpdate:k,isLoading:E=!1,onLoadingChange:s,importedProject:a=[]}){const[f,m]=M.useState(!1),[c,h]=M.useState(!1),[_]=M.useState(42),[S]=M.useState(30),[p,n]=M.useState(null),o=()=>{m(!f)},i=()=>{h(!c)},l=(g,x,b)=>{x&&n({path:g,content:x,language:b})};return u.jsx("div",{className:"h-full flex flex-col",children:u.jsxs(cr,{direction:"horizontal",className:"h-full",children:[u.jsx(vt,{defaultSize:_,minSize:f?5:25,maxSize:f?5:60,collapsible:!0,onCollapse:()=>m(!0),onExpand:()=>m(!1),children:u.jsxs("div",{className:"h-full flex flex-col bg-card",children:[u.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:f?u.jsx("div",{className:"h-full flex items-center justify-center",children:u.jsx(ie,{variant:"ghost",size:"sm",onClick:o,className:"rotate-0 hover:rotate-12 transition-transform",children:u.jsx(Ho,{className:"h-4 w-4"})})}):u.jsx(oc,{messages:r,onNewChat:t,isConnected:y,onMessagesUpdate:k,isLoading:E,onLoadingChange:s})}),!f&&u.jsxs("div",{className:"flex-shrink-0 px-4 py-4 border-t border-border bg-card",children:[u.jsx(xc,{currentPhase:d}),u.jsx(ac,{onSendMessage:e,isLoading:E,disabled:!y})]})]})}),u.jsx(hr,{withHandle:!0}),u.jsx(vt,{defaultSize:100-_,children:u.jsx("div",{className:"h-full flex flex-col",children:u.jsxs("div",{className:"flex-1 min-h-0",children:[u.jsxs(cr,{direction:"vertical",children:[u.jsx(vt,{defaultSize:c?100:100-S,minSize:c?100:40,children:u.jsxs("div",{className:"h-full flex",children:[u.jsx("div",{className:"w-64 h-full border border-border rounded-l-lg bg-card",children:u.jsx(cc,{onFileSelect:l,importedProject:a})}),u.jsx("div",{className:"flex-1 h-full border-t border-r border-b border-border rounded-r-lg bg-black",children:u.jsx(pc,{currentPhase:d,selectedFile:p})})]})}),!c&&u.jsxs(u.Fragment,{children:[u.jsx(hr,{withHandle:!0}),u.jsx(vt,{defaultSize:S,minSize:15,maxSize:60,collapsible:!0,onCollapse:()=>h(!0),children:u.jsx("div",{className:"h-full",children:u.jsx(yc,{})})})]})]}),c&&u.jsx("div",{className:"absolute bottom-3 left-1/2 transform -translate-x-1/2",children:u.jsxs(ie,{variant:"outline",size:"sm",onClick:i,className:"bg-background/80 backdrop-blur-sm border-border/50 hover:bg-background/90",children:[u.jsx(Oo,{className:"h-4 w-4 mr-2"}),"Terminal"]})})]})})})]})})}function ys({className:r,type:e,...t}){return u.jsx("input",{type:e,"data-slot":"input",className:te("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...t})}var ls={exports:{}},cs={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lr;function Cc(){if(Lr)return cs;Lr=1;var r=$n();function e(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var t=typeof Object.is=="function"?Object.is:e,d=r.useState,y=r.useEffect,k=r.useLayoutEffect,E=r.useDebugValue;function s(c,h){var _=h(),S=d({inst:{value:_,getSnapshot:h}}),p=S[0].inst,n=S[1];return k(function(){p.value=_,p.getSnapshot=h,a(p)&&n({inst:p})},[c,_,h]),y(function(){return a(p)&&n({inst:p}),c(function(){a(p)&&n({inst:p})})},[c]),E(_),_}function a(c){var h=c.getSnapshot;c=c.value;try{var _=h();return!t(c,_)}catch{return!0}}function f(c,h){return h()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:s;return cs.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:m,cs}var Ar;function Ec(){return Ar||(Ar=1,ls.exports=Cc()),ls.exports}var kc=Ec();function Rc(){return kc.useSyncExternalStore(Lc,()=>!0,()=>!1)}function Lc(){return()=>{}}var Ks="Avatar",[Ac,zh]=It(Ks),[Dc,Ui]=Ac(Ks),qi=M.forwardRef((r,e)=>{const{__scopeAvatar:t,...d}=r,[y,k]=M.useState("idle");return u.jsx(Dc,{scope:t,imageLoadingStatus:y,onImageLoadingStatusChange:k,children:u.jsx(ue.span,{...d,ref:e})})});qi.displayName=Ks;var Ki="AvatarImage",Tc=M.forwardRef((r,e)=>{const{__scopeAvatar:t,src:d,onLoadingStatusChange:y=()=>{},...k}=r,E=Ui(Ki,t),s=Pc(d,k),a=Pe(f=>{y(f),E.onImageLoadingStatusChange(f)});return Lt(()=>{s!=="idle"&&a(s)},[s,a]),s==="loaded"?u.jsx(ue.img,{...k,ref:e,src:d}):null});Tc.displayName=Ki;var Vi="AvatarFallback",Gi=M.forwardRef((r,e)=>{const{__scopeAvatar:t,delayMs:d,...y}=r,k=Ui(Vi,t),[E,s]=M.useState(d===void 0);return M.useEffect(()=>{if(d!==void 0){const a=window.setTimeout(()=>s(!0),d);return()=>window.clearTimeout(a)}},[d]),E&&k.imageLoadingStatus!=="loaded"?u.jsx(ue.span,{...y,ref:e}):null});Gi.displayName=Vi;function Dr(r,e){return r?e?(r.src!==e&&(r.src=e),r.complete&&r.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Pc(r,{referrerPolicy:e,crossOrigin:t}){const d=Rc(),y=M.useRef(null),k=d?(y.current||(y.current=new window.Image),y.current):null,[E,s]=M.useState(()=>Dr(k,r));return Lt(()=>{s(Dr(k,r))},[k,r]),Lt(()=>{const a=c=>()=>{s(c)};if(!k)return;const f=a("loaded"),m=a("error");return k.addEventListener("load",f),k.addEventListener("error",m),e&&(k.referrerPolicy=e),typeof t=="string"&&(k.crossOrigin=t),()=>{k.removeEventListener("load",f),k.removeEventListener("error",m)}},[k,t,e]),E}var Mc=qi,Nc=Gi;function Bc({className:r,...e}){return u.jsx(Mc,{"data-slot":"avatar",className:te("relative flex size-10 shrink-0 overflow-hidden rounded-full",r),...e})}function Ic({className:r,...e}){return u.jsx(Nc,{"data-slot":"avatar-fallback",className:te("bg-muted flex size-full items-center justify-center rounded-full",r),...e})}function Oc({isOpen:r,onClose:e}){const[t,d]=M.useState(""),[y]=M.useState([{id:"1",title:"React Component Development",lastMessage:"Create a React component for a todo list",timestamp:"2 hours ago",messageCount:12,isStarred:!0},{id:"2",title:"Python Data Validation",lastMessage:"Generate a Python function for data validation",timestamp:"1 day ago",messageCount:8},{id:"3",title:"JavaScript Debugging",lastMessage:"Help me debug this JavaScript error",timestamp:"2 days ago",messageCount:15,isStarred:!0},{id:"4",title:"CSS Animation",lastMessage:"Create a CSS animation for loading spinner",timestamp:"1 week ago",messageCount:6},{id:"5",title:"API Integration",lastMessage:"Help with REST API integration",timestamp:"1 week ago",messageCount:10}]),[k]=M.useState([{id:"6",title:"Database Schema Design",lastMessage:"Design a database schema for user management",timestamp:"3 hours ago",messageCount:7},{id:"7",title:"TypeScript Types",lastMessage:"Create TypeScript interfaces for API responses",timestamp:"5 hours ago",messageCount:4},{id:"8",title:"Authentication System",lastMessage:"Implement JWT authentication in Node.js",timestamp:"6 hours ago",messageCount:18}]),E=y.filter(s=>s.isStarred);return r?u.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[u.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e}),u.jsxs("div",{className:"relative w-80 h-full bg-card/95 backdrop-blur-sm border-r border-border/50 shadow-2xl",children:[u.jsxs("div",{className:"p-4 border-b border-border/50 bg-gradient-to-r from-card to-card/80",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Bc,{className:"h-8 w-8",children:u.jsx(Ic,{className:"bg-primary/20 text-primary border border-primary/30",children:"CA"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-medium text-sm",children:"Chat History"}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Colony AI"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ie,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:u.jsx(Gr,{className:"h-4 w-4"})}),u.jsx(ie,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e,children:u.jsx(pt,{className:"h-4 w-4"})})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),u.jsx(ys,{placeholder:"Search conversations...",value:t,onChange:s=>d(s.target.value),className:"pl-10 bg-input-background/50 border-border/50 focus:border-primary/50 focus:bg-input-background/80"})]})]}),u.jsx("div",{className:"p-4 border-b border-border/50",children:u.jsxs("div",{className:"space-y-2",children:[u.jsxs(ie,{variant:"secondary",className:"w-full justify-start gap-2 bg-primary/10 hover:bg-primary/20 border-primary/20",children:[u.jsx(No,{className:"h-4 w-4"}),"Conversations",u.jsx(Ve,{variant:"secondary",className:"ml-auto bg-primary/20 text-primary",children:y.length})]}),u.jsxs(ie,{variant:"ghost",className:"w-full justify-start gap-2 hover:bg-secondary/50",children:[u.jsx(Yt,{className:"h-4 w-4"}),"Starred",u.jsx(Ve,{variant:"secondary",className:"ml-auto",children:E.length})]}),u.jsxs(ie,{variant:"ghost",className:"w-full justify-start gap-2 hover:bg-secondary/50",children:[u.jsx($r,{className:"h-4 w-4"}),"Recent",u.jsx(Ve,{variant:"secondary",className:"ml-auto",children:k.length})]})]})}),u.jsxs("div",{className:"flex-1 overflow-y-auto",children:[E.length>0&&u.jsxs("div",{className:"p-4 border-b border-border/50",children:[u.jsx("h4",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Starred"}),u.jsx("div",{className:"space-y-2",children:E.map(s=>u.jsxs("div",{className:"p-3 rounded-lg bg-gradient-to-r from-secondary/30 to-secondary/10 hover:from-secondary/50 hover:to-secondary/20 cursor-pointer transition-all duration-200 border border-border/30 hover:border-primary/30",children:[u.jsx("div",{className:"flex items-start justify-between mb-2",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Yt,{className:"h-3 w-3 text-yellow-400 fill-yellow-400"}),u.jsx("p",{className:"font-medium text-sm line-clamp-1",children:s.title})]})}),u.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-2",children:s.lastMessage}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[u.jsxs("span",{children:[s.messageCount," messages"]}),u.jsx("span",{children:s.timestamp})]})]},s.id))})]}),u.jsxs("div",{className:"p-4",children:[u.jsx("h4",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Recent Conversations"}),u.jsx("div",{className:"space-y-2",children:y.map(s=>u.jsxs("div",{className:"p-3 rounded-lg bg-secondary/10 hover:bg-secondary/20 cursor-pointer transition-all duration-200 border border-transparent hover:border-border/50",children:[u.jsxs("div",{className:"flex items-start justify-between mb-2",children:[u.jsx("p",{className:"font-medium text-sm line-clamp-1",children:s.title}),s.isStarred&&u.jsx(Yt,{className:"h-3 w-3 text-yellow-400 fill-yellow-400"})]}),u.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-2",children:s.lastMessage}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[u.jsxs("span",{children:[s.messageCount," messages"]}),u.jsx("span",{children:s.timestamp})]})]},s.id))})]})]})]})]}):null}function jc({...r}){return u.jsx(xn,{"data-slot":"select",...r})}function rt({...r}){return u.jsx(An,{"data-slot":"select-group",...r})}function Hc({...r}){return u.jsx(En,{"data-slot":"select-value",...r})}function zc({className:r,size:e="default",children:t,...d}){return u.jsxs(wn,{"data-slot":"select-trigger","data-size":e,className:te("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...d,children:[t,u.jsx(Cn,{asChild:!0,children:u.jsx(jt,{className:"size-4 opacity-50"})})]})}function Fc({className:r,children:e,position:t="popper",...d}){return u.jsx(kn,{children:u.jsxs(Rn,{"data-slot":"select-content",className:te("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...d,children:[u.jsx(Wc,{}),u.jsx(Ln,{className:te("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:e}),u.jsx($c,{})]})})}function it({className:r,...e}){return u.jsx(Dn,{"data-slot":"select-label",className:te("text-muted-foreground px-2 py-1.5 text-xs",r),...e})}function nt({className:r,children:e,...t}){return u.jsxs(Tn,{"data-slot":"select-item",className:te("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",r),...t,children:[u.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:u.jsx(Pn,{children:u.jsx(je,{className:"size-4"})})}),u.jsx(Mn,{children:e})]})}function Wc({className:r,...e}){return u.jsx(Nn,{"data-slot":"select-scroll-up-button",className:te("flex cursor-default items-center justify-center py-1",r),...e,children:u.jsx(io,{className:"size-4"})})}function $c({className:r,...e}){return u.jsx(Bn,{"data-slot":"select-scroll-down-button",className:te("flex cursor-default items-center justify-center py-1",r),...e,children:u.jsx(jt,{className:"size-4"})})}var Uc="Label",Xi=M.forwardRef((r,e)=>u.jsx(ue.label,{...r,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(r.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Xi.displayName=Uc;var qc=Xi;function ot({className:r,...e}){return u.jsx(qc,{"data-slot":"label",className:te("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...e})}function xs({...r}){return u.jsx(Br,{"data-slot":"dialog",...r})}function Kc({...r}){return u.jsx(Hr,{"data-slot":"dialog-portal",...r})}function Vc({className:r,...e}){return u.jsx(zr,{"data-slot":"dialog-overlay",className:te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",r),...e})}function ws({className:r,children:e,...t}){return u.jsxs(Kc,{"data-slot":"dialog-portal",children:[u.jsx(Vc,{}),u.jsxs(Ir,{"data-slot":"dialog-content",className:te("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",r),...t,children:[e,u.jsxs(Or,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[u.jsx(pt,{}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Cs({className:r,...e}){return u.jsx("div",{"data-slot":"dialog-header",className:te("flex flex-col gap-2 text-center sm:text-left",r),...e})}function Es({className:r,...e}){return u.jsx(jr,{"data-slot":"dialog-title",className:te("text-lg leading-none font-semibold",r),...e})}function ks({className:r,...e}){return u.jsx(In,{"data-slot":"dialog-description",className:te("text-muted-foreground text-sm",r),...e})}var Yi=["PageUp","PageDown"],Ji=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Zi={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Je="Slider",[Rs,Gc,Xc]=jn(Je),[Qi,Fh]=It(Je,[Xc]),[Yc,Gt]=Qi(Je),en=M.forwardRef((r,e)=>{const{name:t,min:d=0,max:y=100,step:k=1,orientation:E="horizontal",disabled:s=!1,minStepsBetweenThumbs:a=0,defaultValue:f=[d],value:m,onValueChange:c=()=>{},onValueCommit:h=()=>{},inverted:_=!1,form:S,...p}=r,n=M.useRef(new Set),o=M.useRef(0),l=E==="horizontal"?Jc:Zc,[g=[],x]=On({prop:m,defaultProp:f,onChange:A=>{[...n.current][o.current]?.focus(),c(A)}}),b=M.useRef(g);function w(A){const N=rh(g,A);T(A,N)}function v(A){T(A,o.current)}function C(){const A=b.current[o.current];g[o.current]!==A&&h(g)}function T(A,N,{commit:D}={commit:!1}){const j=ah(k),F=lh(Math.round((A-d)/k)*k+d,j),U=Ts(F,[d,y]);x((X=[])=>{const q=th(X,U,N);if(oh(q,a*k)){o.current=q.indexOf(U);const R=String(q)!==String(X);return R&&D&&h(q),R?q:X}else return X})}return u.jsx(Yc,{scope:r.__scopeSlider,name:t,disabled:s,min:d,max:y,valueIndexToChangeRef:o,thumbs:n.current,values:g,orientation:E,form:S,children:u.jsx(Rs.Provider,{scope:r.__scopeSlider,children:u.jsx(Rs.Slot,{scope:r.__scopeSlider,children:u.jsx(l,{"aria-disabled":s,"data-disabled":s?"":void 0,...p,ref:e,onPointerDown:me(p.onPointerDown,()=>{s||(b.current=g)}),min:d,max:y,inverted:_,onSlideStart:s?void 0:w,onSlideMove:s?void 0:v,onSlideEnd:s?void 0:C,onHomeKeyDown:()=>!s&&T(d,0,{commit:!0}),onEndKeyDown:()=>!s&&T(y,g.length-1,{commit:!0}),onStepKeyDown:({event:A,direction:N})=>{if(!s){const F=Yi.includes(A.key)||A.shiftKey&&Ji.includes(A.key)?10:1,U=o.current,X=g[U],q=k*F*N;T(X+q,U,{commit:!0})}}})})})})});en.displayName=Je;var[tn,sn]=Qi(Je,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Jc=M.forwardRef((r,e)=>{const{min:t,max:d,dir:y,inverted:k,onSlideStart:E,onSlideMove:s,onSlideEnd:a,onStepKeyDown:f,...m}=r,[c,h]=M.useState(null),_=Se(e,l=>h(l)),S=M.useRef(void 0),p=Nr(y),n=p==="ltr",o=n&&!k||!n&&k;function i(l){const g=S.current||c.getBoundingClientRect(),x=[0,g.width],w=Vs(x,o?[t,d]:[d,t]);return S.current=g,w(l-g.left)}return u.jsx(tn,{scope:r.__scopeSlider,startEdge:o?"left":"right",endEdge:o?"right":"left",direction:o?1:-1,size:"width",children:u.jsx(rn,{dir:p,"data-orientation":"horizontal",...m,ref:_,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:l=>{const g=i(l.clientX);E?.(g)},onSlideMove:l=>{const g=i(l.clientX);s?.(g)},onSlideEnd:()=>{S.current=void 0,a?.()},onStepKeyDown:l=>{const x=Zi[o?"from-left":"from-right"].includes(l.key);f?.({event:l,direction:x?-1:1})}})})}),Zc=M.forwardRef((r,e)=>{const{min:t,max:d,inverted:y,onSlideStart:k,onSlideMove:E,onSlideEnd:s,onStepKeyDown:a,...f}=r,m=M.useRef(null),c=Se(e,m),h=M.useRef(void 0),_=!y;function S(p){const n=h.current||m.current.getBoundingClientRect(),o=[0,n.height],l=Vs(o,_?[d,t]:[t,d]);return h.current=n,l(p-n.top)}return u.jsx(tn,{scope:r.__scopeSlider,startEdge:_?"bottom":"top",endEdge:_?"top":"bottom",size:"height",direction:_?1:-1,children:u.jsx(rn,{"data-orientation":"vertical",...f,ref:c,style:{...f.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:p=>{const n=S(p.clientY);k?.(n)},onSlideMove:p=>{const n=S(p.clientY);E?.(n)},onSlideEnd:()=>{h.current=void 0,s?.()},onStepKeyDown:p=>{const o=Zi[_?"from-bottom":"from-top"].includes(p.key);a?.({event:p,direction:o?-1:1})}})})}),rn=M.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:d,onSlideMove:y,onSlideEnd:k,onHomeKeyDown:E,onEndKeyDown:s,onStepKeyDown:a,...f}=r,m=Gt(Je,t);return u.jsx(ue.span,{...f,ref:e,onKeyDown:me(r.onKeyDown,c=>{c.key==="Home"?(E(c),c.preventDefault()):c.key==="End"?(s(c),c.preventDefault()):Yi.concat(Ji).includes(c.key)&&(a(c),c.preventDefault())}),onPointerDown:me(r.onPointerDown,c=>{const h=c.target;h.setPointerCapture(c.pointerId),c.preventDefault(),m.thumbs.has(h)?h.focus():d(c)}),onPointerMove:me(r.onPointerMove,c=>{c.target.hasPointerCapture(c.pointerId)&&y(c)}),onPointerUp:me(r.onPointerUp,c=>{const h=c.target;h.hasPointerCapture(c.pointerId)&&(h.releasePointerCapture(c.pointerId),k(c))})})}),nn="SliderTrack",on=M.forwardRef((r,e)=>{const{__scopeSlider:t,...d}=r,y=Gt(nn,t);return u.jsx(ue.span,{"data-disabled":y.disabled?"":void 0,"data-orientation":y.orientation,...d,ref:e})});on.displayName=nn;var Ls="SliderRange",an=M.forwardRef((r,e)=>{const{__scopeSlider:t,...d}=r,y=Gt(Ls,t),k=sn(Ls,t),E=M.useRef(null),s=Se(e,E),a=y.values.length,f=y.values.map(h=>hn(h,y.min,y.max)),m=a>1?Math.min(...f):0,c=100-Math.max(...f);return u.jsx(ue.span,{"data-orientation":y.orientation,"data-disabled":y.disabled?"":void 0,...d,ref:s,style:{...r.style,[k.startEdge]:m+"%",[k.endEdge]:c+"%"}})});an.displayName=Ls;var As="SliderThumb",ln=M.forwardRef((r,e)=>{const t=Gc(r.__scopeSlider),[d,y]=M.useState(null),k=Se(e,s=>y(s)),E=M.useMemo(()=>d?t().findIndex(s=>s.ref.current===d):-1,[t,d]);return u.jsx(Qc,{...r,ref:k,index:E})}),Qc=M.forwardRef((r,e)=>{const{__scopeSlider:t,index:d,name:y,...k}=r,E=Gt(As,t),s=sn(As,t),[a,f]=M.useState(null),m=Se(e,i=>f(i)),c=a?E.form||!!a.closest("form"):!0,h=Hn(a),_=E.values[d],S=_===void 0?0:hn(_,E.min,E.max),p=sh(d,E.values.length),n=h?.[s.size],o=n?ih(n,S,s.direction):0;return M.useEffect(()=>{if(a)return E.thumbs.add(a),()=>{E.thumbs.delete(a)}},[a,E.thumbs]),u.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[s.startEdge]:`calc(${S}% + ${o}px)`},children:[u.jsx(Rs.ItemSlot,{scope:r.__scopeSlider,children:u.jsx(ue.span,{role:"slider","aria-label":r["aria-label"]||p,"aria-valuemin":E.min,"aria-valuenow":_,"aria-valuemax":E.max,"aria-orientation":E.orientation,"data-orientation":E.orientation,"data-disabled":E.disabled?"":void 0,tabIndex:E.disabled?void 0:0,...k,ref:m,style:_===void 0?{display:"none"}:r.style,onFocus:me(r.onFocus,()=>{E.valueIndexToChangeRef.current=d})})}),c&&u.jsx(cn,{name:y??(E.name?E.name+(E.values.length>1?"[]":""):void 0),form:E.form,value:_},d)]})});ln.displayName=As;var eh="RadioBubbleInput",cn=M.forwardRef(({__scopeSlider:r,value:e,...t},d)=>{const y=M.useRef(null),k=Se(y,d),E=zn(e);return M.useEffect(()=>{const s=y.current;if(!s)return;const a=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(a,"value").set;if(E!==e&&m){const c=new Event("input",{bubbles:!0});m.call(s,e),s.dispatchEvent(c)}},[E,e]),u.jsx(ue.input,{style:{display:"none"},...t,ref:k,defaultValue:e})});cn.displayName=eh;function th(r=[],e,t){const d=[...r];return d[t]=e,d.sort((y,k)=>y-k)}function hn(r,e,t){const k=100/(t-e)*(r-e);return Ts(k,[0,100])}function sh(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function rh(r,e){if(r.length===1)return 0;const t=r.map(y=>Math.abs(y-e)),d=Math.min(...t);return t.indexOf(d)}function ih(r,e,t){const d=r/2,k=Vs([0,50],[0,d]);return(d-k(e)*t)*t}function nh(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function oh(r,e){if(e>0){const t=nh(r);return Math.min(...t)>=e}return!0}function Vs(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const d=(e[1]-e[0])/(r[1]-r[0]);return e[0]+d*(t-r[0])}}function ah(r){return(String(r).split(".")[1]||"").length}function lh(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var ch=en,hh=on,dh=an,uh=ln;function fh({className:r,defaultValue:e,value:t,min:d=0,max:y=100,...k}){const E=M.useMemo(()=>Array.isArray(t)?t:Array.isArray(e)?e:[d,y],[t,e,d,y]);return u.jsxs(ch,{"data-slot":"slider",defaultValue:e,value:t,min:d,max:y,className:te("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",r),...k,children:[u.jsx(hh,{"data-slot":"slider-track",className:te("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:u.jsx(dh,{"data-slot":"slider-range",className:te("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:E.length},(s,a)=>u.jsx(uh,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},a))]})}const Nt={"gpt-4o":{id:"gpt-4o",name:"GPT-4o",provider:"openai",contextWindow:128e3,description:"OpenAI GPT-4 Optimized - Fast and efficient",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!0},"gpt-4.1":{id:"gpt-4.1",name:"GPT-4.1",provider:"openai",contextWindow:128e3,description:"OpenAI GPT-4.1 - Latest improvements",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!0},o3:{id:"o3",name:"O3",provider:"openai",contextWindow:1e5,description:"OpenAI O3 - Advanced reasoning model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"o3-pro":{id:"o3-pro",name:"O3 Pro",provider:"openai",contextWindow:1e5,description:"OpenAI O3 Pro - Enhanced reasoning capabilities",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-sonnet-4":{id:"claude-sonnet-4",name:"Claude Sonnet 4",provider:"anthropic",contextWindow:2e5,description:"Claude Sonnet 4 - Enhanced reasoning and coding",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-opus-4":{id:"claude-opus-4",name:"Claude Opus 4",provider:"anthropic",contextWindow:2e5,description:"Claude Opus 4 - Most powerful Claude model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-3.7-sonnet":{id:"claude-3.7-sonnet",name:"Claude 3.7 Sonnet",provider:"anthropic",contextWindow:2e5,description:"Claude 3.7 Sonnet - Hybrid reasoning model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-3.5-sonnet":{id:"claude-3.5-sonnet",name:"Claude 3.5 Sonnet",provider:"anthropic",contextWindow:2e5,description:"Claude 3.5 Sonnet - Balanced performance",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"gemini-2.5-flash":{id:"gemini-2.5-flash",name:"Gemini 2.5 Flash",provider:"google",contextWindow:1e5,description:"Google Gemini 2.5 Flash - Fast and efficient",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"gemini-2.5-pro":{id:"gemini-2.5-pro",name:"Gemini 2.5 Pro",provider:"google",contextWindow:1e5,description:"Google Gemini 2.5 Pro - Powerful reasoning",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"deepseek-v3":{id:"deepseek-v3",name:"DeepSeek V3",provider:"deepseek",contextWindow:65536,description:"DeepSeek V3 - General purpose model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"deepseek-r1":{id:"deepseek-r1",name:"DeepSeek R1",provider:"deepseek",contextWindow:65536,description:"DeepSeek R1 - Reasoning model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"grok-3":{id:"grok-3",name:"Grok 3",provider:"xai",contextWindow:1e5,description:"xAI Grok 3 - Flagship model for enterprise tasks",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"grok-3-mini":{id:"grok-3-mini",name:"Grok 3 Mini",provider:"xai",contextWindow:1e5,description:"xAI Grok 3 Mini - Lightweight for math and quantitative tasks",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1}};function at(r){return Object.values(Nt).filter(e=>e.provider===r)}function ph(r){const e=Nt[r];return e?.requiresApiKey?e.provider:null}function _h(r){return r.trim().length>20}function mh(){return{model:"gpt-4o",temperature:.7,maxTokens:1e3,apiKeys:{}}}const Ge={MODEL:"hma_llm_selected_model",TEMPERATURE:"hma_llm_temperature",MAX_TOKENS:"hma_llm_max_tokens"};function dn(){try{const r=localStorage.getItem(Ge.MODEL),e=localStorage.getItem(Ge.TEMPERATURE),t=localStorage.getItem(Ge.MAX_TOKENS);return{model:r||void 0,temperature:e?parseFloat(e):void 0,maxTokens:t?parseInt(t,10):void 0}}catch{return{}}}function Ds(r){try{r.model&&localStorage.setItem(Ge.MODEL,r.model),r.temperature!==void 0&&localStorage.setItem(Ge.TEMPERATURE,r.temperature.toString()),r.maxTokens!==void 0&&localStorage.setItem(Ge.MAX_TOKENS,r.maxTokens.toString())}catch(e){console.error("Failed to save LLM preferences:",e)}}function gh({onConfigChange:r,className:e}){const[t,d]=M.useState("gpt-4o"),[y,k]=M.useState(.7),[E,s]=M.useState(1e3),[a,f]=M.useState({}),[m,c]=M.useState(!1),[h,_]=M.useState(!1),[S,p]=M.useState(null),[n,o]=M.useState(""),[i,l]=M.useState("");M.useEffect(()=>{const C=dn();C.model&&Nt[C.model]&&d(C.model),C.temperature!==void 0&&k(C.temperature),C.maxTokens!==void 0&&s(C.maxTokens)},[]);const g=C=>{d(C),Ds({model:C});const T=ph(C);T&&!a[T]?(p(T),_(!0)):x(C)},x=C=>{const T={model:C||t,temperature:y,maxTokens:E,apiKeys:a};Ds(T),de.configureLLM(T),r?.(T)},b=()=>{if(!S)return;if(!_h(n)){l("Please enter a valid API key");return}const C={...a,[S]:n};f(C),de.setApiKey(S,n),o(""),l(""),_(!1),p(null),x()},w={openai:at("openai"),anthropic:at("anthropic"),google:at("google"),deepseek:at("deepseek"),xai:at("xai")},v=Nt[t];return u.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[u.jsxs(jc,{value:t,onValueChange:g,children:[u.jsx(zc,{className:"w-[240px]",children:u.jsx(Hc,{placeholder:"Select a model"})}),u.jsxs(Fc,{children:[w.openai.length>0&&u.jsxs(rt,{children:[u.jsx(it,{children:"OpenAI"}),w.openai.map(C=>u.jsx(nt,{value:C.id,children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("span",{children:C.name}),a.openai&&u.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.anthropic.length>0&&u.jsxs(rt,{children:[u.jsx(it,{children:"Anthropic"}),w.anthropic.map(C=>u.jsx(nt,{value:C.id,children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("span",{children:C.name}),a.anthropic&&u.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.google.length>0&&u.jsxs(rt,{children:[u.jsx(it,{children:"Google"}),w.google.map(C=>u.jsx(nt,{value:C.id,children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("span",{children:C.name}),a.google&&u.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.deepseek.length>0&&u.jsxs(rt,{children:[u.jsx(it,{children:"DeepSeek"}),w.deepseek.map(C=>u.jsx(nt,{value:C.id,children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("span",{children:C.name}),a.deepseek&&u.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.xai.length>0&&u.jsxs(rt,{children:[u.jsx(it,{children:"xAI"}),w.xai.map(C=>u.jsx(nt,{value:C.id,children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("span",{children:C.name}),a.xai&&u.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]})]})]}),u.jsx(ie,{variant:"outline",size:"icon",onClick:()=>c(!0),title:"Model Settings",children:u.jsx(Gr,{className:"h-4 w-4"})}),u.jsx(xs,{open:m,onOpenChange:c,children:u.jsxs(ws,{className:"sm:max-w-[425px]",children:[u.jsxs(Cs,{children:[u.jsx(Es,{children:"Model Settings"}),u.jsxs(ks,{children:["Configure parameters for ",v?.name||"the selected model"]})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(ot,{children:"Current Model"}),u.jsxs("div",{className:"p-3 border rounded-lg bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"font-medium",children:v?.name}),u.jsx(Ve,{variant:"secondary",children:v?.provider})]}),u.jsx("p",{className:"text-sm text-muted-foreground",children:v?.description}),u.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[u.jsxs("span",{children:["Context: ",v?.contextWindow.toLocaleString()," tokens"]}),v?.supportsStreaming&&u.jsx(Ve,{variant:"outline",className:"text-xs",children:"Streaming"})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx(ot,{htmlFor:"temperature",children:"Temperature"}),u.jsx("span",{className:"text-sm text-muted-foreground",children:y})]}),u.jsx(fh,{id:"temperature",min:0,max:2,step:.1,value:[y],onValueChange:C=>k(C[0]||.7),className:"w-full"}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Controls randomness. Lower values make output more focused and deterministic."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(ot,{htmlFor:"maxTokens",children:"Max Tokens"}),u.jsx(ys,{id:"maxTokens",type:"number",min:1,max:v?.contextWindow||1e5,value:E,onChange:C=>s(parseInt(C.target.value)||1e3)}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum number of tokens to generate in the response."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(ot,{children:"API Keys"}),u.jsx("div",{className:"space-y-2",children:Object.entries(a).map(([C,T])=>u.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[u.jsx("span",{className:"text-sm capitalize",children:C}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(je,{className:"h-4 w-4 text-green-500"}),u.jsxs("span",{className:"text-xs text-muted-foreground",children:[T.substring(0,6),"...",T.substring(T.length-4)]})]})]},C))})]}),u.jsx(ie,{onClick:()=>x(),className:"w-full",children:"Apply Settings"})]})]})}),u.jsx(xs,{open:h,onOpenChange:_,children:u.jsxs(ws,{className:"sm:max-w-[425px]",children:[u.jsxs(Cs,{children:[u.jsx(Es,{children:"API Key Required"}),u.jsxs(ks,{children:["Please enter your ",S," API key to use this model."]})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[u.jsxs("div",{className:"flex items-center gap-2 p-3 border rounded-lg bg-amber-50 dark:bg-amber-950 border-amber-200 dark:border-amber-800",children:[u.jsx(Ae,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),u.jsx("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:"Your API key will be sent securely to the backend server."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs(ot,{htmlFor:"apiKey",children:[u.jsx(Ao,{className:"h-4 w-4 inline mr-2"}),"API Key"]}),u.jsx(ys,{id:"apiKey",type:"password",placeholder:`Enter your ${S} API key`,value:n,onChange:C=>{o(C.target.value),l("")},onKeyDown:C=>{C.key==="Enter"&&b()}}),i&&u.jsx("p",{className:"text-sm text-red-500",children:i})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ie,{variant:"outline",onClick:()=>{_(!1),o(""),l("")},className:"flex-1",children:"Cancel"}),u.jsx(ie,{onClick:b,className:"flex-1",children:"Save API Key"})]})]})]})})]})}const vh=Os("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function hs({className:r,variant:e,...t}){return u.jsx("div",{"data-slot":"alert",role:"alert",className:te(vh({variant:e}),r),...t})}function ds({className:r,...e}){return u.jsx("div",{"data-slot":"alert-description",className:te("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",r),...e})}var Gs="Progress",Xs=100,[Sh,Wh]=It(Gs),[bh,yh]=Sh(Gs),un=M.forwardRef((r,e)=>{const{__scopeProgress:t,value:d=null,max:y,getValueLabel:k=xh,...E}=r;(y||y===0)&&!Tr(y)&&console.error(wh(`${y}`,"Progress"));const s=Tr(y)?y:Xs;d!==null&&!Pr(d,s)&&console.error(Ch(`${d}`,"Progress"));const a=Pr(d,s)?d:null,f=Bt(a)?k(a,s):void 0;return u.jsx(bh,{scope:t,value:a,max:s,children:u.jsx(ue.div,{"aria-valuemax":s,"aria-valuemin":0,"aria-valuenow":Bt(a)?a:void 0,"aria-valuetext":f,role:"progressbar","data-state":_n(a,s),"data-value":a??void 0,"data-max":s,...E,ref:e})})});un.displayName=Gs;var fn="ProgressIndicator",pn=M.forwardRef((r,e)=>{const{__scopeProgress:t,...d}=r,y=yh(fn,t);return u.jsx(ue.div,{"data-state":_n(y.value,y.max),"data-value":y.value??void 0,"data-max":y.max,...d,ref:e})});pn.displayName=fn;function xh(r,e){return`${Math.round(r/e*100)}%`}function _n(r,e){return r==null?"indeterminate":r===e?"complete":"loading"}function Bt(r){return typeof r=="number"}function Tr(r){return Bt(r)&&!isNaN(r)&&r>0}function Pr(r,e){return Bt(r)&&!isNaN(r)&&r<=e&&r>=0}function wh(r,e){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Xs}\`.`}function Ch(r,e){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Xs} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Eh=un,kh=pn;function Rh({className:r,value:e,...t}){return u.jsx(Eh,{"data-slot":"progress",className:te("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",r),...t,children:u.jsx(kh,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})})}function Lh({isOpen:r,onClose:e,onImport:t}){const[d,y]=M.useState(!1),[k,E]=M.useState(0),[s,a]=M.useState("idle"),[f,m]=M.useState(""),[c,h]=M.useState(""),_=async o=>{const i=o.target.files;if(!(!i||i.length===0)){y(!0),a("importing"),m(""),h(""),E(0);try{const l=await bs.importFiles(i);if(l.length===0)throw new Error("No valid files found to import");E(100),a("success"),h(`Successfully imported ${l.length} file${l.length>1?"s":""}`),t(l),setTimeout(()=>{e(),n()},1500)}catch(l){a("error"),m(l.message||"Failed to import files")}finally{y(!1)}}},S=async()=>{y(!0),a("importing"),m(""),h(""),E(20);try{const o=await bs.importFolder();if(!o){n();return}E(100),a("success");const i=p(o);h(`Successfully imported ${i} file${i>1?"s":""} from "${o.name}"`),t([o]),setTimeout(()=>{e(),n()},1500)}catch(o){a("error"),m(o.message||"Failed to import folder")}finally{y(!1)}},p=o=>o.type==="file"?1:o.children.reduce((i,l)=>i+p(l),0),n=()=>{a("idle"),E(0),m(""),h("")};return u.jsx(xs,{open:r,onOpenChange:e,children:u.jsxs(ws,{className:"sm:max-w-[500px]",children:[u.jsxs(Cs,{children:[u.jsx(Es,{children:"Import Project"}),u.jsx(ks,{children:"Import files or an entire folder from your local file system"})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[f&&u.jsxs(hs,{variant:"destructive",children:[u.jsx(Ae,{className:"h-4 w-4"}),u.jsx(ds,{children:f})]}),c&&u.jsxs(hs,{className:"border-green-500 bg-green-50 dark:bg-green-950",children:[u.jsx(ao,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),u.jsx(ds,{className:"text-green-900 dark:text-green-100",children:c})]}),s==="importing"&&u.jsxs("div",{className:"space-y-2",children:[u.jsx(Rh,{value:k,className:"h-2"}),u.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Importing files..."})]}),s==="idle"&&u.jsxs(Ai,{defaultValue:"files",className:"w-full",children:[u.jsxs(Qa,{className:"grid w-full grid-cols-2",children:[u.jsx(pr,{value:"files",children:"Import Files"}),u.jsx(pr,{value:"folder",children:"Import Folder"})]}),u.jsxs(_r,{value:"files",className:"space-y-4 mt-4",children:[u.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center hover:border-primary/50 transition-colors",children:[u.jsx("input",{type:"file",multiple:!0,onChange:_,className:"hidden",id:"file-input",accept:".js,.jsx,.ts,.tsx,.py,.java,.cpp,.c,.h,.cs,.go,.rb,.php,.html,.css,.scss,.sass,.less,.xml,.json,.yaml,.yml,.md,.mdx,.sql,.sh,.bash,.zsh,.fish,.ps1,.r,.R,.swift,.kt,.kts,.dart,.lua,.vim,.dockerfile,.rs,.toml,.ini,.cfg,.conf,.env"}),u.jsxs("label",{htmlFor:"file-input",className:"cursor-pointer flex flex-col items-center gap-3",children:[u.jsx(Ps,{className:"h-12 w-12 text-muted-foreground"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium",children:"Click to select files"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Select multiple files to import"})]})]})]}),u.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Supported: Source code, configuration files, and text files (max 10MB each)"})]}),u.jsxs(_r,{value:"folder",className:"space-y-4 mt-4",children:[u.jsx("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:u.jsx(ie,{onClick:S,disabled:d,className:"w-full h-auto py-8 flex flex-col gap-3",variant:"outline",children:d?u.jsx(Ht,{className:"h-12 w-12 animate-spin"}):u.jsxs(u.Fragment,{children:[u.jsx(qr,{className:"h-12 w-12"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium",children:"Select a folder"}),u.jsx("p",{className:"text-sm font-normal text-muted-foreground",children:"Import an entire project directory"})]})]})})}),u.jsxs(hs,{children:[u.jsx(Ae,{className:"h-4 w-4"}),u.jsxs(ds,{children:[u.jsx("p",{className:"font-medium mb-1",children:"Browser Compatibility"}),u.jsx("p",{className:"text-xs",children:"Folder import requires a Chromium-based browser (Chrome, Edge, Brave, etc.) with File System Access API support."})]})]})]})]})]}),u.jsx("div",{className:"flex justify-end gap-2",children:u.jsx(ie,{variant:"outline",onClick:e,disabled:d,children:"Cancel"})})]})})}class Ah extends Fn.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t),this.setState({error:e,errorInfo:t})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){if(this.state.hasError){if(this.props.fallback){const e=this.props.fallback;return u.jsx(e,{error:this.state.error,reset:this.handleReset})}return u.jsx("div",{className:"h-full flex items-center justify-center bg-background",children:u.jsxs("div",{className:"text-center p-8 max-w-md",children:[u.jsx(Ae,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Something went wrong"}),u.jsx("p",{className:"text-muted-foreground mb-4",children:this.state.error?.message||"An unexpected error occurred."}),!1,u.jsxs(ie,{onClick:this.handleReset,className:"mt-4",children:[u.jsx(Vr,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})}return this.props.children}}class Dh{STORAGE_KEY="colony-chat-history";MAX_AGE_DAYS=90;getStorage(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(e){const t=JSON.parse(e);return t.sessions=t.sessions.map(d=>({...d,createdAt:new Date(d.createdAt),lastModified:new Date(d.lastModified),messages:d.messages.map(y=>({...y,timestamp:new Date(y.timestamp)}))})),t}}catch(e){console.error("Error loading chat history:",e)}return{sessions:[]}}setStorage(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Error saving chat history:",t)}}cleanOldSessions(e){const t=new Date;return t.setDate(t.getDate()-this.MAX_AGE_DAYS),e.filter(d=>d.lastModified>t)}saveChatSession(e){const t=this.getStorage(),d=t.sessions.findIndex(y=>y.id===e.id);d>=0?t.sessions[d]=e:t.sessions.push(e),t.sessions=this.cleanOldSessions(t.sessions),t.sessions.sort((y,k)=>k.lastModified.getTime()-y.lastModified.getTime()),this.setStorage(t)}loadChatSessions(){const e=this.getStorage(),t=this.cleanOldSessions(e.sessions);return t.length!==e.sessions.length&&(e.sessions=t,this.setStorage(e)),t.sort((d,y)=>y.lastModified.getTime()-d.lastModified.getTime())}deleteChatSession(e){const t=this.getStorage();t.sessions=t.sessions.filter(d=>d.id!==e),t.currentSessionId===e&&(t.currentSessionId=void 0),this.setStorage(t)}getCurrentSession(){const e=this.getStorage();return e.currentSessionId&&e.sessions.find(d=>d.id===e.currentSessionId)||null}setCurrentSession(e){const t=this.getStorage();t.currentSessionId=e,this.setStorage(t)}clearCurrentSession(){const e=this.getStorage();e.currentSessionId=void 0,this.setStorage(e)}createNewSession(e){const t={id:`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:e||`Chat ${new Date().toLocaleString()}`,createdAt:new Date,lastModified:new Date,messages:[]};return this.saveChatSession(t),this.setCurrentSession(t.id),t}}const $e=new Dh,Th=M.createContext(void 0);function Ph({children:r}){const[e,t]=M.useState(()=>{const b=dn();return{...mh(),...b}}),[d,y]=M.useState({}),[k,E]=M.useState(null),[s,a]=M.useState(0),[f,m]=M.useState({}),[c,h]=M.useState({}),[_,S]=M.useState({}),[p,n]=M.useState(!1),[o,i]=M.useState(!1);ve("connected",()=>{n(!0),e.model&&(de.configureLLM(e),i(!0))}),ve("disconnected",()=>{n(!1),i(!1)}),ve("llm_config_update",b=>{t(b.config),i(!0)}),ve("llm_stream",b=>{const{messageId:w,chunk:v}=b;w&&(v.isComplete?S(C=>({...C,[w]:!1})):(h(C=>({...C,[w]:(C[w]||"")+v.content})),S(C=>({...C,[w]:!0}))))}),ve("agent_hierarchy",b=>{y(b.agents),E(b.rootAgentId)}),ve("token_usage",b=>{const{agentId:w,tokensUsed:v}=b;m(C=>({...C,[w]:(C[w]||0)+v})),a(C=>C+v),y(C=>{const T=C[w];return T?{...C,[w]:{...T,contextSize:b.contextSize,maxContextSize:b.maxContextSize}}:C})});const l=b=>{const w={...e,...b};t(w),Ds(w),p&&(de.configureLLM(w),i(!0))},g=Object.values(d).filter(b=>b.status==="active"||b.status==="delegating");M.useEffect(()=>{if(p&&o){de.requestAgentHierarchy();const b=setInterval(()=>{de.requestAgentHierarchy()},5e3);return()=>clearInterval(b)}},[p,o]);const x={config:e,updateConfig:l,agents:d,rootAgentId:k,activeAgents:g,totalTokensUsed:s,agentTokenUsage:f,streamingMessages:c,isStreaming:_,isConnected:p,isConfigured:o};return u.jsx(Th.Provider,{value:x,children:r})}function Mh(){const[r,e]=M.useState(!1),[t,d]=M.useState("spec"),[y,k]=M.useState([]),[E,s]=M.useState(!1),[a,f]=M.useState(!1),[m,c]=M.useState(null),[h,_]=M.useState(!1),[S,p]=M.useState([]);M.useEffect(()=>{de.connect();const x=$e.getCurrentSession();if(x)k(x.messages.map(b=>({id:b.id,text:b.content,timestamp:new Date(b.timestamp).toLocaleTimeString(),sender:b.sender,agentId:b.agentId}))),c(x.id);else{const b=$e.createNewSession();c(b.id)}return()=>{de.disconnect()}},[]),ve("connected",()=>{s(!0),console.log("Connected to WebSocket server")}),ve("disconnected",()=>{s(!1),console.log("Disconnected from WebSocket server")});const n=(x,b)=>{if(!x.trim()&&(!b||b.length===0))return;const w=`task-${Date.now()}`,v={id:Date.now().toString(),text:x,timestamp:new Date().toLocaleTimeString(),sender:"user",threadId:w};if(k(C=>[...C,v]),f(!0),de.sendPrompt(x),m){const C=$e.getCurrentSession();C&&(C.messages.push({id:v.id,content:x,sender:"user",timestamp:new Date().toISOString()}),$e.saveChatSession(C))}},o=x=>{if(k(x),m){const b=$e.getCurrentSession();b&&(b.messages=x.map(w=>({id:w.id,content:w.text,sender:w.sender,timestamp:new Date().toISOString(),agentId:w.agentId})),b.lastModified=new Date,$e.saveChatSession(b))}},i=x=>{f(x)},l=()=>{k([{id:"1",text:"Hello! I'm Colony AI. I can help you generate code for your project. What would you like me to create?",timestamp:new Date().toLocaleTimeString(),sender:"assistant",threadId:"welcome-thread"}]),setTimeout(()=>{setTimeout(()=>{d("test"),setTimeout(()=>{setTimeout(()=>{d("impl")},2e3)},1500)},2e3)},1e3)},g=x=>{p(b=>[...b,...x])};return u.jsxs("div",{className:"h-screen bg-background flex flex-col",children:[u.jsx("header",{className:"sticky top-0 z-50 w-full bg-background border-b border-border",children:u.jsxs("div",{className:"h-16 flex items-center px-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(ie,{variant:"ghost",size:"lg",className:"p-2 hover:bg-card focus-visible:outline focus-visible:outline-2 focus-visible:outline-primary/60",onClick:()=>e(!0),children:u.jsx(Po,{className:"h-6 w-6"})}),u.jsx("h1",{className:"text-foreground ml-2",style:{fontFamily:"Quicksand, sans-serif",fontSize:"28px",fontWeight:400,letterSpacing:"-0.5px"},children:"[Name]"})]}),u.jsxs("div",{className:"flex-1 flex justify-end items-center gap-4",children:[u.jsx(gh,{}),u.jsxs(ie,{size:"sm",onClick:()=>_(!0),className:"minimalist-button",children:[u.jsx(sa,{className:"h-4 w-4 mr-1"}),"Import"]}),u.jsxs(ie,{size:"sm",className:"minimalist-button border-primary text-primary hover:bg-primary/5",children:[u.jsx(la,{className:"h-4 w-4 mr-1"}),"Upgrade"]})]})]})}),u.jsx("div",{className:"flex flex-col overflow-hidden",style:{height:"calc(100vh - 4rem)"},children:u.jsx(wc,{messages:y,onSendMessage:n,onNewChat:l,currentPhase:t,isConnected:E,onMessagesUpdate:o,isLoading:a,onLoadingChange:i,importedProject:S})}),u.jsx(Oc,{isOpen:r,onClose:()=>e(!1)}),u.jsx(Lh,{isOpen:h,onClose:()=>_(!1),onImport:g})]})}function Nh(){return u.jsx(Ah,{children:u.jsx(Ph,{children:u.jsx(Mh,{})})})}Kn.createRoot(document.getElementById("root")).render(u.jsx(M.StrictMode,{children:u.jsx(Nh,{})}));
