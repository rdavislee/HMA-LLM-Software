import{r as P,R as fn,j as f,S as Tr,u as Se,a as Pr,c as Nt,P as ue,b as Ot,d as ge,e as Pe,f as Lt,g as Ts,h as pn,L as _n,T as mn,C as gn,i as Mr,k as Br,l as Ir,m as Nr,n as Or,O as jr,o as vn,p as Sn,I as bn,V as yn,q as xn,s as wn,t as Cn,G as En,v as kn,w as Rn,x as Ln,y as An,z as Dn,A as Tn,D as Pn,B as Mn,E as Bn,F as In,H as Nn,J as On}from"./ui-zHZ4fQpc.js";import{a as jn,r as Hn}from"./react-DavUf6mE.js";import{t as Fn,c as Hr}from"./utils-BJeS7sC5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const b of document.querySelectorAll('link[rel="modulepreload"]'))d(b);new MutationObserver(b=>{for(const k of b)if(k.type==="childList")for(const E of k.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&d(E)}).observe(document,{childList:!0,subtree:!0});function t(b){const k={};return b.integrity&&(k.integrity=b.integrity),b.referrerPolicy&&(k.referrerPolicy=b.referrerPolicy),b.crossOrigin==="use-credentials"?k.credentials="include":b.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function d(b){if(b.ep)return;b.ep=!0;const k=t(b);fetch(b.href,k)}})();var mt={},Js;function zn(){if(Js)return mt;Js=1;var r=jn();return mt.createRoot=r.createRoot,mt.hydrateRoot=r.hydrateRoot,mt}var $n=zn();/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Un=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,d)=>d?d.toUpperCase():t.toLowerCase()),Zs=r=>{const e=Un(r);return e.charAt(0).toUpperCase()+e.slice(1)},Fr=(...r)=>r.filter((e,t,d)=>!!e&&e.trim()!==""&&d.indexOf(e)===t).join(" ").trim(),qn=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Kn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=P.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:d,className:b="",children:k,iconNode:E,...s},a)=>P.createElement("svg",{ref:a,...Kn,width:e,height:e,stroke:r,strokeWidth:d?Number(t)*24/Number(e):t,className:Fr("lucide",b),...!k&&!qn(s)&&{"aria-hidden":"true"},...s},[...E.map(([u,p])=>P.createElement(u,p)),...Array.isArray(k)?k:[k]]));/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=(r,e)=>{const t=P.forwardRef(({className:d,...b},k)=>P.createElement(Vn,{ref:k,iconNode:e,className:Fr(`lucide-${Wn(Zs(r))}`,`lucide-${r}`,d),...b}));return t.displayName=Zs(r),t};/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Xn=ee("bot",Gn);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],je=ee("check",Yn);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],jt=ee("chevron-down",Jn);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],us=ee("chevron-right",Zn);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],eo=ee("chevron-up",Qn);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ae=ee("circle-alert",to);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ro=ee("circle-check-big",so);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],zr=ee("clock",io);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],yt=ee("code",no);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ao=ee("copy",oo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],co=ee("database",lo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],uo=ee("download",ho);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],po=ee("ellipsis",fo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xt=ee("file-text",_o);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Ps=ee("file",mo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],vo=ee("folder-open",go);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],$r=ee("folder",So);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],yo=ee("grip-vertical",bo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],wo=ee("image",xo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Eo=ee("key",Co);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ht=ee("loader-circle",ko);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Lo=ee("menu",Ro);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],Do=ee("message-circle",Ao);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],At=ee("message-square",To);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}]],Mo=ee("panel-bottom-open",Po);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],Io=ee("panel-left-open",Bo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Oo=ee("paperclip",No);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Ho=ee("play",jo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wr=ee("plus",Fo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ur=ee("refresh-cw",zo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Wo=ee("search",$o);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],qo=ee("send",Uo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ms=ee("settings",Ko);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Yt=ee("star",Vo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],Xo=ee("terminal",Go);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Jo=ee("upload",Yo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Qo=ee("user",Zo);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pt=ee("x",ea);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],sa=ee("zap",ta),Ft=P.createContext(null);Ft.displayName="PanelGroupContext";const ae={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Bs=10,He=P.useLayoutEffect,Qs=fn.useId,ra=typeof Qs=="function"?Qs:()=>null;let ia=0;function Is(r=null){const e=ra(),t=P.useRef(r||e||null);return t.current===null&&(t.current=""+ia++),r??t.current}function qr({children:r,className:e="",collapsedSize:t,collapsible:d,defaultSize:b,forwardedRef:k,id:E,maxSize:s,minSize:a,onCollapse:u,onExpand:p,onResize:c,order:h,style:m,tagName:S="div",..._}){const n=P.useContext(Ft);if(n===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:o,expandPanel:i,getPanelSize:l,getPanelStyle:g,groupId:x,isPanelCollapsed:y,reevaluatePanelConstraints:w,registerPanel:v,resizePanel:C,unregisterPanel:T}=n,A=Is(E),B=P.useRef({callbacks:{onCollapse:u,onExpand:p,onResize:c},constraints:{collapsedSize:t,collapsible:d,defaultSize:b,maxSize:s,minSize:a},id:A,idIsFromProps:E!==void 0,order:h});P.useRef({didLogMissingDefaultSizeWarning:!1}),He(()=>{const{callbacks:j,constraints:z}=B.current,U={...z};B.current.id=A,B.current.idIsFromProps=E!==void 0,B.current.order=h,j.onCollapse=u,j.onExpand=p,j.onResize=c,z.collapsedSize=t,z.collapsible=d,z.defaultSize=b,z.maxSize=s,z.minSize=a,(U.collapsedSize!==z.collapsedSize||U.collapsible!==z.collapsible||U.maxSize!==z.maxSize||U.minSize!==z.minSize)&&w(B.current,U)}),He(()=>{const j=B.current;return v(j),()=>{T(j)}},[h,A,v,T]),P.useImperativeHandle(k,()=>({collapse:()=>{o(B.current)},expand:j=>{i(B.current,j)},getId(){return A},getSize(){return l(B.current)},isCollapsed(){return y(B.current)},isExpanded(){return!y(B.current)},resize:j=>{C(B.current,j)}}),[o,i,l,y,A,C]);const D=g(B.current,b);return P.createElement(S,{..._,children:r,className:e,id:A,style:{...D,...m},[ae.groupId]:x,[ae.panel]:"",[ae.panelCollapsible]:d||void 0,[ae.panelId]:A,[ae.panelSize]:parseFloat(""+D.flexGrow).toFixed(1)})}const Kr=P.forwardRef((r,e)=>P.createElement(qr,{...r,forwardedRef:e}));qr.displayName="Panel";Kr.displayName="forwardRef(Panel)";let fs=null,wt=-1,Me=null;function na(r,e){if(e){const t=(e&Jr)!==0,d=(e&Zr)!==0,b=(e&Qr)!==0,k=(e&ei)!==0;if(t)return b?"se-resize":k?"ne-resize":"e-resize";if(d)return b?"sw-resize":k?"nw-resize":"w-resize";if(b)return"s-resize";if(k)return"n-resize"}switch(r){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function oa(){Me!==null&&(document.head.removeChild(Me),fs=null,Me=null,wt=-1)}function Jt(r,e){var t,d;const b=na(r,e);if(fs!==b){if(fs=b,Me===null&&(Me=document.createElement("style"),document.head.appendChild(Me)),wt>=0){var k;(k=Me.sheet)===null||k===void 0||k.removeRule(wt)}wt=(t=(d=Me.sheet)===null||d===void 0?void 0:d.insertRule(`*{cursor: ${b} !important;}`))!==null&&t!==void 0?t:-1}}function Vr(r){return r.type==="keydown"}function Gr(r){return r.type.startsWith("pointer")}function Xr(r){return r.type.startsWith("mouse")}function zt(r){if(Gr(r)){if(r.isPrimary)return{x:r.clientX,y:r.clientY}}else if(Xr(r))return{x:r.clientX,y:r.clientY};return{x:1/0,y:1/0}}function aa(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function la(r,e,t){return r.x<e.x+e.width&&r.x+r.width>e.x&&r.y<e.y+e.height&&r.y+r.height>e.y}function ca(r,e){if(r===e)throw new Error("Cannot compare node with itself");const t={a:sr(r),b:sr(e)};let d;for(;t.a.at(-1)===t.b.at(-1);)r=t.a.pop(),e=t.b.pop(),d=r;Q(d,"Stacking order can only be calculated for elements with a common ancestor");const b={a:tr(er(t.a)),b:tr(er(t.b))};if(b.a===b.b){const k=d.childNodes,E={a:t.a.at(-1),b:t.b.at(-1)};let s=k.length;for(;s--;){const a=k[s];if(a===E.a)return 1;if(a===E.b)return-1}}return Math.sign(b.a-b.b)}const ha=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function da(r){var e;const t=getComputedStyle((e=Yr(r))!==null&&e!==void 0?e:r).display;return t==="flex"||t==="inline-flex"}function ua(r){const e=getComputedStyle(r);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||da(r))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||ha.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function er(r){let e=r.length;for(;e--;){const t=r[e];if(Q(t,"Missing node"),ua(t))return t}return null}function tr(r){return r&&Number(getComputedStyle(r).zIndex)||0}function sr(r){const e=[];for(;r;)e.push(r),r=Yr(r);return e}function Yr(r){const{parentNode:e}=r;return e&&e instanceof ShadowRoot?e.host:e}const Jr=1,Zr=2,Qr=4,ei=8,fa=aa()==="coarse";let xe=[],Ke=!1,Be=new Map,$t=new Map;const dt=new Set;function pa(r,e,t,d,b){var k;const{ownerDocument:E}=e,s={direction:t,element:e,hitAreaMargins:d,setResizeHandlerState:b},a=(k=Be.get(E))!==null&&k!==void 0?k:0;return Be.set(E,a+1),dt.add(s),Dt(),function(){var p;$t.delete(r),dt.delete(s);const c=(p=Be.get(E))!==null&&p!==void 0?p:1;if(Be.set(E,c-1),Dt(),c===1&&Be.delete(E),xe.includes(s)){const h=xe.indexOf(s);h>=0&&xe.splice(h,1),Os(),b("up",!0,null)}}}function _a(r){const{target:e}=r,{x:t,y:d}=zt(r);Ke=!0,Ns({target:e,x:t,y:d}),Dt(),xe.length>0&&(Tt("down",r),r.preventDefault(),ti(e)||r.stopImmediatePropagation())}function Zt(r){const{x:e,y:t}=zt(r);if(Ke&&r.buttons===0&&(Ke=!1,Tt("up",r)),!Ke){const{target:d}=r;Ns({target:d,x:e,y:t})}Tt("move",r),Os(),xe.length>0&&r.preventDefault()}function Qt(r){const{target:e}=r,{x:t,y:d}=zt(r);$t.clear(),Ke=!1,xe.length>0&&(r.preventDefault(),ti(e)||r.stopImmediatePropagation()),Tt("up",r),Ns({target:e,x:t,y:d}),Os(),Dt()}function ti(r){let e=r;for(;e;){if(e.hasAttribute(ae.resizeHandle))return!0;e=e.parentElement}return!1}function Ns({target:r,x:e,y:t}){xe.splice(0);let d=null;(r instanceof HTMLElement||r instanceof SVGElement)&&(d=r),dt.forEach(b=>{const{element:k,hitAreaMargins:E}=b,s=k.getBoundingClientRect(),{bottom:a,left:u,right:p,top:c}=s,h=fa?E.coarse:E.fine;if(e>=u-h&&e<=p+h&&t>=c-h&&t<=a+h){if(d!==null&&document.contains(d)&&k!==d&&!k.contains(d)&&!d.contains(k)&&ca(d,k)>0){let S=d,_=!1;for(;S&&!S.contains(k);){if(la(S.getBoundingClientRect(),s)){_=!0;break}S=S.parentElement}if(_)return}xe.push(b)}})}function es(r,e){$t.set(r,e)}function Os(){let r=!1,e=!1;xe.forEach(d=>{const{direction:b}=d;b==="horizontal"?r=!0:e=!0});let t=0;$t.forEach(d=>{t|=d}),r&&e?Jt("intersection",t):r?Jt("horizontal",t):e?Jt("vertical",t):oa()}let ts;function Dt(){var r;(r=ts)===null||r===void 0||r.abort(),ts=new AbortController;const e={capture:!0,signal:ts.signal};dt.size&&(Ke?(xe.length>0&&Be.forEach((t,d)=>{const{body:b}=d;t>0&&(b.addEventListener("contextmenu",Qt,e),b.addEventListener("pointerleave",Zt,e),b.addEventListener("pointermove",Zt,e))}),Be.forEach((t,d)=>{const{body:b}=d;b.addEventListener("pointerup",Qt,e),b.addEventListener("pointercancel",Qt,e)})):Be.forEach((t,d)=>{const{body:b}=d;t>0&&(b.addEventListener("pointerdown",_a,e),b.addEventListener("pointermove",Zt,e))}))}function Tt(r,e){dt.forEach(t=>{const{setResizeHandlerState:d}=t,b=xe.includes(t);d(r,b,e)})}function ma(){const[r,e]=P.useState(0);return P.useCallback(()=>e(t=>t+1),[])}function Q(r,e){if(!r)throw console.error(e),Error(e)}function Fe(r,e,t=Bs){return r.toFixed(t)===e.toFixed(t)?0:r>e?1:-1}function Le(r,e,t=Bs){return Fe(r,e,t)===0}function _e(r,e,t){return Fe(r,e,t)===0}function ga(r,e,t){if(r.length!==e.length)return!1;for(let d=0;d<r.length;d++){const b=r[d],k=e[d];if(!_e(b,k,t))return!1}return!0}function qe({panelConstraints:r,panelIndex:e,size:t}){const d=r[e];Q(d!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:b=0,collapsible:k,maxSize:E=100,minSize:s=0}=d;if(Fe(t,s)<0)if(k){const a=(b+s)/2;Fe(t,a)<0?t=b:t=s}else t=s;return t=Math.min(E,t),t=parseFloat(t.toFixed(Bs)),t}function lt({delta:r,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:b,trigger:k}){if(_e(r,0))return e;const E=[...e],[s,a]=d;Q(s!=null,"Invalid first pivot index"),Q(a!=null,"Invalid second pivot index");let u=0;if(k==="keyboard"){{const c=r<0?a:s,h=t[c];Q(h,`Panel constraints not found for index ${c}`);const{collapsedSize:m=0,collapsible:S,minSize:_=0}=h;if(S){const n=e[c];if(Q(n!=null,`Previous layout not found for panel index ${c}`),_e(n,m)){const o=_-n;Fe(o,Math.abs(r))>0&&(r=r<0?0-o:o)}}}{const c=r<0?s:a,h=t[c];Q(h,`No panel constraints found for index ${c}`);const{collapsedSize:m=0,collapsible:S,minSize:_=0}=h;if(S){const n=e[c];if(Q(n!=null,`Previous layout not found for panel index ${c}`),_e(n,_)){const o=n-m;Fe(o,Math.abs(r))>0&&(r=r<0?0-o:o)}}}}{const c=r<0?1:-1;let h=r<0?a:s,m=0;for(;;){const _=e[h];Q(_!=null,`Previous layout not found for panel index ${h}`);const o=qe({panelConstraints:t,panelIndex:h,size:100})-_;if(m+=o,h+=c,h<0||h>=t.length)break}const S=Math.min(Math.abs(r),Math.abs(m));r=r<0?0-S:S}{let h=r<0?s:a;for(;h>=0&&h<t.length;){const m=Math.abs(r)-Math.abs(u),S=e[h];Q(S!=null,`Previous layout not found for panel index ${h}`);const _=S-m,n=qe({panelConstraints:t,panelIndex:h,size:_});if(!_e(S,n)&&(u+=S-n,E[h]=n,u.toPrecision(3).localeCompare(Math.abs(r).toPrecision(3),void 0,{numeric:!0})>=0))break;r<0?h--:h++}}if(ga(b,E))return b;{const c=r<0?a:s,h=e[c];Q(h!=null,`Previous layout not found for panel index ${c}`);const m=h+u,S=qe({panelConstraints:t,panelIndex:c,size:m});if(E[c]=S,!_e(S,m)){let _=m-S,o=r<0?a:s;for(;o>=0&&o<t.length;){const i=E[o];Q(i!=null,`Previous layout not found for panel index ${o}`);const l=i+_,g=qe({panelConstraints:t,panelIndex:o,size:l});if(_e(i,g)||(_-=g-i,E[o]=g),_e(_,0))break;r>0?o--:o++}}}const p=E.reduce((c,h)=>h+c,0);return _e(p,100)?E:b}function va({layout:r,panelsArray:e,pivotIndices:t}){let d=0,b=100,k=0,E=0;const s=t[0];Q(s!=null,"No pivot index found"),e.forEach((c,h)=>{const{constraints:m}=c,{maxSize:S=100,minSize:_=0}=m;h===s?(d=_,b=S):(k+=_,E+=S)});const a=Math.min(b,100-k),u=Math.max(d,100-E),p=r[s];return{valueMax:a,valueMin:u,valueNow:p}}function ut(r,e=document){return Array.from(e.querySelectorAll(`[${ae.resizeHandleId}][data-panel-group-id="${r}"]`))}function si(r,e,t=document){const b=ut(r,t).findIndex(k=>k.getAttribute(ae.resizeHandleId)===e);return b??null}function ri(r,e,t){const d=si(r,e,t);return d!=null?[d,d+1]:[-1,-1]}function Sa(r){return r instanceof HTMLElement?!0:typeof r=="object"&&r!==null&&"tagName"in r&&"getAttribute"in r}function ii(r,e=document){if(Sa(e)&&e.dataset.panelGroupId==r)return e;const t=e.querySelector(`[data-panel-group][data-panel-group-id="${r}"]`);return t||null}function Wt(r,e=document){const t=e.querySelector(`[${ae.resizeHandleId}="${r}"]`);return t||null}function ba(r,e,t,d=document){var b,k,E,s;const a=Wt(e,d),u=ut(r,d),p=a?u.indexOf(a):-1,c=(b=(k=t[p])===null||k===void 0?void 0:k.id)!==null&&b!==void 0?b:null,h=(E=(s=t[p+1])===null||s===void 0?void 0:s.id)!==null&&E!==void 0?E:null;return[c,h]}function ya({committedValuesRef:r,eagerValuesRef:e,groupId:t,layout:d,panelDataArray:b,panelGroupElement:k,setLayout:E}){P.useRef({didWarnAboutMissingResizeHandle:!1}),He(()=>{if(!k)return;const s=ut(t,k);for(let a=0;a<b.length-1;a++){const{valueMax:u,valueMin:p,valueNow:c}=va({layout:d,panelsArray:b,pivotIndices:[a,a+1]}),h=s[a];if(h!=null){const m=b[a];Q(m,`No panel data found for index "${a}"`),h.setAttribute("aria-controls",m.id),h.setAttribute("aria-valuemax",""+Math.round(u)),h.setAttribute("aria-valuemin",""+Math.round(p)),h.setAttribute("aria-valuenow",c!=null?""+Math.round(c):"")}}return()=>{s.forEach((a,u)=>{a.removeAttribute("aria-controls"),a.removeAttribute("aria-valuemax"),a.removeAttribute("aria-valuemin"),a.removeAttribute("aria-valuenow")})}},[t,d,b,k]),P.useEffect(()=>{if(!k)return;const s=e.current;Q(s,"Eager values not found");const{panelDataArray:a}=s,u=ii(t,k);Q(u!=null,`No group found for id "${t}"`);const p=ut(t,k);Q(p,`No resize handles found for group id "${t}"`);const c=p.map(h=>{const m=h.getAttribute(ae.resizeHandleId);Q(m,"Resize handle element has no handle id attribute");const[S,_]=ba(t,m,a,k);if(S==null||_==null)return()=>{};const n=o=>{if(!o.defaultPrevented)switch(o.key){case"Enter":{o.preventDefault();const i=a.findIndex(l=>l.id===S);if(i>=0){const l=a[i];Q(l,`No panel data found for index ${i}`);const g=d[i],{collapsedSize:x=0,collapsible:y,minSize:w=0}=l.constraints;if(g!=null&&y){const v=lt({delta:_e(g,x)?w-x:x-g,initialLayout:d,panelConstraints:a.map(C=>C.constraints),pivotIndices:ri(t,m,k),prevLayout:d,trigger:"keyboard"});d!==v&&E(v)}}break}}};return h.addEventListener("keydown",n),()=>{h.removeEventListener("keydown",n)}});return()=>{c.forEach(h=>h())}},[k,r,e,t,d,b,E])}function rr(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function ni(r,e){const t=r==="horizontal",{x:d,y:b}=zt(e);return t?d:b}function xa(r,e,t,d,b){const k=t==="horizontal",E=Wt(e,b);Q(E,`No resize handle element found for id "${e}"`);const s=E.getAttribute(ae.groupId);Q(s,"Resize handle element has no group id attribute");let{initialCursorPosition:a}=d;const u=ni(t,r),p=ii(s,b);Q(p,`No group element found for id "${s}"`);const c=p.getBoundingClientRect(),h=k?c.width:c.height;return(u-a)/h*100}function wa(r,e,t,d,b,k){if(Vr(r)){const E=t==="horizontal";let s=0;r.shiftKey?s=100:b!=null?s=b:s=10;let a=0;switch(r.key){case"ArrowDown":a=E?0:s;break;case"ArrowLeft":a=E?-s:0;break;case"ArrowRight":a=E?s:0;break;case"ArrowUp":a=E?0:-s;break;case"End":a=100;break;case"Home":a=-100;break}return a}else return d==null?0:xa(r,e,t,d,k)}function Ca({panelDataArray:r}){const e=Array(r.length),t=r.map(k=>k.constraints);let d=0,b=100;for(let k=0;k<r.length;k++){const E=t[k];Q(E,`Panel constraints not found for index ${k}`);const{defaultSize:s}=E;s!=null&&(d++,e[k]=s,b-=s)}for(let k=0;k<r.length;k++){const E=t[k];Q(E,`Panel constraints not found for index ${k}`);const{defaultSize:s}=E;if(s!=null)continue;const a=r.length-d,u=b/a;d++,e[k]=u,b-=u}return e}function $e(r,e,t){e.forEach((d,b)=>{const k=r[b];Q(k,`Panel data not found for index ${b}`);const{callbacks:E,constraints:s,id:a}=k,{collapsedSize:u=0,collapsible:p}=s,c=t[a];if(c==null||d!==c){t[a]=d;const{onCollapse:h,onExpand:m,onResize:S}=E;S&&S(d,c),p&&(h||m)&&(m&&(c==null||Le(c,u))&&!Le(d,u)&&m(),h&&(c==null||!Le(c,u))&&Le(d,u)&&h())}})}function gt(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t])return!1;return!0}function Ea({defaultSize:r,dragState:e,layout:t,panelData:d,panelIndex:b,precision:k=3}){const E=t[b];let s;return E==null?s=r!=null?r.toPrecision(k):"1":d.length===1?s="1":s=E.toPrecision(k),{flexBasis:0,flexGrow:s,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function ka(r,e=10){let t=null;return(...b)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{r(...b)},e)}}function ir(r){try{if(typeof localStorage<"u")r.getItem=e=>localStorage.getItem(e),r.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),r.getItem=()=>null,r.setItem=()=>{}}}function oi(r){return`react-resizable-panels:${r}`}function ai(r){return r.map(e=>{const{constraints:t,id:d,idIsFromProps:b,order:k}=e;return b?d:k?`${k}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function li(r,e){try{const t=oi(r),d=e.getItem(t);if(d){const b=JSON.parse(d);if(typeof b=="object"&&b!=null)return b}}catch{}return null}function Ra(r,e,t){var d,b;const k=(d=li(r,t))!==null&&d!==void 0?d:{},E=ai(e);return(b=k[E])!==null&&b!==void 0?b:null}function La(r,e,t,d,b){var k;const E=oi(r),s=ai(e),a=(k=li(r,b))!==null&&k!==void 0?k:{};a[s]={expandToSizes:Object.fromEntries(t.entries()),layout:d};try{b.setItem(E,JSON.stringify(a))}catch(u){console.error(u)}}function nr({layout:r,panelConstraints:e}){const t=[...r],d=t.reduce((k,E)=>k+E,0);if(t.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${t.map(k=>`${k}%`).join(", ")}`);if(!_e(d,100)&&t.length>0)for(let k=0;k<e.length;k++){const E=t[k];Q(E!=null,`No layout data found for index ${k}`);const s=100/d*E;t[k]=s}let b=0;for(let k=0;k<e.length;k++){const E=t[k];Q(E!=null,`No layout data found for index ${k}`);const s=qe({panelConstraints:e,panelIndex:k,size:E});E!=s&&(b+=E-s,t[k]=s)}if(!_e(b,0))for(let k=0;k<e.length;k++){const E=t[k];Q(E!=null,`No layout data found for index ${k}`);const s=E+b,a=qe({panelConstraints:e,panelIndex:k,size:s});if(E!==a&&(b-=a-E,t[k]=a,_e(b,0)))break}return t}const Aa=100,ct={getItem:r=>(ir(ct),ct.getItem(r)),setItem:(r,e)=>{ir(ct),ct.setItem(r,e)}},or={};function ci({autoSaveId:r=null,children:e,className:t="",direction:d,forwardedRef:b,id:k=null,onLayout:E=null,keyboardResizeBy:s=null,storage:a=ct,style:u,tagName:p="div",...c}){const h=Is(k),m=P.useRef(null),[S,_]=P.useState(null),[n,o]=P.useState([]),i=ma(),l=P.useRef({}),g=P.useRef(new Map),x=P.useRef(0),y=P.useRef({autoSaveId:r,direction:d,dragState:S,id:h,keyboardResizeBy:s,onLayout:E,storage:a}),w=P.useRef({layout:n,panelDataArray:[],panelDataArrayChanged:!1});P.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),P.useImperativeHandle(b,()=>({getId:()=>y.current.id,getLayout:()=>{const{layout:H}=w.current;return H},setLayout:H=>{const{onLayout:$}=y.current,{layout:K,panelDataArray:V}=w.current,N=nr({layout:H,panelConstraints:V.map(L=>L.constraints)});rr(K,N)||(o(N),w.current.layout=N,$&&$(N),$e(V,N,l.current))}}),[]),He(()=>{y.current.autoSaveId=r,y.current.direction=d,y.current.dragState=S,y.current.id=h,y.current.onLayout=E,y.current.storage=a}),ya({committedValuesRef:y,eagerValuesRef:w,groupId:h,layout:n,panelDataArray:w.current.panelDataArray,setLayout:o,panelGroupElement:m.current}),P.useEffect(()=>{const{panelDataArray:H}=w.current;if(r){if(n.length===0||n.length!==H.length)return;let $=or[r];$==null&&($=ka(La,Aa),or[r]=$);const K=[...H],V=new Map(g.current);$(r,K,V,n,a)}},[r,n,a]),P.useEffect(()=>{});const v=P.useCallback(H=>{const{onLayout:$}=y.current,{layout:K,panelDataArray:V}=w.current;if(H.constraints.collapsible){const N=V.map(Y=>Y.constraints),{collapsedSize:L=0,panelSize:F,pivotIndices:W}=Oe(V,H,K);if(Q(F!=null,`Panel size not found for panel "${H.id}"`),!Le(F,L)){g.current.set(H.id,F);const G=Ue(V,H)===V.length-1?F-L:L-F,J=lt({delta:G,initialLayout:K,panelConstraints:N,pivotIndices:W,prevLayout:K,trigger:"imperative-api"});gt(K,J)||(o(J),w.current.layout=J,$&&$(J),$e(V,J,l.current))}}},[]),C=P.useCallback((H,$)=>{const{onLayout:K}=y.current,{layout:V,panelDataArray:N}=w.current;if(H.constraints.collapsible){const L=N.map(re=>re.constraints),{collapsedSize:F=0,panelSize:W=0,minSize:Y=0,pivotIndices:G}=Oe(N,H,V),J=$??Y;if(Le(W,F)){const re=g.current.get(H.id),ne=re!=null&&re>=J?re:J,Z=Ue(N,H)===N.length-1?W-ne:ne-W,le=lt({delta:Z,initialLayout:V,panelConstraints:L,pivotIndices:G,prevLayout:V,trigger:"imperative-api"});gt(V,le)||(o(le),w.current.layout=le,K&&K(le),$e(N,le,l.current))}}},[]),T=P.useCallback(H=>{const{layout:$,panelDataArray:K}=w.current,{panelSize:V}=Oe(K,H,$);return Q(V!=null,`Panel size not found for panel "${H.id}"`),V},[]),A=P.useCallback((H,$)=>{const{panelDataArray:K}=w.current,V=Ue(K,H);return Ea({defaultSize:$,dragState:S,layout:n,panelData:K,panelIndex:V})},[S,n]),B=P.useCallback(H=>{const{layout:$,panelDataArray:K}=w.current,{collapsedSize:V=0,collapsible:N,panelSize:L}=Oe(K,H,$);return Q(L!=null,`Panel size not found for panel "${H.id}"`),N===!0&&Le(L,V)},[]),D=P.useCallback(H=>{const{layout:$,panelDataArray:K}=w.current,{collapsedSize:V=0,collapsible:N,panelSize:L}=Oe(K,H,$);return Q(L!=null,`Panel size not found for panel "${H.id}"`),!N||Fe(L,V)>0},[]),j=P.useCallback(H=>{const{panelDataArray:$}=w.current;$.push(H),$.sort((K,V)=>{const N=K.order,L=V.order;return N==null&&L==null?0:N==null?-1:L==null?1:N-L}),w.current.panelDataArrayChanged=!0,i()},[i]);He(()=>{if(w.current.panelDataArrayChanged){w.current.panelDataArrayChanged=!1;const{autoSaveId:H,onLayout:$,storage:K}=y.current,{layout:V,panelDataArray:N}=w.current;let L=null;if(H){const W=Ra(H,N,K);W&&(g.current=new Map(Object.entries(W.expandToSizes)),L=W.layout)}L==null&&(L=Ca({panelDataArray:N}));const F=nr({layout:L,panelConstraints:N.map(W=>W.constraints)});rr(V,F)||(o(F),w.current.layout=F,$&&$(F),$e(N,F,l.current))}}),He(()=>{const H=w.current;return()=>{H.layout=[]}},[]);const z=P.useCallback(H=>{let $=!1;const K=m.current;return K&&window.getComputedStyle(K,null).getPropertyValue("direction")==="rtl"&&($=!0),function(N){N.preventDefault();const L=m.current;if(!L)return()=>null;const{direction:F,dragState:W,id:Y,keyboardResizeBy:G,onLayout:J}=y.current,{layout:re,panelDataArray:ne}=w.current,{initialLayout:he}=W??{},Z=ri(Y,H,L);let le=wa(N,H,F,W,G,L);const ze=F==="horizontal";ze&&$&&(le=-le);const Ze=ne.map(pe=>pe.constraints),Re=lt({delta:le,initialLayout:he??re,panelConstraints:Ze,pivotIndices:Z,prevLayout:re,trigger:Vr(N)?"keyboard":"mouse-or-touch"}),Ne=!gt(re,Re);(Gr(N)||Xr(N))&&x.current!=le&&(x.current=le,!Ne&&le!==0?ze?es(H,le<0?Jr:Zr):es(H,le<0?Qr:ei):es(H,0)),Ne&&(o(Re),w.current.layout=Re,J&&J(Re),$e(ne,Re,l.current))}},[]),U=P.useCallback((H,$)=>{const{onLayout:K}=y.current,{layout:V,panelDataArray:N}=w.current,L=N.map(re=>re.constraints),{panelSize:F,pivotIndices:W}=Oe(N,H,V);Q(F!=null,`Panel size not found for panel "${H.id}"`);const G=Ue(N,H)===N.length-1?F-$:$-F,J=lt({delta:G,initialLayout:V,panelConstraints:L,pivotIndices:W,prevLayout:V,trigger:"imperative-api"});gt(V,J)||(o(J),w.current.layout=J,K&&K(J),$e(N,J,l.current))},[]),X=P.useCallback((H,$)=>{const{layout:K,panelDataArray:V}=w.current,{collapsedSize:N=0,collapsible:L}=$,{collapsedSize:F=0,collapsible:W,maxSize:Y=100,minSize:G=0}=H.constraints,{panelSize:J}=Oe(V,H,K);J!=null&&(L&&W&&Le(J,N)?Le(N,F)||U(H,F):J<G?U(H,G):J>Y&&U(H,Y))},[U]),q=P.useCallback((H,$)=>{const{direction:K}=y.current,{layout:V}=w.current;if(!m.current)return;const N=Wt(H,m.current);Q(N,`Drag handle element not found for id "${H}"`);const L=ni(K,$);_({dragHandleId:H,dragHandleRect:N.getBoundingClientRect(),initialCursorPosition:L,initialLayout:V})},[]),R=P.useCallback(()=>{_(null)},[]),M=P.useCallback(H=>{const{panelDataArray:$}=w.current,K=Ue($,H);K>=0&&($.splice(K,1),delete l.current[H.id],w.current.panelDataArrayChanged=!0,i())},[i]),I=P.useMemo(()=>({collapsePanel:v,direction:d,dragState:S,expandPanel:C,getPanelSize:T,getPanelStyle:A,groupId:h,isPanelCollapsed:B,isPanelExpanded:D,reevaluatePanelConstraints:X,registerPanel:j,registerResizeHandle:z,resizePanel:U,startDragging:q,stopDragging:R,unregisterPanel:M,panelGroupElement:m.current}),[v,S,d,C,T,A,h,B,D,X,j,z,U,q,R,M]),O={display:"flex",flexDirection:d==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return P.createElement(Ft.Provider,{value:I},P.createElement(p,{...c,children:e,className:t,id:k,ref:m,style:{...O,...u},[ae.group]:"",[ae.groupDirection]:d,[ae.groupId]:h}))}const hi=P.forwardRef((r,e)=>P.createElement(ci,{...r,forwardedRef:e}));ci.displayName="PanelGroup";hi.displayName="forwardRef(PanelGroup)";function Ue(r,e){return r.findIndex(t=>t===e||t.id===e.id)}function Oe(r,e,t){const d=Ue(r,e),k=d===r.length-1?[d-1,d]:[d,d+1],E=t[d];return{...e.constraints,panelSize:E,pivotIndices:k}}function Da({disabled:r,handleId:e,resizeHandler:t,panelGroupElement:d}){P.useEffect(()=>{if(r||t==null||d==null)return;const b=Wt(e,d);if(b==null)return;const k=E=>{if(!E.defaultPrevented)switch(E.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{E.preventDefault(),t(E);break}case"F6":{E.preventDefault();const s=b.getAttribute(ae.groupId);Q(s,`No group element found for id "${s}"`);const a=ut(s,d),u=si(s,e,d);Q(u!==null,`No resize element found for id "${e}"`);const p=E.shiftKey?u>0?u-1:a.length-1:u+1<a.length?u+1:0;a[p].focus();break}}};return b.addEventListener("keydown",k),()=>{b.removeEventListener("keydown",k)}},[d,r,e,t])}function di({children:r=null,className:e="",disabled:t=!1,hitAreaMargins:d,id:b,onBlur:k,onClick:E,onDragging:s,onFocus:a,onPointerDown:u,onPointerUp:p,style:c={},tabIndex:h=0,tagName:m="div",...S}){var _,n;const o=P.useRef(null),i=P.useRef({onClick:E,onDragging:s,onPointerDown:u,onPointerUp:p});P.useEffect(()=>{i.current.onClick=E,i.current.onDragging=s,i.current.onPointerDown=u,i.current.onPointerUp=p});const l=P.useContext(Ft);if(l===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:g,groupId:x,registerResizeHandle:y,startDragging:w,stopDragging:v,panelGroupElement:C}=l,T=Is(b),[A,B]=P.useState("inactive"),[D,j]=P.useState(!1),[z,U]=P.useState(null),X=P.useRef({state:A});He(()=>{X.current.state=A}),P.useEffect(()=>{if(t)U(null);else{const I=y(T);U(()=>I)}},[t,T,y]);const q=(_=d?.coarse)!==null&&_!==void 0?_:15,R=(n=d?.fine)!==null&&n!==void 0?n:5;P.useEffect(()=>{if(t||z==null)return;const I=o.current;Q(I,"Element ref not attached");let O=!1;return pa(T,I,g,{coarse:q,fine:R},($,K,V)=>{if(!K){B("inactive");return}switch($){case"down":{B("drag"),O=!1,Q(V,'Expected event to be defined for "down" action'),w(T,V);const{onDragging:N,onPointerDown:L}=i.current;N?.(!0),L?.();break}case"move":{const{state:N}=X.current;O=!0,N!=="drag"&&B("hover"),Q(V,'Expected event to be defined for "move" action'),z(V);break}case"up":{B("hover"),v();const{onClick:N,onDragging:L,onPointerUp:F}=i.current;L?.(!1),F?.(),O||N?.();break}}})},[q,g,t,R,y,T,z,w,v]),Da({disabled:t,handleId:T,resizeHandler:z,panelGroupElement:C});const M={touchAction:"none",userSelect:"none"};return P.createElement(m,{...S,children:r,className:e,id:b,onBlur:()=>{j(!1),k?.()},onFocus:()=>{j(!0),a?.()},ref:o,role:"separator",style:{...M,...c},tabIndex:h,[ae.groupDirection]:g,[ae.groupId]:x,[ae.resizeHandle]:"",[ae.resizeHandleActive]:A==="drag"?"pointer":D?"keyboard":void 0,[ae.resizeHandleEnabled]:!t,[ae.resizeHandleId]:T,[ae.resizeHandleState]:A})}di.displayName="PanelResizeHandle";function te(...r){return Fn(Hr(r))}function ar({className:r,...e}){return f.jsx(hi,{"data-slot":"resizable-panel-group",className:te("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",r),...e})}function vt({...r}){return f.jsx(Kr,{"data-slot":"resizable-panel",...r})}function lr({withHandle:r,className:e,...t}){return f.jsx(di,{"data-slot":"resizable-handle",className:te("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",e),...t,children:r&&f.jsx("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:f.jsx(yo,{className:"size-2.5"})})})}const cr=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,hr=Hr,js=(r,e)=>t=>{var d;if(e?.variants==null)return hr(r,t?.class,t?.className);const{variants:b,defaultVariants:k}=e,E=Object.keys(b).map(u=>{const p=t?.[u],c=k?.[u];if(p===null)return null;const h=cr(p)||cr(c);return b[u][h]}),s=t&&Object.entries(t).reduce((u,p)=>{let[c,h]=p;return h===void 0||(u[c]=h),u},{}),a=e==null||(d=e.compoundVariants)===null||d===void 0?void 0:d.reduce((u,p)=>{let{class:c,className:h,...m}=p;return Object.entries(m).every(S=>{let[_,n]=S;return Array.isArray(n)?n.includes({...k,...s}[_]):{...k,...s}[_]===n})?[...u,c,h]:u},[]);return hr(r,E,a,t?.class,t?.className)},Ta=js("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function ie({className:r,variant:e,size:t,asChild:d=!1,...b}){const k=d?Tr:"button";return f.jsx(k,{"data-slot":"button",className:te(Ta({variant:e,size:t,className:r})),...b})}function Pa(r,e){return P.useReducer((t,d)=>e[t][d]??t,r)}var Hs="ScrollArea",[ui,Th]=Nt(Hs),[Ma,be]=ui(Hs),fi=P.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:d="hover",dir:b,scrollHideDelay:k=600,...E}=r,[s,a]=P.useState(null),[u,p]=P.useState(null),[c,h]=P.useState(null),[m,S]=P.useState(null),[_,n]=P.useState(null),[o,i]=P.useState(0),[l,g]=P.useState(0),[x,y]=P.useState(!1),[w,v]=P.useState(!1),C=Se(e,A=>a(A)),T=Pr(b);return f.jsx(Ma,{scope:t,type:d,dir:T,scrollHideDelay:k,scrollArea:s,viewport:u,onViewportChange:p,content:c,onContentChange:h,scrollbarX:m,onScrollbarXChange:S,scrollbarXEnabled:x,onScrollbarXEnabledChange:y,scrollbarY:_,onScrollbarYChange:n,scrollbarYEnabled:w,onScrollbarYEnabledChange:v,onCornerWidthChange:i,onCornerHeightChange:g,children:f.jsx(ue.div,{dir:T,...E,ref:C,style:{position:"relative","--radix-scroll-area-corner-width":o+"px","--radix-scroll-area-corner-height":l+"px",...r.style}})})});fi.displayName=Hs;var pi="ScrollAreaViewport",_i=P.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:d,nonce:b,...k}=r,E=be(pi,t),s=P.useRef(null),a=Se(e,s,E.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:b}),f.jsx(ue.div,{"data-radix-scroll-area-viewport":"",...k,ref:a,style:{overflowX:E.scrollbarXEnabled?"scroll":"hidden",overflowY:E.scrollbarYEnabled?"scroll":"hidden",...r.style},children:f.jsx("div",{ref:E.onContentChange,style:{minWidth:"100%",display:"table"},children:d})})]})});_i.displayName=pi;var ke="ScrollAreaScrollbar",mi=P.forwardRef((r,e)=>{const{forceMount:t,...d}=r,b=be(ke,r.__scopeScrollArea),{onScrollbarXEnabledChange:k,onScrollbarYEnabledChange:E}=b,s=r.orientation==="horizontal";return P.useEffect(()=>(s?k(!0):E(!0),()=>{s?k(!1):E(!1)}),[s,k,E]),b.type==="hover"?f.jsx(Ba,{...d,ref:e,forceMount:t}):b.type==="scroll"?f.jsx(Ia,{...d,ref:e,forceMount:t}):b.type==="auto"?f.jsx(gi,{...d,ref:e,forceMount:t}):b.type==="always"?f.jsx(Fs,{...d,ref:e}):null});mi.displayName=ke;var Ba=P.forwardRef((r,e)=>{const{forceMount:t,...d}=r,b=be(ke,r.__scopeScrollArea),[k,E]=P.useState(!1);return P.useEffect(()=>{const s=b.scrollArea;let a=0;if(s){const u=()=>{window.clearTimeout(a),E(!0)},p=()=>{a=window.setTimeout(()=>E(!1),b.scrollHideDelay)};return s.addEventListener("pointerenter",u),s.addEventListener("pointerleave",p),()=>{window.clearTimeout(a),s.removeEventListener("pointerenter",u),s.removeEventListener("pointerleave",p)}}},[b.scrollArea,b.scrollHideDelay]),f.jsx(Ot,{present:t||k,children:f.jsx(gi,{"data-state":k?"visible":"hidden",...d,ref:e})})}),Ia=P.forwardRef((r,e)=>{const{forceMount:t,...d}=r,b=be(ke,r.__scopeScrollArea),k=r.orientation==="horizontal",E=qt(()=>a("SCROLL_END"),100),[s,a]=Pa("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return P.useEffect(()=>{if(s==="idle"){const u=window.setTimeout(()=>a("HIDE"),b.scrollHideDelay);return()=>window.clearTimeout(u)}},[s,b.scrollHideDelay,a]),P.useEffect(()=>{const u=b.viewport,p=k?"scrollLeft":"scrollTop";if(u){let c=u[p];const h=()=>{const m=u[p];c!==m&&(a("SCROLL"),E()),c=m};return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)}},[b.viewport,k,a,E]),f.jsx(Ot,{present:t||s!=="hidden",children:f.jsx(Fs,{"data-state":s==="hidden"?"hidden":"visible",...d,ref:e,onPointerEnter:ge(r.onPointerEnter,()=>a("POINTER_ENTER")),onPointerLeave:ge(r.onPointerLeave,()=>a("POINTER_LEAVE"))})})}),gi=P.forwardRef((r,e)=>{const t=be(ke,r.__scopeScrollArea),{forceMount:d,...b}=r,[k,E]=P.useState(!1),s=r.orientation==="horizontal",a=qt(()=>{if(t.viewport){const u=t.viewport.offsetWidth<t.viewport.scrollWidth,p=t.viewport.offsetHeight<t.viewport.scrollHeight;E(s?u:p)}},10);return Xe(t.viewport,a),Xe(t.content,a),f.jsx(Ot,{present:d||k,children:f.jsx(Fs,{"data-state":k?"visible":"hidden",...b,ref:e})})}),Fs=P.forwardRef((r,e)=>{const{orientation:t="vertical",...d}=r,b=be(ke,r.__scopeScrollArea),k=P.useRef(null),E=P.useRef(0),[s,a]=P.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=xi(s.viewport,s.content),p={...d,sizes:s,onSizesChange:a,hasThumb:u>0&&u<1,onThumbChange:h=>k.current=h,onThumbPointerUp:()=>E.current=0,onThumbPointerDown:h=>E.current=h};function c(h,m){return za(h,E.current,s,m)}return t==="horizontal"?f.jsx(Na,{...p,ref:e,onThumbPositionChange:()=>{if(b.viewport&&k.current){const h=b.viewport.scrollLeft,m=dr(h,s,b.dir);k.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{b.viewport&&(b.viewport.scrollLeft=h)},onDragScroll:h=>{b.viewport&&(b.viewport.scrollLeft=c(h,b.dir))}}):t==="vertical"?f.jsx(Oa,{...p,ref:e,onThumbPositionChange:()=>{if(b.viewport&&k.current){const h=b.viewport.scrollTop,m=dr(h,s);k.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{b.viewport&&(b.viewport.scrollTop=h)},onDragScroll:h=>{b.viewport&&(b.viewport.scrollTop=c(h))}}):null}),Na=P.forwardRef((r,e)=>{const{sizes:t,onSizesChange:d,...b}=r,k=be(ke,r.__scopeScrollArea),[E,s]=P.useState(),a=P.useRef(null),u=Se(e,a,k.onScrollbarXChange);return P.useEffect(()=>{a.current&&s(getComputedStyle(a.current))},[a]),f.jsx(Si,{"data-orientation":"horizontal",...b,ref:u,sizes:t,style:{bottom:0,left:k.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:k.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ut(t)+"px",...r.style},onThumbPointerDown:p=>r.onThumbPointerDown(p.x),onDragScroll:p=>r.onDragScroll(p.x),onWheelScroll:(p,c)=>{if(k.viewport){const h=k.viewport.scrollLeft+p.deltaX;r.onWheelScroll(h),Ci(h,c)&&p.preventDefault()}},onResize:()=>{a.current&&k.viewport&&E&&d({content:k.viewport.scrollWidth,viewport:k.viewport.offsetWidth,scrollbar:{size:a.current.clientWidth,paddingStart:Mt(E.paddingLeft),paddingEnd:Mt(E.paddingRight)}})}})}),Oa=P.forwardRef((r,e)=>{const{sizes:t,onSizesChange:d,...b}=r,k=be(ke,r.__scopeScrollArea),[E,s]=P.useState(),a=P.useRef(null),u=Se(e,a,k.onScrollbarYChange);return P.useEffect(()=>{a.current&&s(getComputedStyle(a.current))},[a]),f.jsx(Si,{"data-orientation":"vertical",...b,ref:u,sizes:t,style:{top:0,right:k.dir==="ltr"?0:void 0,left:k.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ut(t)+"px",...r.style},onThumbPointerDown:p=>r.onThumbPointerDown(p.y),onDragScroll:p=>r.onDragScroll(p.y),onWheelScroll:(p,c)=>{if(k.viewport){const h=k.viewport.scrollTop+p.deltaY;r.onWheelScroll(h),Ci(h,c)&&p.preventDefault()}},onResize:()=>{a.current&&k.viewport&&E&&d({content:k.viewport.scrollHeight,viewport:k.viewport.offsetHeight,scrollbar:{size:a.current.clientHeight,paddingStart:Mt(E.paddingTop),paddingEnd:Mt(E.paddingBottom)}})}})}),[ja,vi]=ui(ke),Si=P.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:d,hasThumb:b,onThumbChange:k,onThumbPointerUp:E,onThumbPointerDown:s,onThumbPositionChange:a,onDragScroll:u,onWheelScroll:p,onResize:c,...h}=r,m=be(ke,t),[S,_]=P.useState(null),n=Se(e,C=>_(C)),o=P.useRef(null),i=P.useRef(""),l=m.viewport,g=d.content-d.viewport,x=Pe(p),y=Pe(a),w=qt(c,10);function v(C){if(o.current){const T=C.clientX-o.current.left,A=C.clientY-o.current.top;u({x:T,y:A})}}return P.useEffect(()=>{const C=T=>{const A=T.target;S?.contains(A)&&x(T,g)};return document.addEventListener("wheel",C,{passive:!1}),()=>document.removeEventListener("wheel",C,{passive:!1})},[l,S,g,x]),P.useEffect(y,[d,y]),Xe(S,w),Xe(m.content,w),f.jsx(ja,{scope:t,scrollbar:S,hasThumb:b,onThumbChange:Pe(k),onThumbPointerUp:Pe(E),onThumbPositionChange:y,onThumbPointerDown:Pe(s),children:f.jsx(ue.div,{...h,ref:n,style:{position:"absolute",...h.style},onPointerDown:ge(r.onPointerDown,C=>{C.button===0&&(C.target.setPointerCapture(C.pointerId),o.current=S.getBoundingClientRect(),i.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),v(C))}),onPointerMove:ge(r.onPointerMove,v),onPointerUp:ge(r.onPointerUp,C=>{const T=C.target;T.hasPointerCapture(C.pointerId)&&T.releasePointerCapture(C.pointerId),document.body.style.webkitUserSelect=i.current,m.viewport&&(m.viewport.style.scrollBehavior=""),o.current=null})})})}),Pt="ScrollAreaThumb",bi=P.forwardRef((r,e)=>{const{forceMount:t,...d}=r,b=vi(Pt,r.__scopeScrollArea);return f.jsx(Ot,{present:t||b.hasThumb,children:f.jsx(Ha,{ref:e,...d})})}),Ha=P.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:d,...b}=r,k=be(Pt,t),E=vi(Pt,t),{onThumbPositionChange:s}=E,a=Se(e,c=>E.onThumbChange(c)),u=P.useRef(void 0),p=qt(()=>{u.current&&(u.current(),u.current=void 0)},100);return P.useEffect(()=>{const c=k.viewport;if(c){const h=()=>{if(p(),!u.current){const m=$a(c,s);u.current=m,s()}};return s(),c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[k.viewport,p,s]),f.jsx(ue.div,{"data-state":E.hasThumb?"visible":"hidden",...b,ref:a,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...d},onPointerDownCapture:ge(r.onPointerDownCapture,c=>{const m=c.target.getBoundingClientRect(),S=c.clientX-m.left,_=c.clientY-m.top;E.onThumbPointerDown({x:S,y:_})}),onPointerUp:ge(r.onPointerUp,E.onThumbPointerUp)})});bi.displayName=Pt;var zs="ScrollAreaCorner",yi=P.forwardRef((r,e)=>{const t=be(zs,r.__scopeScrollArea),d=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&d?f.jsx(Fa,{...r,ref:e}):null});yi.displayName=zs;var Fa=P.forwardRef((r,e)=>{const{__scopeScrollArea:t,...d}=r,b=be(zs,t),[k,E]=P.useState(0),[s,a]=P.useState(0),u=!!(k&&s);return Xe(b.scrollbarX,()=>{const p=b.scrollbarX?.offsetHeight||0;b.onCornerHeightChange(p),a(p)}),Xe(b.scrollbarY,()=>{const p=b.scrollbarY?.offsetWidth||0;b.onCornerWidthChange(p),E(p)}),u?f.jsx(ue.div,{...d,ref:e,style:{width:k,height:s,position:"absolute",right:b.dir==="ltr"?0:void 0,left:b.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function Mt(r){return r?parseInt(r,10):0}function xi(r,e){const t=r/e;return isNaN(t)?0:t}function Ut(r){const e=xi(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,d=(r.scrollbar.size-t)*e;return Math.max(d,18)}function za(r,e,t,d="ltr"){const b=Ut(t),k=b/2,E=e||k,s=b-E,a=t.scrollbar.paddingStart+E,u=t.scrollbar.size-t.scrollbar.paddingEnd-s,p=t.content-t.viewport,c=d==="ltr"?[0,p]:[p*-1,0];return wi([a,u],c)(r)}function dr(r,e,t="ltr"){const d=Ut(e),b=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,k=e.scrollbar.size-b,E=e.content-e.viewport,s=k-d,a=t==="ltr"?[0,E]:[E*-1,0],u=Ts(r,a);return wi([0,E],[0,s])(u)}function wi(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const d=(e[1]-e[0])/(r[1]-r[0]);return e[0]+d*(t-r[0])}}function Ci(r,e){return r>0&&r<e}var $a=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},d=0;return function b(){const k={left:r.scrollLeft,top:r.scrollTop},E=t.left!==k.left,s=t.top!==k.top;(E||s)&&e(),t=k,d=window.requestAnimationFrame(b)}(),()=>window.cancelAnimationFrame(d)};function qt(r,e){const t=Pe(r),d=P.useRef(0);return P.useEffect(()=>()=>window.clearTimeout(d.current),[]),P.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(t,e)},[t,e])}function Xe(r,e){const t=Pe(e);Lt(()=>{let d=0;if(r){const b=new ResizeObserver(()=>{cancelAnimationFrame(d),d=window.requestAnimationFrame(t)});return b.observe(r),()=>{window.cancelAnimationFrame(d),b.unobserve(r)}}},[r,t])}var Wa=fi,Ua=_i,qa=yi;function ft({className:r,children:e,...t}){return f.jsxs(Wa,{"data-slot":"scroll-area",className:te("relative",r),...t,children:[f.jsx(Ua,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:e}),f.jsx(Ka,{}),f.jsx(qa,{})]})}function Ka({className:r,orientation:e="vertical",...t}){return f.jsx(mi,{"data-slot":"scroll-area-scrollbar",orientation:e,className:te("flex touch-none p-px transition-colors select-none",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",r),...t,children:f.jsx(bi,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Ei({className:r,...e}){return f.jsx(pn,{"data-slot":"tabs",className:te("flex flex-col gap-2",r),...e})}function Va({className:r,...e}){return f.jsx(_n,{"data-slot":"tabs-list",className:te("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",r),...e})}function ur({className:r,...e}){return f.jsx(mn,{"data-slot":"tabs-trigger",className:te("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...e})}function fr({className:r,...e}){return f.jsx(gn,{"data-slot":"tabs-content",className:te("flex-1 outline-none",r),...e})}const Ga=js("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Ve({className:r,variant:e,asChild:t=!1,...d}){const b=t?Tr:"span";return f.jsx(b,{"data-slot":"badge",className:te(Ga({variant:e}),r),...d})}function Xa({...r}){return f.jsx(Mr,{"data-slot":"sheet",...r})}function Ya({...r}){return f.jsx(Or,{"data-slot":"sheet-portal",...r})}function Ja({className:r,...e}){return f.jsx(jr,{"data-slot":"sheet-overlay",className:te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",r),...e})}function Za({className:r,children:e,side:t="right",...d}){return f.jsxs(Ya,{children:[f.jsx(Ja,{}),f.jsxs(Br,{"data-slot":"sheet-content",className:te("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",t==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",t==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",t==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",t==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",r),...d,children:[e,f.jsxs(Ir,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[f.jsx(pt,{className:"size-4"}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Qa({className:r,...e}){return f.jsx("div",{"data-slot":"sheet-header",className:te("flex flex-col gap-1.5 p-4",r),...e})}function el({className:r,...e}){return f.jsx(Nr,{"data-slot":"sheet-title",className:te("text-foreground font-semibold",r),...e})}function tl({className:r,...e}){return f.jsx("textarea",{"data-slot":"textarea",className:te("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...e})}function fe({className:r,...e}){return f.jsx("div",{"data-slot":"skeleton",className:te("bg-accent animate-pulse rounded-md",r),...e})}function sl({className:r}){return f.jsxs("div",{className:`p-4 space-y-4 ${r||""}`,children:[f.jsxs("div",{className:"flex gap-2 mb-4",children:[f.jsx(fe,{className:"h-8 w-12"}),f.jsx(fe,{className:"h-8 w-16"}),f.jsx(fe,{className:"h-8 w-20"})]}),[...Array(3)].map((e,t)=>f.jsxs("div",{className:"border border-border/30 rounded-lg p-3 space-y-2",children:[f.jsx("div",{className:"flex items-start justify-between",children:f.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[f.jsx(fe,{className:"h-4 w-4 rounded mt-1"}),f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsx(fe,{className:"h-4 w-48"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(fe,{className:"h-5 w-16 rounded-full"}),f.jsx(fe,{className:"h-4 w-20"})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(fe,{className:"h-3 w-12"}),f.jsx(fe,{className:"h-3 w-16"}),f.jsx(fe,{className:"h-3 w-8"})]})]})]})}),t===0&&f.jsxs("div",{className:"mt-3 space-y-2",children:[f.jsxs("div",{className:"ml-6 p-2 rounded bg-primary/10",children:[f.jsx(fe,{className:"h-4 w-64 mb-1"}),f.jsx(fe,{className:"h-3 w-16"})]}),f.jsxs("div",{className:"mr-6 p-2 rounded bg-secondary/10",children:[f.jsx(fe,{className:"h-4 w-72 mb-1"}),f.jsx(fe,{className:"h-4 w-48 mb-1"}),f.jsx(fe,{className:"h-3 w-16"})]})]})]},t))]})}const Ee=Object.create(null);Ee.open="0";Ee.close="1";Ee.ping="2";Ee.pong="3";Ee.message="4";Ee.upgrade="5";Ee.noop="6";const Ct=Object.create(null);Object.keys(Ee).forEach(r=>{Ct[Ee[r]]=r});const ps={type:"error",data:"parser error"},ki=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ri=typeof ArrayBuffer=="function",Li=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,$s=({type:r,data:e},t,d)=>ki&&e instanceof Blob?t?d(e):pr(e,d):Ri&&(e instanceof ArrayBuffer||Li(e))?t?d(e):pr(new Blob([e]),d):d(Ee[r]+(e||"")),pr=(r,e)=>{const t=new FileReader;return t.onload=function(){const d=t.result.split(",")[1];e("b"+(d||""))},t.readAsDataURL(r)};function _r(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let ss;function rl(r,e){if(ki&&r.data instanceof Blob)return r.data.arrayBuffer().then(_r).then(e);if(Ri&&(r.data instanceof ArrayBuffer||Li(r.data)))return e(_r(r.data));$s(r,!1,t=>{ss||(ss=new TextEncoder),e(ss.encode(t))})}const mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ht=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<mr.length;r++)ht[mr.charCodeAt(r)]=r;const il=r=>{let e=r.length*.75,t=r.length,d,b=0,k,E,s,a;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);const u=new ArrayBuffer(e),p=new Uint8Array(u);for(d=0;d<t;d+=4)k=ht[r.charCodeAt(d)],E=ht[r.charCodeAt(d+1)],s=ht[r.charCodeAt(d+2)],a=ht[r.charCodeAt(d+3)],p[b++]=k<<2|E>>4,p[b++]=(E&15)<<4|s>>2,p[b++]=(s&3)<<6|a&63;return u},nl=typeof ArrayBuffer=="function",Ws=(r,e)=>{if(typeof r!="string")return{type:"message",data:Ai(r,e)};const t=r.charAt(0);return t==="b"?{type:"message",data:ol(r.substring(1),e)}:Ct[t]?r.length>1?{type:Ct[t],data:r.substring(1)}:{type:Ct[t]}:ps},ol=(r,e)=>{if(nl){const t=il(r);return Ai(t,e)}else return{base64:!0,data:r}},Ai=(r,e)=>{switch(e){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Di="",al=(r,e)=>{const t=r.length,d=new Array(t);let b=0;r.forEach((k,E)=>{$s(k,!1,s=>{d[E]=s,++b===t&&e(d.join(Di))})})},ll=(r,e)=>{const t=r.split(Di),d=[];for(let b=0;b<t.length;b++){const k=Ws(t[b],e);if(d.push(k),k.type==="error")break}return d};function cl(){return new TransformStream({transform(r,e){rl(r,t=>{const d=t.length;let b;if(d<126)b=new Uint8Array(1),new DataView(b.buffer).setUint8(0,d);else if(d<65536){b=new Uint8Array(3);const k=new DataView(b.buffer);k.setUint8(0,126),k.setUint16(1,d)}else{b=new Uint8Array(9);const k=new DataView(b.buffer);k.setUint8(0,127),k.setBigUint64(1,BigInt(d))}r.data&&typeof r.data!="string"&&(b[0]|=128),e.enqueue(b),e.enqueue(t)})}})}let rs;function St(r){return r.reduce((e,t)=>e+t.length,0)}function bt(r,e){if(r[0].length===e)return r.shift();const t=new Uint8Array(e);let d=0;for(let b=0;b<e;b++)t[b]=r[0][d++],d===r[0].length&&(r.shift(),d=0);return r.length&&d<r[0].length&&(r[0]=r[0].slice(d)),t}function hl(r,e){rs||(rs=new TextDecoder);const t=[];let d=0,b=-1,k=!1;return new TransformStream({transform(E,s){for(t.push(E);;){if(d===0){if(St(t)<1)break;const a=bt(t,1);k=(a[0]&128)===128,b=a[0]&127,b<126?d=3:b===126?d=1:d=2}else if(d===1){if(St(t)<2)break;const a=bt(t,2);b=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),d=3}else if(d===2){if(St(t)<8)break;const a=bt(t,8),u=new DataView(a.buffer,a.byteOffset,a.length),p=u.getUint32(0);if(p>Math.pow(2,21)-1){s.enqueue(ps);break}b=p*Math.pow(2,32)+u.getUint32(4),d=3}else{if(St(t)<b)break;const a=bt(t,b);s.enqueue(Ws(k?a:rs.decode(a),e)),d=0}if(b===0||b>r){s.enqueue(ps);break}}}})}const Ti=4;function ce(r){if(r)return dl(r)}function dl(r){for(var e in ce.prototype)r[e]=ce.prototype[e];return r}ce.prototype.on=ce.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};ce.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};ce.prototype.off=ce.prototype.removeListener=ce.prototype.removeAllListeners=ce.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var d,b=0;b<t.length;b++)if(d=t[b],d===e||d.fn===e){t.splice(b,1);break}return t.length===0&&delete this._callbacks["$"+r],this};ce.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],d=1;d<arguments.length;d++)e[d-1]=arguments[d];if(t){t=t.slice(0);for(var d=0,b=t.length;d<b;++d)t[d].apply(this,e)}return this};ce.prototype.emitReserved=ce.prototype.emit;ce.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};ce.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Kt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ve=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ul="arraybuffer";function Pi(r,...e){return e.reduce((t,d)=>(r.hasOwnProperty(d)&&(t[d]=r[d]),t),{})}const fl=ve.setTimeout,pl=ve.clearTimeout;function Vt(r,e){e.useNativeTimers?(r.setTimeoutFn=fl.bind(ve),r.clearTimeoutFn=pl.bind(ve)):(r.setTimeoutFn=ve.setTimeout.bind(ve),r.clearTimeoutFn=ve.clearTimeout.bind(ve))}const _l=1.33;function ml(r){return typeof r=="string"?gl(r):Math.ceil((r.byteLength||r.size)*_l)}function gl(r){let e=0,t=0;for(let d=0,b=r.length;d<b;d++)e=r.charCodeAt(d),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(d++,t+=4);return t}function Mi(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function vl(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}function Sl(r){let e={},t=r.split("&");for(let d=0,b=t.length;d<b;d++){let k=t[d].split("=");e[decodeURIComponent(k[0])]=decodeURIComponent(k[1])}return e}class bl extends Error{constructor(e,t,d){super(e),this.description=t,this.context=d,this.type="TransportError"}}class Us extends ce{constructor(e){super(),this.writable=!1,Vt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,d){return super.emitReserved("error",new bl(e,t,d)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Ws(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=vl(e);return t.length?"?"+t:""}}class yl extends Us{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let d=0;this._polling&&(d++,this.once("pollComplete",function(){--d||t()})),this.writable||(d++,this.once("drain",function(){--d||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=d=>{if(this.readyState==="opening"&&d.type==="open"&&this.onOpen(),d.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(d)};ll(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,al(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Mi()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Bi=!1;try{Bi=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xl=Bi;function wl(){}class Cl extends yl{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let d=location.port;d||(d=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||d!==e.port}}doWrite(e,t){const d=this.request({method:"POST",data:e});d.on("success",t),d.on("error",(b,k)=>{this.onError("xhr post error",b,k)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,d)=>{this.onError("xhr poll error",t,d)}),this.pollXhr=e}}class Ce extends ce{constructor(e,t,d){super(),this.createRequest=e,Vt(this,d),this._opts=d,this._method=d.method||"GET",this._uri=t,this._data=d.data!==void 0?d.data:null,this._create()}_create(){var e;const t=Pi(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const d=this._xhr=this.createRequest(t);try{d.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){d.setDisableHeaderCheck&&d.setDisableHeaderCheck(!0);for(let b in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(b)&&d.setRequestHeader(b,this._opts.extraHeaders[b])}}catch{}if(this._method==="POST")try{d.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{d.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(d),"withCredentials"in d&&(d.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(d.timeout=this._opts.requestTimeout),d.onreadystatechange=()=>{var b;d.readyState===3&&((b=this._opts.cookieJar)===null||b===void 0||b.parseCookies(d.getResponseHeader("set-cookie"))),d.readyState===4&&(d.status===200||d.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof d.status=="number"?d.status:0)},0))},d.send(this._data)}catch(b){this.setTimeoutFn(()=>{this._onError(b)},0);return}typeof document<"u"&&(this._index=Ce.requestsCount++,Ce.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=wl,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ce.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ce.requestsCount=0;Ce.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",gr);else if(typeof addEventListener=="function"){const r="onpagehide"in ve?"pagehide":"unload";addEventListener(r,gr,!1)}}function gr(){for(let r in Ce.requests)Ce.requests.hasOwnProperty(r)&&Ce.requests[r].abort()}const El=function(){const r=Ii({xdomain:!1});return r&&r.responseType!==null}();class kl extends Cl{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=El&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Ce(Ii,this.uri(),e)}}function Ii(r){const e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||xl))return new XMLHttpRequest}catch{}if(!e)try{return new ve[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ni=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Rl extends Us{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,d=Ni?{}:Pi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(d.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,d)}catch(b){return this.emitReserved("error",b)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const d=e[t],b=t===e.length-1;$s(d,this.supportsBinary,k=>{try{this.doWrite(d,k)}catch{}b&&Kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Mi()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const is=ve.WebSocket||ve.MozWebSocket;class Ll extends Rl{createSocket(e,t,d){return Ni?new is(e,t,d):t?new is(e,t):new is(e)}doWrite(e,t){this.ws.send(t)}}class Al extends Us{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=hl(Number.MAX_SAFE_INTEGER,this.socket.binaryType),d=e.readable.pipeThrough(t).getReader(),b=cl();b.readable.pipeTo(e.writable),this._writer=b.writable.getWriter();const k=()=>{d.read().then(({done:s,value:a})=>{s||(this.onPacket(a),k())}).catch(s=>{})};k();const E={type:"open"};this.query.sid&&(E.data=`{"sid":"${this.query.sid}"}`),this._writer.write(E).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const d=e[t],b=t===e.length-1;this._writer.write(d).then(()=>{b&&Kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Dl={websocket:Ll,webtransport:Al,polling:kl},Tl=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Pl=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _s(r){if(r.length>8e3)throw"URI too long";const e=r,t=r.indexOf("["),d=r.indexOf("]");t!=-1&&d!=-1&&(r=r.substring(0,t)+r.substring(t,d).replace(/:/g,";")+r.substring(d,r.length));let b=Tl.exec(r||""),k={},E=14;for(;E--;)k[Pl[E]]=b[E]||"";return t!=-1&&d!=-1&&(k.source=e,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=!0),k.pathNames=Ml(k,k.path),k.queryKey=Bl(k,k.query),k}function Ml(r,e){const t=/\/{2,9}/g,d=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&d.splice(0,1),e.slice(-1)=="/"&&d.splice(d.length-1,1),d}function Bl(r,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(d,b,k){b&&(t[b]=k)}),t}const ms=typeof addEventListener=="function"&&typeof removeEventListener=="function",Et=[];ms&&addEventListener("offline",()=>{Et.forEach(r=>r())},!1);class Ie extends ce{constructor(e,t){if(super(),this.binaryType=ul,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const d=_s(e);t.hostname=d.host,t.secure=d.protocol==="https"||d.protocol==="wss",t.port=d.port,d.query&&(t.query=d.query)}else t.host&&(t.hostname=_s(t.host).host);Vt(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(d=>{const b=d.prototype.name;this.transports.push(b),this._transportsByName[b]=d}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Sl(this.opts.query)),ms&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Et.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Ti,t.transport=e,this.id&&(t.sid=this.id);const d=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](d)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Ie.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Ie.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let d=0;d<this.writeBuffer.length;d++){const b=this.writeBuffer[d].data;if(b&&(t+=ml(b)),d>0&&t>this._maxPayload)return this.writeBuffer.slice(0,d);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Kt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,d){return this._sendPacket("message",e,t,d),this}send(e,t,d){return this._sendPacket("message",e,t,d),this}_sendPacket(e,t,d,b){if(typeof t=="function"&&(b=t,t=void 0),typeof d=="function"&&(b=d,d=null),this.readyState==="closing"||this.readyState==="closed")return;d=d||{},d.compress=d.compress!==!1;const k={type:e,data:t,options:d};this.emitReserved("packetCreate",k),this.writeBuffer.push(k),b&&this.once("flush",b),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},d=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?d():e()}):this.upgrading?d():e()),this}_onError(e){if(Ie.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ms&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const d=Et.indexOf(this._offlineEventListener);d!==-1&&Et.splice(d,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Ie.protocol=Ti;class Il extends Ie{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),d=!1;Ie.priorWebsocketSuccess=!1;const b=()=>{d||(t.send([{type:"ping",data:"probe"}]),t.once("packet",c=>{if(!d)if(c.type==="pong"&&c.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ie.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{d||this.readyState!=="closed"&&(p(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function k(){d||(d=!0,p(),t.close(),t=null)}const E=c=>{const h=new Error("probe error: "+c);h.transport=t.name,k(),this.emitReserved("upgradeError",h)};function s(){E("transport closed")}function a(){E("socket closed")}function u(c){t&&c.name!==t.name&&k()}const p=()=>{t.removeListener("open",b),t.removeListener("error",E),t.removeListener("close",s),this.off("close",a),this.off("upgrading",u)};t.once("open",b),t.once("error",E),t.once("close",s),this.once("close",a),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{d||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let d=0;d<e.length;d++)~this.transports.indexOf(e[d])&&t.push(e[d]);return t}}let Nl=class extends Il{constructor(e,t={}){const d=typeof e=="object"?e:t;(!d.transports||d.transports&&typeof d.transports[0]=="string")&&(d.transports=(d.transports||["polling","websocket","webtransport"]).map(b=>Dl[b]).filter(b=>!!b)),super(e,d)}};function Ol(r,e="",t){let d=r;t=t||typeof location<"u"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(typeof t<"u"?r=t.protocol+"//"+r:r="https://"+r),d=_s(r)),d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/";const k=d.host.indexOf(":")!==-1?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+k+":"+d.port+e,d.href=d.protocol+"://"+k+(t&&t.port===d.port?"":":"+d.port),d}const jl=typeof ArrayBuffer=="function",Hl=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Oi=Object.prototype.toString,Fl=typeof Blob=="function"||typeof Blob<"u"&&Oi.call(Blob)==="[object BlobConstructor]",zl=typeof File=="function"||typeof File<"u"&&Oi.call(File)==="[object FileConstructor]";function qs(r){return jl&&(r instanceof ArrayBuffer||Hl(r))||Fl&&r instanceof Blob||zl&&r instanceof File}function kt(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,d=r.length;t<d;t++)if(kt(r[t]))return!0;return!1}if(qs(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return kt(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&kt(r[t]))return!0;return!1}function $l(r){const e=[],t=r.data,d=r;return d.data=gs(t,e),d.attachments=e.length,{packet:d,buffers:e}}function gs(r,e){if(!r)return r;if(qs(r)){const t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){const t=new Array(r.length);for(let d=0;d<r.length;d++)t[d]=gs(r[d],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){const t={};for(const d in r)Object.prototype.hasOwnProperty.call(r,d)&&(t[d]=gs(r[d],e));return t}return r}function Wl(r,e){return r.data=vs(r.data,e),delete r.attachments,r}function vs(r,e){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=vs(r[t],e);else if(typeof r=="object")for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=vs(r[t],e));return r}const Ul=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],ql=5;var se;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(se||(se={}));class Kl{constructor(e){this.replacer=e}encode(e){return(e.type===se.EVENT||e.type===se.ACK)&&kt(e)?this.encodeAsBinary({type:e.type===se.EVENT?se.BINARY_EVENT:se.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===se.BINARY_EVENT||e.type===se.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=$l(e),d=this.encodeAsString(t.packet),b=t.buffers;return b.unshift(d),b}}function vr(r){return Object.prototype.toString.call(r)==="[object Object]"}class Ks extends ce{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const d=t.type===se.BINARY_EVENT;d||t.type===se.BINARY_ACK?(t.type=d?se.EVENT:se.ACK,this.reconstructor=new Vl(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(qs(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const d={type:Number(e.charAt(0))};if(se[d.type]===void 0)throw new Error("unknown packet type "+d.type);if(d.type===se.BINARY_EVENT||d.type===se.BINARY_ACK){const k=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const E=e.substring(k,t);if(E!=Number(E)||e.charAt(t)!=="-")throw new Error("Illegal attachments");d.attachments=Number(E)}if(e.charAt(t+1)==="/"){const k=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););d.nsp=e.substring(k,t)}else d.nsp="/";const b=e.charAt(t+1);if(b!==""&&Number(b)==b){const k=t+1;for(;++t;){const E=e.charAt(t);if(E==null||Number(E)!=E){--t;break}if(t===e.length)break}d.id=Number(e.substring(k,t+1))}if(e.charAt(++t)){const k=this.tryParse(e.substr(t));if(Ks.isPayloadValid(d.type,k))d.data=k;else throw new Error("invalid payload")}return d}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case se.CONNECT:return vr(t);case se.DISCONNECT:return t===void 0;case se.CONNECT_ERROR:return typeof t=="string"||vr(t);case se.EVENT:case se.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Ul.indexOf(t[0])===-1);case se.ACK:case se.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Vl{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Wl(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Gl=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ks,Encoder:Kl,get PacketType(){return se},protocol:ql},Symbol.toStringTag,{value:"Module"}));function ye(r,e,t){return r.on(e,t),function(){r.off(e,t)}}const Xl=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ji extends ce{constructor(e,t,d){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,d&&d.auth&&(this.auth=d.auth),this._opts=Object.assign({},d),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ye(e,"open",this.onopen.bind(this)),ye(e,"packet",this.onpacket.bind(this)),ye(e,"error",this.onerror.bind(this)),ye(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var d,b,k;if(Xl.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const E={type:se.EVENT,data:t};if(E.options={},E.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const p=this.ids++,c=t.pop();this._registerAckCallback(p,c),E.id=p}const s=(b=(d=this.io.engine)===null||d===void 0?void 0:d.transport)===null||b===void 0?void 0:b.writable,a=this.connected&&!(!((k=this.io.engine)===null||k===void 0)&&k._hasPingExpired());return this.flags.volatile&&!s||(a?(this.notifyOutgoingListeners(E),this.packet(E)):this.sendBuffer.push(E)),this.flags={},this}_registerAckCallback(e,t){var d;const b=(d=this.flags.timeout)!==null&&d!==void 0?d:this._opts.ackTimeout;if(b===void 0){this.acks[e]=t;return}const k=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);t.call(this,new Error("operation has timed out"))},b),E=(...s)=>{this.io.clearTimeoutFn(k),t.apply(this,s)};E.withError=!0,this.acks[e]=E}emitWithAck(e,...t){return new Promise((d,b)=>{const k=(E,s)=>E?b(E):d(s);k.withError=!0,t.push(k),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const d={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((b,...k)=>d!==this._queue[0]?void 0:(b!==null?d.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(b)):(this._queue.shift(),t&&t(null,...k)),d.pending=!1,this._drainQueue())),this._queue.push(d),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:se.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(d=>String(d.id)===e)){const d=this.acks[e];delete this.acks[e],d.withError&&d.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case se.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case se.EVENT:case se.BINARY_EVENT:this.onevent(e);break;case se.ACK:case se.BINARY_ACK:this.onack(e);break;case se.DISCONNECT:this.ondisconnect();break;case se.CONNECT_ERROR:this.destroy();const d=new Error(e.data.message);d.data=e.data.data,this.emitReserved("connect_error",d);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const d of t)d.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let d=!1;return function(...b){d||(d=!0,t.packet({type:se.ACK,id:e,data:b}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:se.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let d=0;d<t.length;d++)if(e===t[d])return t.splice(d,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let d=0;d<t.length;d++)if(e===t[d])return t.splice(d,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const d of t)d.apply(this,e.data)}}}function Ye(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Ye.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};Ye.prototype.reset=function(){this.attempts=0};Ye.prototype.setMin=function(r){this.ms=r};Ye.prototype.setMax=function(r){this.max=r};Ye.prototype.setJitter=function(r){this.jitter=r};class Ss extends ce{constructor(e,t){var d;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Vt(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((d=t.randomizationFactor)!==null&&d!==void 0?d:.5),this.backoff=new Ye({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const b=t.parser||Gl;this.encoder=new b.Encoder,this.decoder=new b.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Nl(this.uri,this.opts);const t=this.engine,d=this;this._readyState="opening",this.skipReconnect=!1;const b=ye(t,"open",function(){d.onopen(),e&&e()}),k=s=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",s),e?e(s):this.maybeReconnectOnOpen()},E=ye(t,"error",k);if(this._timeout!==!1){const s=this._timeout,a=this.setTimeoutFn(()=>{b(),k(new Error("timeout")),t.close()},s);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(b),this.subs.push(E),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ye(e,"ping",this.onping.bind(this)),ye(e,"data",this.ondata.bind(this)),ye(e,"error",this.onerror.bind(this)),ye(e,"close",this.onclose.bind(this)),ye(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Kt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let d=this.nsps[e];return d?this._autoConnect&&!d.active&&d.connect():(d=new ji(this,e,t),this.nsps[e]=d),d}_destroy(e){const t=Object.keys(this.nsps);for(const d of t)if(this.nsps[d].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let d=0;d<t.length;d++)this.engine.write(t[d],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var d;this.cleanup(),(d=this.engine)===null||d===void 0||d.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const d=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(b=>{b?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",b)):e.onreconnect()}))},t);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const st={};function Rt(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};const t=Ol(r,e.path||"/socket.io"),d=t.source,b=t.id,k=t.path,E=st[b]&&k in st[b].nsps,s=e.forceNew||e["force new connection"]||e.multiplex===!1||E;let a;return s?a=new Ss(d,e):(st[b]||(st[b]=new Ss(d,e)),a=st[b]),t.query&&!e.query&&(e.query=t.queryKey),a.socket(t.path,e)}Object.assign(Rt,{Manager:Ss,Socket:ji,io:Rt,connect:Rt});const Yl={},Jl=()=>Yl?.VITE_WS_URL||"ws://localhost:8080";class Zl{socket=null;eventListeners={};reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;messageQueue=[];isConnecting=!1;terminalSessions=new Map;connect(e){if(!(this.socket?.connected||this.isConnecting)){this.isConnecting=!0;try{const d=(e||Jl()).replace("ws://","http://").replace("wss://","https://");console.log(`Connecting to WebSocket server: ${d}`),this.socket=Rt(d,{transports:["websocket"],path:"/ws",timeout:2e4,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:this.reconnectDelay}),this.setupEventListeners()}catch(t){console.error("Failed to connect to WebSocket server:",t),this.emit("error","Failed to connect to server"),this.isConnecting=!1}}}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{console.log("Connected to server"),this.isConnecting=!1,this.reconnectAttempts=0,this.processMessageQueue(),this.emit("connected")}),this.socket.on("disconnect",e=>{console.log("Disconnected from server:",e),this.emit("disconnected")}),this.socket.on("connect_error",e=>{console.error("Connection error:",e),this.handleReconnect()}),this.socket.on("message",e=>{try{const t=typeof e=="string"?JSON.parse(e):e;switch(t.type){case"message":this.emit("message",t.payload);break;case"code_stream":this.emit("code_stream",t.payload);break;case"agent_update":this.emit("agent_update",t.payload);break;case"file_tree_update":this.emit("file_tree_update",t.payload);break;case"project_status":this.emit("project_status",t.payload);break;case"terminal_data":this.emit("terminal_data",t.payload);break;case"terminal_session":this.handleTerminalSession(t.payload);break;case"wave_progress":this.emit("wave_progress",t.payload);break;case"llm_config_update":this.emit("llm_config_update",t.payload);break;case"llm_stream":this.emit("llm_stream",t.payload);break;case"agent_hierarchy":this.emit("agent_hierarchy",t.payload);break;case"token_usage":this.emit("token_usage",t.payload);break;default:console.warn("Unknown message type:",t.type)}}catch(t){console.error("Error parsing message:",t)}}),this.socket.on("error",e=>{console.error("WebSocket error:",e),this.emit("error",e.message||"WebSocket error occurred")}))}handleReconnect(){if(this.isConnecting=!1,this.reconnectAttempts++,this.reconnectAttempts>=this.maxReconnectAttempts){this.emit("error","Failed to connect after multiple attempts");return}setTimeout(()=>{console.log(`Attempting to reconnect... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.connect()},this.reconnectDelay*this.reconnectAttempts)}processMessageQueue(){for(;this.messageQueue.length>0&&this.socket?.connected;){const e=this.messageQueue.shift();e&&this.socket.send(JSON.stringify(e))}}handleTerminalSession(e){this.terminalSessions.set(e.sessionId,e),this.emit("terminal_session",e)}sendPrompt(e,t="root"){const d={type:"prompt",payload:{prompt:e,agentId:t}};this.socket?.connected?this.socket.send(JSON.stringify(d)):(this.messageQueue.push({event:"prompt",data:d}),this.emit("error","Not connected to server. Message queued."))}selectFile(e){const t={type:"file_select",payload:{filePath:e}};this.socket?.connected&&this.socket.send(JSON.stringify(t))}createTerminalSession(e){const t={type:"terminal_create",payload:{projectId:e}};this.socket?.connected?this.socket.send(JSON.stringify(t)):this.messageQueue.push({event:"terminal_create",data:t})}sendTerminalData(e,t){const d={type:"terminal_data",payload:{sessionId:e,data:t}};this.socket?.connected&&this.socket.send(JSON.stringify(d))}resizeTerminal(e,t,d){const b={type:"terminal_resize",payload:{sessionId:e,cols:t,rows:d}};this.socket?.connected&&this.socket.send(JSON.stringify(b))}closeTerminal(e){const t={type:"terminal_close",payload:{sessionId:e}};this.socket?.connected&&this.socket.send(JSON.stringify(t)),this.terminalSessions.delete(e)}getTerminalSession(e){return this.terminalSessions.get(e)}configureLLM(e){try{const t={type:"llm_config",payload:e};this.socket?.connected?this.socket.send(JSON.stringify(t)):(this.messageQueue.push({event:"llm_config",data:t}),this.emit("error","Not connected to server. Configuration queued."))}catch(t){console.error("Error configuring LLM:",t),this.emit("error","Failed to configure LLM")}}setModel(e){try{const t={type:"set_model",payload:{model:e}};this.socket?.connected?this.socket.send(JSON.stringify(t)):this.emit("error","Not connected to server. Please connect first.")}catch(t){console.error("Error setting model:",t),this.emit("error","Failed to set model")}}setApiKey(e,t){try{if(!e||!t){this.emit("error","Invalid API key or provider");return}const d={type:"set_api_key",payload:{provider:e,apiKey:t}};this.socket?.connected?this.socket.send(JSON.stringify(d)):this.emit("error","Not connected to server. Please connect first.")}catch(d){console.error("Error setting API key:",d),this.emit("error","Failed to set API key")}}requestAgentHierarchy(){const e={type:"get_agent_hierarchy",payload:{}};this.socket?.connected&&this.socket.send(JSON.stringify(e))}on(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t)}off(e,t){if(this.eventListeners[e])if(t){const d=this.eventListeners[e].indexOf(t);d>-1&&this.eventListeners[e].splice(d,1)}else this.eventListeners[e]=[]}emit(e,...t){const d=this.eventListeners[e];d&&d.forEach(b=>{try{b(...t)}catch(k){console.error(`Error in event listener for ${e}:`,k)}})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.messageQueue=[],this.isConnecting=!1}isConnected(){return this.socket?.connected||!1}getConnectionStatus(){return this.socket?.connected?"connected":this.isConnecting?"connecting":"disconnected"}}const de=new Zl;function Ql({onNewChat:r,messages:e=[],isConnected:t=!1,onMessagesUpdate:d,isLoading:b=!1,onLoadingChange:k}){const[E,s]=P.useState([]),[a,u]=P.useState(null),[p,c]=P.useState(!1),[h,m]=P.useState(0),[S,_]=P.useState(""),[n,o]=P.useState(!0),i=P.useRef(null),l=P.useRef(new Map);P.useEffect(()=>{const A=new Map;e.forEach(B=>{if(!B.threadId)return;A.has(B.threadId)||A.set(B.threadId,{taskId:B.threadId,summary:`Task ${B.threadId}`,agentName:B.agentId||"Agent",agentState:"working",createdAt:new Date().toISOString(),lastActivity:B.timestamp,messageCount:0,errorCount:0,hasUnread:!1,isCollapsed:!0,messages:[]});const D=A.get(B.threadId);D.messages.push({id:B.id,threadId:B.threadId,text:B.text,timestamp:B.timestamp,sender:B.sender==="user"?"user":"assistant",type:"normal",isRead:!1}),D.messageCount++,D.lastActivity=B.timestamp}),s(Array.from(A.values())),o(!1)},[e]),P.useEffect(()=>{const A=localStorage.getItem("threadCollapseStates");if(A){const B=JSON.parse(A);s(D=>D.map(j=>({...j,isCollapsed:B[j.taskId]??j.isCollapsed})))}},[]);const g=P.useCallback(A=>{const B={};A.forEach(D=>{B[D.taskId]=D.isCollapsed}),localStorage.setItem("threadCollapseStates",JSON.stringify(B))},[]),x=A=>{const B={idle:"bg-gray-500/20 text-gray-300 border-gray-500/30",working:"bg-blue-500/20 text-blue-300 border-blue-500/30",error:"bg-red-500/20 text-red-300 border-red-500/30",complete:"bg-green-500/20 text-green-300 border-green-500/30"},j={idle:zr,working:Ur,error:Ae,complete:us}[A];return f.jsxs(Ve,{variant:"outline",className:`${B[A]} text-xs px-2 py-0.5 flex items-center gap-1`,children:[f.jsx(j,{className:`h-3 w-3 ${A==="working"?"animate-spin":""}`}),A]})},y=A=>{const B=new Date(A),j=new Date().getTime()-B.getTime(),z=Math.floor(j/6e4),U=Math.floor(j/36e5);return z<1?"now":z<60?`${z}m`:U<24?`${U}h`:B.toLocaleDateString()},w=P.useCallback(A=>{s(B=>{const D=B.map(j=>j.taskId===A?{...j,isCollapsed:!j.isCollapsed,hasUnread:!1}:j);return g(D),D})},[g]),v=P.useCallback(A=>{u(A),c(!0),_("")},[]);P.useEffect(()=>{const A=B=>{if(i.current?.contains(document.activeElement))switch(B.key){case"ArrowDown":B.preventDefault(),m(D=>Math.min(D+1,E.length-1));break;case"ArrowUp":B.preventDefault(),m(D=>Math.max(D-1,0));break;case"ArrowRight":B.preventDefault(),E[h]?.isCollapsed&&w(E[h].taskId);break;case"ArrowLeft":B.preventDefault(),E[h]&&!E[h].isCollapsed&&w(E[h].taskId);break;case"Enter":B.preventDefault(),E[h]&&v(E[h].taskId);break}};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[h,E,w,v]);const C=()=>{if(!S.trim()||!a)return;t&&de.sendPrompt(S,a||"root");const A={id:`msg-${Date.now()}`,text:S,timestamp:new Date().toISOString(),sender:"user",threadId:a};d&&d([...e,A]),s(B=>B.map(D=>D.taskId===a?{...D,messages:[...D.messages,{id:A.id,threadId:a,text:S,timestamp:A.timestamp,sender:"user",type:"normal",isRead:!0}],messageCount:D.messageCount+1,lastActivity:A.timestamp,agentState:"working"}:D)),_(""),c(!1)},T=E.find(A=>A.taskId===a);return n||b?f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"p-4 flex items-center gap-2",children:[f.jsx(Ht,{className:"h-4 w-4 animate-spin text-primary"}),f.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading tasks..."})]}),f.jsx(sl,{})]}):E.length===0?f.jsx("div",{className:"h-full flex items-center justify-center",children:f.jsxs("div",{className:"text-center text-muted-foreground",children:[f.jsx(At,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),f.jsx("p",{className:"text-sm",children:"No active tasks"})]})}):f.jsxs("div",{ref:i,className:"h-full flex flex-col",role:"tree","aria-label":"Task threads",tabIndex:0,children:[f.jsx("div",{className:"flex-1",children:f.jsx(ft,{className:"h-full",children:f.jsx("div",{className:"p-2 space-y-2",children:E.map((A,B)=>f.jsxs("div",{ref:D=>{D&&l.current.set(A.taskId,D)},role:"group","aria-expanded":!A.isCollapsed,"aria-label":`Task: ${A.summary}`,className:`border border-border/30 rounded-lg transition-all duration-200 ${B===h?"ring-2 ring-primary/50":""}`,children:[f.jsx("div",{className:"p-3 cursor-pointer hover:bg-secondary/10 transition-colors",onClick:()=>w(A.taskId),onDoubleClick:()=>v(A.taskId),role:"article",tabIndex:0,children:f.jsx("div",{className:"flex items-start justify-between",children:f.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[f.jsx("div",{className:"flex-shrink-0 mt-1",children:A.isCollapsed?f.jsx(us,{className:"h-4 w-4 text-muted-foreground"}):f.jsx(jt,{className:"h-4 w-4 text-muted-foreground"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("h3",{className:"text-sm font-medium text-foreground truncate",children:A.summary}),A.hasUnread&&f.jsx("div",{className:"w-2 h-2 bg-primary rounded-full flex-shrink-0"})]}),f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x(A.agentState),f.jsx("span",{className:"text-xs text-muted-foreground",children:A.agentName})]}),f.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(At,{className:"h-3 w-3"}),A.messageCount," msgs"]}),A.errorCount>0&&f.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[f.jsx(Ae,{className:"h-3 w-3"}),A.errorCount," errors"]}),f.jsx("span",{children:y(A.lastActivity)})]})]})]})})}),!A.isCollapsed&&f.jsx("div",{className:"border-t border-border/20",children:f.jsx("div",{className:"p-3 space-y-2 max-h-64 overflow-y-auto",children:A.messages.map(D=>f.jsx("div",{className:`p-2 rounded text-sm ${D.sender==="user"?"bg-primary/10 text-primary-foreground ml-6":D.type==="error"?"bg-red-500/10 text-red-300 border border-red-500/20":"bg-secondary/10 text-secondary-foreground mr-6"}`,children:f.jsxs("div",{className:"flex items-start justify-between gap-2",children:[f.jsx("p",{className:"flex-1",children:D.text}),f.jsx("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:y(D.timestamp)})]})},D.id))})})]},A.taskId))})})}),f.jsx(Xa,{open:p,onOpenChange:c,children:f.jsxs(Za,{side:"right",className:"w-[500px] sm:w-[600px]",children:[f.jsx(Qa,{children:f.jsxs(el,{className:"flex items-center gap-2",children:[T?.summary,T&&x(T.agentState)]})}),T&&f.jsxs("div",{className:"mt-6 space-y-4",children:[f.jsx("div",{className:"p-4 bg-secondary/10 rounded-lg",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-muted-foreground",children:"Agent:"}),f.jsx("span",{className:"ml-2",children:T.agentName})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-muted-foreground",children:"Created:"}),f.jsx("span",{className:"ml-2",children:y(T.createdAt)})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),f.jsx("span",{className:"ml-2",children:T.messageCount})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),f.jsx("span",{className:"ml-2 text-red-400",children:T.errorCount})]})]})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium mb-2",children:"Full Conversation"}),f.jsx(ft,{className:"h-64 border border-border/30 rounded-lg",children:f.jsx("div",{className:"p-3 space-y-3",children:T.messages.map(A=>f.jsxs("div",{className:`p-3 rounded-lg ${A.sender==="user"?"bg-primary/10 text-primary-foreground":A.type==="error"?"bg-red-500/10 text-red-300 border border-red-500/20":"bg-secondary/10 text-secondary-foreground"}`,children:[f.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[f.jsx("span",{className:"text-xs font-medium",children:A.sender==="user"?"You":T.agentName}),f.jsx("span",{className:"text-xs text-muted-foreground",children:y(A.timestamp)})]}),f.jsx("p",{className:"text-sm",children:A.text})]},A.id))})})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium mb-2",children:"Re-prompt"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(tl,{value:S,onChange:A=>_(A.target.value),placeholder:"Add additional instructions or corrections...",className:"min-h-24 resize-none"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(ie,{onClick:C,disabled:!S.trim(),className:"minimalist-button",children:"Send Re-prompt"}),f.jsx(ie,{variant:"outline",onClick:()=>c(!1),className:"minimalist-button",children:"Cancel"})]})]})]})]})]})})]})}function ec({messages:r,onNewChat:e,isConnected:t=!1,onMessagesUpdate:d,isLoading:b=!1,onLoadingChange:k}){const[E,s]=P.useState("chat"),a=P.useRef(null);P.useEffect(()=>{a.current?.scrollIntoView({behavior:"smooth"})},[r]);const u=m=>{const S=new Date(m),n=new Date().getTime()-S.getTime(),o=Math.floor(n/6e4),i=Math.floor(n/36e5);return o<1?"now":o<60?`${o}m`:i<24?`${i}h`:S.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},p=r.length;return f.jsx("div",{className:"h-full flex flex-col",children:f.jsxs(Ei,{value:E,onValueChange:s,className:"h-full flex flex-col",children:[f.jsx("div",{className:"flex-shrink-0 px-4 pt-4 pb-2",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>s("chat"),className:`ghost-chip flex items-center gap-2 ${E==="chat"?"active":""}`,children:[f.jsx(At,{className:"h-3 w-3"}),"Chat",p>0&&f.jsx("span",{className:"bg-muted text-muted-foreground text-xs px-1.5 py-0.5 rounded ml-1",children:p})]}),f.jsxs("button",{onClick:()=>s("tasks"),className:`ghost-chip flex items-center gap-2 ${E==="tasks"?"active":""}`,children:[f.jsx(xt,{className:"h-3 w-3"}),"Tasks",f.jsx("span",{className:"bg-muted text-muted-foreground text-xs px-1.5 py-0.5 rounded ml-1",children:3})]}),f.jsxs("button",{onClick:()=>s("logs"),className:`ghost-chip flex items-center gap-2 ${E==="logs"?"active":""}`,children:[f.jsx(Ae,{className:"h-3 w-3"}),"Logs",f.jsx("span",{className:"bg-destructive/20 text-destructive text-xs px-1.5 py-0.5 rounded ml-1",children:2})]})]}),f.jsx(ie,{variant:"ghost",size:"sm",onClick:e,className:"minimalist-button",children:f.jsx(Wr,{className:"h-4 w-4"})})]})}),f.jsxs("div",{className:"flex-1 min-h-0",children:[E==="chat"&&f.jsx("div",{className:"h-full",children:f.jsx(ft,{className:"h-full",children:f.jsx("div",{className:"px-4 py-2",children:r.length===0?f.jsx("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:f.jsxs("div",{className:"text-center",children:[f.jsx(At,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),f.jsx("p",{className:"text-body",children:"Start a conversation with Colony AI"})]})}):f.jsxs("div",{className:"space-y-4",children:[r.map(m=>f.jsxs("div",{className:"flex items-start gap-3 py-2",children:[f.jsx("div",{className:"flex-shrink-0 mt-1",children:m.sender==="user"?f.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center",children:f.jsx(Qo,{className:"h-3 w-3 text-primary"})}):f.jsx("div",{className:"w-6 h-6 rounded-full bg-secondary/10 border border-border flex items-center justify-center",children:f.jsx(Xn,{className:"h-3 w-3 text-foreground"})})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"text-tab font-medium",children:m.sender==="user"?"You":"Colony AI"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:u(m.timestamp)})]}),f.jsx("div",{className:"text-body text-foreground leading-relaxed",children:m.text})]})]},m.id)),f.jsx("div",{ref:a})]})})})}),E==="tasks"&&f.jsx("div",{className:"h-full",children:f.jsx(Ql,{onNewChat:e,messages:r,isConnected:t,onMessagesUpdate:d,isLoading:b,onLoadingChange:k})}),E==="logs"&&f.jsx("div",{className:"h-full",children:f.jsx(ft,{className:"h-full",children:f.jsxs("div",{className:"px-4 py-2 space-y-3",children:[f.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-destructive pl-3",children:[f.jsx(Ae,{className:"h-4 w-4 text-destructive mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"text-tab font-medium text-destructive",children:"Error"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"2m ago"})]}),f.jsx("p",{className:"text-body text-destructive",children:"Failed to connect to database: Connection timeout"})]})]}),f.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-yellow-500 pl-3",children:[f.jsx(Ae,{className:"h-4 w-4 text-yellow-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"text-tab font-medium text-yellow-500",children:"Warning"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"5m ago"})]}),f.jsx("p",{className:"text-body text-yellow-500",children:"API rate limit approaching: 80% of quota used"})]})]}),f.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-blue-500 pl-3",children:[f.jsx(xt,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"text-tab font-medium text-blue-500",children:"Info"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"8m ago"})]}),f.jsx("p",{className:"text-body text-blue-500",children:"Code generation completed successfully for Button.tsx"})]})]}),f.jsxs("div",{className:"flex items-start gap-3 py-2 border-l-2 border-l-green-500 pl-3",children:[f.jsx(xt,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"text-tab font-medium text-green-500",children:"Success"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"12m ago"})]}),f.jsx("p",{className:"text-body text-green-500",children:"All tests passed for authentication module"})]})]})]})})})]})]})})}function tc({onSendMessage:r,isLoading:e=!1,disabled:t=!1,placeholder:d="Enter a prompt"}){const[b,k]=P.useState(""),[E,s]=P.useState([]),a=P.useRef(null),u=()=>{(b.trim()||E.length>0)&&(r(b,E),k(""),s([]))},p=P.useCallback(async m=>{const S=m.target.files;if(!S)return;const _=[];for(let n=0;n<S.length;n++){const o=S[n],i=`file-${Date.now()}-${n}`;if(o?.type.startsWith("text/")||o?.name.endsWith(".md")||o?.name.endsWith(".json")){const l=await o.text();_.push({id:i,name:o?.name||"unknown",size:o?.size||0,type:o?.type||"text/plain",content:l})}else _.push({id:i,name:o?.name||"unknown",size:o?.size||0,type:o?.type||"application/octet-stream"})}s(n=>[...n,..._]),a.current&&(a.current.value="")},[]),c=m=>{s(S=>S.filter(_=>_.id!==m))},h=m=>m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB";return f.jsxs("div",{className:"relative h-full flex flex-col",children:[E.length>0&&f.jsx("div",{className:"flex flex-wrap gap-2 p-2 border-b border-border",children:E.map(m=>f.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-muted/50 rounded-md text-sm",children:[f.jsx(Ps,{className:"h-3 w-3 text-muted-foreground"}),f.jsx("span",{className:"text-foreground",children:m.name}),f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",h(m.size),")"]}),f.jsx(ie,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>c(m.id),children:f.jsx(pt,{className:"h-3 w-3"})})]},m.id))}),f.jsxs("div",{className:"minimalist-input flex-1 relative",children:[f.jsx("textarea",{placeholder:d,value:b,onChange:m=>k(m.target.value),onKeyPress:m=>{m.key==="Enter"&&!m.shiftKey&&!t&&!e&&(m.preventDefault(),u())},className:"w-full h-full bg-transparent resize-none text-foreground placeholder-muted-foreground focus:outline-none text-body leading-relaxed pr-24",style:{border:"none"},disabled:t||e}),f.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2",children:[f.jsx(ie,{variant:"ghost",size:"sm",className:"p-2 hover:bg-muted/50",onClick:()=>a.current?.click(),disabled:t||e,children:f.jsx(Oo,{className:"h-4 w-4"})}),f.jsx(ie,{onClick:u,className:"minimalist-button p-2",disabled:!b.trim()&&E.length===0||t||e,children:e?f.jsx(Ht,{className:"h-4 w-4 animate-spin"}):f.jsx(qo,{className:"h-4 w-4"})})]}),f.jsx("input",{ref:a,type:"file",multiple:!0,onChange:p,className:"hidden",accept:"text/*,.md,.json,.js,.jsx,.ts,.tsx,.py,.java,.cpp,.c,.h,.cs,.go,.rb,.php,.html,.css,.xml,.yaml,.yml"})]})]})}function me(r,e){P.useEffect(()=>(de.on(r,e),()=>{de.off(r,e)}),[r,e])}const sc={".js":"javascript",".jsx":"javascript",".ts":"typescript",".tsx":"typescript",".py":"python",".java":"java",".cpp":"cpp",".c":"c",".h":"c",".cs":"csharp",".go":"go",".rb":"ruby",".php":"php",".html":"html",".css":"css",".scss":"scss",".sass":"sass",".less":"less",".xml":"xml",".json":"json",".yaml":"yaml",".yml":"yaml",".md":"markdown",".mdx":"markdown",".sql":"sql",".sh":"bash",".bash":"bash",".zsh":"bash",".fish":"bash",".ps1":"powershell",".r":"r",".R":"r",".swift":"swift",".kt":"kotlin",".kts":"kotlin",".dart":"dart",".lua":"lua",".vim":"vim",".dockerfile":"dockerfile",".rs":"rust",".toml":"toml",".ini":"ini",".cfg":"ini",".conf":"ini",".env":"dotenv"},Sr=10*1024*1024,br=new Set([".jpg",".jpeg",".png",".gif",".bmp",".ico",".svg",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".zip",".rar",".tar",".gz",".7z",".exe",".dll",".so",".dylib",".mp3",".mp4",".avi",".mov",".wav",".ttf",".otf",".woff",".woff2",".db",".sqlite"]),yr=new Set(["node_modules",".git",".svn",".hg","dist","build","out","target","bin","obj",".idea",".vscode",".vs","__pycache__",".pytest_cache",".mypy_cache","venv","env",".env"]);class bs{static async importFile(e){try{if(e.size>Sr)throw new Error(`File "${e.name}" exceeds the maximum size of 10MB`);const t=this.getFileExtension(e.name);if(br.has(t.toLowerCase()))return console.warn(`Skipping binary file: ${e.name}`),null;const d=await this.readFileAsText(e);return{id:this.generateId(),name:e.name,path:e.name,content:d,type:"file",language:this.getLanguageFromExtension(t),size:e.size}}catch(t){return console.error(`Error importing file ${e.name}:`,t),null}}static async importFiles(e){const t=[];for(let d=0;d<e.length;d++){const b=e[d];if(!b)continue;const k=await this.importFile(b);k&&t.push(k)}return t}static async importFolder(){try{if(!("showDirectoryPicker"in window))throw new Error("Your browser does not support folder import. Please use Chrome, Edge, or another Chromium-based browser.");const e=await window.showDirectoryPicker({mode:"read"});return await this.readDirectory(e,e.name)}catch(e){if(e.name==="AbortError")return null;throw console.error("Error importing folder:",e),e}}static async readDirectory(e,t,d=0,b=10){const k={id:this.generateId(),name:e.name,path:t,type:"folder",children:[]};if(d>b)return console.warn(`Max depth reached for folder: ${t}`),k;if(yr.has(e.name))return console.log(`Skipping folder: ${e.name}`),k;try{for await(const E of e.values()){const s=`${t}/${E.name}`;if(E.kind==="file"){const a=await E.getFile();if(!a)continue;if(a.size>Sr){console.warn(`Skipping large file: ${s} (${a.size} bytes)`);continue}const u=this.getFileExtension(a.name);if(br.has(u.toLowerCase())){console.log(`Skipping binary file: ${s}`);continue}try{const p=await this.readFileAsText(a);k.children.push({id:this.generateId(),name:a.name,path:s,content:p,type:"file",language:this.getLanguageFromExtension(u),size:a.size})}catch(p){console.error(`Error reading file ${s}:`,p)}}else if(E.kind==="directory"&&!yr.has(E.name)){const a=await this.readDirectory(E,s,d+1,b);a.children.length>0&&k.children.push(a)}}}catch(E){console.error(`Error reading directory ${t}:`,E)}return k.children.sort((E,s)=>E.type!==s.type?E.type==="folder"?-1:1:E.name.localeCompare(s.name)),k}static async readFileAsText(e){return new Promise((t,d)=>{const b=new FileReader;b.onload=k=>t(k.target?.result),b.onerror=d,b.readAsText(e)})}static getFileExtension(e){const t=e.lastIndexOf(".");return t===-1?"":e.substring(t)}static getLanguageFromExtension(e){return sc[e.toLowerCase()]||"plaintext"}static generateId(){return`import-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}static convertToFileTreeNodes(e){return e.map(t=>this.convertNode(t))}static convertNode(e){return e.type==="file"?{id:e.id,name:e.name,path:e.path,type:"file",content:e.content,language:e.language}:{id:e.id,name:e.name,path:e.path,type:"folder",children:e.children.map(t=>this.convertNode(t)),isExpanded:!1}}}function rc({onFileSelect:r,importedProject:e=[]}){const[t,d]=P.useState([]),[b,k]=P.useState(null);P.useEffect(()=>{if(e.length>0){const p=bs.convertToFileTreeNodes(e);d(p)}},[e]),me("file_tree_update",p=>{d(c=>{const h=[...c],m=p.filePath.split("/"),S=(_,n,o=0)=>{if(o===n.length-1){const g=_.findIndex(x=>x.name===n[o]);if(p.action==="delete")return _.filter(x=>x.name!==n[o]);if(p.action==="create"||p.action==="update"){const x={id:p.filePath,name:n[o]||"unknown",path:p.filePath,type:p.fileType,children:p.fileType==="folder"?[]:void 0};g>=0?_[g]={..._[g],...x}:_.push(x)}return _}const i=n[o]||"unknown";let l=_.find(g=>g.name===i&&g.type==="folder");return l||(l={id:n.slice(0,o+1).join("/"),name:i,path:n.slice(0,o+1).join("/"),type:"folder",children:[],isExpanded:!1},_.push(l)),l?.children&&(l.children=S(l.children,n,o+1)),_};return S(h,m)})});const E=p=>{const c=h=>h.map(m=>m.id===p?{...m,isExpanded:!m.isExpanded}:m.children?{...m,children:c(m.children)}:m);d(c(t))},s=p=>{p.type==="file"&&(k(p.id),p.content?r?.(p.path,p.content,p.language):(de.selectFile(p.path),r?.(p.path)))},a=p=>{switch(p.split(".").pop()?.toLowerCase()){case"tsx":case"jsx":case"ts":case"js":return f.jsx(yt,{className:"h-3 w-3 text-blue-400"});case"json":return f.jsx(co,{className:"h-3 w-3 text-yellow-400"});case"md":return f.jsx(xt,{className:"h-3 w-3 text-gray-400"});case"html":return f.jsx(yt,{className:"h-3 w-3 text-orange-400"});case"css":return f.jsx(yt,{className:"h-3 w-3 text-purple-400"});case"png":case"jpg":case"jpeg":case"svg":return f.jsx(wo,{className:"h-3 w-3 text-green-400"});default:return f.jsx(Ps,{className:"h-3 w-3 text-gray-400"})}},u=(p,c=0)=>{const h=b===p.id;return f.jsxs("div",{className:"file-tree-item",children:[f.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 cursor-pointer hover:bg-muted/20 file-tree-small ${h?"bg-primary/10 text-primary":"text-foreground"}`,style:{paddingLeft:`${8+c*12}px`,fontFamily:"Quicksand, sans-serif"},onClick:()=>{p.type==="folder"?E(p.id):s(p)},children:[p.type==="folder"&&f.jsxs(f.Fragment,{children:[p.isExpanded?f.jsx(jt,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}):f.jsx(us,{className:"h-3 w-3 text-muted-foreground flex-shrink-0"}),f.jsx("div",{className:"w-3 flex justify-center",children:p.isExpanded?f.jsx(vo,{className:"h-3 w-3 text-primary"}):f.jsx($r,{className:"h-3 w-3 text-muted-foreground"})})]}),p.type==="file"&&f.jsx("div",{className:"w-3 flex justify-center ml-3",children:a(p.name)}),f.jsx("span",{className:"file-tree-node-name truncate text-xs",children:p.name})]}),p.type==="folder"&&p.isExpanded&&p.children&&f.jsx("div",{children:p.children.map(m=>u(m,c+1))})]},p.id)};return f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("div",{className:"p-4 border-b border-border",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5 text-[13px]",children:f.jsx(Wr,{className:"h-4 w-4"})}),f.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",children:f.jsx(Ms,{className:"h-4 w-4"})})]})}),f.jsx(ft,{className:"flex-1",children:f.jsx("div",{className:"p-2",children:t.map(p=>u(p))})})]})}const ic=r=>{const e=document.createElement("div");return e.textContent=r,e.innerHTML},xr={typescript:["import","export","from","interface","type","class","function","const","let","var","if","else","for","while","return","extends","implements","public","private","protected","static","async","await","try","catch","finally","throw","new","this","super","null","undefined","true","false","as","in","of","typeof","instanceof","break","continue","switch","case","default","do","with","enum","namespace"],javascript:["import","export","from","class","function","const","let","var","if","else","for","while","return","extends","async","await","try","catch","finally","throw","new","this","super","null","undefined","true","false","in","of","typeof","instanceof","break","continue","switch","case","default","do","with"],python:["import","from","class","def","if","elif","else","for","while","return","try","except","finally","raise","pass","break","continue","lambda","with","as","yield","assert","del","global","nonlocal","in","is","not","and","or","None","True","False","self","async","await"],java:["import","package","class","interface","extends","implements","public","private","protected","static","final","abstract","void","int","long","float","double","boolean","char","byte","short","if","else","for","while","return","switch","case","default","break","continue","try","catch","finally","throw","throws","new","this","super","null","true","false","instanceof","synchronized","volatile"]},nc=(r,e)=>{if(!r)return"";let t=ic(r);const d=xr[e]||xr.typescript||[],b=[],k=(m,S,_)=>{b.push({start:m,end:S,replacement:_})},E=/(\/\/[^\n]*|\/\*[\s\S]*?\*\/)/g;let s;for(;(s=E.exec(t))!==null;)k(s.index,s.index+s[0].length,`<span class="syntax-comment">${s[0]}</span>`);const a=/(["'`])(?:(?=(\\?))\2[\s\S])*?\1/g;for(;(s=a.exec(t))!==null;)b.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-string">${s[0]}</span>`);const u=/\b(\d+\.?\d*)\b/g;for(;(s=u.exec(t))!==null;)b.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-number">${s[0]}</span>`);const p=new RegExp(`\\b(${d.join("|")})\\b`,"g");for(;(s=p.exec(t))!==null;)b.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-keyword">${s[0]}</span>`);const c=/\b([a-zA-Z_$][a-zA-Z0-9_$]*)\s*(?=\()/g;for(;(s=c.exec(t))!==null;){const m=b.some(_=>s.index>=_.start&&s.index<_.end),S=s[1]&&d.includes(s[1]);!m&&!S&&s[1]&&k(s.index,s.index+s[1].length,`<span class="syntax-function">${s[1]}</span>`)}const h=/\b([A-Z][a-zA-Z0-9_]*)\b(?!\s*\()/g;for(;(s=h.exec(t))!==null;)b.some(S=>s.index>=S.start&&s.index<S.end)||k(s.index,s.index+s[0].length,`<span class="syntax-type">${s[0]}</span>`);b.sort((m,S)=>S.start-m.start);for(const{start:m,end:S,replacement:_}of b)t=t.substring(0,m)+_+t.substring(S);return t};function oc({value:r,onChange:e,language:t,placeholder:d="Start typing your code here..."}){const[b,k]=P.useState(""),E=P.useRef(null),s=P.useRef(null);P.useEffect(()=>{k(r?nc(r,t):"")},[r,t]);const a=()=>{E.current&&s.current&&(s.current.scrollTop=E.current.scrollTop,s.current.scrollLeft=E.current.scrollLeft)},u=c=>{e(c.target.value)},p=c=>{if(c.key==="Tab"){c.preventDefault();const h=c.currentTarget,m=h.selectionStart,S=h.selectionEnd,_=r.substring(0,m)+"    "+r.substring(S);e(_),setTimeout(()=>{h.selectionStart=h.selectionEnd=m+4},0)}};return f.jsxs("div",{className:"relative h-full w-full overflow-hidden bg-[#1e1e1e]",children:[f.jsx("div",{ref:s,className:"absolute inset-0 overflow-auto pointer-events-none syntax-highlighted-content",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"12px",lineHeight:"1.6",padding:"1rem",color:"#d4d4d4"},children:f.jsx("pre",{style:{margin:0,padding:0,background:"transparent",fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word"},dangerouslySetInnerHTML:{__html:b||"&nbsp;"}})}),f.jsx("textarea",{ref:E,value:r,onChange:u,onScroll:a,onKeyDown:p,placeholder:d,className:"absolute inset-0 w-full h-full resize-none bg-transparent border-0 outline-none code-editor-textarea",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"12px",lineHeight:"1.6",padding:"1rem",color:"transparent",caretColor:"#d4d4d4",WebkitTextFillColor:"transparent",whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word"},spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off"}),!r&&f.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{fontFamily:'"JetBrains Mono", monospace',fontSize:"12px",lineHeight:"1.6",padding:"1rem",color:"#6e6e6e"},children:d})]})}function ac({currentPhase:r="spec",selectedFile:e}){const[t,d]=P.useState(""),[b,k]=P.useState([]),E=h=>{const m=b.filter(S=>S.id!==h);k(m),t===h&&m.length>0?d(m[0]?.id||""):m.length===0&&d("")};P.useEffect(()=>{const h=m=>{(m.ctrlKey||m.metaKey)&&m.key==="w"&&(m.preventDefault(),t&&E(t))};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,b]),P.useEffect(()=>{if(e&&e.content){const h=e.path.split("/").pop()||"untitled",m=`file-${e.path}`;b.find(_=>_.id===m)||k(_=>[..._,{id:m,name:h,language:e.language||"plaintext",code:e.content,isActive:!0}]),d(m)}},[e,b]);const s=(h,m)=>{k(S=>S.map(_=>_.id===h?{..._,code:m}:_))},a=()=>{const h=b.find(m=>m.id===t);h&&navigator.clipboard.writeText(h.code)},u=()=>{const h=b.find(m=>m.id===t);if(h){const m=new Blob([h.code],{type:"text/plain"}),S=URL.createObjectURL(m),_=document.createElement("a");_.href=S,_.download=h.name,_.click(),URL.revokeObjectURL(S)}},p=h=>{switch(h){case"spec":return"border-blue-500";case"test":return"border-yellow-500";case"impl":return"border-violet-500";default:return"border-blue-500"}},c=b.find(h=>h.id===t);return b.length===0?f.jsx("div",{className:"h-full flex items-center justify-center bg-[#1e1e1e]",children:f.jsxs("div",{className:"text-center text-muted-foreground px-8",children:[f.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-30"}),f.jsx("p",{className:"text-body mb-2",children:"No files open"}),f.jsx("p",{className:"text-sm mb-4",children:"Select a file from the file tree or import a project to start editing"}),f.jsxs("div",{className:"text-xs space-y-1",children:[f.jsx("p",{className:"opacity-60",children:"Keyboard shortcuts:"}),f.jsx("p",{className:"font-mono opacity-50",children:"Ctrl/Cmd + W - Close active tab"})]})]})}):f.jsxs("div",{className:"h-full flex flex-col bg-[#1e1e1e]",children:[f.jsx("div",{className:"p-4 border-b border-border bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"flex gap-0.5",children:b.map(h=>f.jsxs("div",{className:"relative flex items-center group",children:[t===h.id&&f.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-0.5 ${p(r)} rounded-full`}),f.jsxs("div",{className:`flex items-center rounded-md transition-all duration-200 ${t===h.id?"bg-primary/10 border border-primary/20":"bg-transparent border border-transparent hover:bg-muted/10"}`,style:{fontFamily:"Quicksand, sans-serif",fontSize:"13px",fontWeight:500,minWidth:"120px"},children:[f.jsx("button",{onClick:()=>d(h.id),className:`flex-1 px-3 py-2 text-left truncate transition-colors ${t===h.id?"text-primary":"text-muted-foreground hover:text-foreground"}`,children:h.name}),f.jsx("button",{onClick:m=>{m.stopPropagation(),E(h.id)},className:"p-1.5 mr-1 rounded hover:bg-destructive/20 hover:text-destructive transition-all duration-150 opacity-50 hover:opacity-100 focus:opacity-100",title:"Close file (Ctrl/Cmd + W)",tabIndex:0,children:f.jsx(pt,{className:"h-3 w-3"})})]})]},h.id))}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",onClick:a,children:f.jsx(ao,{className:"h-4 w-4"})}),f.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",onClick:u,children:f.jsx(uo,{className:"h-4 w-4"})}),f.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",children:f.jsx(Ho,{className:"h-4 w-4"})}),f.jsx(ie,{variant:"ghost",size:"sm",className:"minimalist-button p-1.5",children:f.jsx(po,{className:"h-4 w-4"})})]})]})}),f.jsx("div",{className:"flex-1 overflow-hidden bg-[#1e1e1e]",children:c&&f.jsx(oc,{value:c.code,onChange:h=>s(c.id,h),language:c.language,placeholder:"Start typing your code here..."})})]})}var ns={exports:{}},wr;function lc(){return wr||(wr=1,function(r,e){(function(t,d){r.exports=d()})(globalThis,()=>(()=>{var t={4567:function(E,s,a){var u=this&&this.__decorate||function(i,l,g,x){var y,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(y=i[C])&&(v=(w<3?y(v):w>3?y(l,g,v):y(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},p=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const c=a(9042),h=a(9924),m=a(844),S=a(4725),_=a(2585),n=a(3656);let o=s.AccessibilityManager=class extends m.Disposable{constructor(i,l,g,x){super(),this._terminal=i,this._coreBrowserService=g,this._renderService=x,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let y=0;y<this._terminal.rows;y++)this._rowElements[y]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[y]);if(this._topBoundaryFocusListener=y=>this._handleBoundaryFocus(y,0),this._bottomBoundaryFocusListener=y=>this._handleBoundaryFocus(y,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new h.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(y=>this._handleResize(y.rows))),this.register(this._terminal.onRender(y=>this._refreshRows(y.start,y.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(y=>this._handleChar(y))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(y=>this._handleTab(y))),this.register(this._terminal.onKey(y=>this._handleKey(y.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,n.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,m.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(i){for(let l=0;l<i;l++)this._handleChar(" ")}_handleChar(i){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==i&&(this._charsToAnnounce+=i):this._charsToAnnounce+=i,i===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(i){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(i)||this._charsToConsume.push(i)}_refreshRows(i,l){this._liveRegionDebouncer.refresh(i,l,this._terminal.rows)}_renderRows(i,l){const g=this._terminal.buffer,x=g.lines.length.toString();for(let y=i;y<=l;y++){const w=g.lines.get(g.ydisp+y),v=[],C=w?.translateToString(!0,void 0,void 0,v)||"",T=(g.ydisp+y+1).toString(),A=this._rowElements[y];A&&(C.length===0?(A.innerText="",this._rowColumns.set(A,[0,1])):(A.textContent=C,this._rowColumns.set(A,v)),A.setAttribute("aria-posinset",T),A.setAttribute("aria-setsize",x))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(i,l){const g=i.target,x=this._rowElements[l===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(l===0?"1":`${this._terminal.buffer.lines.length}`)||i.relatedTarget!==x)return;let y,w;if(l===0?(y=g,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(y=this._rowElements.shift(),w=g,this._rowContainer.removeChild(y)),y.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),l===0){const v=this._createAccessibilityTreeNode();this._rowElements.unshift(v),this._rowContainer.insertAdjacentElement("afterbegin",v)}else{const v=this._createAccessibilityTreeNode();this._rowElements.push(v),this._rowContainer.appendChild(v)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(l===0?-1:1),this._rowElements[l===0?1:this._rowElements.length-2].focus(),i.preventDefault(),i.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;const i=document.getSelection();if(!i)return;if(i.isCollapsed)return void(this._rowContainer.contains(i.anchorNode)&&this._terminal.clearSelection());if(!i.anchorNode||!i.focusNode)return void console.error("anchorNode and/or focusNode are null");let l={node:i.anchorNode,offset:i.anchorOffset},g={node:i.focusNode,offset:i.focusOffset};if((l.node.compareDocumentPosition(g.node)&Node.DOCUMENT_POSITION_PRECEDING||l.node===g.node&&l.offset>g.offset)&&([l,g]=[g,l]),l.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(l={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(l.node))return;const x=this._rowElements.slice(-1)[0];if(g.node.compareDocumentPosition(x)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(g={node:x,offset:x.textContent?.length??0}),!this._rowContainer.contains(g.node))return;const y=({node:C,offset:T})=>{const A=C instanceof Text?C.parentNode:C;let B=parseInt(A?.getAttribute("aria-posinset"),10)-1;if(isNaN(B))return console.warn("row is invalid. Race condition?"),null;const D=this._rowColumns.get(A);if(!D)return console.warn("columns is null. Race condition?"),null;let j=T<D.length?D[T]:D.slice(-1)[0]+1;return j>=this._terminal.cols&&(++B,j=0),{row:B,column:j}},w=y(l),v=y(g);if(w&&v){if(w.row>v.row||w.row===v.row&&w.column>=v.column)throw new Error("invalid range");this._terminal.select(w.column,w.row,(v.row-w.row)*this._terminal.cols-w.column+v.column)}}_handleResize(i){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let l=this._rowContainer.children.length;l<this._terminal.rows;l++)this._rowElements[l]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[l]);for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const i=this._coreBrowserService.mainDocument.createElement("div");return i.setAttribute("role","listitem"),i.tabIndex=-1,this._refreshRowDimensions(i),i}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let i=0;i<this._terminal.rows;i++)this._refreshRowDimensions(this._rowElements[i])}}_refreshRowDimensions(i){i.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s.AccessibilityManager=o=u([p(1,_.IInstantiationService),p(2,S.ICoreBrowserService),p(3,S.IRenderService)],o)},3614:(E,s)=>{function a(h){return h.replace(/\r?\n/g,"\r")}function u(h,m){return m?"\x1B[200~"+h+"\x1B[201~":h}function p(h,m,S,_){h=u(h=a(h),S.decPrivateModes.bracketedPasteMode&&_.rawOptions.ignoreBracketedPasteMode!==!0),S.triggerDataEvent(h,!0),m.value=""}function c(h,m,S){const _=S.getBoundingClientRect(),n=h.clientX-_.left-10,o=h.clientY-_.top-10;m.style.width="20px",m.style.height="20px",m.style.left=`${n}px`,m.style.top=`${o}px`,m.style.zIndex="1000",m.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=a,s.bracketTextForPaste=u,s.copyHandler=function(h,m){h.clipboardData&&h.clipboardData.setData("text/plain",m.selectionText),h.preventDefault()},s.handlePasteEvent=function(h,m,S,_){h.stopPropagation(),h.clipboardData&&p(h.clipboardData.getData("text/plain"),m,S,_)},s.paste=p,s.moveTextAreaUnderMouseCursor=c,s.rightClickHandler=function(h,m,S,_,n){c(h,m,S),n&&_.rightClickSelect(h),m.value=_.selectionText,m.select()}},7239:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const u=a(1505);s.ColorContrastCache=class{constructor(){this._color=new u.TwoKeyMap,this._css=new u.TwoKeyMap}setCss(p,c,h){this._css.set(p,c,h)}getCss(p,c){return this._css.get(p,c)}setColor(p,c,h){this._color.set(p,c,h)}getColor(p,c){return this._color.get(p,c)}clear(){this._color.clear(),this._css.clear()}}},3656:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(a,u,p,c){a.addEventListener(u,p,c);let h=!1;return{dispose:()=>{h||(h=!0,a.removeEventListener(u,p,c))}}}},3551:function(E,s,a){var u=this&&this.__decorate||function(o,i,l,g){var x,y=arguments.length,w=y<3?i:g===null?g=Object.getOwnPropertyDescriptor(i,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,i,l,g);else for(var v=o.length-1;v>=0;v--)(x=o[v])&&(w=(y<3?x(w):y>3?x(i,l,w):x(i,l))||w);return y>3&&w&&Object.defineProperty(i,l,w),w},p=this&&this.__param||function(o,i){return function(l,g){i(l,g,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier=void 0;const c=a(3656),h=a(8460),m=a(844),S=a(2585),_=a(4725);let n=s.Linkifier=class extends m.Disposable{get currentLink(){return this._currentLink}constructor(o,i,l,g,x){super(),this._element=o,this._mouseService=i,this._renderService=l,this._bufferService=g,this._linkProviderService=x,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,m.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,m.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(o){this._lastMouseEvent=o;const i=this._positionFromMouseEvent(o,this._element,this._mouseService);if(!i)return;this._isMouseOut=!1;const l=o.composedPath();for(let g=0;g<l.length;g++){const x=l[g];if(x.classList.contains("xterm"))break;if(x.classList.contains("xterm-hover"))return}this._lastBufferCell&&i.x===this._lastBufferCell.x&&i.y===this._lastBufferCell.y||(this._handleHover(i),this._lastBufferCell=i)}_handleHover(o){if(this._activeLine!==o.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(o,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,o)||(this._clearCurrentLink(),this._askForLink(o,!0))}_askForLink(o,i){this._activeProviderReplies&&i||(this._activeProviderReplies?.forEach(g=>{g?.forEach(x=>{x.link.dispose&&x.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=o.y);let l=!1;for(const[g,x]of this._linkProviderService.linkProviders.entries())i?this._activeProviderReplies?.get(g)&&(l=this._checkLinkProviderResult(g,o,l)):x.provideLinks(o.y,y=>{if(this._isMouseOut)return;const w=y?.map(v=>({link:v}));this._activeProviderReplies?.set(g,w),l=this._checkLinkProviderResult(g,o,l),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(o.y,this._activeProviderReplies)})}_removeIntersectingLinks(o,i){const l=new Set;for(let g=0;g<i.size;g++){const x=i.get(g);if(x)for(let y=0;y<x.length;y++){const w=x[y],v=w.link.range.start.y<o?0:w.link.range.start.x,C=w.link.range.end.y>o?this._bufferService.cols:w.link.range.end.x;for(let T=v;T<=C;T++){if(l.has(T)){x.splice(y--,1);break}l.add(T)}}}}_checkLinkProviderResult(o,i,l){if(!this._activeProviderReplies)return l;const g=this._activeProviderReplies.get(o);let x=!1;for(let y=0;y<o;y++)this._activeProviderReplies.has(y)&&!this._activeProviderReplies.get(y)||(x=!0);if(!x&&g){const y=g.find(w=>this._linkAtPosition(w.link,i));y&&(l=!0,this._handleNewLink(y))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!l)for(let y=0;y<this._activeProviderReplies.size;y++){const w=this._activeProviderReplies.get(y)?.find(v=>this._linkAtPosition(v.link,i));if(w){l=!0,this._handleNewLink(w);break}}return l}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(o){if(!this._currentLink)return;const i=this._positionFromMouseEvent(o,this._element,this._mouseService);i&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,i)&&this._currentLink.link.activate(o,this._currentLink.link.text)}_clearCurrentLink(o,i){this._currentLink&&this._lastMouseEvent&&(!o||!i||this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=i)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,m.disposeArray)(this._linkCacheDisposables))}_handleNewLink(o){if(!this._lastMouseEvent)return;const i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(o.link,i)&&(this._currentLink=o,this._currentLink.state={decorations:{underline:o.link.decorations===void 0||o.link.decorations.underline,pointerCursor:o.link.decorations===void 0||o.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,o.link,this._lastMouseEvent),o.link.decorations={},Object.defineProperties(o.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:l=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==l&&(this._currentLink.state.decorations.pointerCursor=l,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",l))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:l=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==l&&(this._currentLink.state.decorations.underline=l,this._currentLink.state.isHovered&&this._fireUnderlineEvent(o.link,l))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(l=>{if(!this._currentLink)return;const g=l.start===0?0:l.start+1+this._bufferService.buffer.ydisp,x=this._bufferService.buffer.ydisp+1+l.end;if(this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=x&&(this._clearCurrentLink(g,x),this._lastMouseEvent)){const y=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);y&&this._askForLink(y,!1)}})))}_linkHover(o,i,l){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!0),this._currentLink.state.decorations.pointerCursor&&o.classList.add("xterm-cursor-pointer")),i.hover&&i.hover(l,i.text)}_fireUnderlineEvent(o,i){const l=o.range,g=this._bufferService.buffer.ydisp,x=this._createLinkUnderlineEvent(l.start.x-1,l.start.y-g-1,l.end.x,l.end.y-g-1,void 0);(i?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(x)}_linkLeave(o,i,l){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!1),this._currentLink.state.decorations.pointerCursor&&o.classList.remove("xterm-cursor-pointer")),i.leave&&i.leave(l,i.text)}_linkAtPosition(o,i){const l=o.range.start.y*this._bufferService.cols+o.range.start.x,g=o.range.end.y*this._bufferService.cols+o.range.end.x,x=i.y*this._bufferService.cols+i.x;return l<=x&&x<=g}_positionFromMouseEvent(o,i,l){const g=l.getCoords(o,i,this._bufferService.cols,this._bufferService.rows);if(g)return{x:g[0],y:g[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(o,i,l,g,x){return{x1:o,y1:i,x2:l,y2:g,cols:this._bufferService.cols,fg:x}}};s.Linkifier=n=u([p(1,_.IMouseService),p(2,_.IRenderService),p(3,S.IBufferService),p(4,_.ILinkProviderService)],n)},9042:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(E,s,a){var u=this&&this.__decorate||function(_,n,o,i){var l,g=arguments.length,x=g<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(_,n,o,i);else for(var y=_.length-1;y>=0;y--)(l=_[y])&&(x=(g<3?l(x):g>3?l(n,o,x):l(n,o))||x);return g>3&&x&&Object.defineProperty(n,o,x),x},p=this&&this.__param||function(_,n){return function(o,i){n(o,i,_)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const c=a(511),h=a(2585);let m=s.OscLinkProvider=class{constructor(_,n,o){this._bufferService=_,this._optionsService=n,this._oscLinkService=o}provideLinks(_,n){const o=this._bufferService.buffer.lines.get(_-1);if(!o)return void n(void 0);const i=[],l=this._optionsService.rawOptions.linkHandler,g=new c.CellData,x=o.getTrimmedLength();let y=-1,w=-1,v=!1;for(let C=0;C<x;C++)if(w!==-1||o.hasContent(C)){if(o.loadCell(C,g),g.hasExtendedAttrs()&&g.extended.urlId){if(w===-1){w=C,y=g.extended.urlId;continue}v=g.extended.urlId!==y}else w!==-1&&(v=!0);if(v||w!==-1&&C===x-1){const T=this._oscLinkService.getLinkData(y)?.uri;if(T){const A={start:{x:w+1,y:_},end:{x:C+(v||C!==x-1?0:1),y:_}};let B=!1;if(!l?.allowNonHttpProtocols)try{const D=new URL(T);["http:","https:"].includes(D.protocol)||(B=!0)}catch{B=!0}B||i.push({text:T,range:A,activate:(D,j)=>l?l.activate(D,j,A):S(0,j),hover:(D,j)=>l?.hover?.(D,j,A),leave:(D,j)=>l?.leave?.(D,j,A)})}v=!1,g.hasExtendedAttrs()&&g.extended.urlId?(w=C,y=g.extended.urlId):(w=-1,y=-1)}}n(i)}};function S(_,n){if(confirm(`Do you want to navigate to ${n}?

WARNING: This link could potentially be dangerous`)){const o=window.open();if(o){try{o.opener=null}catch{}o.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}}s.OscLinkProvider=m=u([p(0,h.IBufferService),p(1,h.IOptionsService),p(2,h.IOscLinkService)],m)},6193:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(a,u){this._renderCallback=a,this._coreBrowserService=u,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,u,p){this._rowCount=p,a=a!==void 0?a:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const a=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,u),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},3236:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const u=a(3614),p=a(3656),c=a(3551),h=a(9042),m=a(3730),S=a(1680),_=a(3107),n=a(5744),o=a(2950),i=a(1296),l=a(428),g=a(4269),x=a(5114),y=a(8934),w=a(3230),v=a(9312),C=a(4725),T=a(6731),A=a(8055),B=a(8969),D=a(8460),j=a(844),z=a(6114),U=a(8437),X=a(2584),q=a(7399),R=a(5941),M=a(9074),I=a(2585),O=a(5435),H=a(4567),$=a(779);class K extends B.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(N={}){super(N),this.browser=z,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new j.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(M.DecorationService),this._instantiationService.setService(I.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance($.LinkProviderService),this._instantiationService.setService(C.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(m.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((L,F)=>this.refresh(L,F))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(L=>this._reportWindowsOptions(L))),this.register(this._inputHandler.onColor(L=>this._handleColorEvent(L))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(L=>this._afterResize(L.cols,L.rows))),this.register((0,j.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(N){if(this._themeService)for(const L of N){let F,W="";switch(L.index){case 256:F="foreground",W="10";break;case 257:F="background",W="11";break;case 258:F="cursor",W="12";break;default:F="ansi",W="4;"+L.index}switch(L.type){case 0:const Y=A.color.toColorRGB(F==="ansi"?this._themeService.colors.ansi[L.index]:this._themeService.colors[F]);this.coreService.triggerDataEvent(`${X.C0.ESC}]${W};${(0,R.toRgbString)(Y)}${X.C1_ESCAPED.ST}`);break;case 1:if(F==="ansi")this._themeService.modifyColors(G=>G.ansi[L.index]=A.channels.toColor(...L.color));else{const G=F;this._themeService.modifyColors(J=>J[G]=A.channels.toColor(...L.color))}break;case 2:this._themeService.restoreColor(L.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(N){N?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(H.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(N){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const N=this.buffer.ybase+this.buffer.y,L=this.buffer.lines.get(N);if(!L)return;const F=Math.min(this.buffer.x,this.cols-1),W=this._renderService.dimensions.css.cell.height,Y=L.getWidth(F),G=this._renderService.dimensions.css.cell.width*Y,J=this.buffer.y*this._renderService.dimensions.css.cell.height,re=F*this._renderService.dimensions.css.cell.width;this.textarea.style.left=re+"px",this.textarea.style.top=J+"px",this.textarea.style.width=G+"px",this.textarea.style.height=W+"px",this.textarea.style.lineHeight=W+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,p.addDisposableDomListener)(this.element,"copy",L=>{this.hasSelection()&&(0,u.copyHandler)(L,this._selectionService)}));const N=L=>(0,u.handlePasteEvent)(L,this.textarea,this.coreService,this.optionsService);this.register((0,p.addDisposableDomListener)(this.textarea,"paste",N)),this.register((0,p.addDisposableDomListener)(this.element,"paste",N)),z.isFirefox?this.register((0,p.addDisposableDomListener)(this.element,"mousedown",L=>{L.button===2&&(0,u.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,p.addDisposableDomListener)(this.element,"contextmenu",L=>{(0,u.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),z.isLinux&&this.register((0,p.addDisposableDomListener)(this.element,"auxclick",L=>{L.button===1&&(0,u.moveTextAreaUnderMouseCursor)(L,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,p.addDisposableDomListener)(this.textarea,"keyup",N=>this._keyUp(N),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keydown",N=>this._keyDown(N),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keypress",N=>this._keyPress(N),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionupdate",N=>this._compositionHelper.compositionupdate(N))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,p.addDisposableDomListener)(this.textarea,"input",N=>this._inputEvent(N),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(N){if(!N)throw new Error("Terminal requires a parent element.");if(N.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=N.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),N.appendChild(this.element);const L=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),L.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,p.addDisposableDomListener)(this.screenElement,"mousemove",F=>this.updateCursorStyle(F))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),L.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),z.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(x.CoreBrowserService,this.textarea,N.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(C.ICoreBrowserService,this._coreBrowserService),this.register((0,p.addDisposableDomListener)(this.textarea,"focus",F=>this._handleTextAreaFocus(F))),this.register((0,p.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(l.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(C.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(T.ThemeService),this._instantiationService.setService(C.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(g.CharacterJoinerService),this._instantiationService.setService(C.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(w.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(C.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(F=>this._onRender.fire(F))),this.onResize(F=>this._renderService.resize(F.cols,F.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(o.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(y.MouseService),this._instantiationService.setService(C.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(c.Linkifier,this.screenElement)),this.element.appendChild(L);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(S.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(F=>this.scrollLines(F.amount,F.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(C.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(F=>this.scrollLines(F.amount,F.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(F=>this._renderService.handleSelectionChanged(F.start,F.end,F.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(F=>{this.textarea.value=F,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(F=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(_.BufferDecorationRenderer,this.screenElement)),this.register((0,p.addDisposableDomListener)(this.element,"mousedown",F=>this._selectionService.handleMouseDown(F))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(H.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",F=>this._handleScreenReaderModeOptionChange(F))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",F=>{!this._overviewRulerRenderer&&F&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const N=this,L=this.element;function F(G){const J=N._mouseService.getMouseReportCoords(G,N.screenElement);if(!J)return!1;let re,ne;switch(G.overrideType||G.type){case"mousemove":ne=32,G.buttons===void 0?(re=3,G.button!==void 0&&(re=G.button<3?G.button:3)):re=1&G.buttons?0:4&G.buttons?1:2&G.buttons?2:3;break;case"mouseup":ne=0,re=G.button<3?G.button:3;break;case"mousedown":ne=1,re=G.button<3?G.button:3;break;case"wheel":if(N._customWheelEventHandler&&N._customWheelEventHandler(G)===!1||N.viewport.getLinesScrolled(G)===0)return!1;ne=G.deltaY<0?0:1,re=4;break;default:return!1}return!(ne===void 0||re===void 0||re>4)&&N.coreMouseService.triggerMouseEvent({col:J.col,row:J.row,x:J.x,y:J.y,button:re,action:ne,ctrl:G.ctrlKey,alt:G.altKey,shift:G.shiftKey})}const W={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Y={mouseup:G=>(F(G),G.buttons||(this._document.removeEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.removeEventListener("mousemove",W.mousedrag)),this.cancel(G)),wheel:G=>(F(G),this.cancel(G,!0)),mousedrag:G=>{G.buttons&&F(G)},mousemove:G=>{G.buttons||F(G)}};this.register(this.coreMouseService.onProtocolChange(G=>{G?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(G)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&G?W.mousemove||(L.addEventListener("mousemove",Y.mousemove),W.mousemove=Y.mousemove):(L.removeEventListener("mousemove",W.mousemove),W.mousemove=null),16&G?W.wheel||(L.addEventListener("wheel",Y.wheel,{passive:!1}),W.wheel=Y.wheel):(L.removeEventListener("wheel",W.wheel),W.wheel=null),2&G?W.mouseup||(W.mouseup=Y.mouseup):(this._document.removeEventListener("mouseup",W.mouseup),W.mouseup=null),4&G?W.mousedrag||(W.mousedrag=Y.mousedrag):(this._document.removeEventListener("mousemove",W.mousedrag),W.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,p.addDisposableDomListener)(L,"mousedown",G=>{if(G.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(G))return F(G),W.mouseup&&this._document.addEventListener("mouseup",W.mouseup),W.mousedrag&&this._document.addEventListener("mousemove",W.mousedrag),this.cancel(G)})),this.register((0,p.addDisposableDomListener)(L,"wheel",G=>{if(!W.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(G)===!1)return!1;if(!this.buffer.hasScrollback){const J=this.viewport.getLinesScrolled(G);if(J===0)return;const re=X.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(G.deltaY<0?"A":"B");let ne="";for(let he=0;he<Math.abs(J);he++)ne+=re;return this.coreService.triggerDataEvent(ne,!0),this.cancel(G,!0)}return this.viewport.handleWheel(G)?this.cancel(G):void 0}},{passive:!1})),this.register((0,p.addDisposableDomListener)(L,"touchstart",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(G),this.cancel(G)},{passive:!0})),this.register((0,p.addDisposableDomListener)(L,"touchmove",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(G)?void 0:this.cancel(G)},{passive:!1}))}refresh(N,L){this._renderService?.refreshRows(N,L)}updateCursorStyle(N){this._selectionService?.shouldColumnSelect(N)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(N,L,F=0){F===1?(super.scrollLines(N,L,F),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(N)}paste(N){(0,u.paste)(N,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(N){this._customKeyEventHandler=N}attachCustomWheelEventHandler(N){this._customWheelEventHandler=N}registerLinkProvider(N){return this._linkProviderService.registerLinkProvider(N)}registerCharacterJoiner(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const L=this._characterJoinerService.register(N);return this.refresh(0,this.rows-1),L}deregisterCharacterJoiner(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(N)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(N){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+N)}registerDecoration(N){return this._decorationService.registerDecoration(N)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(N,L,F){this._selectionService.setSelection(N,L,F)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(N,L){this._selectionService?.selectLines(N,L)}_keyDown(N){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1)return!1;const L=this.browser.isMac&&this.options.macOptionIsMeta&&N.altKey;if(!L&&!this._compositionHelper.keydown(N))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;L||N.key!=="Dead"&&N.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const F=(0,q.evaluateKeyboardEvent)(N,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(N),F.type===3||F.type===2){const W=this.rows-1;return this.scrollLines(F.type===2?-W:W),this.cancel(N,!0)}return F.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,N)||(F.cancel&&this.cancel(N,!0),!F.key||!!(N.key&&!N.ctrlKey&&!N.altKey&&!N.metaKey&&N.key.length===1&&N.key.charCodeAt(0)>=65&&N.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(F.key!==X.C0.ETX&&F.key!==X.C0.CR||(this.textarea.value=""),this._onKey.fire({key:F.key,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(F.key,!0),!this.optionsService.rawOptions.screenReaderMode||N.altKey||N.ctrlKey?this.cancel(N,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(N,L){const F=N.isMac&&!this.options.macOptionIsMeta&&L.altKey&&!L.ctrlKey&&!L.metaKey||N.isWindows&&L.altKey&&L.ctrlKey&&!L.metaKey||N.isWindows&&L.getModifierState("AltGraph");return L.type==="keypress"?F:F&&(!L.keyCode||L.keyCode>47)}_keyUp(N){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1||(function(L){return L.keyCode===16||L.keyCode===17||L.keyCode===18}(N)||this.focus(),this.updateCursorStyle(N),this._keyPressHandled=!1)}_keyPress(N){let L;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1)return!1;if(this.cancel(N),N.charCode)L=N.charCode;else if(N.which===null||N.which===void 0)L=N.keyCode;else{if(N.which===0||N.charCode===0)return!1;L=N.which}return!(!L||(N.altKey||N.ctrlKey||N.metaKey)&&!this._isThirdLevelShift(this.browser,N)||(L=String.fromCharCode(L),this._onKey.fire({key:L,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(L,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(N){if(N.data&&N.inputType==="insertText"&&(!N.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const L=N.data;return this.coreService.triggerDataEvent(L,!0),this.cancel(N),!0}return!1}resize(N,L){N!==this.cols||L!==this.rows?super.resize(N,L):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(N,L){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let N=1;N<this.rows;N++)this.buffer.lines.push(this.buffer.getBlankLine(U.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const N=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=N,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(X.C0.ESC+"[I"):this.coreService.triggerDataEvent(X.C0.ESC+"[O")}_reportWindowsOptions(N){if(this._renderService)switch(N){case O.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const L=this._renderService.dimensions.css.canvas.width.toFixed(0),F=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[4;${F};${L}t`);break;case O.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const W=this._renderService.dimensions.css.cell.width.toFixed(0),Y=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[6;${Y};${W}t`)}}cancel(N,L){if(this.options.cancelEvents||L)return N.preventDefault(),N.stopPropagation(),!1}}s.Terminal=K},9924:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(a,u=1e3){this._renderCallback=a,this._debounceThresholdMS=u,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,u,p){this._rowCount=p,a=a!==void 0?a:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u;const c=Date.now();if(c-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=c,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=c-this._lastRefreshMs,m=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},m)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const a=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,u)}}},1680:function(E,s,a){var u=this&&this.__decorate||function(o,i,l,g){var x,y=arguments.length,w=y<3?i:g===null?g=Object.getOwnPropertyDescriptor(i,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,i,l,g);else for(var v=o.length-1;v>=0;v--)(x=o[v])&&(w=(y<3?x(w):y>3?x(i,l,w):x(i,l))||w);return y>3&&w&&Object.defineProperty(i,l,w),w},p=this&&this.__param||function(o,i){return function(l,g){i(l,g,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const c=a(3656),h=a(4725),m=a(8460),S=a(844),_=a(2585);let n=s.Viewport=class extends S.Disposable{constructor(o,i,l,g,x,y,w,v){super(),this._viewportElement=o,this._scrollArea=i,this._bufferService=l,this._optionsService=g,this._charSizeService=x,this._renderService=y,this._coreBrowserService=w,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(o){this._viewportElement.style.backgroundColor=o.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(o){if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const i=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==i&&(this._lastRecordedBufferHeight=i,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const o=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==o&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=o),this._refreshAnimationFrame=null}syncScrollArea(o=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(o)}_handleScroll(o){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const i=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:i,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const o=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(o*(this._smoothScrollState.target-this._smoothScrollState.origin)),o<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(o,i){const l=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(i<0&&this._viewportElement.scrollTop!==0||i>0&&l<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)}handleWheel(o){const i=this._getPixelsScrolled(o);return i!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+i:this._smoothScrollState.target+=i,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=i,this._bubbleScroll(o,i))}scrollLines(o){if(o!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const i=o*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+i,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!1})}_getPixelsScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let i=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?i*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(i*=this._currentRowHeight*this._bufferService.rows),i}getBufferElements(o,i){let l,g="";const x=[],y=i??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let v=o;v<y;v++){const C=w.get(v);if(!C)continue;const T=w.get(v+1)?.isWrapped;if(g+=C.translateToString(!T),!T||v===w.length-1){const A=document.createElement("div");A.textContent=g,x.push(A),g.length>0&&(l=A),g=""}}return{bufferElements:x,cursorElement:l}}getLinesScrolled(o){if(o.deltaY===0||o.shiftKey)return 0;let i=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(i/=this._currentRowHeight+0,this._wheelPartialScroll+=i,i=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(i*=this._bufferService.rows),i}_applyScrollModifier(o,i){const l=this._optionsService.rawOptions.fastScrollModifier;return l==="alt"&&i.altKey||l==="ctrl"&&i.ctrlKey||l==="shift"&&i.shiftKey?o*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:o*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(o){this._lastTouchY=o.touches[0].pageY}handleTouchMove(o){const i=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,i!==0&&(this._viewportElement.scrollTop+=i,this._bubbleScroll(o,i))}};s.Viewport=n=u([p(2,_.IBufferService),p(3,_.IOptionsService),p(4,h.ICharSizeService),p(5,h.IRenderService),p(6,h.ICoreBrowserService),p(7,h.IThemeService)],n)},3107:function(E,s,a){var u=this&&this.__decorate||function(_,n,o,i){var l,g=arguments.length,x=g<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(_,n,o,i);else for(var y=_.length-1;y>=0;y--)(l=_[y])&&(x=(g<3?l(x):g>3?l(n,o,x):l(n,o))||x);return g>3&&x&&Object.defineProperty(n,o,x),x},p=this&&this.__param||function(_,n){return function(o,i){n(o,i,_)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const c=a(4725),h=a(844),m=a(2585);let S=s.BufferDecorationRenderer=class extends h.Disposable{constructor(_,n,o,i,l){super(),this._screenElement=_,this._bufferService=n,this._coreBrowserService=o,this._decorationService=i,this._renderService=l,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(g=>this._removeDecoration(g))),this.register((0,h.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const _ of this._decorationService.decorations)this._renderDecoration(_);this._dimensionsChanged=!1}_renderDecoration(_){this._refreshStyle(_),this._dimensionsChanged&&this._refreshXPosition(_)}_createElement(_){const n=this._coreBrowserService.mainDocument.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer",_?.options?.layer==="top"),n.style.width=`${Math.round((_.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=(_.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(_.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const o=_.options.x??0;return o&&o>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(_,n),n}_refreshStyle(_){const n=_.marker.line-this._bufferService.buffers.active.ydisp;if(n<0||n>=this._bufferService.rows)_.element&&(_.element.style.display="none",_.onRenderEmitter.fire(_.element));else{let o=this._decorationElements.get(_);o||(o=this._createElement(_),_.element=o,this._decorationElements.set(_,o),this._container.appendChild(o),_.onDispose(()=>{this._decorationElements.delete(_),o.remove()})),o.style.top=n*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",_.onRenderEmitter.fire(o)}}_refreshXPosition(_,n=_.element){if(!n)return;const o=_.options.x??0;(_.options.anchor||"left")==="right"?n.style.right=o?o*this._renderService.dimensions.css.cell.width+"px":"":n.style.left=o?o*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(_){this._decorationElements.get(_)?.remove(),this._decorationElements.delete(_),_.dispose()}};s.BufferDecorationRenderer=S=u([p(1,m.IBufferService),p(2,c.ICoreBrowserService),p(3,m.IDecorationService),p(4,c.IRenderService)],S)},5871:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(const u of this._zones)if(u.color===a.options.overviewRulerOptions.color&&u.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(u,a.marker.line))return;if(this._lineAdjacentToZone(u,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(u,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,u){return u>=a.startBufferLine&&u<=a.endBufferLine}_lineAdjacentToZone(a,u,p){return u>=a.startBufferLine-this._linePadding[p||"full"]&&u<=a.endBufferLine+this._linePadding[p||"full"]}_addLineToZone(a,u){a.startBufferLine=Math.min(a.startBufferLine,u),a.endBufferLine=Math.max(a.endBufferLine,u)}}},5744:function(E,s,a){var u=this&&this.__decorate||function(l,g,x,y){var w,v=arguments.length,C=v<3?g:y===null?y=Object.getOwnPropertyDescriptor(g,x):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,g,x,y);else for(var T=l.length-1;T>=0;T--)(w=l[T])&&(C=(v<3?w(C):v>3?w(g,x,C):w(g,x))||C);return v>3&&C&&Object.defineProperty(g,x,C),C},p=this&&this.__param||function(l,g){return function(x,y){g(x,y,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const c=a(5871),h=a(4725),m=a(844),S=a(2585),_={full:0,left:0,center:0,right:0},n={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let i=s.OverviewRulerRenderer=class extends m.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(l,g,x,y,w,v,C){super(),this._viewportElement=l,this._screenElement=g,this._bufferService=x,this._decorationService=y,this._renderService=w,this._optionsService=v,this._coreBrowserService=C,this._colorZoneStore=new c.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,m.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const l=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);n.full=this._canvas.width,n.left=l,n.center=g,n.right=l,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=n.left,o.right=n.left+n.center}_refreshDrawHeightConstants(){_.full=Math.round(2*this._coreBrowserService.dpr);const l=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(l,12),6)*this._coreBrowserService.dpr);_.left=g,_.center=g,_.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const l=this._colorZoneStore.zones;for(const g of l)g.position!=="full"&&this._renderColorZone(g);for(const g of l)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(l){this._ctx.fillStyle=l.color,this._ctx.fillRect(o[l.position||"full"],Math.round((this._canvas.height-1)*(l.startBufferLine/this._bufferService.buffers.active.lines.length)-_[l.position||"full"]/2),n[l.position||"full"],Math.round((this._canvas.height-1)*((l.endBufferLine-l.startBufferLine)/this._bufferService.buffers.active.lines.length)+_[l.position||"full"]))}_queueRefresh(l,g){this._shouldUpdateDimensions=l||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s.OverviewRulerRenderer=i=u([p(2,S.IBufferService),p(3,S.IDecorationService),p(4,h.IRenderService),p(5,S.IOptionsService),p(6,h.ICoreBrowserService)],i)},2950:function(E,s,a){var u=this&&this.__decorate||function(_,n,o,i){var l,g=arguments.length,x=g<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(_,n,o,i);else for(var y=_.length-1;y>=0;y--)(l=_[y])&&(x=(g<3?l(x):g>3?l(n,o,x):l(n,o))||x);return g>3&&x&&Object.defineProperty(n,o,x),x},p=this&&this.__param||function(_,n){return function(o,i){n(o,i,_)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const c=a(4725),h=a(2585),m=a(2584);let S=s.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(_,n,o,i,l,g){this._textarea=_,this._compositionView=n,this._bufferService=o,this._optionsService=i,this._coreService=l,this._renderService=g,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){const n={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let o;this._isSendingComposition=!1,n.start+=this._dataAlreadySent.length,o=this._isComposing?this._textarea.value.substring(n.start,n.end):this._textarea.value.substring(n.start),o.length>0&&this._coreService.triggerDataEvent(o,!0)}},0)}else{this._isSendingComposition=!1;const n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}_handleAnyTextareaChanges(){const _=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const n=this._textarea.value,o=n.replace(_,"");this._dataAlreadySent=o,n.length>_.length?this._coreService.triggerDataEvent(o,!0):n.length<_.length?this._coreService.triggerDataEvent(`${m.C0.DEL}`,!0):n.length===_.length&&n!==_&&this._coreService.triggerDataEvent(n,!0)}},0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),o=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,l=n*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=l+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=o+"px",this._compositionView.style.lineHeight=o+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const g=this._compositionView.getBoundingClientRect();this._textarea.style.left=l+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(g.width,1)+"px",this._textarea.style.height=Math.max(g.height,1)+"px",this._textarea.style.lineHeight=g.height+"px"}_||setTimeout(()=>this.updateCompositionElements(!0),0)}}};s.CompositionHelper=S=u([p(2,h.IBufferService),p(3,h.IOptionsService),p(4,h.ICoreService),p(5,c.IRenderService)],S)},9806:(E,s)=>{function a(u,p,c){const h=c.getBoundingClientRect(),m=u.getComputedStyle(c),S=parseInt(m.getPropertyValue("padding-left")),_=parseInt(m.getPropertyValue("padding-top"));return[p.clientX-h.left-S,p.clientY-h.top-_]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=a,s.getCoords=function(u,p,c,h,m,S,_,n,o){if(!S)return;const i=a(u,p,c);return i?(i[0]=Math.ceil((i[0]+(o?_/2:0))/_),i[1]=Math.ceil(i[1]/n),i[0]=Math.min(Math.max(i[0],1),h+(o?1:0)),i[1]=Math.min(Math.max(i[1],1),m),i):void 0}},9504:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const u=a(2584);function p(n,o,i,l){const g=n-c(n,i),x=o-c(o,i),y=Math.abs(g-x)-function(w,v,C){let T=0;const A=w-c(w,C),B=v-c(v,C);for(let D=0;D<Math.abs(A-B);D++){const j=h(w,v)==="A"?-1:1;C.buffer.lines.get(A+j*D)?.isWrapped&&T++}return T}(n,o,i);return _(y,S(h(n,o),l))}function c(n,o){let i=0,l=o.buffer.lines.get(n),g=l?.isWrapped;for(;g&&n>=0&&n<o.rows;)i++,l=o.buffer.lines.get(--n),g=l?.isWrapped;return i}function h(n,o){return n>o?"A":"B"}function m(n,o,i,l,g,x){let y=n,w=o,v="";for(;y!==i||w!==l;)y+=g?1:-1,g&&y>x.cols-1?(v+=x.buffer.translateBufferLineToString(w,!1,n,y),y=0,n=0,w++):!g&&y<0&&(v+=x.buffer.translateBufferLineToString(w,!1,0,n+1),y=x.cols-1,n=y,w--);return v+x.buffer.translateBufferLineToString(w,!1,n,y)}function S(n,o){const i=o?"O":"[";return u.C0.ESC+i+n}function _(n,o){n=Math.floor(n);let i="";for(let l=0;l<n;l++)i+=o;return i}s.moveToCellSequence=function(n,o,i,l){const g=i.buffer.x,x=i.buffer.y;if(!i.buffer.hasScrollback)return function(v,C,T,A,B,D){return p(C,A,B,D).length===0?"":_(m(v,C,v,C-c(C,B),!1,B).length,S("D",D))}(g,x,0,o,i,l)+p(x,o,i,l)+function(v,C,T,A,B,D){let j;j=p(C,A,B,D).length>0?A-c(A,B):C;const z=A,U=function(X,q,R,M,I,O){let H;return H=p(R,M,I,O).length>0?M-c(M,I):q,X<R&&H<=M||X>=R&&H<M?"C":"D"}(v,C,T,A,B,D);return _(m(v,j,T,z,U==="C",B).length,S(U,D))}(g,x,n,o,i,l);let y;if(x===o)return y=g>n?"D":"C",_(Math.abs(g-n),S(y,l));y=x>o?"D":"C";const w=Math.abs(x-o);return _(function(v,C){return C.cols-v}(x>o?n:g,i)+(w-1)*i.cols+1+((x>o?g:n)-1),S(y,l))}},1296:function(E,s,a){var u=this&&this.__decorate||function(D,j,z,U){var X,q=arguments.length,R=q<3?j:U===null?U=Object.getOwnPropertyDescriptor(j,z):U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(D,j,z,U);else for(var M=D.length-1;M>=0;M--)(X=D[M])&&(R=(q<3?X(R):q>3?X(j,z,R):X(j,z))||R);return q>3&&R&&Object.defineProperty(j,z,R),R},p=this&&this.__param||function(D,j){return function(z,U){j(z,U,D)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const c=a(3787),h=a(2550),m=a(2223),S=a(6171),_=a(6052),n=a(4725),o=a(8055),i=a(8460),l=a(844),g=a(2585),x="xterm-dom-renderer-owner-",y="xterm-rows",w="xterm-fg-",v="xterm-bg-",C="xterm-focus",T="xterm-selection";let A=1,B=s.DomRenderer=class extends l.Disposable{constructor(D,j,z,U,X,q,R,M,I,O,H,$,K){super(),this._terminal=D,this._document=j,this._element=z,this._screenElement=U,this._viewportElement=X,this._helperContainer=q,this._linkifier2=R,this._charSizeService=I,this._optionsService=O,this._bufferService=H,this._coreBrowserService=$,this._themeService=K,this._terminalClass=A++,this._rowElements=[],this._selectionRenderModel=(0,_.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new i.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(y),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(T),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,S.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(V=>this._injectCss(V))),this._injectCss(this._themeService.colors),this._rowFactory=M.createInstance(c.DomRendererRowFactory,document),this._element.classList.add(x+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(V=>this._handleLinkHover(V))),this.register(this._linkifier2.onHideLinkUnderline(V=>this._handleLinkLeave(V))),this.register((0,l.toDisposable)(()=>{this._element.classList.remove(x+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const D=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*D,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*D),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/D),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/D),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const z of this._rowElements)z.style.width=`${this.dimensions.css.canvas.width}px`,z.style.height=`${this.dimensions.css.cell.height}px`,z.style.lineHeight=`${this.dimensions.css.cell.height}px`,z.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const j=`${this._terminalSelector} .${y} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=j,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(D){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let j=`${this._terminalSelector} .${y} { color: ${D.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;j+=`${this._terminalSelector} .${y} .xterm-dim { color: ${o.color.multiplyOpacity(D.foreground,.5).css};}`,j+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const z=`blink_underline_${this._terminalClass}`,U=`blink_bar_${this._terminalClass}`,X=`blink_block_${this._terminalClass}`;j+=`@keyframes ${z} { 50% {  border-bottom-style: hidden; }}`,j+=`@keyframes ${U} { 50% {  box-shadow: none; }}`,j+=`@keyframes ${X} { 0% {  background-color: ${D.cursor.css};  color: ${D.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${D.cursor.css}; }}`,j+=`${this._terminalSelector} .${y}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${z} 1s step-end infinite;}${this._terminalSelector} .${y}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${U} 1s step-end infinite;}${this._terminalSelector} .${y}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-block { background-color: ${D.cursor.css}; color: ${D.cursorAccent.css};}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${D.cursor.css} !important; color: ${D.cursorAccent.css} !important;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${D.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${D.cursor.css} inset;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${D.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,j+=`${this._terminalSelector} .${T} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${T} div { position: absolute; background-color: ${D.selectionBackgroundOpaque.css};}${this._terminalSelector} .${T} div { position: absolute; background-color: ${D.selectionInactiveBackgroundOpaque.css};}`;for(const[q,R]of D.ansi.entries())j+=`${this._terminalSelector} .${w}${q} { color: ${R.css}; }${this._terminalSelector} .${w}${q}.xterm-dim { color: ${o.color.multiplyOpacity(R,.5).css}; }${this._terminalSelector} .${v}${q} { background-color: ${R.css}; }`;j+=`${this._terminalSelector} .${w}${m.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(D.background).css}; }${this._terminalSelector} .${w}${m.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${o.color.multiplyOpacity(o.color.opaque(D.background),.5).css}; }${this._terminalSelector} .${v}${m.INVERTED_DEFAULT_COLOR} { background-color: ${D.foreground.css}; }`,this._themeStyleElement.textContent=j}_setDefaultSpacing(){const D=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${D}px`,this._rowFactory.defaultSpacing=D}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(D,j){for(let z=this._rowElements.length;z<=j;z++){const U=this._document.createElement("div");this._rowContainer.appendChild(U),this._rowElements.push(U)}for(;this._rowElements.length>j;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(D,j){this._refreshRowElements(D,j),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(C),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(C),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(D,j,z){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(D,j,z),this.renderRows(0,this._bufferService.rows-1),!D||!j)return;this._selectionRenderModel.update(this._terminal,D,j,z);const U=this._selectionRenderModel.viewportStartRow,X=this._selectionRenderModel.viewportEndRow,q=this._selectionRenderModel.viewportCappedStartRow,R=this._selectionRenderModel.viewportCappedEndRow;if(q>=this._bufferService.rows||R<0)return;const M=this._document.createDocumentFragment();if(z){const I=D[0]>j[0];M.appendChild(this._createSelectionElement(q,I?j[0]:D[0],I?D[0]:j[0],R-q+1))}else{const I=U===q?D[0]:0,O=q===X?j[0]:this._bufferService.cols;M.appendChild(this._createSelectionElement(q,I,O));const H=R-q-1;if(M.appendChild(this._createSelectionElement(q+1,0,this._bufferService.cols,H)),q!==R){const $=X===R?j[0]:this._bufferService.cols;M.appendChild(this._createSelectionElement(R,0,$))}}this._selectionContainer.appendChild(M)}_createSelectionElement(D,j,z,U=1){const X=this._document.createElement("div"),q=j*this.dimensions.css.cell.width;let R=this.dimensions.css.cell.width*(z-j);return q+R>this.dimensions.css.canvas.width&&(R=this.dimensions.css.canvas.width-q),X.style.height=U*this.dimensions.css.cell.height+"px",X.style.top=D*this.dimensions.css.cell.height+"px",X.style.left=`${q}px`,X.style.width=`${R}px`,X}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const D of this._rowElements)D.replaceChildren()}renderRows(D,j){const z=this._bufferService.buffer,U=z.ybase+z.y,X=Math.min(z.x,this._bufferService.cols-1),q=this._optionsService.rawOptions.cursorBlink,R=this._optionsService.rawOptions.cursorStyle,M=this._optionsService.rawOptions.cursorInactiveStyle;for(let I=D;I<=j;I++){const O=I+z.ydisp,H=this._rowElements[I],$=z.lines.get(O);if(!H||!$)break;H.replaceChildren(...this._rowFactory.createRow($,O,O===U,R,M,X,q,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${x}${this._terminalClass}`}_handleLinkHover(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!0)}_handleLinkLeave(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!1)}_setCellUnderline(D,j,z,U,X,q){z<0&&(D=0),U<0&&(j=0);const R=this._bufferService.rows-1;z=Math.max(Math.min(z,R),0),U=Math.max(Math.min(U,R),0),X=Math.min(X,this._bufferService.cols);const M=this._bufferService.buffer,I=M.ybase+M.y,O=Math.min(M.x,X-1),H=this._optionsService.rawOptions.cursorBlink,$=this._optionsService.rawOptions.cursorStyle,K=this._optionsService.rawOptions.cursorInactiveStyle;for(let V=z;V<=U;++V){const N=V+M.ydisp,L=this._rowElements[V],F=M.lines.get(N);if(!L||!F)break;L.replaceChildren(...this._rowFactory.createRow(F,N,N===I,$,K,O,H,this.dimensions.css.cell.width,this._widthCache,q?V===z?D:0:-1,q?(V===U?j:X)-1:-1))}}};s.DomRenderer=B=u([p(7,g.IInstantiationService),p(8,n.ICharSizeService),p(9,g.IOptionsService),p(10,g.IBufferService),p(11,n.ICoreBrowserService),p(12,n.IThemeService)],B)},3787:function(E,s,a){var u=this&&this.__decorate||function(y,w,v,C){var T,A=arguments.length,B=A<3?w:C===null?C=Object.getOwnPropertyDescriptor(w,v):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(y,w,v,C);else for(var D=y.length-1;D>=0;D--)(T=y[D])&&(B=(A<3?T(B):A>3?T(w,v,B):T(w,v))||B);return A>3&&B&&Object.defineProperty(w,v,B),B},p=this&&this.__param||function(y,w){return function(v,C){w(v,C,y)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=void 0;const c=a(2223),h=a(643),m=a(511),S=a(2585),_=a(8055),n=a(4725),o=a(4269),i=a(6171),l=a(3734);let g=s.DomRendererRowFactory=class{constructor(y,w,v,C,T,A,B){this._document=y,this._characterJoinerService=w,this._optionsService=v,this._coreBrowserService=C,this._coreService=T,this._decorationService=A,this._themeService=B,this._workCell=new m.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(y,w,v){this._selectionStart=y,this._selectionEnd=w,this._columnSelectMode=v}createRow(y,w,v,C,T,A,B,D,j,z,U){const X=[],q=this._characterJoinerService.getJoinedCharacters(w),R=this._themeService.colors;let M,I=y.getNoBgTrimmedLength();v&&I<A+1&&(I=A+1);let O=0,H="",$=0,K=0,V=0,N=!1,L=0,F=!1,W=0;const Y=[],G=z!==-1&&U!==-1;for(let J=0;J<I;J++){y.loadCell(J,this._workCell);let re=this._workCell.getWidth();if(re===0)continue;let ne=!1,he=J,Z=this._workCell;if(q.length>0&&J===q[0][0]){ne=!0;const oe=q.shift();Z=new o.JoinedCellData(this._workCell,y.translateToString(!0,oe[0],oe[1]),oe[1]-oe[0]),he=oe[1]-1,re=Z.getWidth()}const le=this._isCellInSelection(J,w),ze=v&&J===A,Ze=G&&J>=z&&J<=U;let Re=!1;this._decorationService.forEachDecorationAtCell(J,w,void 0,oe=>{Re=!0});let Ne=Z.getChars()||h.WHITESPACE_CELL_CHAR;if(Ne===" "&&(Z.isUnderline()||Z.isOverline())&&(Ne=""),W=re*D-j.get(Ne,Z.isBold(),Z.isItalic()),M){if(O&&(le&&F||!le&&!F&&Z.bg===$)&&(le&&F&&R.selectionForeground||Z.fg===K)&&Z.extended.ext===V&&Ze===N&&W===L&&!ze&&!ne&&!Re){Z.isInvisible()?H+=h.WHITESPACE_CELL_CHAR:H+=Ne,O++;continue}O&&(M.textContent=H),M=this._document.createElement("span"),O=0,H=""}else M=this._document.createElement("span");if($=Z.bg,K=Z.fg,V=Z.extended.ext,N=Ze,L=W,F=le,ne&&A>=J&&A<=he&&(A=J),!this._coreService.isCursorHidden&&ze&&this._coreService.isCursorInitialized){if(Y.push("xterm-cursor"),this._coreBrowserService.isFocused)B&&Y.push("xterm-cursor-blink"),Y.push(C==="bar"?"xterm-cursor-bar":C==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(T)switch(T){case"outline":Y.push("xterm-cursor-outline");break;case"block":Y.push("xterm-cursor-block");break;case"bar":Y.push("xterm-cursor-bar");break;case"underline":Y.push("xterm-cursor-underline")}}if(Z.isBold()&&Y.push("xterm-bold"),Z.isItalic()&&Y.push("xterm-italic"),Z.isDim()&&Y.push("xterm-dim"),H=Z.isInvisible()?h.WHITESPACE_CELL_CHAR:Z.getChars()||h.WHITESPACE_CELL_CHAR,Z.isUnderline()&&(Y.push(`xterm-underline-${Z.extended.underlineStyle}`),H===" "&&(H=""),!Z.isUnderlineColorDefault()))if(Z.isUnderlineColorRGB())M.style.textDecorationColor=`rgb(${l.AttributeData.toColorRGB(Z.getUnderlineColor()).join(",")})`;else{let oe=Z.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Z.isBold()&&oe<8&&(oe+=8),M.style.textDecorationColor=R.ansi[oe].css}Z.isOverline()&&(Y.push("xterm-overline"),H===" "&&(H="")),Z.isStrikethrough()&&Y.push("xterm-strikethrough"),Ze&&(M.style.textDecoration="underline");let pe=Z.getFgColor(),Qe=Z.getFgColorMode(),we=Z.getBgColor(),et=Z.getBgColorMode();const Xt=!!Z.isInverse();if(Xt){const oe=pe;pe=we,we=oe;const un=Qe;Qe=et,et=un}let De,_t,Te,tt=!1;switch(this._decorationService.forEachDecorationAtCell(J,w,void 0,oe=>{oe.options.layer!=="top"&&tt||(oe.backgroundColorRGB&&(et=50331648,we=oe.backgroundColorRGB.rgba>>8&16777215,De=oe.backgroundColorRGB),oe.foregroundColorRGB&&(Qe=50331648,pe=oe.foregroundColorRGB.rgba>>8&16777215,_t=oe.foregroundColorRGB),tt=oe.options.layer==="top")}),!tt&&le&&(De=this._coreBrowserService.isFocused?R.selectionBackgroundOpaque:R.selectionInactiveBackgroundOpaque,we=De.rgba>>8&16777215,et=50331648,tt=!0,R.selectionForeground&&(Qe=50331648,pe=R.selectionForeground.rgba>>8&16777215,_t=R.selectionForeground)),tt&&Y.push("xterm-decoration-top"),et){case 16777216:case 33554432:Te=R.ansi[we],Y.push(`xterm-bg-${we}`);break;case 50331648:Te=_.channels.toColor(we>>16,we>>8&255,255&we),this._addStyle(M,`background-color:#${x((we>>>0).toString(16),"0",6)}`);break;default:Xt?(Te=R.foreground,Y.push(`xterm-bg-${c.INVERTED_DEFAULT_COLOR}`)):Te=R.background}switch(De||Z.isDim()&&(De=_.color.multiplyOpacity(Te,.5)),Qe){case 16777216:case 33554432:Z.isBold()&&pe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(pe+=8),this._applyMinimumContrast(M,Te,R.ansi[pe],Z,De,void 0)||Y.push(`xterm-fg-${pe}`);break;case 50331648:const oe=_.channels.toColor(pe>>16&255,pe>>8&255,255&pe);this._applyMinimumContrast(M,Te,oe,Z,De,_t)||this._addStyle(M,`color:#${x(pe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(M,Te,R.foreground,Z,De,_t)||Xt&&Y.push(`xterm-fg-${c.INVERTED_DEFAULT_COLOR}`)}Y.length&&(M.className=Y.join(" "),Y.length=0),ze||ne||Re?M.textContent=H:O++,W!==this.defaultSpacing&&(M.style.letterSpacing=`${W}px`),X.push(M),J=he}return M&&O&&(M.textContent=H),X}_applyMinimumContrast(y,w,v,C,T,A){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,i.treatGlyphAsBackgroundColor)(C.getCode()))return!1;const B=this._getContrastCache(C);let D;if(T||A||(D=B.getColor(w.rgba,v.rgba)),D===void 0){const j=this._optionsService.rawOptions.minimumContrastRatio/(C.isDim()?2:1);D=_.color.ensureContrastRatio(T||w,A||v,j),B.setColor((T||w).rgba,(A||v).rgba,D??null)}return!!D&&(this._addStyle(y,`color:${D.css}`),!0)}_getContrastCache(y){return y.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(y,w){y.setAttribute("style",`${y.getAttribute("style")||""}${w};`)}_isCellInSelection(y,w){const v=this._selectionStart,C=this._selectionEnd;return!(!v||!C)&&(this._columnSelectMode?v[0]<=C[0]?y>=v[0]&&w>=v[1]&&y<C[0]&&w<=C[1]:y<v[0]&&w>=v[1]&&y>=C[0]&&w<=C[1]:w>v[1]&&w<C[1]||v[1]===C[1]&&w===v[1]&&y>=v[0]&&y<C[0]||v[1]<C[1]&&w===C[1]&&y<C[0]||v[1]<C[1]&&w===v[1]&&y>=v[0])}};function x(y,w,v){for(;y.length<v;)y=w+y;return y}s.DomRendererRowFactory=g=u([p(1,n.ICharacterJoinerService),p(2,S.IOptionsService),p(3,n.ICoreBrowserService),p(4,S.ICoreService),p(5,S.IDecorationService),p(6,n.IThemeService)],g)},2550:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WidthCache=void 0,s.WidthCache=class{constructor(a,u){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=a.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const p=a.createElement("span");p.classList.add("xterm-char-measure-element");const c=a.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontWeight="bold";const h=a.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontStyle="italic";const m=a.createElement("span");m.classList.add("xterm-char-measure-element"),m.style.fontWeight="bold",m.style.fontStyle="italic",this._measureElements=[p,c,h,m],this._container.appendChild(p),this._container.appendChild(c),this._container.appendChild(h),this._container.appendChild(m),u.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(a,u,p,c){a===this._font&&u===this._fontSize&&p===this._weight&&c===this._weightBold||(this._font=a,this._fontSize=u,this._weight=p,this._weightBold=c,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${p}`,this._measureElements[1].style.fontWeight=`${c}`,this._measureElements[2].style.fontWeight=`${p}`,this._measureElements[3].style.fontWeight=`${c}`,this.clear())}get(a,u,p){let c=0;if(!u&&!p&&a.length===1&&(c=a.charCodeAt(0))<256){if(this._flat[c]!==-9999)return this._flat[c];const S=this._measure(a,0);return S>0&&(this._flat[c]=S),S}let h=a;u&&(h+="B"),p&&(h+="I");let m=this._holey.get(h);if(m===void 0){let S=0;u&&(S|=1),p&&(S|=2),m=this._measure(a,S),m>0&&this._holey.set(h,m)}return m}_measure(a,u){const p=this._measureElements[u];return p.textContent=a.repeat(32),p.offsetWidth/32}}},2223:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const u=a(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=u.isFirefox||u.isLegacyEdge?"bottom":"ideographic"},6171:(E,s)=>{function a(p){return 57508<=p&&p<=57558}function u(p){return p>=128512&&p<=128591||p>=127744&&p<=128511||p>=128640&&p<=128767||p>=9728&&p<=9983||p>=9984&&p<=10175||p>=65024&&p<=65039||p>=129280&&p<=129535||p>=127462&&p<=127487}Object.defineProperty(s,"__esModule",{value:!0}),s.computeNextVariantOffset=s.createRenderDimensions=s.treatGlyphAsBackgroundColor=s.allowRescaling=s.isEmoji=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(p){if(!p)throw new Error("value must not be falsy");return p},s.isPowerlineGlyph=a,s.isRestrictedPowerlineGlyph=function(p){return 57520<=p&&p<=57527},s.isEmoji=u,s.allowRescaling=function(p,c,h,m){return c===1&&h>Math.ceil(1.5*m)&&p!==void 0&&p>255&&!u(p)&&!a(p)&&!function(S){return 57344<=S&&S<=63743}(p)},s.treatGlyphAsBackgroundColor=function(p){return a(p)||function(c){return 9472<=c&&c<=9631}(p)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},s.computeNextVariantOffset=function(p,c,h=0){return(p-(2*Math.round(c)-h))%(2*Math.round(c))}},6052:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createSelectionRenderModel=void 0;class a{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(p,c,h,m=!1){if(this.selectionStart=c,this.selectionEnd=h,!c||!h||c[0]===h[0]&&c[1]===h[1])return void this.clear();const S=p.buffers.active.ydisp,_=c[1]-S,n=h[1]-S,o=Math.max(_,0),i=Math.min(n,p.rows-1);o>=p.rows||i<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=m,this.viewportStartRow=_,this.viewportEndRow=n,this.viewportCappedStartRow=o,this.viewportCappedEndRow=i,this.startCol=c[0],this.endCol=h[0])}isCellSelected(p,c,h){return!!this.hasSelection&&(h-=p.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?c>=this.startCol&&h>=this.viewportCappedStartRow&&c<this.endCol&&h<=this.viewportCappedEndRow:c<this.startCol&&h>=this.viewportCappedStartRow&&c>=this.endCol&&h<=this.viewportCappedEndRow:h>this.viewportStartRow&&h<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&h===this.viewportStartRow&&c>=this.startCol&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&h===this.viewportEndRow&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&h===this.viewportStartRow&&c>=this.startCol)}}s.createSelectionRenderModel=function(){return new a}},456:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const a=this.selectionStart,u=this.selectionEnd;return!(!a||!u)&&(a[1]>u[1]||a[1]===u[1]&&a[0]>u[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(E,s,a){var u=this&&this.__decorate||function(i,l,g,x){var y,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(y=i[C])&&(v=(w<3?y(v):w>3?y(l,g,v):y(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},p=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const c=a(2585),h=a(8460),m=a(844);let S=s.CharSizeService=class extends m.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(i,l,g){super(),this._optionsService=g,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new o(this._optionsService))}catch{this._measureStrategy=this.register(new n(i,l,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const i=this._measureStrategy.measure();i.width===this.width&&i.height===this.height||(this.width=i.width,this.height=i.height,this._onCharSizeChange.fire())}};s.CharSizeService=S=u([p(2,c.IOptionsService)],S);class _ extends m.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(l,g){l!==void 0&&l>0&&g!==void 0&&g>0&&(this._result.width=l,this._result.height=g)}}class n extends _{constructor(l,g,x){super(),this._document=l,this._parentElement=g,this._optionsService=x,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class o extends _{constructor(l){super(),this._optionsService=l,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const g=this._ctx.measureText("W");if(!("width"in g&&"fontBoundingBoxAscent"in g&&"fontBoundingBoxDescent"in g))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const l=this._ctx.measureText("W");return this._validateAndSet(l.width,l.fontBoundingBoxAscent+l.fontBoundingBoxDescent),this._result}}},4269:function(E,s,a){var u=this&&this.__decorate||function(o,i,l,g){var x,y=arguments.length,w=y<3?i:g===null?g=Object.getOwnPropertyDescriptor(i,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,i,l,g);else for(var v=o.length-1;v>=0;v--)(x=o[v])&&(w=(y<3?x(w):y>3?x(i,l,w):x(i,l))||w);return y>3&&w&&Object.defineProperty(i,l,w),w},p=this&&this.__param||function(o,i){return function(l,g){i(l,g,o)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const c=a(3734),h=a(643),m=a(511),S=a(2585);class _ extends c.AttributeData{constructor(i,l,g){super(),this.content=0,this.combinedData="",this.fg=i.fg,this.bg=i.bg,this.combinedData=l,this._width=g}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(i){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=_;let n=s.CharacterJoinerService=class Hi{constructor(i){this._bufferService=i,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new m.CellData}register(i){const l={id:this._nextCharacterJoinerId++,handler:i};return this._characterJoiners.push(l),l.id}deregister(i){for(let l=0;l<this._characterJoiners.length;l++)if(this._characterJoiners[l].id===i)return this._characterJoiners.splice(l,1),!0;return!1}getJoinedCharacters(i){if(this._characterJoiners.length===0)return[];const l=this._bufferService.buffer.lines.get(i);if(!l||l.length===0)return[];const g=[],x=l.translateToString(!0);let y=0,w=0,v=0,C=l.getFg(0),T=l.getBg(0);for(let A=0;A<l.getTrimmedLength();A++)if(l.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==T){if(A-y>1){const B=this._getJoinedRanges(x,v,w,l,y);for(let D=0;D<B.length;D++)g.push(B[D])}y=A,v=w,C=this._workCell.fg,T=this._workCell.bg}w+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-y>1){const A=this._getJoinedRanges(x,v,w,l,y);for(let B=0;B<A.length;B++)g.push(A[B])}return g}_getJoinedRanges(i,l,g,x,y){const w=i.substring(l,g);let v=[];try{v=this._characterJoiners[0].handler(w)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{const T=this._characterJoiners[C].handler(w);for(let A=0;A<T.length;A++)Hi._mergeRanges(v,T[A])}catch(T){console.error(T)}return this._stringRangesToCellRanges(v,x,y),v}_stringRangesToCellRanges(i,l,g){let x=0,y=!1,w=0,v=i[x];if(v){for(let C=g;C<this._bufferService.cols;C++){const T=l.getWidth(C),A=l.getString(C).length||h.WHITESPACE_CELL_CHAR.length;if(T!==0){if(!y&&v[0]<=w&&(v[0]=C,y=!0),v[1]<=w){if(v[1]=C,v=i[++x],!v)break;v[0]<=w?(v[0]=C,y=!0):y=!1}w+=A}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(i,l){let g=!1;for(let x=0;x<i.length;x++){const y=i[x];if(g){if(l[1]<=y[0])return i[x-1][1]=l[1],i;if(l[1]<=y[1])return i[x-1][1]=Math.max(l[1],y[1]),i.splice(x,1),i;i.splice(x,1),x--}else{if(l[1]<=y[0])return i.splice(x,0,l),i;if(l[1]<=y[1])return y[0]=Math.min(l[0],y[0]),i;l[0]<y[1]&&(y[0]=Math.min(l[0],y[0]),g=!0)}}return g?i[i.length-1][1]=l[1]:i.push(l),i}};s.CharacterJoinerService=n=u([p(0,S.IBufferService)],n)},5114:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0;const u=a(844),p=a(8460),c=a(3656);class h extends u.Disposable{constructor(_,n,o){super(),this._textarea=_,this._window=n,this.mainDocument=o,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new m(this._window),this._onDprChange=this.register(new p.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new p.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(i=>this._screenDprMonitor.setWindow(i))),this.register((0,p.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(_){this._window!==_&&(this._window=_,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}s.CoreBrowserService=h;class m extends u.Disposable{constructor(_){super(),this._parentWindow=_,this._windowResizeListener=this.register(new u.MutableDisposable),this._onDprChange=this.register(new p.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,u.toDisposable)(()=>this.clearListener()))}setWindow(_){this._parentWindow=_,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,c.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.LinkProviderService=void 0;const u=a(844);class p extends u.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,u.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(h){return this.linkProviders.push(h),{dispose:()=>{const m=this.linkProviders.indexOf(h);m!==-1&&this.linkProviders.splice(m,1)}}}}s.LinkProviderService=p},8934:function(E,s,a){var u=this&&this.__decorate||function(S,_,n,o){var i,l=arguments.length,g=l<3?_:o===null?o=Object.getOwnPropertyDescriptor(_,n):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(S,_,n,o);else for(var x=S.length-1;x>=0;x--)(i=S[x])&&(g=(l<3?i(g):l>3?i(_,n,g):i(_,n))||g);return l>3&&g&&Object.defineProperty(_,n,g),g},p=this&&this.__param||function(S,_){return function(n,o){_(n,o,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const c=a(4725),h=a(9806);let m=s.MouseService=class{constructor(S,_){this._renderService=S,this._charSizeService=_}getCoords(S,_,n,o,i){return(0,h.getCoords)(window,S,_,n,o,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,i)}getMouseReportCoords(S,_){const n=(0,h.getCoordsRelativeToElement)(window,S,_);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};s.MouseService=m=u([p(0,c.IRenderService),p(1,c.ICharSizeService)],m)},3230:function(E,s,a){var u=this&&this.__decorate||function(i,l,g,x){var y,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(y=i[C])&&(v=(w<3?y(v):w>3?y(l,g,v):y(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},p=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const c=a(6193),h=a(4725),m=a(8460),S=a(844),_=a(7226),n=a(2585);let o=s.RenderService=class extends S.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(i,l,g,x,y,w,v,C){super(),this._rowCount=i,this._charSizeService=x,this._renderer=this.register(new S.MutableDisposable),this._pausedResizeTask=new _.DebouncedIdleTask,this._observerDisposable=this.register(new S.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new m.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new m.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new m.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new m.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new c.RenderDebouncer((T,A)=>this._renderRows(T,A),v),this.register(this._renderDebouncer),this.register(v.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(w.onResize(()=>this._fullRefresh())),this.register(w.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(y.onDecorationRegistered(()=>this._fullRefresh())),this.register(y.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(w.cols,w.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(w.buffer.y,w.buffer.y,!0))),this.register(C.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(v.window,l),this.register(v.onWindowChange(T=>this._registerIntersectionObserver(T,l)))}_registerIntersectionObserver(i,l){if("IntersectionObserver"in i){const g=new i.IntersectionObserver(x=>this._handleIntersectionChange(x[x.length-1]),{threshold:0});g.observe(l),this._observerDisposable.value=(0,S.toDisposable)(()=>g.disconnect())}}_handleIntersectionChange(i){this._isPaused=i.isIntersecting===void 0?i.intersectionRatio===0:!i.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(i,l,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(i,l,this._rowCount))}_renderRows(i,l){this._renderer.value&&(i=Math.min(i,this._rowCount-1),l=Math.min(l,this._rowCount-1),this._renderer.value.renderRows(i,l),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:i,end:l}),this._onRender.fire({start:i,end:l}),this._isNextRenderRedrawOnly=!0)}resize(i,l){this._rowCount=l,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(i){this._renderer.value=i,this._renderer.value&&(this._renderer.value.onRequestRedraw(l=>this.refreshRows(l.start,l.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(i){return this._renderDebouncer.addRefreshCallback(i)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(i,l){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(i,l)):this._renderer.value.handleResize(i,l),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(i,l,g){this._selectionState.start=i,this._selectionState.end=l,this._selectionState.columnSelectMode=g,this._renderer.value?.handleSelectionChanged(i,l,g)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};s.RenderService=o=u([p(2,n.IOptionsService),p(3,h.ICharSizeService),p(4,n.IDecorationService),p(5,n.IBufferService),p(6,h.ICoreBrowserService),p(7,h.IThemeService)],o)},9312:function(E,s,a){var u=this&&this.__decorate||function(v,C,T,A){var B,D=arguments.length,j=D<3?C:A===null?A=Object.getOwnPropertyDescriptor(C,T):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(v,C,T,A);else for(var z=v.length-1;z>=0;z--)(B=v[z])&&(j=(D<3?B(j):D>3?B(C,T,j):B(C,T))||j);return D>3&&j&&Object.defineProperty(C,T,j),j},p=this&&this.__param||function(v,C){return function(T,A){C(T,A,v)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const c=a(9806),h=a(9504),m=a(456),S=a(4725),_=a(8460),n=a(844),o=a(6114),i=a(4841),l=a(511),g=a(2585),x="",y=new RegExp(x,"g");let w=s.SelectionService=class extends n.Disposable{constructor(v,C,T,A,B,D,j,z,U){super(),this._element=v,this._screenElement=C,this._linkifier=T,this._bufferService=A,this._coreService=B,this._mouseService=D,this._optionsService=j,this._renderService=z,this._coreBrowserService=U,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new l.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=X=>this._handleMouseMove(X),this._mouseUpListener=X=>this._handleMouseUp(X),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(X=>this._handleTrim(X)),this.register(this._bufferService.buffers.onBufferActivate(X=>this._handleBufferActivate(X))),this.enable(),this._model=new m.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,n.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const v=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!v||!C||v[0]===C[0]&&v[1]===C[1])}get selectionText(){const v=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!v||!C)return"";const T=this._bufferService.buffer,A=[];if(this._activeSelectionMode===3){if(v[0]===C[0])return"";const B=v[0]<C[0]?v[0]:C[0],D=v[0]<C[0]?C[0]:v[0];for(let j=v[1];j<=C[1];j++){const z=T.translateBufferLineToString(j,!0,B,D);A.push(z)}}else{const B=v[1]===C[1]?C[0]:void 0;A.push(T.translateBufferLineToString(v[1],!0,v[0],B));for(let D=v[1]+1;D<=C[1]-1;D++){const j=T.lines.get(D),z=T.translateBufferLineToString(D,!0);j?.isWrapped?A[A.length-1]+=z:A.push(z)}if(v[1]!==C[1]){const D=T.lines.get(C[1]),j=T.translateBufferLineToString(C[1],!0,0,C[0]);D&&D.isWrapped?A[A.length-1]+=j:A.push(j)}}return A.map(B=>B.replace(y," ")).join(o.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),o.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){const C=this._getMouseBufferCoords(v),T=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!!(T&&A&&C)&&this._areCoordsInSelection(C,T,A)}isCellInSelection(v,C){const T=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!(!T||!A)&&this._areCoordsInSelection([v,C],T,A)}_areCoordsInSelection(v,C,T){return v[1]>C[1]&&v[1]<T[1]||C[1]===T[1]&&v[1]===C[1]&&v[0]>=C[0]&&v[0]<T[0]||C[1]<T[1]&&v[1]===T[1]&&v[0]<T[0]||C[1]<T[1]&&v[1]===C[1]&&v[0]>=C[0]}_selectWordAtCursor(v,C){const T=this._linkifier.currentLink?.link?.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,i.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const A=this._getMouseBufferCoords(v);return!!A&&(this._selectWordAt(A,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,C){this._model.clearSelection(),v=Math.max(v,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){const C=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(v){let C=(0,c.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1];const T=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=T?0:(C>T&&(C-=T),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(v){return o.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){const C=this._getMouseBufferCoords(v);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(v){return v.altKey&&!(o.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;const C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const T=this._bufferService.buffer;if(this._model.selectionEnd[1]<T.lines.length){const A=T.lines.get(this._model.selectionEnd[1]);A&&A.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){const C=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const T=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(T&&T[0]!==void 0&&T[1]!==void 0){const A=(0,h.moveToCellSequence)(T[0]-1,T[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(A,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const v=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,T=!(!v||!C||v[0]===C[0]&&v[1]===C[1]);T?v&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,C,T)):this._oldHasSelection&&this._fireOnSelectionChange(v,C,T)}_fireOnSelectionChange(v,C,T){this._oldSelectionStart=v,this._oldSelectionEnd=C,this._oldHasSelection=T,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(v,C){let T=C;for(let A=0;C>=A;A++){const B=v.loadCell(A,this._workCell).getChars().length;this._workCell.getWidth()===0?T--:B>1&&C!==A&&(T+=B-1)}return T}setSelection(v,C,T){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,C],this._model.selectionStartLength=T,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,C,T=!0,A=!0){if(v[0]>=this._bufferService.cols)return;const B=this._bufferService.buffer,D=B.lines.get(v[1]);if(!D)return;const j=B.translateBufferLineToString(v[1],!1);let z=this._convertViewportColToCharacterIndex(D,v[0]),U=z;const X=v[0]-z;let q=0,R=0,M=0,I=0;if(j.charAt(z)===" "){for(;z>0&&j.charAt(z-1)===" ";)z--;for(;U<j.length&&j.charAt(U+1)===" ";)U++}else{let $=v[0],K=v[0];D.getWidth($)===0&&(q++,$--),D.getWidth(K)===2&&(R++,K++);const V=D.getString(K).length;for(V>1&&(I+=V-1,U+=V-1);$>0&&z>0&&!this._isCharWordSeparator(D.loadCell($-1,this._workCell));){D.loadCell($-1,this._workCell);const N=this._workCell.getChars().length;this._workCell.getWidth()===0?(q++,$--):N>1&&(M+=N-1,z-=N-1),z--,$--}for(;K<D.length&&U+1<j.length&&!this._isCharWordSeparator(D.loadCell(K+1,this._workCell));){D.loadCell(K+1,this._workCell);const N=this._workCell.getChars().length;this._workCell.getWidth()===2?(R++,K++):N>1&&(I+=N-1,U+=N-1),U++,K++}}U++;let O=z+X-q+M,H=Math.min(this._bufferService.cols,U-z+q+R-M-I);if(C||j.slice(z,U).trim()!==""){if(T&&O===0&&D.getCodePoint(0)!==32){const $=B.lines.get(v[1]-1);if($&&D.isWrapped&&$.getCodePoint(this._bufferService.cols-1)!==32){const K=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(K){const V=this._bufferService.cols-K.start;O-=V,H+=V}}}if(A&&O+H===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const $=B.lines.get(v[1]+1);if($?.isWrapped&&$.getCodePoint(0)!==32){const K=this._getWordAt([0,v[1]+1],!1,!1,!0);K&&(H+=K.length)}}return{start:O,length:H}}}_selectWordAt(v,C){const T=this._getWordAt(v,C);if(T){for(;T.start<0;)T.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[T.start,v[1]],this._model.selectionStartLength=T.length}}_selectToWordAt(v){const C=this._getWordAt(v,!0);if(C){let T=v[1];for(;C.start<0;)C.start+=this._bufferService.cols,T--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,T++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,T]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){const C=this._bufferService.buffer.getWrappedRangeForLine(v),T={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,i.getRangeLength)(T,this._bufferService.cols)}};s.SelectionService=w=u([p(3,g.IBufferService),p(4,g.ICoreService),p(5,S.IMouseService),p(6,g.IOptionsService),p(7,S.IRenderService),p(8,S.ICoreBrowserService)],w)},4725:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ILinkProviderService=s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const u=a(8343);s.ICharSizeService=(0,u.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,u.createDecorator)("CoreBrowserService"),s.IMouseService=(0,u.createDecorator)("MouseService"),s.IRenderService=(0,u.createDecorator)("RenderService"),s.ISelectionService=(0,u.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,u.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,u.createDecorator)("ThemeService"),s.ILinkProviderService=(0,u.createDecorator)("LinkProviderService")},6731:function(E,s,a){var u=this&&this.__decorate||function(w,v,C,T){var A,B=arguments.length,D=B<3?v:T===null?T=Object.getOwnPropertyDescriptor(v,C):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(w,v,C,T);else for(var j=w.length-1;j>=0;j--)(A=w[j])&&(D=(B<3?A(D):B>3?A(v,C,D):A(v,C))||D);return B>3&&D&&Object.defineProperty(v,C,D),D},p=this&&this.__param||function(w,v){return function(C,T){v(C,T,w)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const c=a(7239),h=a(8055),m=a(8460),S=a(844),_=a(2585),n=h.css.toColor("#ffffff"),o=h.css.toColor("#000000"),i=h.css.toColor("#ffffff"),l=h.css.toColor("#000000"),g={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const w=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let C=0;C<216;C++){const T=v[C/36%6|0],A=v[C/6%6|0],B=v[C%6];w.push({css:h.channels.toCss(T,A,B),rgba:h.channels.toRgba(T,A,B)})}for(let C=0;C<24;C++){const T=8+10*C;w.push({css:h.channels.toCss(T,T,T),rgba:h.channels.toRgba(T,T,T)})}return w})());let x=s.ThemeService=class extends S.Disposable{get colors(){return this._colors}constructor(w){super(),this._optionsService=w,this._contrastCache=new c.ColorContrastCache,this._halfContrastCache=new c.ColorContrastCache,this._onChangeColors=this.register(new m.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:n,background:o,cursor:i,cursorAccent:l,selectionForeground:void 0,selectionBackgroundTransparent:g,selectionBackgroundOpaque:h.color.blend(o,g),selectionInactiveBackgroundTransparent:g,selectionInactiveBackgroundOpaque:h.color.blend(o,g),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(w={}){const v=this._colors;if(v.foreground=y(w.foreground,n),v.background=y(w.background,o),v.cursor=y(w.cursor,i),v.cursorAccent=y(w.cursorAccent,l),v.selectionBackgroundTransparent=y(w.selectionBackground,g),v.selectionBackgroundOpaque=h.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=y(w.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=h.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=w.selectionForeground?y(w.selectionForeground,h.NULL_COLOR):void 0,v.selectionForeground===h.NULL_COLOR&&(v.selectionForeground=void 0),h.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=h.color.opacity(v.selectionBackgroundTransparent,.3)),h.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=h.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=s.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=y(w.black,s.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=y(w.red,s.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=y(w.green,s.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=y(w.yellow,s.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=y(w.blue,s.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=y(w.magenta,s.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=y(w.cyan,s.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=y(w.white,s.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=y(w.brightBlack,s.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=y(w.brightRed,s.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=y(w.brightGreen,s.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=y(w.brightYellow,s.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=y(w.brightBlue,s.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=y(w.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=y(w.brightCyan,s.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=y(w.brightWhite,s.DEFAULT_ANSI_COLORS[15]),w.extendedAnsi){const C=Math.min(v.ansi.length-16,w.extendedAnsi.length);for(let T=0;T<C;T++)v.ansi[T+16]=y(w.extendedAnsi[T],s.DEFAULT_ANSI_COLORS[T+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(w){this._restoreColor(w),this._onChangeColors.fire(this.colors)}_restoreColor(w){if(w!==void 0)switch(w){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[w]=this._restoreColors.ansi[w]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(w){w(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function y(w,v){if(w!==void 0)try{return h.css.toColor(w)}catch{}return v}s.ThemeService=x=u([p(0,_.IOptionsService)],x)},6349:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const u=a(8460),p=a(844);class c extends p.Disposable{constructor(m){super(),this._maxLength=m,this.onDeleteEmitter=this.register(new u.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new u.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new u.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(m){if(this._maxLength===m)return;const S=new Array(m);for(let _=0;_<Math.min(m,this.length);_++)S[_]=this._array[this._getCyclicIndex(_)];this._array=S,this._maxLength=m,this._startIndex=0}get length(){return this._length}set length(m){if(m>this._length)for(let S=this._length;S<m;S++)this._array[S]=void 0;this._length=m}get(m){return this._array[this._getCyclicIndex(m)]}set(m,S){this._array[this._getCyclicIndex(m)]=S}push(m){this._array[this._getCyclicIndex(this._length)]=m,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(m,S,..._){if(S){for(let n=m;n<this._length-S;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+S)];this._length-=S,this.onDeleteEmitter.fire({index:m,amount:S})}for(let n=this._length-1;n>=m;n--)this._array[this._getCyclicIndex(n+_.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<_.length;n++)this._array[this._getCyclicIndex(m+n)]=_[n];if(_.length&&this.onInsertEmitter.fire({index:m,amount:_.length}),this._length+_.length>this._maxLength){const n=this._length+_.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=_.length}trimStart(m){m>this._length&&(m=this._length),this._startIndex+=m,this._length-=m,this.onTrimEmitter.fire(m)}shiftElements(m,S,_){if(!(S<=0)){if(m<0||m>=this._length)throw new Error("start argument out of range");if(m+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let o=S-1;o>=0;o--)this.set(m+o+_,this.get(m+o));const n=m+S+_-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<S;n++)this.set(m+n+_,this.get(m+n))}}_getCyclicIndex(m){return(this._startIndex+m)%this._maxLength}}s.CircularList=c},1439:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function a(u,p=5){if(typeof u!="object")return u;const c=Array.isArray(u)?[]:{};for(const h in u)c[h]=p<=1?u[h]:u[h]&&a(u[h],p-1);return c}},8055:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;let a=0,u=0,p=0,c=0;var h,m,S,_,n;function o(l){const g=l.toString(16);return g.length<2?"0"+g:g}function i(l,g){return l<g?(g+.05)/(l+.05):(l+.05)/(g+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(l){l.toCss=function(g,x,y,w){return w!==void 0?`#${o(g)}${o(x)}${o(y)}${o(w)}`:`#${o(g)}${o(x)}${o(y)}`},l.toRgba=function(g,x,y,w=255){return(g<<24|x<<16|y<<8|w)>>>0},l.toColor=function(g,x,y,w){return{css:l.toCss(g,x,y,w),rgba:l.toRgba(g,x,y,w)}}}(h||(s.channels=h={})),function(l){function g(x,y){return c=Math.round(255*y),[a,u,p]=n.toChannels(x.rgba),{css:h.toCss(a,u,p,c),rgba:h.toRgba(a,u,p,c)}}l.blend=function(x,y){if(c=(255&y.rgba)/255,c===1)return{css:y.css,rgba:y.rgba};const w=y.rgba>>24&255,v=y.rgba>>16&255,C=y.rgba>>8&255,T=x.rgba>>24&255,A=x.rgba>>16&255,B=x.rgba>>8&255;return a=T+Math.round((w-T)*c),u=A+Math.round((v-A)*c),p=B+Math.round((C-B)*c),{css:h.toCss(a,u,p),rgba:h.toRgba(a,u,p)}},l.isOpaque=function(x){return(255&x.rgba)==255},l.ensureContrastRatio=function(x,y,w){const v=n.ensureContrastRatio(x.rgba,y.rgba,w);if(v)return h.toColor(v>>24&255,v>>16&255,v>>8&255)},l.opaque=function(x){const y=(255|x.rgba)>>>0;return[a,u,p]=n.toChannels(y),{css:h.toCss(a,u,p),rgba:y}},l.opacity=g,l.multiplyOpacity=function(x,y){return c=255&x.rgba,g(x,c*y/255)},l.toColorRGB=function(x){return[x.rgba>>24&255,x.rgba>>16&255,x.rgba>>8&255]}}(m||(s.color=m={})),function(l){let g,x;try{const y=document.createElement("canvas");y.width=1,y.height=1;const w=y.getContext("2d",{willReadFrequently:!0});w&&(g=w,g.globalCompositeOperation="copy",x=g.createLinearGradient(0,0,1,1))}catch{}l.toColor=function(y){if(y.match(/#[\da-f]{3,8}/i))switch(y.length){case 4:return a=parseInt(y.slice(1,2).repeat(2),16),u=parseInt(y.slice(2,3).repeat(2),16),p=parseInt(y.slice(3,4).repeat(2),16),h.toColor(a,u,p);case 5:return a=parseInt(y.slice(1,2).repeat(2),16),u=parseInt(y.slice(2,3).repeat(2),16),p=parseInt(y.slice(3,4).repeat(2),16),c=parseInt(y.slice(4,5).repeat(2),16),h.toColor(a,u,p,c);case 7:return{css:y,rgba:(parseInt(y.slice(1),16)<<8|255)>>>0};case 9:return{css:y,rgba:parseInt(y.slice(1),16)>>>0}}const w=y.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return a=parseInt(w[1]),u=parseInt(w[2]),p=parseInt(w[3]),c=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),h.toColor(a,u,p,c);if(!g||!x)throw new Error("css.toColor: Unsupported css format");if(g.fillStyle=x,g.fillStyle=y,typeof g.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(g.fillRect(0,0,1,1),[a,u,p,c]=g.getImageData(0,0,1,1).data,c!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:h.toRgba(a,u,p,c),css:y}}}(S||(s.css=S={})),function(l){function g(x,y,w){const v=x/255,C=y/255,T=w/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.0722*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))}l.relativeLuminance=function(x){return g(x>>16&255,x>>8&255,255&x)},l.relativeLuminance2=g}(_||(s.rgb=_={})),function(l){function g(y,w,v){const C=y>>24&255,T=y>>16&255,A=y>>8&255;let B=w>>24&255,D=w>>16&255,j=w>>8&255,z=i(_.relativeLuminance2(B,D,j),_.relativeLuminance2(C,T,A));for(;z<v&&(B>0||D>0||j>0);)B-=Math.max(0,Math.ceil(.1*B)),D-=Math.max(0,Math.ceil(.1*D)),j-=Math.max(0,Math.ceil(.1*j)),z=i(_.relativeLuminance2(B,D,j),_.relativeLuminance2(C,T,A));return(B<<24|D<<16|j<<8|255)>>>0}function x(y,w,v){const C=y>>24&255,T=y>>16&255,A=y>>8&255;let B=w>>24&255,D=w>>16&255,j=w>>8&255,z=i(_.relativeLuminance2(B,D,j),_.relativeLuminance2(C,T,A));for(;z<v&&(B<255||D<255||j<255);)B=Math.min(255,B+Math.ceil(.1*(255-B))),D=Math.min(255,D+Math.ceil(.1*(255-D))),j=Math.min(255,j+Math.ceil(.1*(255-j))),z=i(_.relativeLuminance2(B,D,j),_.relativeLuminance2(C,T,A));return(B<<24|D<<16|j<<8|255)>>>0}l.blend=function(y,w){if(c=(255&w)/255,c===1)return w;const v=w>>24&255,C=w>>16&255,T=w>>8&255,A=y>>24&255,B=y>>16&255,D=y>>8&255;return a=A+Math.round((v-A)*c),u=B+Math.round((C-B)*c),p=D+Math.round((T-D)*c),h.toRgba(a,u,p)},l.ensureContrastRatio=function(y,w,v){const C=_.relativeLuminance(y>>8),T=_.relativeLuminance(w>>8);if(i(C,T)<v){if(T<C){const D=g(y,w,v),j=i(C,_.relativeLuminance(D>>8));if(j<v){const z=x(y,w,v);return j>i(C,_.relativeLuminance(z>>8))?D:z}return D}const A=x(y,w,v),B=i(C,_.relativeLuminance(A>>8));if(B<v){const D=g(y,w,v);return B>i(C,_.relativeLuminance(D>>8))?A:D}return A}},l.reduceLuminance=g,l.increaseLuminance=x,l.toChannels=function(y){return[y>>24&255,y>>16&255,y>>8&255,255&y]}}(n||(s.rgba=n={})),s.toPaddedHex=o,s.contrastRatio=i},8969:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const u=a(844),p=a(2585),c=a(4348),h=a(7866),m=a(744),S=a(7302),_=a(6975),n=a(8460),o=a(1753),i=a(1480),l=a(7994),g=a(9282),x=a(5435),y=a(5981),w=a(2660);let v=!1;class C extends u.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new n.EventEmitter),this._onScroll.event(A=>{this._onScrollApi?.fire(A.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(A){for(const B in A)this.optionsService.options[B]=A[B]}constructor(A){super(),this._windowsWrappingHeuristics=this.register(new u.MutableDisposable),this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new n.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new n.EventEmitter),this._instantiationService=new c.InstantiationService,this.optionsService=this.register(new S.OptionsService(A)),this._instantiationService.setService(p.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(m.BufferService)),this._instantiationService.setService(p.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(p.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(p.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(o.CoreMouseService)),this._instantiationService.setService(p.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(i.UnicodeService)),this._instantiationService.setService(p.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(l.CharsetService),this._instantiationService.setService(p.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(w.OscLinkService),this._instantiationService.setService(p.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new x.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,n.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,n.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,n.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,n.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(B=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(B=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new y.WriteBuffer((B,D)=>this._inputHandler.parse(B,D))),this.register((0,n.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(A,B){this._writeBuffer.write(A,B)}writeSync(A,B){this._logService.logLevel<=p.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(A,B)}input(A,B=!0){this.coreService.triggerDataEvent(A,B)}resize(A,B){isNaN(A)||isNaN(B)||(A=Math.max(A,m.MINIMUM_COLS),B=Math.max(B,m.MINIMUM_ROWS),this._bufferService.resize(A,B))}scroll(A,B=!1){this._bufferService.scroll(A,B)}scrollLines(A,B,D){this._bufferService.scrollLines(A,B,D)}scrollPages(A){this.scrollLines(A*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(A){const B=A-this._bufferService.buffer.ydisp;B!==0&&this.scrollLines(B)}registerEscHandler(A,B){return this._inputHandler.registerEscHandler(A,B)}registerDcsHandler(A,B){return this._inputHandler.registerDcsHandler(A,B)}registerCsiHandler(A,B){return this._inputHandler.registerCsiHandler(A,B)}registerOscHandler(A,B){return this._inputHandler.registerOscHandler(A,B)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let A=!1;const B=this.optionsService.rawOptions.windowsPty;B&&B.buildNumber!==void 0&&B.buildNumber!==void 0?A=B.backend==="conpty"&&B.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(A=!0),A?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const A=[];A.push(this.onLineFeed(g.updateWindowsModeWrappedState.bind(null,this._bufferService))),A.push(this.registerCsiHandler({final:"H"},()=>((0,g.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,u.toDisposable)(()=>{for(const B of A)B.dispose()})}}}s.CoreTerminal=C},8460:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.runAndSubscribe=s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let u=0;u<this._listeners.length;u++)if(this._listeners[u]===a)return void this._listeners.splice(u,1)}}})),this._event}fire(a,u){const p=[];for(let c=0;c<this._listeners.length;c++)p.push(this._listeners[c]);for(let c=0;c<p.length;c++)p[c].call(void 0,a,u)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},s.forwardEvent=function(a,u){return a(p=>u.fire(p))},s.runAndSubscribe=function(a,u){return u(void 0),a(p=>u(p))}},5435:function(E,s,a){var u=this&&this.__decorate||function(q,R,M,I){var O,H=arguments.length,$=H<3?R:I===null?I=Object.getOwnPropertyDescriptor(R,M):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")$=Reflect.decorate(q,R,M,I);else for(var K=q.length-1;K>=0;K--)(O=q[K])&&($=(H<3?O($):H>3?O(R,M,$):O(R,M))||$);return H>3&&$&&Object.defineProperty(R,M,$),$},p=this&&this.__param||function(q,R){return function(M,I){R(M,I,q)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const c=a(2584),h=a(7116),m=a(2015),S=a(844),_=a(482),n=a(8437),o=a(8460),i=a(643),l=a(511),g=a(3734),x=a(2585),y=a(1480),w=a(6242),v=a(6351),C=a(5941),T={"(":0,")":1,"*":2,"+":3,"-":1,".":2},A=131072;function B(q,R){if(q>24)return R.setWinLines||!1;switch(q){case 1:return!!R.restoreWin;case 2:return!!R.minimizeWin;case 3:return!!R.setWinPosition;case 4:return!!R.setWinSizePixels;case 5:return!!R.raiseWin;case 6:return!!R.lowerWin;case 7:return!!R.refreshWin;case 8:return!!R.setWinSizeChars;case 9:return!!R.maximizeWin;case 10:return!!R.fullscreenWin;case 11:return!!R.getWinState;case 13:return!!R.getWinPosition;case 14:return!!R.getWinSizePixels;case 15:return!!R.getScreenSizePixels;case 16:return!!R.getCellSizePixels;case 18:return!!R.getWinSizeChars;case 19:return!!R.getScreenSizeChars;case 20:return!!R.getIconTitle;case 21:return!!R.getWinTitle;case 22:return!!R.pushTitle;case 23:return!!R.popTitle;case 24:return!!R.setWinLines}return!1}var D;(function(q){q[q.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",q[q.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(D||(s.WindowsOptionsReportType=D={}));let j=0;class z extends S.Disposable{getAttrData(){return this._curAttrData}constructor(R,M,I,O,H,$,K,V,N=new m.EscapeSequenceParser){super(),this._bufferService=R,this._charsetService=M,this._coreService=I,this._logService=O,this._optionsService=H,this._oscLinkService=$,this._coreMouseService=K,this._unicodeService=V,this._parser=N,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new l.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new o.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new o.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new o.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new o.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new o.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new o.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new o.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new o.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new o.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new o.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new o.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new U(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._parser.setCsiHandlerFallback((L,F)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(L),params:F.toArray()})}),this._parser.setEscHandlerFallback(L=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(L)})}),this._parser.setExecuteHandlerFallback(L=>{this._logService.debug("Unknown EXECUTE code: ",{code:L})}),this._parser.setOscHandlerFallback((L,F,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:L,action:F,data:W})}),this._parser.setDcsHandlerFallback((L,F,W)=>{F==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(L),action:F,payload:W})}),this._parser.setPrintHandler((L,F,W)=>this.print(L,F,W)),this._parser.registerCsiHandler({final:"@"},L=>this.insertChars(L)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},L=>this.scrollLeft(L)),this._parser.registerCsiHandler({final:"A"},L=>this.cursorUp(L)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},L=>this.scrollRight(L)),this._parser.registerCsiHandler({final:"B"},L=>this.cursorDown(L)),this._parser.registerCsiHandler({final:"C"},L=>this.cursorForward(L)),this._parser.registerCsiHandler({final:"D"},L=>this.cursorBackward(L)),this._parser.registerCsiHandler({final:"E"},L=>this.cursorNextLine(L)),this._parser.registerCsiHandler({final:"F"},L=>this.cursorPrecedingLine(L)),this._parser.registerCsiHandler({final:"G"},L=>this.cursorCharAbsolute(L)),this._parser.registerCsiHandler({final:"H"},L=>this.cursorPosition(L)),this._parser.registerCsiHandler({final:"I"},L=>this.cursorForwardTab(L)),this._parser.registerCsiHandler({final:"J"},L=>this.eraseInDisplay(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},L=>this.eraseInDisplay(L,!0)),this._parser.registerCsiHandler({final:"K"},L=>this.eraseInLine(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},L=>this.eraseInLine(L,!0)),this._parser.registerCsiHandler({final:"L"},L=>this.insertLines(L)),this._parser.registerCsiHandler({final:"M"},L=>this.deleteLines(L)),this._parser.registerCsiHandler({final:"P"},L=>this.deleteChars(L)),this._parser.registerCsiHandler({final:"S"},L=>this.scrollUp(L)),this._parser.registerCsiHandler({final:"T"},L=>this.scrollDown(L)),this._parser.registerCsiHandler({final:"X"},L=>this.eraseChars(L)),this._parser.registerCsiHandler({final:"Z"},L=>this.cursorBackwardTab(L)),this._parser.registerCsiHandler({final:"`"},L=>this.charPosAbsolute(L)),this._parser.registerCsiHandler({final:"a"},L=>this.hPositionRelative(L)),this._parser.registerCsiHandler({final:"b"},L=>this.repeatPrecedingCharacter(L)),this._parser.registerCsiHandler({final:"c"},L=>this.sendDeviceAttributesPrimary(L)),this._parser.registerCsiHandler({prefix:">",final:"c"},L=>this.sendDeviceAttributesSecondary(L)),this._parser.registerCsiHandler({final:"d"},L=>this.linePosAbsolute(L)),this._parser.registerCsiHandler({final:"e"},L=>this.vPositionRelative(L)),this._parser.registerCsiHandler({final:"f"},L=>this.hVPosition(L)),this._parser.registerCsiHandler({final:"g"},L=>this.tabClear(L)),this._parser.registerCsiHandler({final:"h"},L=>this.setMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"h"},L=>this.setModePrivate(L)),this._parser.registerCsiHandler({final:"l"},L=>this.resetMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"l"},L=>this.resetModePrivate(L)),this._parser.registerCsiHandler({final:"m"},L=>this.charAttributes(L)),this._parser.registerCsiHandler({final:"n"},L=>this.deviceStatus(L)),this._parser.registerCsiHandler({prefix:"?",final:"n"},L=>this.deviceStatusPrivate(L)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},L=>this.softReset(L)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},L=>this.setCursorStyle(L)),this._parser.registerCsiHandler({final:"r"},L=>this.setScrollRegion(L)),this._parser.registerCsiHandler({final:"s"},L=>this.saveCursor(L)),this._parser.registerCsiHandler({final:"t"},L=>this.windowOptions(L)),this._parser.registerCsiHandler({final:"u"},L=>this.restoreCursor(L)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},L=>this.insertColumns(L)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},L=>this.deleteColumns(L)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},L=>this.selectProtected(L)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},L=>this.requestMode(L,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},L=>this.requestMode(L,!1)),this._parser.setExecuteHandler(c.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(c.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(c.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(c.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(c.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(c.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(c.C1.IND,()=>this.index()),this._parser.setExecuteHandler(c.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(c.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new w.OscHandler(L=>(this.setTitle(L),this.setIconName(L),!0))),this._parser.registerOscHandler(1,new w.OscHandler(L=>this.setIconName(L))),this._parser.registerOscHandler(2,new w.OscHandler(L=>this.setTitle(L))),this._parser.registerOscHandler(4,new w.OscHandler(L=>this.setOrReportIndexedColor(L))),this._parser.registerOscHandler(8,new w.OscHandler(L=>this.setHyperlink(L))),this._parser.registerOscHandler(10,new w.OscHandler(L=>this.setOrReportFgColor(L))),this._parser.registerOscHandler(11,new w.OscHandler(L=>this.setOrReportBgColor(L))),this._parser.registerOscHandler(12,new w.OscHandler(L=>this.setOrReportCursorColor(L))),this._parser.registerOscHandler(104,new w.OscHandler(L=>this.restoreIndexedColor(L))),this._parser.registerOscHandler(110,new w.OscHandler(L=>this.restoreFgColor(L))),this._parser.registerOscHandler(111,new w.OscHandler(L=>this.restoreBgColor(L))),this._parser.registerOscHandler(112,new w.OscHandler(L=>this.restoreCursorColor(L))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const L in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:L},()=>this.selectCharset("("+L)),this._parser.registerEscHandler({intermediates:")",final:L},()=>this.selectCharset(")"+L)),this._parser.registerEscHandler({intermediates:"*",final:L},()=>this.selectCharset("*"+L)),this._parser.registerEscHandler({intermediates:"+",final:L},()=>this.selectCharset("+"+L)),this._parser.registerEscHandler({intermediates:"-",final:L},()=>this.selectCharset("-"+L)),this._parser.registerEscHandler({intermediates:".",final:L},()=>this.selectCharset("."+L)),this._parser.registerEscHandler({intermediates:"/",final:L},()=>this.selectCharset("/"+L));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(L=>(this._logService.error("Parsing error: ",L),L)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new v.DcsHandler((L,F)=>this.requestStatusString(L,F)))}_preserveStack(R,M,I,O){this._parseStack.paused=!0,this._parseStack.cursorStartX=R,this._parseStack.cursorStartY=M,this._parseStack.decodedLength=I,this._parseStack.position=O}_logSlowResolvingAsync(R){this._logService.logLevel<=x.LogLevelEnum.WARN&&Promise.race([R,new Promise((M,I)=>setTimeout(()=>I("#SLOW_TIMEOUT"),5e3))]).catch(M=>{if(M!=="#SLOW_TIMEOUT")throw M;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(R,M){let I,O=this._activeBuffer.x,H=this._activeBuffer.y,$=0;const K=this._parseStack.paused;if(K){if(I=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,M))return this._logSlowResolvingAsync(I),I;O=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=!1,R.length>A&&($=this._parseStack.position+A)}if(this._logService.logLevel<=x.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof R=="string"?` "${R}"`:` "${Array.prototype.map.call(R,L=>String.fromCharCode(L)).join("")}"`),typeof R=="string"?R.split("").map(L=>L.charCodeAt(0)):R),this._parseBuffer.length<R.length&&this._parseBuffer.length<A&&(this._parseBuffer=new Uint32Array(Math.min(R.length,A))),K||this._dirtyRowTracker.clearRange(),R.length>A)for(let L=$;L<R.length;L+=A){const F=L+A<R.length?L+A:R.length,W=typeof R=="string"?this._stringDecoder.decode(R.substring(L,F),this._parseBuffer):this._utf8Decoder.decode(R.subarray(L,F),this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,W))return this._preserveStack(O,H,W,L),this._logSlowResolvingAsync(I),I}else if(!K){const L=typeof R=="string"?this._stringDecoder.decode(R,this._parseBuffer):this._utf8Decoder.decode(R,this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,L))return this._preserveStack(O,H,L,0),this._logSlowResolvingAsync(I),I}this._activeBuffer.x===O&&this._activeBuffer.y===H||this._onCursorMove.fire();const V=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),N=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);N<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(N,this._bufferService.rows-1),Math.min(V,this._bufferService.rows-1))}print(R,M,I){let O,H;const $=this._charsetService.charset,K=this._optionsService.rawOptions.screenReaderMode,V=this._bufferService.cols,N=this._coreService.decPrivateModes.wraparound,L=this._coreService.modes.insertMode,F=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&I-M>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodepoint(this._activeBuffer.x-1,0,1,F);let Y=this._parser.precedingJoinState;for(let G=M;G<I;++G){if(O=R[G],O<127&&$){const he=$[String.fromCharCode(O)];he&&(O=he.charCodeAt(0))}const J=this._unicodeService.charProperties(O,Y);H=y.UnicodeService.extractWidth(J);const re=y.UnicodeService.extractShouldJoin(J),ne=re?y.UnicodeService.extractWidth(Y):0;if(Y=J,K&&this._onA11yChar.fire((0,_.stringFromCodePoint)(O)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+H-ne>V){if(N){const he=W;let Z=this._activeBuffer.x-ne;for(this._activeBuffer.x=ne,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ne>0&&W instanceof n.BufferLine&&W.copyCellsFrom(he,Z,0,ne,!1);Z<V;)he.setCellFromCodepoint(Z++,0,1,F)}else if(this._activeBuffer.x=V-1,H===2)continue}if(re&&this._activeBuffer.x){const he=W.getWidth(this._activeBuffer.x-1)?1:2;W.addCodepointToCell(this._activeBuffer.x-he,O,H);for(let Z=H-ne;--Z>=0;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,F)}else if(L&&(W.insertCells(this._activeBuffer.x,H-ne,this._activeBuffer.getNullCell(F)),W.getWidth(V-1)===2&&W.setCellFromCodepoint(V-1,i.NULL_CELL_CODE,i.NULL_CELL_WIDTH,F)),W.setCellFromCodepoint(this._activeBuffer.x++,O,H,F),H>0)for(;--H;)W.setCellFromCodepoint(this._activeBuffer.x++,0,0,F)}this._parser.precedingJoinState=Y,this._activeBuffer.x<V&&I-M>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodepoint(this._activeBuffer.x,0,1,F),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(R,M){return R.final!=="t"||R.prefix||R.intermediates?this._parser.registerCsiHandler(R,M):this._parser.registerCsiHandler(R,I=>!B(I.params[0],this._optionsService.rawOptions.windowOptions)||M(I))}registerDcsHandler(R,M){return this._parser.registerDcsHandler(R,new v.DcsHandler(M))}registerEscHandler(R,M){return this._parser.registerEscHandler(R,M)}registerOscHandler(R,M){return this._parser.registerOscHandler(R,new w.OscHandler(M))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);R.hasWidth(this._activeBuffer.x)&&!R.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const R=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-R),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(R=this._bufferService.cols-1){this._activeBuffer.x=Math.min(R,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(R,M){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=R,this._activeBuffer.y=this._activeBuffer.scrollTop+M):(this._activeBuffer.x=R,this._activeBuffer.y=M),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(R,M){this._restrictCursor(),this._setCursor(this._activeBuffer.x+R,this._activeBuffer.y+M)}cursorUp(R){const M=this._activeBuffer.y-this._activeBuffer.scrollTop;return M>=0?this._moveCursor(0,-Math.min(M,R.params[0]||1)):this._moveCursor(0,-(R.params[0]||1)),!0}cursorDown(R){const M=this._activeBuffer.scrollBottom-this._activeBuffer.y;return M>=0?this._moveCursor(0,Math.min(M,R.params[0]||1)):this._moveCursor(0,R.params[0]||1),!0}cursorForward(R){return this._moveCursor(R.params[0]||1,0),!0}cursorBackward(R){return this._moveCursor(-(R.params[0]||1),0),!0}cursorNextLine(R){return this.cursorDown(R),this._activeBuffer.x=0,!0}cursorPrecedingLine(R){return this.cursorUp(R),this._activeBuffer.x=0,!0}cursorCharAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(R){return this._setCursor(R.length>=2?(R.params[1]||1)-1:0,(R.params[0]||1)-1),!0}charPosAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(R){return this._moveCursor(R.params[0]||1,0),!0}linePosAbsolute(R){return this._setCursor(this._activeBuffer.x,(R.params[0]||1)-1),!0}vPositionRelative(R){return this._moveCursor(0,R.params[0]||1),!0}hVPosition(R){return this.cursorPosition(R),!0}tabClear(R){const M=R.params[0];return M===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:M===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let M=R.params[0]||1;for(;M--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let M=R.params[0]||1;for(;M--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(R){const M=R.params[0];return M===1&&(this._curAttrData.bg|=536870912),M!==2&&M!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(R,M,I,O=!1,H=!1){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);$.replaceCells(M,I,this._activeBuffer.getNullCell(this._eraseAttrData()),H),O&&($.isWrapped=!1)}_resetBufferLine(R,M=!1){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);I&&(I.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),M),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+R),I.isWrapped=!1)}eraseInDisplay(R,M=!1){let I;switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,M);I<this._bufferService.rows;I++)this._resetBufferLine(I,M);this._dirtyRowTracker.markDirty(I);break;case 1:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I,0,this._activeBuffer.x+1,!0,M),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(I+1).isWrapped=!1);I--;)this._resetBufferLine(I,M);this._dirtyRowTracker.markDirty(0);break;case 2:for(I=this._bufferService.rows,this._dirtyRowTracker.markDirty(I-1);I--;)this._resetBufferLine(I,M);this._dirtyRowTracker.markDirty(0);break;case 3:const O=this._activeBuffer.lines.length-this._bufferService.rows;O>0&&(this._activeBuffer.lines.trimStart(O),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-O,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-O,0),this._onScroll.fire(0))}return!0}eraseInLine(R,M=!1){switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,M);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,M);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,M)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(R){this._restrictCursor();let M=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y,O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-O+1;for(;M--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(R){this._restrictCursor();let M=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y;let O;for(O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,O=this._bufferService.rows-1+this._activeBuffer.ybase-O;M--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.insertCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.deleteCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(R){let M=R.params[0]||1;for(;M--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(R){let M=R.params[0]||1;for(;M--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(n.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);O.deleteCells(0,M,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);O.insertCells(0,M,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);O.insertCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);O.deleteCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(this._eraseAttrData())),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(R.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(R){const M=this._parser.precedingJoinState;if(!M)return!0;const I=R.params[0]||1,O=y.UnicodeService.extractWidth(M),H=this._activeBuffer.x-O,$=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(H),K=new Uint32Array($.length*I);let V=0;for(let L=0;L<$.length;){const F=$.codePointAt(L)||0;K[V++]=F,L+=F>65535?2:1}let N=V;for(let L=1;L<I;++L)K.copyWithin(N,0,V),N+=V;return this.print(K,0,N),!0}sendDeviceAttributesPrimary(R){return R.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(c.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(c.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(R){return R.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(c.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(c.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(R.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(c.C0.ESC+"[>83;40003;0c")),!0}_is(R){return(this._optionsService.rawOptions.termName+"").indexOf(R)===0}setMode(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),R.params[M]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(R,M){const I=this._coreService.decPrivateModes,{activeProtocol:O,activeEncoding:H}=this._coreMouseService,$=this._coreService,{buffers:K,cols:V}=this._bufferService,{active:N,alt:L}=K,F=this._optionsService.rawOptions,W=re=>re?1:2,Y=R.params[0];return G=Y,J=M?Y===2?4:Y===4?W($.modes.insertMode):Y===12?3:Y===20?W(F.convertEol):0:Y===1?W(I.applicationCursorKeys):Y===3?F.windowOptions.setWinLines?V===80?2:V===132?1:0:0:Y===6?W(I.origin):Y===7?W(I.wraparound):Y===8?3:Y===9?W(O==="X10"):Y===12?W(F.cursorBlink):Y===25?W(!$.isCursorHidden):Y===45?W(I.reverseWraparound):Y===66?W(I.applicationKeypad):Y===67?4:Y===1e3?W(O==="VT200"):Y===1002?W(O==="DRAG"):Y===1003?W(O==="ANY"):Y===1004?W(I.sendFocus):Y===1005?4:Y===1006?W(H==="SGR"):Y===1015?4:Y===1016?W(H==="SGR_PIXELS"):Y===1048?1:Y===47||Y===1047||Y===1049?W(N===L):Y===2004?W(I.bracketedPasteMode):0,$.triggerDataEvent(`${c.C0.ESC}[${M?"":"?"}${G};${J}$y`),!0;var G,J}_updateAttrColor(R,M,I,O,H){return M===2?(R|=50331648,R&=-16777216,R|=g.AttributeData.fromColorRGB([I,O,H])):M===5&&(R&=-50331904,R|=33554432|255&I),R}_extractColor(R,M,I){const O=[0,0,-1,0,0,0];let H=0,$=0;do{if(O[$+H]=R.params[M+$],R.hasSubParams(M+$)){const K=R.getSubParams(M+$);let V=0;do O[1]===5&&(H=1),O[$+V+1+H]=K[V];while(++V<K.length&&V+$+1+H<O.length);break}if(O[1]===5&&$+H>=2||O[1]===2&&$+H>=5)break;O[1]&&(H=1)}while(++$+M<R.length&&$+H<O.length);for(let K=2;K<O.length;++K)O[K]===-1&&(O[K]=0);switch(O[0]){case 38:I.fg=this._updateAttrColor(I.fg,O[1],O[3],O[4],O[5]);break;case 48:I.bg=this._updateAttrColor(I.bg,O[1],O[3],O[4],O[5]);break;case 58:I.extended=I.extended.clone(),I.extended.underlineColor=this._updateAttrColor(I.extended.underlineColor,O[1],O[3],O[4],O[5])}return $}_processUnderline(R,M){M.extended=M.extended.clone(),(!~R||R>5)&&(R=1),M.extended.underlineStyle=R,M.fg|=268435456,R===0&&(M.fg&=-268435457),M.updateExtended()}_processSGR0(R){R.fg=n.DEFAULT_ATTR_DATA.fg,R.bg=n.DEFAULT_ATTR_DATA.bg,R.extended=R.extended.clone(),R.extended.underlineStyle=0,R.extended.underlineColor&=-67108864,R.updateExtended()}charAttributes(R){if(R.length===1&&R.params[0]===0)return this._processSGR0(this._curAttrData),!0;const M=R.length;let I;const O=this._curAttrData;for(let H=0;H<M;H++)I=R.params[H],I>=30&&I<=37?(O.fg&=-50331904,O.fg|=16777216|I-30):I>=40&&I<=47?(O.bg&=-50331904,O.bg|=16777216|I-40):I>=90&&I<=97?(O.fg&=-50331904,O.fg|=16777224|I-90):I>=100&&I<=107?(O.bg&=-50331904,O.bg|=16777224|I-100):I===0?this._processSGR0(O):I===1?O.fg|=134217728:I===3?O.bg|=67108864:I===4?(O.fg|=268435456,this._processUnderline(R.hasSubParams(H)?R.getSubParams(H)[0]:1,O)):I===5?O.fg|=536870912:I===7?O.fg|=67108864:I===8?O.fg|=1073741824:I===9?O.fg|=2147483648:I===2?O.bg|=134217728:I===21?this._processUnderline(2,O):I===22?(O.fg&=-134217729,O.bg&=-134217729):I===23?O.bg&=-67108865:I===24?(O.fg&=-268435457,this._processUnderline(0,O)):I===25?O.fg&=-536870913:I===27?O.fg&=-67108865:I===28?O.fg&=-1073741825:I===29?O.fg&=2147483647:I===39?(O.fg&=-67108864,O.fg|=16777215&n.DEFAULT_ATTR_DATA.fg):I===49?(O.bg&=-67108864,O.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):I===38||I===48||I===58?H+=this._extractColor(R,H,O):I===53?O.bg|=1073741824:I===55?O.bg&=-1073741825:I===59?(O.extended=O.extended.clone(),O.extended.underlineColor=-1,O.updateExtended()):I===100?(O.fg&=-67108864,O.fg|=16777215&n.DEFAULT_ATTR_DATA.fg,O.bg&=-67108864,O.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",I);return!0}deviceStatus(R){switch(R.params[0]){case 5:this._coreService.triggerDataEvent(`${c.C0.ESC}[0n`);break;case 6:const M=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[${M};${I}R`)}return!0}deviceStatusPrivate(R){if(R.params[0]===6){const M=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[?${M};${I}R`)}return!0}softReset(R){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(R){const M=R.params[0]||1;switch(M){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const I=M%2==1;return this._optionsService.options.cursorBlink=I,!0}setScrollRegion(R){const M=R.params[0]||1;let I;return(R.length<2||(I=R.params[1])>this._bufferService.rows||I===0)&&(I=this._bufferService.rows),I>M&&(this._activeBuffer.scrollTop=M-1,this._activeBuffer.scrollBottom=I-1,this._setCursor(0,0)),!0}windowOptions(R){if(!B(R.params[0],this._optionsService.rawOptions.windowOptions))return!0;const M=R.length>1?R.params[1]:0;switch(R.params[0]){case 14:M!==2&&this._onRequestWindowsOptionsReport.fire(D.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(D.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${c.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:M!==0&&M!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),M!==0&&M!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:M!==0&&M!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),M!==0&&M!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(R){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(R){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(R){return this._windowTitle=R,this._onTitleChange.fire(R),!0}setIconName(R){return this._iconName=R,!0}setOrReportIndexedColor(R){const M=[],I=R.split(";");for(;I.length>1;){const O=I.shift(),H=I.shift();if(/^\d+$/.exec(O)){const $=parseInt(O);if(X($))if(H==="?")M.push({type:0,index:$});else{const K=(0,C.parseColor)(H);K&&M.push({type:1,index:$,color:K})}}}return M.length&&this._onColor.fire(M),!0}setHyperlink(R){const M=R.split(";");return!(M.length<2)&&(M[1]?this._createHyperlink(M[0],M[1]):!M[0]&&this._finishHyperlink())}_createHyperlink(R,M){this._getCurrentLinkId()&&this._finishHyperlink();const I=R.split(":");let O;const H=I.findIndex($=>$.startsWith("id="));return H!==-1&&(O=I[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:O,uri:M}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(R,M){const I=R.split(";");for(let O=0;O<I.length&&!(M>=this._specialColors.length);++O,++M)if(I[O]==="?")this._onColor.fire([{type:0,index:this._specialColors[M]}]);else{const H=(0,C.parseColor)(I[O]);H&&this._onColor.fire([{type:1,index:this._specialColors[M],color:H}])}return!0}setOrReportFgColor(R){return this._setOrReportSpecialColor(R,0)}setOrReportBgColor(R){return this._setOrReportSpecialColor(R,1)}setOrReportCursorColor(R){return this._setOrReportSpecialColor(R,2)}restoreIndexedColor(R){if(!R)return this._onColor.fire([{type:2}]),!0;const M=[],I=R.split(";");for(let O=0;O<I.length;++O)if(/^\d+$/.exec(I[O])){const H=parseInt(I[O]);X(H)&&M.push({type:2,index:H})}return M.length&&this._onColor.fire(M),!0}restoreFgColor(R){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(R){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(R){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(R){return R.length!==2?(this.selectDefaultCharset(),!0):(R[0]==="/"||this._charsetService.setgCharset(T[R[0]],h.CHARSETS[R[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const R=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,R,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(R){return this._charsetService.setgLevel(R),!0}screenAlignmentPattern(){const R=new l.CellData;R.content=4194373,R.fg=this._curAttrData.fg,R.bg=this._curAttrData.bg,this._setCursor(0,0);for(let M=0;M<this._bufferService.rows;++M){const I=this._activeBuffer.ybase+this._activeBuffer.y+M,O=this._activeBuffer.lines.get(I);O&&(O.fill(R),O.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(R,M){const I=this._bufferService.buffer,O=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${c.C0.ESC}${H}${c.C0.ESC}\\`),!0))(R==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:R==='"p'?'P1$r61;1"p':R==="r"?`P1$r${I.scrollTop+1};${I.scrollBottom+1}r`:R==="m"?"P1$r0m":R===" q"?`P1$r${{block:2,underline:4,bar:6}[O.cursorStyle]-(O.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(R,M){this._dirtyRowTracker.markRangeDirty(R,M)}}s.InputHandler=z;let U=class{constructor(q){this._bufferService=q,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(q){q<this.start?this.start=q:q>this.end&&(this.end=q)}markRangeDirty(q,R){q>R&&(j=q,q=R,R=j),q<this.start&&(this.start=q),R>this.end&&(this.end=R)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function X(q){return 0<=q&&q<256}U=u([p(0,x.IBufferService)],U)},844:(E,s)=>{function a(u){for(const p of u)p.dispose();u.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.MutableDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const u of this._disposables)u.dispose();this._disposables.length=0}register(u){return this._disposables.push(u),u}unregister(u){const p=this._disposables.indexOf(u);p!==-1&&this._disposables.splice(p,1)}},s.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(u){this._isDisposed||u===this._value||(this._value?.dispose(),this._value=u)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},s.toDisposable=function(u){return{dispose:u}},s.disposeArray=a,s.getDisposeArrayDisposable=function(u){return{dispose:()=>a(u)}}},1505:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(p,c,h){this._data[p]||(this._data[p]={}),this._data[p][c]=h}get(p,c){return this._data[p]?this._data[p][c]:void 0}clear(){this._data={}}}s.TwoKeyMap=a,s.FourKeyMap=class{constructor(){this._data=new a}set(u,p,c,h,m){this._data.get(u,p)||this._data.set(u,p,new a),this._data.get(u,p).set(c,h,m)}get(u,p,c,h){return this._data.get(u,p)?.get(c,h)}clear(){this._data.clear()}}},6114:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof process<"u"&&"title"in process;const a=s.isNode?"node":navigator.userAgent,u=s.isNode?"node":navigator.platform;s.isFirefox=a.includes("Firefox"),s.isLegacyEdge=a.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(a),s.getSafariVersion=function(){if(!s.isSafari)return 0;const p=a.match(/Version\/(\d+)/);return p===null||p.length<2?0:parseInt(p[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u),s.isIpad=u==="iPad",s.isIphone=u==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(u),s.isLinux=u.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(a)},6106:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let a=0;s.SortedList=class{constructor(u){this._getKey=u,this._array=[]}clear(){this._array.length=0}insert(u){this._array.length!==0?(a=this._search(this._getKey(u)),this._array.splice(a,0,u)):this._array.push(u)}delete(u){if(this._array.length===0)return!1;const p=this._getKey(u);if(p===void 0||(a=this._search(p),a===-1)||this._getKey(this._array[a])!==p)return!1;do if(this._array[a]===u)return this._array.splice(a,1),!0;while(++a<this._array.length&&this._getKey(this._array[a])===p);return!1}*getKeyIterator(u){if(this._array.length!==0&&(a=this._search(u),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===u))do yield this._array[a];while(++a<this._array.length&&this._getKey(this._array[a])===u)}forEachByKey(u,p){if(this._array.length!==0&&(a=this._search(u),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===u))do p(this._array[a]);while(++a<this._array.length&&this._getKey(this._array[a])===u)}values(){return[...this._array].values()}_search(u){let p=0,c=this._array.length-1;for(;c>=p;){let h=p+c>>1;const m=this._getKey(this._array[h]);if(m>u)c=h-1;else{if(!(m<u)){for(;h>0&&this._getKey(this._array[h-1])===u;)h--;return h}p=h+1}}return p}}},7226:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const u=a(6114);class p{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let S=0,_=0,n=m.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(S=Date.now(),this._tasks[this._i]()||this._i++,S=Math.max(1,Date.now()-S),_=Math.max(S,_),o=m.timeRemaining(),1.5*_>o)return n-S<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-S))}ms`),void this._start();n=o}this.clear()}}class c extends p{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){const S=Date.now()+m;return{timeRemaining:()=>Math.max(0,S-Date.now())}}}s.PriorityTaskQueue=c,s.IdleTaskQueue=!u.isNode&&"requestIdleCallback"in window?class extends p{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:c,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const u=a(643);s.updateWindowsModeWrappedState=function(p){const c=p.buffer.lines.get(p.buffer.ybase+p.buffer.y-1),h=c?.get(p.cols-1),m=p.buffer.lines.get(p.buffer.ybase+p.buffer.y);m&&h&&(m.isWrapped=h[u.CHAR_DATA_CODE_INDEX]!==u.NULL_CELL_CODE&&h[u.CHAR_DATA_CODE_INDEX]!==u.WHITESPACE_CELL_CODE)}},3734:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new u}static toColorRGB(c){return[c>>>16&255,c>>>8&255,255&c]}static fromColorRGB(c){return(255&c[0])<<16|(255&c[1])<<8|255&c[2]}clone(){const c=new a;return c.fg=this.fg,c.bg=this.bg,c.extended=this.extended.clone(),c}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}s.AttributeData=a;class u{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(c){this._ext=c}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(c){this._ext&=-469762049,this._ext|=c<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(c){this._ext&=-67108864,this._ext|=67108863&c}get urlId(){return this._urlId}set urlId(c){this._urlId=c}get underlineVariantOffset(){const c=(3758096384&this._ext)>>29;return c<0?4294967288^c:c}set underlineVariantOffset(c){this._ext&=536870911,this._ext|=c<<29&3758096384}constructor(c=0,h=0){this._ext=0,this._urlId=0,this._ext=c,this._urlId=h}clone(){return new u(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=u},9092:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const u=a(6349),p=a(7226),c=a(3734),h=a(8437),m=a(4634),S=a(511),_=a(643),n=a(4863),o=a(7116);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(i,l,g){this._hasScrollback=i,this._optionsService=l,this._bufferService=g,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=S.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=S.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(i){return i?(this._nullCell.fg=i.fg,this._nullCell.bg=i.bg,this._nullCell.extended=i.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(i){return i?(this._whitespaceCell.fg=i.fg,this._whitespaceCell.bg=i.bg,this._whitespaceCell.extended=i.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(i,l){return new h.BufferLine(this._bufferService.cols,this.getNullCell(i),l)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const i=this.ybase+this.y-this.ydisp;return i>=0&&i<this._rows}_getCorrectBufferLength(i){if(!this._hasScrollback)return i;const l=i+this._optionsService.rawOptions.scrollback;return l>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:l}fillViewportRows(i){if(this.lines.length===0){i===void 0&&(i=h.DEFAULT_ATTR_DATA);let l=this._rows;for(;l--;)this.lines.push(this.getBlankLine(i))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(i,l){const g=this.getNullCell(h.DEFAULT_ATTR_DATA);let x=0;const y=this._getCorrectBufferLength(l);if(y>this.lines.maxLength&&(this.lines.maxLength=y),this.lines.length>0){if(this._cols<i)for(let v=0;v<this.lines.length;v++)x+=+this.lines.get(v).resize(i,g);let w=0;if(this._rows<l)for(let v=this._rows;v<l;v++)this.lines.length<l+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(i,g)):this.ybase>0&&this.lines.length<=this.ybase+this.y+w+1?(this.ybase--,w++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(i,g)));else for(let v=this._rows;v>l;v--)this.lines.length>l+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(y<this.lines.maxLength){const v=this.lines.length-y;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=y}this.x=Math.min(this.x,i-1),this.y=Math.min(this.y,l-1),w&&(this.y+=w),this.savedX=Math.min(this.savedX,i-1),this.scrollTop=0}if(this.scrollBottom=l-1,this._isReflowEnabled&&(this._reflow(i,l),this._cols>i))for(let w=0;w<this.lines.length;w++)x+=+this.lines.get(w).resize(i,g);this._cols=i,this._rows=l,this._memoryCleanupQueue.clear(),x>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let i=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,i=!1);let l=0;for(;this._memoryCleanupPosition<this.lines.length;)if(l+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),l>100)return!0;return i}get _isReflowEnabled(){const i=this._optionsService.rawOptions.windowsPty;return i&&i.buildNumber?this._hasScrollback&&i.backend==="conpty"&&i.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(i,l){this._cols!==i&&(i>this._cols?this._reflowLarger(i,l):this._reflowSmaller(i,l))}_reflowLarger(i,l){const g=(0,m.reflowLargerGetLinesToRemove)(this.lines,this._cols,i,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(g.length>0){const x=(0,m.reflowLargerCreateNewLayout)(this.lines,g);(0,m.reflowLargerApplyNewLayout)(this.lines,x.layout),this._reflowLargerAdjustViewport(i,l,x.countRemoved)}}_reflowLargerAdjustViewport(i,l,g){const x=this.getNullCell(h.DEFAULT_ATTR_DATA);let y=g;for(;y-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<l&&this.lines.push(new h.BufferLine(i,x))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-g,0)}_reflowSmaller(i,l){const g=this.getNullCell(h.DEFAULT_ATTR_DATA),x=[];let y=0;for(let w=this.lines.length-1;w>=0;w--){let v=this.lines.get(w);if(!v||!v.isWrapped&&v.getTrimmedLength()<=i)continue;const C=[v];for(;v.isWrapped&&w>0;)v=this.lines.get(--w),C.unshift(v);const T=this.ybase+this.y;if(T>=w&&T<w+C.length)continue;const A=C[C.length-1].getTrimmedLength(),B=(0,m.reflowSmallerGetNewLineLengths)(C,this._cols,i),D=B.length-C.length;let j;j=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const z=[];for(let I=0;I<D;I++){const O=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);z.push(O)}z.length>0&&(x.push({start:w+C.length+y,newLines:z}),y+=z.length),C.push(...z);let U=B.length-1,X=B[U];X===0&&(U--,X=B[U]);let q=C.length-D-1,R=A;for(;q>=0;){const I=Math.min(R,X);if(C[U]===void 0)break;if(C[U].copyCellsFrom(C[q],R-I,X-I,I,!0),X-=I,X===0&&(U--,X=B[U]),R-=I,R===0){q--;const O=Math.max(q,0);R=(0,m.getWrappedLineTrimmedLength)(C,O,this._cols)}}for(let I=0;I<C.length;I++)B[I]<i&&C[I].setCell(B[I],g);let M=D-j;for(;M-- >0;)this.ybase===0?this.y<l-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+y)-l&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+l-1)}if(x.length>0){const w=[],v=[];for(let U=0;U<this.lines.length;U++)v.push(this.lines.get(U));const C=this.lines.length;let T=C-1,A=0,B=x[A];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+y);let D=0;for(let U=Math.min(this.lines.maxLength-1,C+y-1);U>=0;U--)if(B&&B.start>T+D){for(let X=B.newLines.length-1;X>=0;X--)this.lines.set(U--,B.newLines[X]);U++,w.push({index:T+1,amount:B.newLines.length}),D+=B.newLines.length,B=x[++A]}else this.lines.set(U,v[T--]);let j=0;for(let U=w.length-1;U>=0;U--)w[U].index+=j,this.lines.onInsertEmitter.fire(w[U]),j+=w[U].amount;const z=Math.max(0,C+y-this.lines.maxLength);z>0&&this.lines.onTrimEmitter.fire(z)}}translateBufferLineToString(i,l,g=0,x){const y=this.lines.get(i);return y?y.translateToString(l,g,x):""}getWrappedRangeForLine(i){let l=i,g=i;for(;l>0&&this.lines.get(l).isWrapped;)l--;for(;g+1<this.lines.length&&this.lines.get(g+1).isWrapped;)g++;return{first:l,last:g}}setupTabStops(i){for(i!=null?this.tabs[i]||(i=this.prevStop(i)):(this.tabs={},i=0);i<this._cols;i+=this._optionsService.rawOptions.tabStopWidth)this.tabs[i]=!0}prevStop(i){for(i==null&&(i=this.x);!this.tabs[--i]&&i>0;);return i>=this._cols?this._cols-1:i<0?0:i}nextStop(i){for(i==null&&(i=this.x);!this.tabs[++i]&&i<this._cols;);return i>=this._cols?this._cols-1:i<0?0:i}clearMarkers(i){this._isClearing=!0;for(let l=0;l<this.markers.length;l++)this.markers[l].line===i&&(this.markers[l].dispose(),this.markers.splice(l--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].dispose(),this.markers.splice(i--,1);this._isClearing=!1}addMarker(i){const l=new n.Marker(i);return this.markers.push(l),l.register(this.lines.onTrim(g=>{l.line-=g,l.line<0&&l.dispose()})),l.register(this.lines.onInsert(g=>{l.line>=g.index&&(l.line+=g.amount)})),l.register(this.lines.onDelete(g=>{l.line>=g.index&&l.line<g.index+g.amount&&l.dispose(),l.line>g.index&&(l.line-=g.amount)})),l.register(l.onDispose(()=>this._removeMarker(l))),l}_removeMarker(i){this._isClearing||this.markers.splice(this.markers.indexOf(i),1)}}},8437:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const u=a(3734),p=a(511),c=a(643),h=a(482);s.DEFAULT_ATTR_DATA=Object.freeze(new u.AttributeData);let m=0;class S{constructor(n,o,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*n);const l=o||p.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]);for(let g=0;g<n;++g)this.setCell(g,l);this.length=n}get(n){const o=this._data[3*n+0],i=2097151&o;return[this._data[3*n+1],2097152&o?this._combined[n]:i?(0,h.stringFromCodePoint)(i):"",o>>22,2097152&o?this._combined[n].charCodeAt(this._combined[n].length-1):i]}set(n,o){this._data[3*n+1]=o[c.CHAR_DATA_ATTR_INDEX],o[c.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[n]=o[1],this._data[3*n+0]=2097152|n|o[c.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*n+0]=o[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|o[c.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(n){return this._data[3*n+0]>>22}hasWidth(n){return 12582912&this._data[3*n+0]}getFg(n){return this._data[3*n+1]}getBg(n){return this._data[3*n+2]}hasContent(n){return 4194303&this._data[3*n+0]}getCodePoint(n){const o=this._data[3*n+0];return 2097152&o?this._combined[n].charCodeAt(this._combined[n].length-1):2097151&o}isCombined(n){return 2097152&this._data[3*n+0]}getString(n){const o=this._data[3*n+0];return 2097152&o?this._combined[n]:2097151&o?(0,h.stringFromCodePoint)(2097151&o):""}isProtected(n){return 536870912&this._data[3*n+2]}loadCell(n,o){return m=3*n,o.content=this._data[m+0],o.fg=this._data[m+1],o.bg=this._data[m+2],2097152&o.content&&(o.combinedData=this._combined[n]),268435456&o.bg&&(o.extended=this._extendedAttrs[n]),o}setCell(n,o){2097152&o.content&&(this._combined[n]=o.combinedData),268435456&o.bg&&(this._extendedAttrs[n]=o.extended),this._data[3*n+0]=o.content,this._data[3*n+1]=o.fg,this._data[3*n+2]=o.bg}setCellFromCodepoint(n,o,i,l){268435456&l.bg&&(this._extendedAttrs[n]=l.extended),this._data[3*n+0]=o|i<<22,this._data[3*n+1]=l.fg,this._data[3*n+2]=l.bg}addCodepointToCell(n,o,i){let l=this._data[3*n+0];2097152&l?this._combined[n]+=(0,h.stringFromCodePoint)(o):2097151&l?(this._combined[n]=(0,h.stringFromCodePoint)(2097151&l)+(0,h.stringFromCodePoint)(o),l&=-2097152,l|=2097152):l=o|4194304,i&&(l&=-12582913,l|=i<<22),this._data[3*n+0]=l}insertCells(n,o,i){if((n%=this.length)&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),o<this.length-n){const l=new p.CellData;for(let g=this.length-n-o-1;g>=0;--g)this.setCell(n+o+g,this.loadCell(n+g,l));for(let g=0;g<o;++g)this.setCell(n+g,i)}else for(let l=n;l<this.length;++l)this.setCell(l,i);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,i)}deleteCells(n,o,i){if(n%=this.length,o<this.length-n){const l=new p.CellData;for(let g=0;g<this.length-n-o;++g)this.setCell(n+g,this.loadCell(n+o+g,l));for(let g=this.length-o;g<this.length;++g)this.setCell(g,i)}else for(let l=n;l<this.length;++l)this.setCell(l,i);n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),this.getWidth(n)!==0||this.hasContent(n)||this.setCellFromCodepoint(n,0,1,i)}replaceCells(n,o,i,l=!1){if(l)for(n&&this.getWidth(n-1)===2&&!this.isProtected(n-1)&&this.setCellFromCodepoint(n-1,0,1,i),o<this.length&&this.getWidth(o-1)===2&&!this.isProtected(o)&&this.setCellFromCodepoint(o,0,1,i);n<o&&n<this.length;)this.isProtected(n)||this.setCell(n,i),n++;else for(n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),o<this.length&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o,0,1,i);n<o&&n<this.length;)this.setCell(n++,i)}resize(n,o){if(n===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const i=3*n;if(n>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{const l=new Uint32Array(i);l.set(this._data),this._data=l}for(let l=this.length;l<n;++l)this.setCell(l,o)}else{this._data=this._data.subarray(0,i);const l=Object.keys(this._combined);for(let x=0;x<l.length;x++){const y=parseInt(l[x],10);y>=n&&delete this._combined[y]}const g=Object.keys(this._extendedAttrs);for(let x=0;x<g.length;x++){const y=parseInt(g[x],10);y>=n&&delete this._extendedAttrs[y]}}return this.length=n,4*i*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const n=new Uint32Array(this._data.length);return n.set(this._data),this._data=n,1}return 0}fill(n,o=!1){if(o)for(let i=0;i<this.length;++i)this.isProtected(i)||this.setCell(i,n);else{this._combined={},this._extendedAttrs={};for(let i=0;i<this.length;++i)this.setCell(i,n)}}copyFrom(n){this.length!==n.length?this._data=new Uint32Array(n._data):this._data.set(n._data),this.length=n.length,this._combined={};for(const o in n._combined)this._combined[o]=n._combined[o];this._extendedAttrs={};for(const o in n._extendedAttrs)this._extendedAttrs[o]=n._extendedAttrs[o];this.isWrapped=n.isWrapped}clone(){const n=new S(0);n._data=new Uint32Array(this._data),n.length=this.length;for(const o in this._combined)n._combined[o]=this._combined[o];for(const o in this._extendedAttrs)n._extendedAttrs[o]=this._extendedAttrs[o];return n.isWrapped=this.isWrapped,n}getTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0])return n+(this._data[3*n+0]>>22);return 0}getNoBgTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0]||50331648&this._data[3*n+2])return n+(this._data[3*n+0]>>22);return 0}copyCellsFrom(n,o,i,l,g){const x=n._data;if(g)for(let w=l-1;w>=0;w--){for(let v=0;v<3;v++)this._data[3*(i+w)+v]=x[3*(o+w)+v];268435456&x[3*(o+w)+2]&&(this._extendedAttrs[i+w]=n._extendedAttrs[o+w])}else for(let w=0;w<l;w++){for(let v=0;v<3;v++)this._data[3*(i+w)+v]=x[3*(o+w)+v];268435456&x[3*(o+w)+2]&&(this._extendedAttrs[i+w]=n._extendedAttrs[o+w])}const y=Object.keys(n._combined);for(let w=0;w<y.length;w++){const v=parseInt(y[w],10);v>=o&&(this._combined[v-o+i]=n._combined[v])}}translateToString(n,o,i,l){o=o??0,i=i??this.length,n&&(i=Math.min(i,this.getTrimmedLength())),l&&(l.length=0);let g="";for(;o<i;){const x=this._data[3*o+0],y=2097151&x,w=2097152&x?this._combined[o]:y?(0,h.stringFromCodePoint)(y):c.WHITESPACE_CELL_CHAR;if(g+=w,l)for(let v=0;v<w.length;++v)l.push(o);o+=x>>22||1}return l&&l.push(o),g}}s.BufferLine=S},4841:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(a,u){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return u*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(E,s)=>{function a(u,p,c){if(p===u.length-1)return u[p].getTrimmedLength();const h=!u[p].hasContent(c-1)&&u[p].getWidth(c-1)===1,m=u[p+1].getWidth(0)===2;return h&&m?c-1:c}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(u,p,c,h,m){const S=[];for(let _=0;_<u.length-1;_++){let n=_,o=u.get(++n);if(!o.isWrapped)continue;const i=[u.get(_)];for(;n<u.length&&o.isWrapped;)i.push(o),o=u.get(++n);if(h>=_&&h<n){_+=i.length-1;continue}let l=0,g=a(i,l,p),x=1,y=0;for(;x<i.length;){const v=a(i,x,p),C=v-y,T=c-g,A=Math.min(C,T);i[l].copyCellsFrom(i[x],y,g,A,!1),g+=A,g===c&&(l++,g=0),y+=A,y===v&&(x++,y=0),g===0&&l!==0&&i[l-1].getWidth(c-1)===2&&(i[l].copyCellsFrom(i[l-1],c-1,g++,1,!1),i[l-1].setCell(c-1,m))}i[l].replaceCells(g,c,m);let w=0;for(let v=i.length-1;v>0&&(v>l||i[v].getTrimmedLength()===0);v--)w++;w>0&&(S.push(_+i.length-w),S.push(w)),_+=i.length-1}return S},s.reflowLargerCreateNewLayout=function(u,p){const c=[];let h=0,m=p[h],S=0;for(let _=0;_<u.length;_++)if(m===_){const n=p[++h];u.onDeleteEmitter.fire({index:_-S,amount:n}),_+=n-1,S+=n,m=p[++h]}else c.push(_);return{layout:c,countRemoved:S}},s.reflowLargerApplyNewLayout=function(u,p){const c=[];for(let h=0;h<p.length;h++)c.push(u.get(p[h]));for(let h=0;h<c.length;h++)u.set(h,c[h]);u.length=p.length},s.reflowSmallerGetNewLineLengths=function(u,p,c){const h=[],m=u.map((o,i)=>a(u,i,p)).reduce((o,i)=>o+i);let S=0,_=0,n=0;for(;n<m;){if(m-n<c){h.push(m-n);break}S+=c;const o=a(u,_,p);S>o&&(S-=o,_++);const i=u[_].getWidth(S-1)===2;i&&S--;const l=i?c-1:c;h.push(l),n+=l}return h},s.getWrappedLineTrimmedLength=a},5295:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const u=a(8460),p=a(844),c=a(9092);class h extends p.Disposable{constructor(S,_){super(),this._optionsService=S,this._bufferService=_,this._onBufferActivate=this.register(new u.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(S){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(S),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(S,_){this._normal.resize(S,_),this._alt.resize(S,_),this.setupTabStops(S)}setupTabStops(S){this._normal.setupTabStops(S),this._alt.setupTabStops(S)}}s.BufferSet=h},511:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const u=a(482),p=a(643),c=a(3734);class h extends c.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new c.ExtendedAttrs,this.combinedData=""}static fromCharData(S){const _=new h;return _.setFromCharData(S),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,u.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(S){this.fg=S[p.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(S[p.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(S[p.CHAR_DATA_CHAR_INDEX].length===2){const n=S[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const o=S[p.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(n-55296)+o-56320+65536|S[p.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=S[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|S[p.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=S[p.CHAR_DATA_CHAR_INDEX],this.content=2097152|S[p.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=h},643:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const u=a(8460),p=a(844);class c{get id(){return this._id}constructor(m){this.line=m,this.isDisposed=!1,this._disposables=[],this._id=c._nextId++,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,p.disposeArray)(this._disposables),this._disposables.length=0)}register(m){return this._disposables.push(m),m}}s.Marker=c,c._nextId=1},7116:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},s.CHARSETS.A={"#":""},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},s.CHARSETS.C=s.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.E=s.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},s.CHARSETS.H=s.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(E,s)=>{var a,u,p;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(c){c.NUL="\0",c.SOH="",c.STX="",c.ETX="",c.EOT="",c.ENQ="",c.ACK="",c.BEL="\x07",c.BS="\b",c.HT="	",c.LF=`
`,c.VT="\v",c.FF="\f",c.CR="\r",c.SO="",c.SI="",c.DLE="",c.DC1="",c.DC2="",c.DC3="",c.DC4="",c.NAK="",c.SYN="",c.ETB="",c.CAN="",c.EM="",c.SUB="",c.ESC="\x1B",c.FS="",c.GS="",c.RS="",c.US="",c.SP=" ",c.DEL=""}(a||(s.C0=a={})),function(c){c.PAD="",c.HOP="",c.BPH="",c.NBH="",c.IND="",c.NEL="",c.SSA="",c.ESA="",c.HTS="",c.HTJ="",c.VTS="",c.PLD="",c.PLU="",c.RI="",c.SS2="",c.SS3="",c.DCS="",c.PU1="",c.PU2="",c.STS="",c.CCH="",c.MW="",c.SPA="",c.EPA="",c.SOS="",c.SGCI="",c.SCI="",c.CSI="",c.ST="",c.OSC="",c.PM="",c.APC=""}(u||(s.C1=u={})),function(c){c.ST=`${a.ESC}\\`}(p||(s.C1_ESCAPED=p={}))},7399:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const u=a(2584),p={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(c,h,m,S){const _={type:0,cancel:!1,key:void 0},n=(c.shiftKey?1:0)|(c.altKey?2:0)|(c.ctrlKey?4:0)|(c.metaKey?8:0);switch(c.keyCode){case 0:c.key==="UIKeyInputUpArrow"?_.key=h?u.C0.ESC+"OA":u.C0.ESC+"[A":c.key==="UIKeyInputLeftArrow"?_.key=h?u.C0.ESC+"OD":u.C0.ESC+"[D":c.key==="UIKeyInputRightArrow"?_.key=h?u.C0.ESC+"OC":u.C0.ESC+"[C":c.key==="UIKeyInputDownArrow"&&(_.key=h?u.C0.ESC+"OB":u.C0.ESC+"[B");break;case 8:_.key=c.ctrlKey?"\b":u.C0.DEL,c.altKey&&(_.key=u.C0.ESC+_.key);break;case 9:if(c.shiftKey){_.key=u.C0.ESC+"[Z";break}_.key=u.C0.HT,_.cancel=!0;break;case 13:_.key=c.altKey?u.C0.ESC+u.C0.CR:u.C0.CR,_.cancel=!0;break;case 27:_.key=u.C0.ESC,c.altKey&&(_.key=u.C0.ESC+u.C0.ESC),_.cancel=!0;break;case 37:if(c.metaKey)break;n?(_.key=u.C0.ESC+"[1;"+(n+1)+"D",_.key===u.C0.ESC+"[1;3D"&&(_.key=u.C0.ESC+(m?"b":"[1;5D"))):_.key=h?u.C0.ESC+"OD":u.C0.ESC+"[D";break;case 39:if(c.metaKey)break;n?(_.key=u.C0.ESC+"[1;"+(n+1)+"C",_.key===u.C0.ESC+"[1;3C"&&(_.key=u.C0.ESC+(m?"f":"[1;5C"))):_.key=h?u.C0.ESC+"OC":u.C0.ESC+"[C";break;case 38:if(c.metaKey)break;n?(_.key=u.C0.ESC+"[1;"+(n+1)+"A",m||_.key!==u.C0.ESC+"[1;3A"||(_.key=u.C0.ESC+"[1;5A")):_.key=h?u.C0.ESC+"OA":u.C0.ESC+"[A";break;case 40:if(c.metaKey)break;n?(_.key=u.C0.ESC+"[1;"+(n+1)+"B",m||_.key!==u.C0.ESC+"[1;3B"||(_.key=u.C0.ESC+"[1;5B")):_.key=h?u.C0.ESC+"OB":u.C0.ESC+"[B";break;case 45:c.shiftKey||c.ctrlKey||(_.key=u.C0.ESC+"[2~");break;case 46:_.key=n?u.C0.ESC+"[3;"+(n+1)+"~":u.C0.ESC+"[3~";break;case 36:_.key=n?u.C0.ESC+"[1;"+(n+1)+"H":h?u.C0.ESC+"OH":u.C0.ESC+"[H";break;case 35:_.key=n?u.C0.ESC+"[1;"+(n+1)+"F":h?u.C0.ESC+"OF":u.C0.ESC+"[F";break;case 33:c.shiftKey?_.type=2:c.ctrlKey?_.key=u.C0.ESC+"[5;"+(n+1)+"~":_.key=u.C0.ESC+"[5~";break;case 34:c.shiftKey?_.type=3:c.ctrlKey?_.key=u.C0.ESC+"[6;"+(n+1)+"~":_.key=u.C0.ESC+"[6~";break;case 112:_.key=n?u.C0.ESC+"[1;"+(n+1)+"P":u.C0.ESC+"OP";break;case 113:_.key=n?u.C0.ESC+"[1;"+(n+1)+"Q":u.C0.ESC+"OQ";break;case 114:_.key=n?u.C0.ESC+"[1;"+(n+1)+"R":u.C0.ESC+"OR";break;case 115:_.key=n?u.C0.ESC+"[1;"+(n+1)+"S":u.C0.ESC+"OS";break;case 116:_.key=n?u.C0.ESC+"[15;"+(n+1)+"~":u.C0.ESC+"[15~";break;case 117:_.key=n?u.C0.ESC+"[17;"+(n+1)+"~":u.C0.ESC+"[17~";break;case 118:_.key=n?u.C0.ESC+"[18;"+(n+1)+"~":u.C0.ESC+"[18~";break;case 119:_.key=n?u.C0.ESC+"[19;"+(n+1)+"~":u.C0.ESC+"[19~";break;case 120:_.key=n?u.C0.ESC+"[20;"+(n+1)+"~":u.C0.ESC+"[20~";break;case 121:_.key=n?u.C0.ESC+"[21;"+(n+1)+"~":u.C0.ESC+"[21~";break;case 122:_.key=n?u.C0.ESC+"[23;"+(n+1)+"~":u.C0.ESC+"[23~";break;case 123:_.key=n?u.C0.ESC+"[24;"+(n+1)+"~":u.C0.ESC+"[24~";break;default:if(!c.ctrlKey||c.shiftKey||c.altKey||c.metaKey)if(m&&!S||!c.altKey||c.metaKey)!m||c.altKey||c.ctrlKey||c.shiftKey||!c.metaKey?c.key&&!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.keyCode>=48&&c.key.length===1?_.key=c.key:c.key&&c.ctrlKey&&(c.key==="_"&&(_.key=u.C0.US),c.key==="@"&&(_.key=u.C0.NUL)):c.keyCode===65&&(_.type=1);else{const o=p[c.keyCode],i=o?.[c.shiftKey?1:0];if(i)_.key=u.C0.ESC+i;else if(c.keyCode>=65&&c.keyCode<=90){const l=c.ctrlKey?c.keyCode-64:c.keyCode+32;let g=String.fromCharCode(l);c.shiftKey&&(g=g.toUpperCase()),_.key=u.C0.ESC+g}else if(c.keyCode===32)_.key=u.C0.ESC+(c.ctrlKey?u.C0.NUL:" ");else if(c.key==="Dead"&&c.code.startsWith("Key")){let l=c.code.slice(3,4);c.shiftKey||(l=l.toLowerCase()),_.key=u.C0.ESC+l,_.cancel=!0}}else c.keyCode>=65&&c.keyCode<=90?_.key=String.fromCharCode(c.keyCode-64):c.keyCode===32?_.key=u.C0.NUL:c.keyCode>=51&&c.keyCode<=55?_.key=String.fromCharCode(c.keyCode-51+27):c.keyCode===56?_.key=u.C0.DEL:c.keyCode===219?_.key=u.C0.ESC:c.keyCode===220?_.key=u.C0.FS:c.keyCode===221&&(_.key=u.C0.GS)}return _}},482:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},s.utf32ToString=function(a,u=0,p=a.length){let c="";for(let h=u;h<p;++h){let m=a[h];m>65535?(m-=65536,c+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):c+=String.fromCharCode(m)}return c},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,u){const p=a.length;if(!p)return 0;let c=0,h=0;if(this._interim){const m=a.charCodeAt(h++);56320<=m&&m<=57343?u[c++]=1024*(this._interim-55296)+m-56320+65536:(u[c++]=this._interim,u[c++]=m),this._interim=0}for(let m=h;m<p;++m){const S=a.charCodeAt(m);if(55296<=S&&S<=56319){if(++m>=p)return this._interim=S,c;const _=a.charCodeAt(m);56320<=_&&_<=57343?u[c++]=1024*(S-55296)+_-56320+65536:(u[c++]=S,u[c++]=_)}else S!==65279&&(u[c++]=S)}return c}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,u){const p=a.length;if(!p)return 0;let c,h,m,S,_=0,n=0,o=0;if(this.interim[0]){let g=!1,x=this.interim[0];x&=(224&x)==192?31:(240&x)==224?15:7;let y,w=0;for(;(y=63&this.interim[++w])&&w<4;)x<<=6,x|=y;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=v-w;for(;o<C;){if(o>=p)return 0;if(y=a[o++],(192&y)!=128){o--,g=!0;break}this.interim[w++]=y,x<<=6,x|=63&y}g||(v===2?x<128?o--:u[_++]=x:v===3?x<2048||x>=55296&&x<=57343||x===65279||(u[_++]=x):x<65536||x>1114111||(u[_++]=x)),this.interim.fill(0)}const i=p-4;let l=o;for(;l<p;){for(;!(!(l<i)||128&(c=a[l])||128&(h=a[l+1])||128&(m=a[l+2])||128&(S=a[l+3]));)u[_++]=c,u[_++]=h,u[_++]=m,u[_++]=S,l+=4;if(c=a[l++],c<128)u[_++]=c;else if((224&c)==192){if(l>=p)return this.interim[0]=c,_;if(h=a[l++],(192&h)!=128){l--;continue}if(n=(31&c)<<6|63&h,n<128){l--;continue}u[_++]=n}else if((240&c)==224){if(l>=p)return this.interim[0]=c,_;if(h=a[l++],(192&h)!=128){l--;continue}if(l>=p)return this.interim[0]=c,this.interim[1]=h,_;if(m=a[l++],(192&m)!=128){l--;continue}if(n=(15&c)<<12|(63&h)<<6|63&m,n<2048||n>=55296&&n<=57343||n===65279)continue;u[_++]=n}else if((248&c)==240){if(l>=p)return this.interim[0]=c,_;if(h=a[l++],(192&h)!=128){l--;continue}if(l>=p)return this.interim[0]=c,this.interim[1]=h,_;if(m=a[l++],(192&m)!=128){l--;continue}if(l>=p)return this.interim[0]=c,this.interim[1]=h,this.interim[2]=m,_;if(S=a[l++],(192&S)!=128){l--;continue}if(n=(7&c)<<18|(63&h)<<12|(63&m)<<6|63&S,n<65536||n>1114111)continue;u[_++]=n}}return _}}},225:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const u=a(1480),p=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let h;s.UnicodeV6=class{constructor(){if(this.version="6",!h){h=new Uint8Array(65536),h.fill(1),h[0]=0,h.fill(0,1,32),h.fill(0,127,160),h.fill(2,4352,4448),h[9001]=2,h[9002]=2,h.fill(2,11904,42192),h[12351]=1,h.fill(2,44032,55204),h.fill(2,63744,64256),h.fill(2,65040,65050),h.fill(2,65072,65136),h.fill(2,65280,65377),h.fill(2,65504,65511);for(let m=0;m<p.length;++m)h.fill(0,p[m][0],p[m][1]+1)}}wcwidth(m){return m<32?0:m<127?1:m<65536?h[m]:function(S,_){let n,o=0,i=_.length-1;if(S<_[0][0]||S>_[i][1])return!1;for(;i>=o;)if(n=o+i>>1,S>_[n][1])o=n+1;else{if(!(S<_[n][0]))return!0;i=n-1}return!1}(m,c)?0:m>=131072&&m<=196605||m>=196608&&m<=262141?2:1}charProperties(m,S){let _=this.wcwidth(m),n=_===0&&S!==0;if(n){const o=u.UnicodeService.extractWidth(S);o===0?n=!1:o>_&&(_=o)}return u.UnicodeService.createPropertyValue(0,_,n)}}},5981:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const u=a(8460),p=a(844);class c extends p.Disposable{constructor(m){super(),this._action=m,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new u.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(m,S){if(S!==void 0&&this._syncCalls>S)return void(this._syncCalls=0);if(this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);const n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(m,S){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(S),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(S)}_innerWrite(m=0,S=!0){const _=m||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const n=this._writeBuffer[this._bufferOffset],o=this._action(n,S);if(o){const l=g=>Date.now()-_>=12?setTimeout(()=>this._innerWrite(0,g)):this._innerWrite(_,g);return void o.catch(g=>(queueMicrotask(()=>{throw g}),Promise.resolve(!1))).then(l)}const i=this._callbacks[this._bufferOffset];if(i&&i(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=c},5941:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,u=/^[\da-f]+$/;function p(c,h){const m=c.toString(16),S=m.length<2?"0"+m:m;switch(h){case 4:return m[0];case 8:return S;case 12:return(S+S).slice(0,3);default:return S+S}}s.parseColor=function(c){if(!c)return;let h=c.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const m=a.exec(h);if(m){const S=m[1]?15:m[4]?255:m[7]?4095:65535;return[Math.round(parseInt(m[1]||m[4]||m[7]||m[10],16)/S*255),Math.round(parseInt(m[2]||m[5]||m[8]||m[11],16)/S*255),Math.round(parseInt(m[3]||m[6]||m[9]||m[12],16)/S*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),u.exec(h)&&[3,6,9,12].includes(h.length))){const m=h.length/3,S=[0,0,0];for(let _=0;_<3;++_){const n=parseInt(h.slice(m*_,m*_+m),16);S[_]=m===1?n<<4:m===2?n:m===3?n>>4:n>>8}return S}},s.toRgbString=function(c,h=16){const[m,S,_]=c;return`rgb:${p(m,h)}/${p(S,h)}/${p(_,h)}`}},5770:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const u=a(482),p=a(8742),c=a(5770),h=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(S,_){this._handlers[S]===void 0&&(this._handlers[S]=[]);const n=this._handlers[S];return n.push(_),{dispose:()=>{const o=n.indexOf(_);o!==-1&&n.splice(o,1)}}}clearHandler(S){this._handlers[S]&&delete this._handlers[S]}setHandlerFallback(S){this._handlerFb=S}reset(){if(this._active.length)for(let S=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;S>=0;--S)this._active[S].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(S,_){if(this.reset(),this._ident=S,this._active=this._handlers[S]||h,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(S,_,n){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(S,_,n);else this._handlerFb(this._ident,"PUT",(0,u.utf32ToString)(S,_,n))}unhook(S,_=!0){if(this._active.length){let n=!1,o=this._active.length-1,i=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,n=_,i=this._stack.fallThrough,this._stack.paused=!1),!i&&n===!1){for(;o>=0&&(n=this._active[o].unhook(S),n!==!0);o--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,n;o--}for(;o>=0;o--)if(n=this._active[o].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,n}else this._handlerFb(this._ident,"UNHOOK",S);this._active=h,this._ident=0}};const m=new p.Params;m.addParam(0),s.DcsHandler=class{constructor(S){this._handler=S,this._data="",this._params=m,this._hitLimit=!1}hook(S){this._params=S.length>1||S.params[0]?S.clone():m,this._data="",this._hitLimit=!1}put(S,_,n){this._hitLimit||(this._data+=(0,u.utf32ToString)(S,_,n),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(S){let _=!1;if(this._hitLimit)_=!1;else if(S&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then(n=>(this._params=m,this._data="",this._hitLimit=!1,n));return this._params=m,this._data="",this._hitLimit=!1,_}}},2015:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const u=a(844),p=a(8742),c=a(6242),h=a(6351);class m{constructor(o){this.table=new Uint8Array(o)}setDefault(o,i){this.table.fill(o<<4|i)}add(o,i,l,g){this.table[i<<8|o]=l<<4|g}addMany(o,i,l,g){for(let x=0;x<o.length;x++)this.table[i<<8|o[x]]=l<<4|g}}s.TransitionTable=m;const S=160;s.VT500_TRANSITION_TABLE=function(){const n=new m(4095),o=Array.apply(null,Array(256)).map((w,v)=>v),i=(w,v)=>o.slice(w,v),l=i(32,127),g=i(0,24);g.push(25),g.push.apply(g,i(28,32));const x=i(0,14);let y;for(y in n.setDefault(1,0),n.addMany(l,0,2,0),x)n.addMany([24,26,153,154],y,3,0),n.addMany(i(128,144),y,3,0),n.addMany(i(144,152),y,3,0),n.add(156,y,0,0),n.add(27,y,11,1),n.add(157,y,4,8),n.addMany([152,158,159],y,0,7),n.add(155,y,11,3),n.add(144,y,11,9);return n.addMany(g,0,3,0),n.addMany(g,1,3,1),n.add(127,1,0,1),n.addMany(g,8,0,8),n.addMany(g,3,3,3),n.add(127,3,0,3),n.addMany(g,4,3,4),n.add(127,4,0,4),n.addMany(g,6,3,6),n.addMany(g,5,3,5),n.add(127,5,0,5),n.addMany(g,2,3,2),n.add(127,2,0,2),n.add(93,1,4,8),n.addMany(l,8,5,8),n.add(127,8,5,8),n.addMany([156,27,24,26,7],8,6,0),n.addMany(i(28,32),8,0,8),n.addMany([88,94,95],1,0,7),n.addMany(l,7,0,7),n.addMany(g,7,0,7),n.add(156,7,0,0),n.add(127,7,0,7),n.add(91,1,11,3),n.addMany(i(64,127),3,7,0),n.addMany(i(48,60),3,8,4),n.addMany([60,61,62,63],3,9,4),n.addMany(i(48,60),4,8,4),n.addMany(i(64,127),4,7,0),n.addMany([60,61,62,63],4,0,6),n.addMany(i(32,64),6,0,6),n.add(127,6,0,6),n.addMany(i(64,127),6,0,0),n.addMany(i(32,48),3,9,5),n.addMany(i(32,48),5,9,5),n.addMany(i(48,64),5,0,6),n.addMany(i(64,127),5,7,0),n.addMany(i(32,48),4,9,5),n.addMany(i(32,48),1,9,2),n.addMany(i(32,48),2,9,2),n.addMany(i(48,127),2,10,0),n.addMany(i(48,80),1,10,0),n.addMany(i(81,88),1,10,0),n.addMany([89,90,92],1,10,0),n.addMany(i(96,127),1,10,0),n.add(80,1,11,9),n.addMany(g,9,0,9),n.add(127,9,0,9),n.addMany(i(28,32),9,0,9),n.addMany(i(32,48),9,9,12),n.addMany(i(48,60),9,8,10),n.addMany([60,61,62,63],9,9,10),n.addMany(g,11,0,11),n.addMany(i(32,128),11,0,11),n.addMany(i(28,32),11,0,11),n.addMany(g,10,0,10),n.add(127,10,0,10),n.addMany(i(28,32),10,0,10),n.addMany(i(48,60),10,8,10),n.addMany([60,61,62,63],10,0,11),n.addMany(i(32,48),10,9,12),n.addMany(g,12,0,12),n.add(127,12,0,12),n.addMany(i(28,32),12,0,12),n.addMany(i(32,48),12,9,12),n.addMany(i(48,64),12,0,11),n.addMany(i(64,127),12,12,13),n.addMany(i(64,127),10,12,13),n.addMany(i(64,127),9,12,13),n.addMany(g,13,13,13),n.addMany(l,13,13,13),n.add(127,13,0,13),n.addMany([27,156,24,26],13,14,0),n.add(S,0,2,0),n.add(S,8,5,8),n.add(S,6,0,6),n.add(S,11,0,11),n.add(S,13,13,13),n}();class _ extends u.Disposable{constructor(o=s.VT500_TRANSITION_TABLE){super(),this._transitions=o,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new p.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(i,l,g)=>{},this._executeHandlerFb=i=>{},this._csiHandlerFb=(i,l)=>{},this._escHandlerFb=i=>{},this._errorHandlerFb=i=>i,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,u.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new c.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(o,i=[64,126]){let l=0;if(o.prefix){if(o.prefix.length>1)throw new Error("only one byte as prefix supported");if(l=o.prefix.charCodeAt(0),l&&60>l||l>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(o.intermediates){if(o.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let x=0;x<o.intermediates.length;++x){const y=o.intermediates.charCodeAt(x);if(32>y||y>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");l<<=8,l|=y}}if(o.final.length!==1)throw new Error("final must be a single byte");const g=o.final.charCodeAt(0);if(i[0]>g||g>i[1])throw new Error(`final must be in range ${i[0]} .. ${i[1]}`);return l<<=8,l|=g,l}identToString(o){const i=[];for(;o;)i.push(String.fromCharCode(255&o)),o>>=8;return i.reverse().join("")}setPrintHandler(o){this._printHandler=o}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(o,i){const l=this._identifier(o,[48,126]);this._escHandlers[l]===void 0&&(this._escHandlers[l]=[]);const g=this._escHandlers[l];return g.push(i),{dispose:()=>{const x=g.indexOf(i);x!==-1&&g.splice(x,1)}}}clearEscHandler(o){this._escHandlers[this._identifier(o,[48,126])]&&delete this._escHandlers[this._identifier(o,[48,126])]}setEscHandlerFallback(o){this._escHandlerFb=o}setExecuteHandler(o,i){this._executeHandlers[o.charCodeAt(0)]=i}clearExecuteHandler(o){this._executeHandlers[o.charCodeAt(0)]&&delete this._executeHandlers[o.charCodeAt(0)]}setExecuteHandlerFallback(o){this._executeHandlerFb=o}registerCsiHandler(o,i){const l=this._identifier(o);this._csiHandlers[l]===void 0&&(this._csiHandlers[l]=[]);const g=this._csiHandlers[l];return g.push(i),{dispose:()=>{const x=g.indexOf(i);x!==-1&&g.splice(x,1)}}}clearCsiHandler(o){this._csiHandlers[this._identifier(o)]&&delete this._csiHandlers[this._identifier(o)]}setCsiHandlerFallback(o){this._csiHandlerFb=o}registerDcsHandler(o,i){return this._dcsParser.registerHandler(this._identifier(o),i)}clearDcsHandler(o){this._dcsParser.clearHandler(this._identifier(o))}setDcsHandlerFallback(o){this._dcsParser.setHandlerFallback(o)}registerOscHandler(o,i){return this._oscParser.registerHandler(o,i)}clearOscHandler(o){this._oscParser.clearHandler(o)}setOscHandlerFallback(o){this._oscParser.setHandlerFallback(o)}setErrorHandler(o){this._errorHandler=o}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(o,i,l,g,x){this._parseStack.state=o,this._parseStack.handlers=i,this._parseStack.handlerPos=l,this._parseStack.transition=g,this._parseStack.chunkPos=x}parse(o,i,l){let g,x=0,y=0,w=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,w=this._parseStack.chunkPos+1;else{if(l===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const v=this._parseStack.handlers;let C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(l===!1&&C>-1){for(;C>=0&&(g=v[C](this._params),g!==!0);C--)if(g instanceof Promise)return this._parseStack.handlerPos=C,g}this._parseStack.handlers=[];break;case 4:if(l===!1&&C>-1){for(;C>=0&&(g=v[C](),g!==!0);C--)if(g instanceof Promise)return this._parseStack.handlerPos=C,g}this._parseStack.handlers=[];break;case 6:if(x=o[this._parseStack.chunkPos],g=this._dcsParser.unhook(x!==24&&x!==26,l),g)return g;x===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(x=o[this._parseStack.chunkPos],g=this._oscParser.end(x!==24&&x!==26,l),g)return g;x===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,w=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let v=w;v<i;++v){switch(x=o[v],y=this._transitions.table[this.currentState<<8|(x<160?x:S)],y>>4){case 2:for(let D=v+1;;++D){if(D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}if(++D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}if(++D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}if(++D>=i||(x=o[D])<32||x>126&&x<S){this._printHandler(o,v,D),v=D-1;break}}break;case 3:this._executeHandlers[x]?this._executeHandlers[x]():this._executeHandlerFb(x),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:x,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const C=this._csiHandlers[this._collect<<8|x];let T=C?C.length-1:-1;for(;T>=0&&(g=C[T](this._params),g!==!0);T--)if(g instanceof Promise)return this._preserveStack(3,C,T,y,v),g;T<0&&this._csiHandlerFb(this._collect<<8|x,this._params),this.precedingJoinState=0;break;case 8:do switch(x){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(x-48)}while(++v<i&&(x=o[v])>47&&x<60);v--;break;case 9:this._collect<<=8,this._collect|=x;break;case 10:const A=this._escHandlers[this._collect<<8|x];let B=A?A.length-1:-1;for(;B>=0&&(g=A[B](),g!==!0);B--)if(g instanceof Promise)return this._preserveStack(4,A,B,y,v),g;B<0&&this._escHandlerFb(this._collect<<8|x),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|x,this._params);break;case 13:for(let D=v+1;;++D)if(D>=i||(x=o[D])===24||x===26||x===27||x>127&&x<S){this._dcsParser.put(o,v,D),v=D-1;break}break;case 14:if(g=this._dcsParser.unhook(x!==24&&x!==26),g)return this._preserveStack(6,[],0,y,v),g;x===27&&(y|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let D=v+1;;D++)if(D>=i||(x=o[D])<32||x>127&&x<S){this._oscParser.put(o,v,D),v=D-1;break}break;case 6:if(g=this._oscParser.end(x!==24&&x!==26),g)return this._preserveStack(5,[],0,y,v),g;x===27&&(y|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&y}}}s.EscapeSequenceParser=_},6242:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const u=a(5770),p=a(482),c=[];s.OscParser=class{constructor(){this._state=0,this._active=c,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,m){this._handlers[h]===void 0&&(this._handlers[h]=[]);const S=this._handlers[h];return S.push(m),{dispose:()=>{const _=S.indexOf(m);_!==-1&&S.splice(_,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=c,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||c,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,m,S){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(h,m,S);else this._handlerFb(this._id,"PUT",(0,p.utf32ToString)(h,m,S))}start(){this.reset(),this._state=1}put(h,m,S){if(this._state!==3){if(this._state===1)for(;m<S;){const _=h[m++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&S-m>0&&this._put(h,m,S)}}end(h,m=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let S=!1,_=this._active.length-1,n=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,S=m,n=this._stack.fallThrough,this._stack.paused=!1),!n&&S===!1){for(;_>=0&&(S=this._active[_].end(h),S!==!0);_--)if(S instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,S;_--}for(;_>=0;_--)if(S=this._active[_].end(!1),S instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,S}else this._handlerFb(this._id,"END",h);this._active=c,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,m,S){this._hitLimit||(this._data+=(0,p.utf32ToString)(h,m,S),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let m=!1;if(this._hitLimit)m=!1;else if(h&&(m=this._handler(this._data),m instanceof Promise))return m.then(S=>(this._data="",this._hitLimit=!1,S));return this._data="",this._hitLimit=!1,m}}},8742:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const a=2147483647;class u{static fromArray(c){const h=new u;if(!c.length)return h;for(let m=Array.isArray(c[0])?1:0;m<c.length;++m){const S=c[m];if(Array.isArray(S))for(let _=0;_<S.length;++_)h.addSubParam(S[_]);else h.addParam(S)}return h}constructor(c=32,h=32){if(this.maxLength=c,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(c),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(c),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const c=new u(this.maxLength,this.maxSubParamsLength);return c.params.set(this.params),c.length=this.length,c._subParams.set(this._subParams),c._subParamsLength=this._subParamsLength,c._subParamsIdx.set(this._subParamsIdx),c._rejectDigits=this._rejectDigits,c._rejectSubDigits=this._rejectSubDigits,c._digitIsSub=this._digitIsSub,c}toArray(){const c=[];for(let h=0;h<this.length;++h){c.push(this.params[h]);const m=this._subParamsIdx[h]>>8,S=255&this._subParamsIdx[h];S-m>0&&c.push(Array.prototype.slice.call(this._subParams,m,S))}return c}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(c){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=c>a?a:c}}addSubParam(c){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=c>a?a:c,this._subParamsIdx[this.length-1]++}}hasSubParams(c){return(255&this._subParamsIdx[c])-(this._subParamsIdx[c]>>8)>0}getSubParams(c){const h=this._subParamsIdx[c]>>8,m=255&this._subParamsIdx[c];return m-h>0?this._subParams.subarray(h,m):null}getSubParamsAll(){const c={};for(let h=0;h<this.length;++h){const m=this._subParamsIdx[h]>>8,S=255&this._subParamsIdx[h];S-m>0&&(c[h]=this._subParams.slice(m,S))}return c}addDigit(c){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const m=this._digitIsSub?this._subParams:this.params,S=m[h-1];m[h-1]=~S?Math.min(10*S+c,a):c}}s.Params=u},5741:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,u){const p={instance:u,dispose:u.dispose,isDisposed:!1};this._addons.push(p),u.dispose=()=>this._wrappedAddonDispose(p),u.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let u=-1;for(let p=0;p<this._addons.length;p++)if(this._addons[p]===a){u=p;break}if(u===-1)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(u,1)}}},8771:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const u=a(3785),p=a(511);s.BufferApiView=class{constructor(c,h){this._buffer=c,this.type=h}init(c){return this._buffer=c,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(c){const h=this._buffer.lines.get(c);if(h)return new u.BufferLineApiView(h)}getNullCell(){return new p.CellData}}},3785:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const u=a(511);s.BufferLineApiView=class{constructor(p){this._line=p}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(p,c){if(!(p<0||p>=this._line.length))return c?(this._line.loadCell(p,c),c):this._line.loadCell(p,new u.CellData)}translateToString(p,c,h){return this._line.translateToString(p,c,h)}}},8285:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const u=a(8771),p=a(8460),c=a(844);class h extends c.Disposable{constructor(S){super(),this._core=S,this._onBufferChange=this.register(new p.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new u.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new u.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}s.BufferNamespaceApi=h},7975:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,u){return this._core.registerCsiHandler(a,p=>u(p.toArray()))}addCsiHandler(a,u){return this.registerCsiHandler(a,u)}registerDcsHandler(a,u){return this._core.registerDcsHandler(a,(p,c)=>u(p,c.toArray()))}addDcsHandler(a,u){return this.registerDcsHandler(a,u)}registerEscHandler(a,u){return this._core.registerEscHandler(a,u)}addEscHandler(a,u){return this.registerEscHandler(a,u)}registerOscHandler(a,u){return this._core.registerOscHandler(a,u)}addOscHandler(a,u){return this.registerOscHandler(a,u)}}},7090:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(E,s,a){var u=this&&this.__decorate||function(n,o,i,l){var g,x=arguments.length,y=x<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,i):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,o,i,l);else for(var w=n.length-1;w>=0;w--)(g=n[w])&&(y=(x<3?g(y):x>3?g(o,i,y):g(o,i))||y);return x>3&&y&&Object.defineProperty(o,i,y),y},p=this&&this.__param||function(n,o){return function(i,l){o(i,l,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const c=a(8460),h=a(844),m=a(5295),S=a(2585);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let _=s.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(n){super(),this.isUserScrolling=!1,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new c.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(n.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(n.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new m.BufferSet(n,this))}resize(n,o){this.cols=n,this.rows=o,this.buffers.resize(n,o),this._onResize.fire({cols:n,rows:o})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(n,o=!1){const i=this.buffer;let l;l=this._cachedBlankLine,l&&l.length===this.cols&&l.getFg(0)===n.fg&&l.getBg(0)===n.bg||(l=i.getBlankLine(n,o),this._cachedBlankLine=l),l.isWrapped=o;const g=i.ybase+i.scrollTop,x=i.ybase+i.scrollBottom;if(i.scrollTop===0){const y=i.lines.isFull;x===i.lines.length-1?y?i.lines.recycle().copyFrom(l):i.lines.push(l.clone()):i.lines.splice(x+1,0,l.clone()),y?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{const y=x-g+1;i.lines.shiftElements(g+1,y-1,-1),i.lines.set(x,l.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(n,o,i){const l=this.buffer;if(n<0){if(l.ydisp===0)return;this.isUserScrolling=!0}else n+l.ydisp>=l.ybase&&(this.isUserScrolling=!1);const g=l.ydisp;l.ydisp=Math.max(Math.min(l.ydisp+n,l.ybase),0),g!==l.ydisp&&(o||this._onScroll.fire(l.ydisp))}};s.BufferService=_=u([p(0,S.IOptionsService)],_)},7994:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,u){this._charsets[a]=u,this.glevel===a&&(this.charset=u)}}},1753:function(E,s,a){var u=this&&this.__decorate||function(l,g,x,y){var w,v=arguments.length,C=v<3?g:y===null?y=Object.getOwnPropertyDescriptor(g,x):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(l,g,x,y);else for(var T=l.length-1;T>=0;T--)(w=l[T])&&(C=(v<3?w(C):v>3?w(g,x,C):w(g,x))||C);return v>3&&C&&Object.defineProperty(g,x,C),C},p=this&&this.__param||function(l,g){return function(x,y){g(x,y,l)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const c=a(2585),h=a(8460),m=a(844),S={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:l=>l.button!==4&&l.action===1&&(l.ctrl=!1,l.alt=!1,l.shift=!1,!0)},VT200:{events:19,restrict:l=>l.action!==32},DRAG:{events:23,restrict:l=>l.action!==32||l.button!==3},ANY:{events:31,restrict:l=>!0}};function _(l,g){let x=(l.ctrl?16:0)|(l.shift?4:0)|(l.alt?8:0);return l.button===4?(x|=64,x|=l.action):(x|=3&l.button,4&l.button&&(x|=64),8&l.button&&(x|=128),l.action===32?x|=32:l.action!==0||g||(x|=3)),x}const n=String.fromCharCode,o={DEFAULT:l=>{const g=[_(l,!1)+32,l.col+32,l.row+32];return g[0]>255||g[1]>255||g[2]>255?"":`\x1B[M${n(g[0])}${n(g[1])}${n(g[2])}`},SGR:l=>{const g=l.action===0&&l.button!==4?"m":"M";return`\x1B[<${_(l,!0)};${l.col};${l.row}${g}`},SGR_PIXELS:l=>{const g=l.action===0&&l.button!==4?"m":"M";return`\x1B[<${_(l,!0)};${l.x};${l.y}${g}`}};let i=s.CoreMouseService=class extends m.Disposable{constructor(l,g){super(),this._bufferService=l,this._coreService=g,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const x of Object.keys(S))this.addProtocol(x,S[x]);for(const x of Object.keys(o))this.addEncoding(x,o[x]);this.reset()}addProtocol(l,g){this._protocols[l]=g}addEncoding(l,g){this._encodings[l]=g}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(l){if(!this._protocols[l])throw new Error(`unknown protocol "${l}"`);this._activeProtocol=l,this._onProtocolChange.fire(this._protocols[l].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(l){if(!this._encodings[l])throw new Error(`unknown encoding "${l}"`);this._activeEncoding=l}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(l){if(l.col<0||l.col>=this._bufferService.cols||l.row<0||l.row>=this._bufferService.rows||l.button===4&&l.action===32||l.button===3&&l.action!==32||l.button!==4&&(l.action===2||l.action===3)||(l.col++,l.row++,l.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,l,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(l))return!1;const g=this._encodings[this._activeEncoding](l);return g&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(g):this._coreService.triggerDataEvent(g,!0)),this._lastEvent=l,!0}explainEvents(l){return{down:!!(1&l),up:!!(2&l),drag:!!(4&l),move:!!(8&l),wheel:!!(16&l)}}_equalEvents(l,g,x){if(x){if(l.x!==g.x||l.y!==g.y)return!1}else if(l.col!==g.col||l.row!==g.row)return!1;return l.button===g.button&&l.action===g.action&&l.ctrl===g.ctrl&&l.alt===g.alt&&l.shift===g.shift}};s.CoreMouseService=i=u([p(0,c.IBufferService),p(1,c.ICoreService)],i)},6975:function(E,s,a){var u=this&&this.__decorate||function(i,l,g,x){var y,w=arguments.length,v=w<3?l:x===null?x=Object.getOwnPropertyDescriptor(l,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(i,l,g,x);else for(var C=i.length-1;C>=0;C--)(y=i[C])&&(v=(w<3?y(v):w>3?y(l,g,v):y(l,g))||v);return w>3&&v&&Object.defineProperty(l,g,v),v},p=this&&this.__param||function(i,l){return function(g,x){l(g,x,i)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const c=a(1439),h=a(8460),m=a(844),S=a(2585),_=Object.freeze({insertMode:!1}),n=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let o=s.CoreService=class extends m.Disposable{constructor(i,l,g){super(),this._bufferService=i,this._logService=l,this._optionsService=g,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,c.clone)(_),this.decPrivateModes=(0,c.clone)(n)}reset(){this.modes=(0,c.clone)(_),this.decPrivateModes=(0,c.clone)(n)}triggerDataEvent(i,l=!1){if(this._optionsService.rawOptions.disableStdin)return;const g=this._bufferService.buffer;l&&this._optionsService.rawOptions.scrollOnUserInput&&g.ybase!==g.ydisp&&this._onRequestScrollToBottom.fire(),l&&this._onUserInput.fire(),this._logService.debug(`sending data "${i}"`,()=>i.split("").map(x=>x.charCodeAt(0))),this._onData.fire(i)}triggerBinaryEvent(i){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${i}"`,()=>i.split("").map(l=>l.charCodeAt(0))),this._onBinary.fire(i))}};s.CoreService=o=u([p(0,S.IBufferService),p(1,S.ILogService),p(2,S.IOptionsService)],o)},9074:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const u=a(8055),p=a(8460),c=a(844),h=a(6106);let m=0,S=0;class _ extends c.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(i=>i?.marker.line),this._onDecorationRegistered=this.register(new p.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new p.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,c.toDisposable)(()=>this.reset()))}registerDecoration(i){if(i.marker.isDisposed)return;const l=new n(i);if(l){const g=l.marker.onDispose(()=>l.dispose());l.onDispose(()=>{l&&(this._decorations.delete(l)&&this._onDecorationRemoved.fire(l),g.dispose())}),this._decorations.insert(l),this._onDecorationRegistered.fire(l)}return l}reset(){for(const i of this._decorations.values())i.dispose();this._decorations.clear()}*getDecorationsAtCell(i,l,g){let x=0,y=0;for(const w of this._decorations.getKeyIterator(l))x=w.options.x??0,y=x+(w.options.width??1),i>=x&&i<y&&(!g||(w.options.layer??"bottom")===g)&&(yield w)}forEachDecorationAtCell(i,l,g,x){this._decorations.forEachByKey(l,y=>{m=y.options.x??0,S=m+(y.options.width??1),i>=m&&i<S&&(!g||(y.options.layer??"bottom")===g)&&x(y)})}}s.DecorationService=_;class n extends c.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=u.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=u.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(i){super(),this.options=i,this.onRenderEmitter=this.register(new p.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new p.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=i.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const u=a(2585),p=a(8343);class c{constructor(...m){this._entries=new Map;for(const[S,_]of m)this.set(S,_)}set(m,S){const _=this._entries.get(m);return this._entries.set(m,S),_}forEach(m){for(const[S,_]of this._entries.entries())m(S,_)}has(m){return this._entries.has(m)}get(m){return this._entries.get(m)}}s.ServiceCollection=c,s.InstantiationService=class{constructor(){this._services=new c,this._services.set(u.IInstantiationService,this)}setService(h,m){this._services.set(h,m)}getService(h){return this._services.get(h)}createInstance(h,...m){const S=(0,p.getServiceDependencies)(h).sort((o,i)=>o.index-i.index),_=[];for(const o of S){const i=this._services.get(o.id);if(!i)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${o.id}.`);_.push(i)}const n=S.length>0?S[0].index:m.length;if(m.length!==n)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${n+1} conflicts with ${m.length} static arguments`);return new h(...m,..._)}}},7866:function(E,s,a){var u=this&&this.__decorate||function(n,o,i,l){var g,x=arguments.length,y=x<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,i):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,o,i,l);else for(var w=n.length-1;w>=0;w--)(g=n[w])&&(y=(x<3?g(y):x>3?g(o,i,y):g(o,i))||y);return x>3&&y&&Object.defineProperty(o,i,y),y},p=this&&this.__param||function(n,o){return function(i,l){o(i,l,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.traceCall=s.setTraceLogger=s.LogService=void 0;const c=a(844),h=a(2585),m={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let S,_=s.LogService=class extends c.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),S=this}_updateLogLevel(){this._logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let o=0;o<n.length;o++)typeof n[o]=="function"&&(n[o]=n[o]())}_log(n,o,i){this._evalLazyOptionalParams(i),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+o,...i)}trace(n,...o){this._logLevel<=h.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,n,o)}debug(n,...o){this._logLevel<=h.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,n,o)}info(n,...o){this._logLevel<=h.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,n,o)}warn(n,...o){this._logLevel<=h.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,n,o)}error(n,...o){this._logLevel<=h.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,n,o)}};s.LogService=_=u([p(0,h.IOptionsService)],_),s.setTraceLogger=function(n){S=n},s.traceCall=function(n,o,i){if(typeof i.value!="function")throw new Error("not supported");const l=i.value;i.value=function(...g){if(S.logLevel!==h.LogLevelEnum.TRACE)return l.apply(this,g);S.trace(`GlyphRenderer#${l.name}(${g.map(y=>JSON.stringify(y)).join(", ")})`);const x=l.apply(this,g);return S.trace(`GlyphRenderer#${l.name} return`,x),x}}},7302:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const u=a(8460),p=a(844),c=a(6114);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:c.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class m extends p.Disposable{constructor(_){super(),this._onOptionChange=this.register(new u.EventEmitter),this.onOptionChange=this._onOptionChange.event;const n={...s.DEFAULT_OPTIONS};for(const o in _)if(o in n)try{const i=_[o];n[o]=this._sanitizeAndValidateOption(o,i)}catch(i){console.error(i)}this.rawOptions=n,this.options={...n},this._setupOptions(),this.register((0,p.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(_,n){return this.onOptionChange(o=>{o===_&&n(this.rawOptions[_])})}onMultipleOptionChange(_,n){return this.onOptionChange(o=>{_.indexOf(o)!==-1&&n()})}_setupOptions(){const _=o=>{if(!(o in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);return this.rawOptions[o]},n=(o,i)=>{if(!(o in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${o}"`);i=this._sanitizeAndValidateOption(o,i),this.rawOptions[o]!==i&&(this.rawOptions[o]=i,this._onOptionChange.fire(o))};for(const o in this.rawOptions){const i={get:_.bind(this,o),set:n.bind(this,o)};Object.defineProperty(this.options,o,i)}}_sanitizeAndValidateOption(_,n){switch(_){case"cursorStyle":if(n||(n=s.DEFAULT_OPTIONS[_]),!function(o){return o==="block"||o==="underline"||o==="bar"}(n))throw new Error(`"${n}" is not a valid value for ${_}`);break;case"wordSeparator":n||(n=s.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof n=="number"&&1<=n&&n<=1e3)break;n=h.includes(n)?n:s.DEFAULT_OPTIONS[_];break;case"cursorWidth":n=Math.floor(n);case"lineHeight":case"tabStopWidth":if(n<1)throw new Error(`${_} cannot be less than 1, value: ${n}`);break;case"minimumContrastRatio":n=Math.max(1,Math.min(21,Math.round(10*n)/10));break;case"scrollback":if((n=Math.min(n,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${n}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(n<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${n}`);break;case"rows":case"cols":if(!n&&n!==0)throw new Error(`${_} must be numeric, value: ${n}`);break;case"windowsPty":n=n??{}}return n}}s.OptionsService=m},2660:function(E,s,a){var u=this&&this.__decorate||function(m,S,_,n){var o,i=arguments.length,l=i<3?S:n===null?n=Object.getOwnPropertyDescriptor(S,_):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(m,S,_,n);else for(var g=m.length-1;g>=0;g--)(o=m[g])&&(l=(i<3?o(l):i>3?o(S,_,l):o(S,_))||l);return i>3&&l&&Object.defineProperty(S,_,l),l},p=this&&this.__param||function(m,S){return function(_,n){S(_,n,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const c=a(2585);let h=s.OscLinkService=class{constructor(m){this._bufferService=m,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(m){const S=this._bufferService.buffer;if(m.id===void 0){const g=S.addMarker(S.ybase+S.y),x={data:m,id:this._nextId++,lines:[g]};return g.onDispose(()=>this._removeMarkerFromLink(x,g)),this._dataByLinkId.set(x.id,x),x.id}const _=m,n=this._getEntryIdKey(_),o=this._entriesWithId.get(n);if(o)return this.addLineToLink(o.id,S.ybase+S.y),o.id;const i=S.addMarker(S.ybase+S.y),l={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[i]};return i.onDispose(()=>this._removeMarkerFromLink(l,i)),this._entriesWithId.set(l.key,l),this._dataByLinkId.set(l.id,l),l.id}addLineToLink(m,S){const _=this._dataByLinkId.get(m);if(_&&_.lines.every(n=>n.line!==S)){const n=this._bufferService.buffer.addMarker(S);_.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(_,n))}}getLinkData(m){return this._dataByLinkId.get(m)?.data}_getEntryIdKey(m){return`${m.id};;${m.uri}`}_removeMarkerFromLink(m,S){const _=m.lines.indexOf(S);_!==-1&&(m.lines.splice(_,1),m.lines.length===0&&(m.data.id!==void 0&&this._entriesWithId.delete(m.key),this._dataByLinkId.delete(m.id)))}};s.OscLinkService=h=u([p(0,c.IBufferService)],h)},8343:(E,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0;const a="di$target",u="di$dependencies";s.serviceRegistry=new Map,s.getServiceDependencies=function(p){return p[u]||[]},s.createDecorator=function(p){if(s.serviceRegistry.has(p))return s.serviceRegistry.get(p);const c=function(h,m,S){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(_,n,o){n[a]===n?n[u].push({id:_,index:o}):(n[u]=[{id:_,index:o}],n[a]=n)})(c,h,S)};return c.toString=()=>p,s.serviceRegistry.set(p,c),c}},2585:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const u=a(8343);var p;s.IBufferService=(0,u.createDecorator)("BufferService"),s.ICoreMouseService=(0,u.createDecorator)("CoreMouseService"),s.ICoreService=(0,u.createDecorator)("CoreService"),s.ICharsetService=(0,u.createDecorator)("CharsetService"),s.IInstantiationService=(0,u.createDecorator)("InstantiationService"),function(c){c[c.TRACE=0]="TRACE",c[c.DEBUG=1]="DEBUG",c[c.INFO=2]="INFO",c[c.WARN=3]="WARN",c[c.ERROR=4]="ERROR",c[c.OFF=5]="OFF"}(p||(s.LogLevelEnum=p={})),s.ILogService=(0,u.createDecorator)("LogService"),s.IOptionsService=(0,u.createDecorator)("OptionsService"),s.IOscLinkService=(0,u.createDecorator)("OscLinkService"),s.IUnicodeService=(0,u.createDecorator)("UnicodeService"),s.IDecorationService=(0,u.createDecorator)("DecorationService")},1480:(E,s,a)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const u=a(8460),p=a(225);class c{static extractShouldJoin(m){return(1&m)!=0}static extractWidth(m){return m>>1&3}static extractCharKind(m){return m>>3}static createPropertyValue(m,S,_=!1){return(16777215&m)<<3|(3&S)<<1|(_?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new u.EventEmitter,this.onChange=this._onChange.event;const m=new p.UnicodeV6;this.register(m),this._active=m.version,this._activeProvider=m}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(m){if(!this._providers[m])throw new Error(`unknown Unicode version "${m}"`);this._active=m,this._activeProvider=this._providers[m],this._onChange.fire(m)}register(m){this._providers[m.version]=m}wcwidth(m){return this._activeProvider.wcwidth(m)}getStringCellWidth(m){let S=0,_=0;const n=m.length;for(let o=0;o<n;++o){let i=m.charCodeAt(o);if(55296<=i&&i<=56319){if(++o>=n)return S+this.wcwidth(i);const x=m.charCodeAt(o);56320<=x&&x<=57343?i=1024*(i-55296)+x-56320+65536:S+=this.wcwidth(x)}const l=this.charProperties(i,_);let g=c.extractWidth(l);c.extractShouldJoin(l)&&(g-=c.extractWidth(_)),S+=g,_=l}return S}charProperties(m,S){return this._activeProvider.charProperties(m,S)}}s.UnicodeService=c}},d={};function b(E){var s=d[E];if(s!==void 0)return s.exports;var a=d[E]={exports:{}};return t[E].call(a.exports,a,a.exports,b),a.exports}var k={};return(()=>{var E=k;Object.defineProperty(E,"__esModule",{value:!0}),E.Terminal=void 0;const s=b(9042),a=b(3236),u=b(844),p=b(5741),c=b(8285),h=b(7975),m=b(7090),S=["cols","rows"];class _ extends u.Disposable{constructor(o){super(),this._core=this.register(new a.Terminal(o)),this._addonManager=this.register(new p.AddonManager),this._publicOptions={...this._core.options};const i=g=>this._core.options[g],l=(g,x)=>{this._checkReadonlyOptions(g),this._core.options[g]=x};for(const g in this._core.options){const x={get:i.bind(this,g),set:l.bind(this,g)};Object.defineProperty(this._publicOptions,g,x)}}_checkReadonlyOptions(o){if(S.includes(o))throw new Error(`Option "${o}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new m.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new c.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const o=this._core.coreService.decPrivateModes;let i="none";switch(this._core.coreMouseService.activeProtocol){case"X10":i="x10";break;case"VT200":i="vt200";break;case"DRAG":i="drag";break;case"ANY":i="any"}return{applicationCursorKeysMode:o.applicationCursorKeys,applicationKeypadMode:o.applicationKeypad,bracketedPasteMode:o.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:i,originMode:o.origin,reverseWraparoundMode:o.reverseWraparound,sendFocusMode:o.sendFocus,wraparoundMode:o.wraparound}}get options(){return this._publicOptions}set options(o){for(const i in o)this._publicOptions[i]=o[i]}blur(){this._core.blur()}focus(){this._core.focus()}input(o,i=!0){this._core.input(o,i)}resize(o,i){this._verifyIntegers(o,i),this._core.resize(o,i)}open(o){this._core.open(o)}attachCustomKeyEventHandler(o){this._core.attachCustomKeyEventHandler(o)}attachCustomWheelEventHandler(o){this._core.attachCustomWheelEventHandler(o)}registerLinkProvider(o){return this._core.registerLinkProvider(o)}registerCharacterJoiner(o){return this._checkProposedApi(),this._core.registerCharacterJoiner(o)}deregisterCharacterJoiner(o){this._checkProposedApi(),this._core.deregisterCharacterJoiner(o)}registerMarker(o=0){return this._verifyIntegers(o),this._core.registerMarker(o)}registerDecoration(o){return this._checkProposedApi(),this._verifyPositiveIntegers(o.x??0,o.width??0,o.height??0),this._core.registerDecoration(o)}hasSelection(){return this._core.hasSelection()}select(o,i,l){this._verifyIntegers(o,i,l),this._core.select(o,i,l)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(o,i){this._verifyIntegers(o,i),this._core.selectLines(o,i)}dispose(){super.dispose()}scrollLines(o){this._verifyIntegers(o),this._core.scrollLines(o)}scrollPages(o){this._verifyIntegers(o),this._core.scrollPages(o)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(o){this._verifyIntegers(o),this._core.scrollToLine(o)}clear(){this._core.clear()}write(o,i){this._core.write(o,i)}writeln(o,i){this._core.write(o),this._core.write(`\r
`,i)}paste(o){this._core.paste(o)}refresh(o,i){this._verifyIntegers(o,i),this._core.refresh(o,i)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(o){this._addonManager.loadAddon(this,o)}static get strings(){return s}_verifyIntegers(...o){for(const i of o)if(i===1/0||isNaN(i)||i%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...o){for(const i of o)if(i&&(i===1/0||isNaN(i)||i%1!=0||i<0))throw new Error("This API only accepts positive integers")}}E.Terminal=_})(),k})())}(ns)),ns.exports}var cc=lc(),os={exports:{}},Cr;function hc(){return Cr||(Cr=1,function(r,e){(function(t,d){r.exports=d()})(self,()=>(()=>{var t={};return(()=>{var d=t;Object.defineProperty(d,"__esModule",{value:!0}),d.FitAddon=void 0,d.FitAddon=class{activate(b){this._terminal=b}dispose(){}fit(){const b=this.proposeDimensions();if(!b||!this._terminal||isNaN(b.cols)||isNaN(b.rows))return;const k=this._terminal._core;this._terminal.rows===b.rows&&this._terminal.cols===b.cols||(k._renderService.clear(),this._terminal.resize(b.cols,b.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const b=this._terminal._core,k=b._renderService.dimensions;if(k.css.cell.width===0||k.css.cell.height===0)return;const E=this._terminal.options.scrollback===0?0:b.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(s.getPropertyValue("height")),u=Math.max(0,parseInt(s.getPropertyValue("width"))),p=window.getComputedStyle(this._terminal.element),c=a-(parseInt(p.getPropertyValue("padding-top"))+parseInt(p.getPropertyValue("padding-bottom"))),h=u-(parseInt(p.getPropertyValue("padding-right"))+parseInt(p.getPropertyValue("padding-left")))-E;return{cols:Math.max(2,Math.floor(h/k.css.cell.width)),rows:Math.max(1,Math.floor(c/k.css.cell.height))}}}})(),t})())}(os)),os.exports}var dc=hc(),as={exports:{}},Er;function uc(){return Er||(Er=1,function(r,e){(function(t,d){r.exports=d()})(self,()=>(()=>{var t={6:(E,s)=>{function a(p){try{const c=new URL(p),h=c.password&&c.username?`${c.protocol}//${c.username}:${c.password}@${c.host}`:c.username?`${c.protocol}//${c.username}@${c.host}`:`${c.protocol}//${c.host}`;return p.toLocaleLowerCase().startsWith(h.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.LinkComputer=s.WebLinkProvider=void 0,s.WebLinkProvider=class{constructor(p,c,h,m={}){this._terminal=p,this._regex=c,this._handler=h,this._options=m}provideLinks(p,c){const h=u.computeLink(p,this._regex,this._terminal,this._handler);c(this._addCallbacks(h))}_addCallbacks(p){return p.map(c=>(c.leave=this._options.leave,c.hover=(h,m)=>{if(this._options.hover){const{range:S}=c;this._options.hover(h,m,S)}},c))}};class u{static computeLink(c,h,m,S){const _=new RegExp(h.source,(h.flags||"")+"g"),[n,o]=u._getWindowedLineStrings(c-1,m),i=n.join("");let l;const g=[];for(;l=_.exec(i);){const x=l[0];if(!a(x))continue;const[y,w]=u._mapStrIdx(m,o,0,l.index),[v,C]=u._mapStrIdx(m,y,w,x.length);if(y===-1||w===-1||v===-1||C===-1)continue;const T={start:{x:w+1,y:y+1},end:{x:C,y:v+1}};g.push({range:T,text:x,activate:S})}return g}static _getWindowedLineStrings(c,h){let m,S=c,_=c,n=0,o="";const i=[];if(m=h.buffer.active.getLine(c)){const l=m.translateToString(!0);if(m.isWrapped&&l[0]!==" "){for(n=0;(m=h.buffer.active.getLine(--S))&&n<2048&&(o=m.translateToString(!0),n+=o.length,i.push(o),m.isWrapped&&o.indexOf(" ")===-1););i.reverse()}for(i.push(l),n=0;(m=h.buffer.active.getLine(++_))&&m.isWrapped&&n<2048&&(o=m.translateToString(!0),n+=o.length,i.push(o),o.indexOf(" ")===-1););}return[i,S]}static _mapStrIdx(c,h,m,S){const _=c.buffer.active,n=_.getNullCell();let o=m;for(;S;){const i=_.getLine(h);if(!i)return[-1,-1];for(let l=o;l<i.length;++l){i.getCell(l,n);const g=n.getChars();if(n.getWidth()&&(S-=g.length||1,l===i.length-1&&g==="")){const x=_.getLine(h+1);x&&x.isWrapped&&(x.getCell(0,n),n.getWidth()===2&&(S+=1))}if(S<0)return[h,l]}h++,o=0}return[h,o]}}s.LinkComputer=u}},d={};function b(E){var s=d[E];if(s!==void 0)return s.exports;var a=d[E]={exports:{}};return t[E](a,a.exports,b),a.exports}var k={};return(()=>{var E=k;Object.defineProperty(E,"__esModule",{value:!0}),E.WebLinksAddon=void 0;const s=b(6),a=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function u(p,c){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=c}else console.warn("Opening link blocked as opener could not be cleared")}E.WebLinksAddon=class{constructor(p=u,c={}){this._handler=p,this._options=c}activate(p){this._terminal=p;const c=this._options,h=c.urlRegex||a;this._linkProvider=this._terminal.registerLinkProvider(new s.WebLinkProvider(this._terminal,h,this._handler,c))}dispose(){this._linkProvider?.dispose()}}})(),k})())}(as)),as.exports}var fc=uc();function pc({projectId:r="default"}){const[e,t]=P.useState(null),[d,b]=P.useState(null),[k,E]=P.useState(!1),s=P.useRef(null),a=P.useRef(null),u=P.useRef(null),p=P.useRef(null);me("terminal_session",h=>{h.sessionId===e&&(b(h),E(!1),h.status==="error"&&a.current&&a.current.write(`\r
\x1B[31mError: ${h.error||"Failed to start terminal"}\x1B[0m\r
`))}),me("terminal_data",h=>{h.sessionId===e&&a.current&&a.current.write(h.data)});const c=P.useCallback(()=>{u.current&&a.current&&setTimeout(()=>{if(u.current&&a.current)try{u.current.fit();const{cols:h,rows:m}=a.current;p.current&&clearTimeout(p.current),p.current=window.setTimeout(()=>{e&&de.resizeTerminal(e,h,m)},200)}catch(h){console.warn("Terminal resize error:",h)}},100)},[e]);return P.useEffect(()=>{if(!s.current||a.current)return;const h=new cc.Terminal({cursorBlink:!0,fontSize:13,fontFamily:"'JetBrains Mono', 'Consolas', 'Monaco', monospace",fontWeight:500,lineHeight:1.6,allowTransparency:!1,convertEol:!0,rows:24,cols:80,theme:{background:"hsl(var(--card))",foreground:"hsl(var(--foreground))",cursor:"hsl(var(--primary))",selectionBackground:"hsl(var(--primary) / 0.3)",black:"#000000",red:"hsl(var(--destructive))",green:"#13A10E",yellow:"#C19C00",blue:"hsl(var(--primary))",magenta:"hsl(var(--accent))",cyan:"#3A96DD",white:"hsl(var(--foreground))",brightBlack:"hsl(var(--muted-foreground))",brightRed:"hsl(var(--destructive))",brightGreen:"#16C60C",brightYellow:"#F9F1A5",brightBlue:"hsl(var(--primary))",brightMagenta:"hsl(var(--accent))",brightCyan:"#61D6D6",brightWhite:"hsl(var(--foreground))"},allowProposedApi:!0}),m=new dc.FitAddon,S=new fc.WebLinksAddon;return h.loadAddon(m),h.loadAddon(S),h.open(s.current),a.current=h,u.current=m,c(),h.write(`Welcome to Colony AI Terminal\r
`),h.write(`Connecting to server...\r
\r
`),h.onData(_=>{e&&d?.status==="running"&&de.sendTerminalData(e,_)}),h.onResize(({cols:_,rows:n})=>{e&&de.resizeTerminal(e,_,n)}),E(!0),de.createTerminalSession(r),()=>{e&&de.closeTerminal(e),h.dispose(),a.current=null,u.current=null}},[r]),me("terminal_session",h=>{h.projectId===r&&!e&&t(h.sessionId)}),P.useEffect(()=>{const h=new ResizeObserver(()=>{c()});return s.current&&h.observe(s.current),window.addEventListener("resize",c),()=>{h.disconnect(),window.removeEventListener("resize",c),p.current&&clearTimeout(p.current)}},[c]),f.jsx("div",{className:"h-full border border-border rounded-lg bg-card",children:f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Xo,{className:"h-4 w-4 text-primary"}),f.jsx("span",{className:"text-sm font-medium",children:"Terminal"}),k&&f.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[f.jsx(Ht,{className:"h-3 w-3 animate-spin"}),f.jsx("span",{className:"text-xs",children:"Initializing..."})]})]}),d&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`w-2 h-2 rounded-full ${d.status==="running"?"bg-green-500":d.status==="error"?"bg-red-500":"bg-yellow-500"}`}),f.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:d.status})]})]}),f.jsx("div",{ref:s,className:"flex-1 p-2",style:{backgroundColor:"hsl(var(--card))"}})]})})}function _c({messages:r,onSendMessage:e,onNewChat:t,currentPhase:d="spec",isConnected:b=!1,onMessagesUpdate:k,isLoading:E=!1,onLoadingChange:s,importedProject:a=[]}){const[u,p]=P.useState(!1),[c,h]=P.useState(!1),[m]=P.useState(42),[S]=P.useState(30),[_,n]=P.useState(null),o=()=>{p(!u)},i=()=>{h(!c)},l=(g,x,y)=>{x&&n({path:g,content:x,language:y})};return f.jsx("div",{className:"flex-1 flex flex-col",children:f.jsxs(ar,{direction:"horizontal",className:"flex-1",children:[f.jsx(vt,{defaultSize:m,minSize:u?5:25,maxSize:u?5:60,collapsible:!0,onCollapse:()=>p(!0),onExpand:()=>p(!1),children:f.jsxs("div",{className:"h-full flex flex-col bg-card",children:[f.jsx("div",{className:"flex-1 min-h-0 mb-6 mr-3",children:u?f.jsx("div",{className:"h-full flex items-center justify-center",children:f.jsx(ie,{variant:"ghost",size:"sm",onClick:o,className:"rotate-0 hover:rotate-12 transition-transform",children:f.jsx(Io,{className:"h-4 w-4"})})}):f.jsx(ec,{messages:r,onNewChat:t,isConnected:b,onMessagesUpdate:k,isLoading:E,onLoadingChange:s})}),!u&&f.jsx("div",{className:"flex-shrink-0 px-6 pb-6",style:{height:"16.67vh"},children:f.jsx(tc,{onSendMessage:e,isLoading:E,disabled:!b})})]})}),f.jsx(lr,{withHandle:!0}),f.jsx(vt,{defaultSize:100-m,children:f.jsx("div",{className:"h-full flex flex-col",children:f.jsxs("div",{className:"flex-1 min-h-0",children:[f.jsxs(ar,{direction:"vertical",children:[f.jsx(vt,{defaultSize:c?100:100-S,minSize:c?100:40,children:f.jsxs("div",{className:"h-full flex",children:[f.jsx("div",{className:"w-64 h-full border border-border rounded-l-lg bg-card",children:f.jsx(rc,{onFileSelect:l,importedProject:a})}),f.jsx("div",{className:"flex-1 h-full border-t border-r border-b border-border rounded-r-lg bg-black",children:f.jsx(ac,{currentPhase:d,selectedFile:_})})]})}),!c&&f.jsxs(f.Fragment,{children:[f.jsx(lr,{withHandle:!0}),f.jsx(vt,{defaultSize:S,minSize:15,maxSize:60,collapsible:!0,onCollapse:()=>h(!0),children:f.jsx("div",{className:"h-full",children:f.jsx(pc,{})})})]})]}),c&&f.jsx("div",{className:"absolute bottom-3 left-1/2 transform -translate-x-1/2",children:f.jsxs(ie,{variant:"outline",size:"sm",onClick:i,className:"bg-background/80 backdrop-blur-sm border-border/50 hover:bg-background/90",children:[f.jsx(Mo,{className:"h-4 w-4 mr-2"}),"Terminal"]})})]})})})]})})}function ys({className:r,type:e,...t}){return f.jsx("input",{type:e,"data-slot":"input",className:te("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...t})}var ls={exports:{}},cs={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kr;function mc(){if(kr)return cs;kr=1;var r=Hn();function e(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var t=typeof Object.is=="function"?Object.is:e,d=r.useState,b=r.useEffect,k=r.useLayoutEffect,E=r.useDebugValue;function s(c,h){var m=h(),S=d({inst:{value:m,getSnapshot:h}}),_=S[0].inst,n=S[1];return k(function(){_.value=m,_.getSnapshot=h,a(_)&&n({inst:_})},[c,m,h]),b(function(){return a(_)&&n({inst:_}),c(function(){a(_)&&n({inst:_})})},[c]),E(m),m}function a(c){var h=c.getSnapshot;c=c.value;try{var m=h();return!t(c,m)}catch{return!0}}function u(c,h){return h()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:s;return cs.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:p,cs}var Rr;function gc(){return Rr||(Rr=1,ls.exports=mc()),ls.exports}var vc=gc();function Sc(){return vc.useSyncExternalStore(bc,()=>!0,()=>!1)}function bc(){return()=>{}}var Vs="Avatar",[yc,Mh]=Nt(Vs),[xc,Fi]=yc(Vs),zi=P.forwardRef((r,e)=>{const{__scopeAvatar:t,...d}=r,[b,k]=P.useState("idle");return f.jsx(xc,{scope:t,imageLoadingStatus:b,onImageLoadingStatusChange:k,children:f.jsx(ue.span,{...d,ref:e})})});zi.displayName=Vs;var $i="AvatarImage",wc=P.forwardRef((r,e)=>{const{__scopeAvatar:t,src:d,onLoadingStatusChange:b=()=>{},...k}=r,E=Fi($i,t),s=Cc(d,k),a=Pe(u=>{b(u),E.onImageLoadingStatusChange(u)});return Lt(()=>{s!=="idle"&&a(s)},[s,a]),s==="loaded"?f.jsx(ue.img,{...k,ref:e,src:d}):null});wc.displayName=$i;var Wi="AvatarFallback",Ui=P.forwardRef((r,e)=>{const{__scopeAvatar:t,delayMs:d,...b}=r,k=Fi(Wi,t),[E,s]=P.useState(d===void 0);return P.useEffect(()=>{if(d!==void 0){const a=window.setTimeout(()=>s(!0),d);return()=>window.clearTimeout(a)}},[d]),E&&k.imageLoadingStatus!=="loaded"?f.jsx(ue.span,{...b,ref:e}):null});Ui.displayName=Wi;function Lr(r,e){return r?e?(r.src!==e&&(r.src=e),r.complete&&r.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Cc(r,{referrerPolicy:e,crossOrigin:t}){const d=Sc(),b=P.useRef(null),k=d?(b.current||(b.current=new window.Image),b.current):null,[E,s]=P.useState(()=>Lr(k,r));return Lt(()=>{s(Lr(k,r))},[k,r]),Lt(()=>{const a=c=>()=>{s(c)};if(!k)return;const u=a("loaded"),p=a("error");return k.addEventListener("load",u),k.addEventListener("error",p),e&&(k.referrerPolicy=e),typeof t=="string"&&(k.crossOrigin=t),()=>{k.removeEventListener("load",u),k.removeEventListener("error",p)}},[k,t,e]),E}var Ec=zi,kc=Ui;function Rc({className:r,...e}){return f.jsx(Ec,{"data-slot":"avatar",className:te("relative flex size-10 shrink-0 overflow-hidden rounded-full",r),...e})}function Lc({className:r,...e}){return f.jsx(kc,{"data-slot":"avatar-fallback",className:te("bg-muted flex size-full items-center justify-center rounded-full",r),...e})}function Ac({isOpen:r,onClose:e}){const[t,d]=P.useState(""),[b]=P.useState([{id:"1",title:"React Component Development",lastMessage:"Create a React component for a todo list",timestamp:"2 hours ago",messageCount:12,isStarred:!0},{id:"2",title:"Python Data Validation",lastMessage:"Generate a Python function for data validation",timestamp:"1 day ago",messageCount:8},{id:"3",title:"JavaScript Debugging",lastMessage:"Help me debug this JavaScript error",timestamp:"2 days ago",messageCount:15,isStarred:!0},{id:"4",title:"CSS Animation",lastMessage:"Create a CSS animation for loading spinner",timestamp:"1 week ago",messageCount:6},{id:"5",title:"API Integration",lastMessage:"Help with REST API integration",timestamp:"1 week ago",messageCount:10}]),[k]=P.useState([{id:"6",title:"Database Schema Design",lastMessage:"Design a database schema for user management",timestamp:"3 hours ago",messageCount:7},{id:"7",title:"TypeScript Types",lastMessage:"Create TypeScript interfaces for API responses",timestamp:"5 hours ago",messageCount:4},{id:"8",title:"Authentication System",lastMessage:"Implement JWT authentication in Node.js",timestamp:"6 hours ago",messageCount:18}]),E=b.filter(s=>s.isStarred);return r?f.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[f.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e}),f.jsxs("div",{className:"relative w-80 h-full bg-card/95 backdrop-blur-sm border-r border-border/50 shadow-2xl",children:[f.jsxs("div",{className:"p-4 border-b border-border/50 bg-gradient-to-r from-card to-card/80",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Rc,{className:"h-8 w-8",children:f.jsx(Lc,{className:"bg-primary/20 text-primary border border-primary/30",children:"CA"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-sm",children:"Chat History"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Colony AI"})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ie,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:f.jsx(Ms,{className:"h-4 w-4"})}),f.jsx(ie,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e,children:f.jsx(pt,{className:"h-4 w-4"})})]})]}),f.jsxs("div",{className:"relative",children:[f.jsx(Wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),f.jsx(ys,{placeholder:"Search conversations...",value:t,onChange:s=>d(s.target.value),className:"pl-10 bg-input-background/50 border-border/50 focus:border-primary/50 focus:bg-input-background/80"})]})]}),f.jsx("div",{className:"p-4 border-b border-border/50",children:f.jsxs("div",{className:"space-y-2",children:[f.jsxs(ie,{variant:"secondary",className:"w-full justify-start gap-2 bg-primary/10 hover:bg-primary/20 border-primary/20",children:[f.jsx(Do,{className:"h-4 w-4"}),"Conversations",f.jsx(Ve,{variant:"secondary",className:"ml-auto bg-primary/20 text-primary",children:b.length})]}),f.jsxs(ie,{variant:"ghost",className:"w-full justify-start gap-2 hover:bg-secondary/50",children:[f.jsx(Yt,{className:"h-4 w-4"}),"Starred",f.jsx(Ve,{variant:"secondary",className:"ml-auto",children:E.length})]}),f.jsxs(ie,{variant:"ghost",className:"w-full justify-start gap-2 hover:bg-secondary/50",children:[f.jsx(zr,{className:"h-4 w-4"}),"Recent",f.jsx(Ve,{variant:"secondary",className:"ml-auto",children:k.length})]})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto",children:[E.length>0&&f.jsxs("div",{className:"p-4 border-b border-border/50",children:[f.jsx("h4",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Starred"}),f.jsx("div",{className:"space-y-2",children:E.map(s=>f.jsxs("div",{className:"p-3 rounded-lg bg-gradient-to-r from-secondary/30 to-secondary/10 hover:from-secondary/50 hover:to-secondary/20 cursor-pointer transition-all duration-200 border border-border/30 hover:border-primary/30",children:[f.jsx("div",{className:"flex items-start justify-between mb-2",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Yt,{className:"h-3 w-3 text-yellow-400 fill-yellow-400"}),f.jsx("p",{className:"font-medium text-sm line-clamp-1",children:s.title})]})}),f.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-2",children:s.lastMessage}),f.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[f.jsxs("span",{children:[s.messageCount," messages"]}),f.jsx("span",{children:s.timestamp})]})]},s.id))})]}),f.jsxs("div",{className:"p-4",children:[f.jsx("h4",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Recent Conversations"}),f.jsx("div",{className:"space-y-2",children:b.map(s=>f.jsxs("div",{className:"p-3 rounded-lg bg-secondary/10 hover:bg-secondary/20 cursor-pointer transition-all duration-200 border border-transparent hover:border-border/50",children:[f.jsxs("div",{className:"flex items-start justify-between mb-2",children:[f.jsx("p",{className:"font-medium text-sm line-clamp-1",children:s.title}),s.isStarred&&f.jsx(Yt,{className:"h-3 w-3 text-yellow-400 fill-yellow-400"})]}),f.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-2",children:s.lastMessage}),f.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[f.jsxs("span",{children:[s.messageCount," messages"]}),f.jsx("span",{children:s.timestamp})]})]},s.id))})]})]})]})]}):null}function Dc({currentPhase:r,progress:e}){const[t,d]=P.useState(r||"spec"),[b,k]=P.useState(e||0),[E,s]=P.useState(0),[a,u]=P.useState(null);me("wave_progress",h=>{d(h.phase),k(h.progress),h.message&&(u(h.message),setTimeout(()=>u(null),3e3))}),P.useEffect(()=>{r!==void 0&&d(r),e!==void 0&&k(e)},[r,e]),P.useEffect(()=>{const h=setTimeout(()=>{s(b)},100);return()=>clearTimeout(h)},[b]);const p=()=>{switch(t){case"spec":return"#3B82F6";case"test":return"#F59E0B";case"impl":return"#8B5CF6";default:return"#3B82F6"}},c=()=>{switch(t){case"spec":return"rgba(59, 130, 246, 0.4)";case"test":return"rgba(245, 158, 11, 0.4)";case"impl":return"rgba(139, 92, 246, 0.4)";default:return"rgba(59, 130, 246, 0.4)"}};return f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"absolute -top-6 left-0 right-0 flex justify-between text-xs text-muted-foreground px-4",children:[f.jsx("span",{className:`transition-colors ${t==="spec"?"text-blue-400 font-medium":""}`,children:"Spec"}),f.jsx("span",{className:`transition-colors ${t==="test"?"text-amber-400 font-medium":""}`,children:"Test"}),f.jsx("span",{className:`transition-colors ${t==="impl"?"text-violet-400 font-medium":""}`,children:"Impl"})]}),f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-border/30 overflow-hidden",children:f.jsx("div",{className:"h-full transition-all duration-1000 ease-out relative",style:{width:`${E}%`,backgroundColor:p(),boxShadow:`0 0 8px ${c()}`},children:f.jsx("div",{className:"absolute top-0 left-0 h-full w-8 opacity-60 wave-shimmer",style:{background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent)",animation:"shimmer 2s linear infinite"}})})}),a&&f.jsx("div",{className:"absolute -bottom-8 left-4 text-xs text-muted-foreground animate-fade-in",children:a})]})}function Tc({...r}){return f.jsx(vn,{"data-slot":"select",...r})}function rt({...r}){return f.jsx(En,{"data-slot":"select-group",...r})}function Pc({...r}){return f.jsx(yn,{"data-slot":"select-value",...r})}function Mc({className:r,size:e="default",children:t,...d}){return f.jsxs(Sn,{"data-slot":"select-trigger","data-size":e,className:te("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...d,children:[t,f.jsx(bn,{asChild:!0,children:f.jsx(jt,{className:"size-4 opacity-50"})})]})}function Bc({className:r,children:e,position:t="popper",...d}){return f.jsx(xn,{children:f.jsxs(wn,{"data-slot":"select-content",className:te("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...d,children:[f.jsx(Ic,{}),f.jsx(Cn,{className:te("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:e}),f.jsx(Nc,{})]})})}function it({className:r,...e}){return f.jsx(kn,{"data-slot":"select-label",className:te("text-muted-foreground px-2 py-1.5 text-xs",r),...e})}function nt({className:r,children:e,...t}){return f.jsxs(Rn,{"data-slot":"select-item",className:te("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",r),...t,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(Ln,{children:f.jsx(je,{className:"size-4"})})}),f.jsx(An,{children:e})]})}function Ic({className:r,...e}){return f.jsx(Dn,{"data-slot":"select-scroll-up-button",className:te("flex cursor-default items-center justify-center py-1",r),...e,children:f.jsx(eo,{className:"size-4"})})}function Nc({className:r,...e}){return f.jsx(Tn,{"data-slot":"select-scroll-down-button",className:te("flex cursor-default items-center justify-center py-1",r),...e,children:f.jsx(jt,{className:"size-4"})})}var Oc="Label",qi=P.forwardRef((r,e)=>f.jsx(ue.label,{...r,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(r.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));qi.displayName=Oc;var jc=qi;function ot({className:r,...e}){return f.jsx(jc,{"data-slot":"label",className:te("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...e})}function xs({...r}){return f.jsx(Mr,{"data-slot":"dialog",...r})}function Hc({...r}){return f.jsx(Or,{"data-slot":"dialog-portal",...r})}function Fc({className:r,...e}){return f.jsx(jr,{"data-slot":"dialog-overlay",className:te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",r),...e})}function ws({className:r,children:e,...t}){return f.jsxs(Hc,{"data-slot":"dialog-portal",children:[f.jsx(Fc,{}),f.jsxs(Br,{"data-slot":"dialog-content",className:te("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",r),...t,children:[e,f.jsxs(Ir,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(pt,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Cs({className:r,...e}){return f.jsx("div",{"data-slot":"dialog-header",className:te("flex flex-col gap-2 text-center sm:text-left",r),...e})}function Es({className:r,...e}){return f.jsx(Nr,{"data-slot":"dialog-title",className:te("text-lg leading-none font-semibold",r),...e})}function ks({className:r,...e}){return f.jsx(Pn,{"data-slot":"dialog-description",className:te("text-muted-foreground text-sm",r),...e})}var Ki=["PageUp","PageDown"],Vi=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Gi={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Je="Slider",[Rs,zc,$c]=Bn(Je),[Xi,Bh]=Nt(Je,[$c]),[Wc,Gt]=Xi(Je),Yi=P.forwardRef((r,e)=>{const{name:t,min:d=0,max:b=100,step:k=1,orientation:E="horizontal",disabled:s=!1,minStepsBetweenThumbs:a=0,defaultValue:u=[d],value:p,onValueChange:c=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:S,..._}=r,n=P.useRef(new Set),o=P.useRef(0),l=E==="horizontal"?Uc:qc,[g=[],x]=Mn({prop:p,defaultProp:u,onChange:A=>{[...n.current][o.current]?.focus(),c(A)}}),y=P.useRef(g);function w(A){const B=Yc(g,A);T(A,B)}function v(A){T(A,o.current)}function C(){const A=y.current[o.current];g[o.current]!==A&&h(g)}function T(A,B,{commit:D}={commit:!1}){const j=eh(k),z=th(Math.round((A-d)/k)*k+d,j),U=Ts(z,[d,b]);x((X=[])=>{const q=Gc(X,U,B);if(Qc(q,a*k)){o.current=q.indexOf(U);const R=String(q)!==String(X);return R&&D&&h(q),R?q:X}else return X})}return f.jsx(Wc,{scope:r.__scopeSlider,name:t,disabled:s,min:d,max:b,valueIndexToChangeRef:o,thumbs:n.current,values:g,orientation:E,form:S,children:f.jsx(Rs.Provider,{scope:r.__scopeSlider,children:f.jsx(Rs.Slot,{scope:r.__scopeSlider,children:f.jsx(l,{"aria-disabled":s,"data-disabled":s?"":void 0,..._,ref:e,onPointerDown:ge(_.onPointerDown,()=>{s||(y.current=g)}),min:d,max:b,inverted:m,onSlideStart:s?void 0:w,onSlideMove:s?void 0:v,onSlideEnd:s?void 0:C,onHomeKeyDown:()=>!s&&T(d,0,{commit:!0}),onEndKeyDown:()=>!s&&T(b,g.length-1,{commit:!0}),onStepKeyDown:({event:A,direction:B})=>{if(!s){const z=Ki.includes(A.key)||A.shiftKey&&Vi.includes(A.key)?10:1,U=o.current,X=g[U],q=k*z*B;T(X+q,U,{commit:!0})}}})})})})});Yi.displayName=Je;var[Ji,Zi]=Xi(Je,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Uc=P.forwardRef((r,e)=>{const{min:t,max:d,dir:b,inverted:k,onSlideStart:E,onSlideMove:s,onSlideEnd:a,onStepKeyDown:u,...p}=r,[c,h]=P.useState(null),m=Se(e,l=>h(l)),S=P.useRef(void 0),_=Pr(b),n=_==="ltr",o=n&&!k||!n&&k;function i(l){const g=S.current||c.getBoundingClientRect(),x=[0,g.width],w=Gs(x,o?[t,d]:[d,t]);return S.current=g,w(l-g.left)}return f.jsx(Ji,{scope:r.__scopeSlider,startEdge:o?"left":"right",endEdge:o?"right":"left",direction:o?1:-1,size:"width",children:f.jsx(Qi,{dir:_,"data-orientation":"horizontal",...p,ref:m,style:{...p.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:l=>{const g=i(l.clientX);E?.(g)},onSlideMove:l=>{const g=i(l.clientX);s?.(g)},onSlideEnd:()=>{S.current=void 0,a?.()},onStepKeyDown:l=>{const x=Gi[o?"from-left":"from-right"].includes(l.key);u?.({event:l,direction:x?-1:1})}})})}),qc=P.forwardRef((r,e)=>{const{min:t,max:d,inverted:b,onSlideStart:k,onSlideMove:E,onSlideEnd:s,onStepKeyDown:a,...u}=r,p=P.useRef(null),c=Se(e,p),h=P.useRef(void 0),m=!b;function S(_){const n=h.current||p.current.getBoundingClientRect(),o=[0,n.height],l=Gs(o,m?[d,t]:[t,d]);return h.current=n,l(_-n.top)}return f.jsx(Ji,{scope:r.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(Qi,{"data-orientation":"vertical",...u,ref:c,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:_=>{const n=S(_.clientY);k?.(n)},onSlideMove:_=>{const n=S(_.clientY);E?.(n)},onSlideEnd:()=>{h.current=void 0,s?.()},onStepKeyDown:_=>{const o=Gi[m?"from-bottom":"from-top"].includes(_.key);a?.({event:_,direction:o?-1:1})}})})}),Qi=P.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:d,onSlideMove:b,onSlideEnd:k,onHomeKeyDown:E,onEndKeyDown:s,onStepKeyDown:a,...u}=r,p=Gt(Je,t);return f.jsx(ue.span,{...u,ref:e,onKeyDown:ge(r.onKeyDown,c=>{c.key==="Home"?(E(c),c.preventDefault()):c.key==="End"?(s(c),c.preventDefault()):Ki.concat(Vi).includes(c.key)&&(a(c),c.preventDefault())}),onPointerDown:ge(r.onPointerDown,c=>{const h=c.target;h.setPointerCapture(c.pointerId),c.preventDefault(),p.thumbs.has(h)?h.focus():d(c)}),onPointerMove:ge(r.onPointerMove,c=>{c.target.hasPointerCapture(c.pointerId)&&b(c)}),onPointerUp:ge(r.onPointerUp,c=>{const h=c.target;h.hasPointerCapture(c.pointerId)&&(h.releasePointerCapture(c.pointerId),k(c))})})}),en="SliderTrack",tn=P.forwardRef((r,e)=>{const{__scopeSlider:t,...d}=r,b=Gt(en,t);return f.jsx(ue.span,{"data-disabled":b.disabled?"":void 0,"data-orientation":b.orientation,...d,ref:e})});tn.displayName=en;var Ls="SliderRange",sn=P.forwardRef((r,e)=>{const{__scopeSlider:t,...d}=r,b=Gt(Ls,t),k=Zi(Ls,t),E=P.useRef(null),s=Se(e,E),a=b.values.length,u=b.values.map(h=>on(h,b.min,b.max)),p=a>1?Math.min(...u):0,c=100-Math.max(...u);return f.jsx(ue.span,{"data-orientation":b.orientation,"data-disabled":b.disabled?"":void 0,...d,ref:s,style:{...r.style,[k.startEdge]:p+"%",[k.endEdge]:c+"%"}})});sn.displayName=Ls;var As="SliderThumb",rn=P.forwardRef((r,e)=>{const t=zc(r.__scopeSlider),[d,b]=P.useState(null),k=Se(e,s=>b(s)),E=P.useMemo(()=>d?t().findIndex(s=>s.ref.current===d):-1,[t,d]);return f.jsx(Kc,{...r,ref:k,index:E})}),Kc=P.forwardRef((r,e)=>{const{__scopeSlider:t,index:d,name:b,...k}=r,E=Gt(As,t),s=Zi(As,t),[a,u]=P.useState(null),p=Se(e,i=>u(i)),c=a?E.form||!!a.closest("form"):!0,h=In(a),m=E.values[d],S=m===void 0?0:on(m,E.min,E.max),_=Xc(d,E.values.length),n=h?.[s.size],o=n?Jc(n,S,s.direction):0;return P.useEffect(()=>{if(a)return E.thumbs.add(a),()=>{E.thumbs.delete(a)}},[a,E.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[s.startEdge]:`calc(${S}% + ${o}px)`},children:[f.jsx(Rs.ItemSlot,{scope:r.__scopeSlider,children:f.jsx(ue.span,{role:"slider","aria-label":r["aria-label"]||_,"aria-valuemin":E.min,"aria-valuenow":m,"aria-valuemax":E.max,"aria-orientation":E.orientation,"data-orientation":E.orientation,"data-disabled":E.disabled?"":void 0,tabIndex:E.disabled?void 0:0,...k,ref:p,style:m===void 0?{display:"none"}:r.style,onFocus:ge(r.onFocus,()=>{E.valueIndexToChangeRef.current=d})})}),c&&f.jsx(nn,{name:b??(E.name?E.name+(E.values.length>1?"[]":""):void 0),form:E.form,value:m},d)]})});rn.displayName=As;var Vc="RadioBubbleInput",nn=P.forwardRef(({__scopeSlider:r,value:e,...t},d)=>{const b=P.useRef(null),k=Se(b,d),E=Nn(e);return P.useEffect(()=>{const s=b.current;if(!s)return;const a=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(a,"value").set;if(E!==e&&p){const c=new Event("input",{bubbles:!0});p.call(s,e),s.dispatchEvent(c)}},[E,e]),f.jsx(ue.input,{style:{display:"none"},...t,ref:k,defaultValue:e})});nn.displayName=Vc;function Gc(r=[],e,t){const d=[...r];return d[t]=e,d.sort((b,k)=>b-k)}function on(r,e,t){const k=100/(t-e)*(r-e);return Ts(k,[0,100])}function Xc(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function Yc(r,e){if(r.length===1)return 0;const t=r.map(b=>Math.abs(b-e)),d=Math.min(...t);return t.indexOf(d)}function Jc(r,e,t){const d=r/2,k=Gs([0,50],[0,d]);return(d-k(e)*t)*t}function Zc(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function Qc(r,e){if(e>0){const t=Zc(r);return Math.min(...t)>=e}return!0}function Gs(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const d=(e[1]-e[0])/(r[1]-r[0]);return e[0]+d*(t-r[0])}}function eh(r){return(String(r).split(".")[1]||"").length}function th(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var sh=Yi,rh=tn,ih=sn,nh=rn;function oh({className:r,defaultValue:e,value:t,min:d=0,max:b=100,...k}){const E=P.useMemo(()=>Array.isArray(t)?t:Array.isArray(e)?e:[d,b],[t,e,d,b]);return f.jsxs(sh,{"data-slot":"slider",defaultValue:e,value:t,min:d,max:b,className:te("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",r),...k,children:[f.jsx(rh,{"data-slot":"slider-track",className:te("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(ih,{"data-slot":"slider-range",className:te("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:E.length},(s,a)=>f.jsx(nh,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},a))]})}const Bt={"gpt-4o":{id:"gpt-4o",name:"GPT-4o",provider:"openai",contextWindow:128e3,description:"OpenAI GPT-4 Optimized - Fast and efficient",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!0},"gpt-4.1":{id:"gpt-4.1",name:"GPT-4.1",provider:"openai",contextWindow:128e3,description:"OpenAI GPT-4.1 - Latest improvements",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!0},o3:{id:"o3",name:"O3",provider:"openai",contextWindow:1e5,description:"OpenAI O3 - Advanced reasoning model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"o3-pro":{id:"o3-pro",name:"O3 Pro",provider:"openai",contextWindow:1e5,description:"OpenAI O3 Pro - Enhanced reasoning capabilities",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-sonnet-4":{id:"claude-sonnet-4",name:"Claude Sonnet 4",provider:"anthropic",contextWindow:2e5,description:"Claude Sonnet 4 - Enhanced reasoning and coding",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-opus-4":{id:"claude-opus-4",name:"Claude Opus 4",provider:"anthropic",contextWindow:2e5,description:"Claude Opus 4 - Most powerful Claude model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-3.7-sonnet":{id:"claude-3.7-sonnet",name:"Claude 3.7 Sonnet",provider:"anthropic",contextWindow:2e5,description:"Claude 3.7 Sonnet - Hybrid reasoning model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"claude-3.5-sonnet":{id:"claude-3.5-sonnet",name:"Claude 3.5 Sonnet",provider:"anthropic",contextWindow:2e5,description:"Claude 3.5 Sonnet - Balanced performance",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"gemini-2.5-flash":{id:"gemini-2.5-flash",name:"Gemini 2.5 Flash",provider:"google",contextWindow:1e5,description:"Google Gemini 2.5 Flash - Fast and efficient",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"gemini-2.5-pro":{id:"gemini-2.5-pro",name:"Gemini 2.5 Pro",provider:"google",contextWindow:1e5,description:"Google Gemini 2.5 Pro - Powerful reasoning",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"deepseek-v3":{id:"deepseek-v3",name:"DeepSeek V3",provider:"deepseek",contextWindow:65536,description:"DeepSeek V3 - General purpose model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"deepseek-r1":{id:"deepseek-r1",name:"DeepSeek R1",provider:"deepseek",contextWindow:65536,description:"DeepSeek R1 - Reasoning model",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"grok-3":{id:"grok-3",name:"Grok 3",provider:"xai",contextWindow:1e5,description:"xAI Grok 3 - Flagship model for enterprise tasks",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1},"grok-3-mini":{id:"grok-3-mini",name:"Grok 3 Mini",provider:"xai",contextWindow:1e5,description:"xAI Grok 3 Mini - Lightweight for math and quantitative tasks",requiresApiKey:!0,supportsStreaming:!0,supportsStructuredOutput:!1}};function at(r){return Object.values(Bt).filter(e=>e.provider===r)}function ah(r){const e=Bt[r];return e?.requiresApiKey?e.provider:null}function lh(r){return r.trim().length>20}function ch(){return{model:"gpt-4o",temperature:.7,maxTokens:1e3,apiKeys:{}}}const Ge={MODEL:"hma_llm_selected_model",TEMPERATURE:"hma_llm_temperature",MAX_TOKENS:"hma_llm_max_tokens"};function an(){try{const r=localStorage.getItem(Ge.MODEL),e=localStorage.getItem(Ge.TEMPERATURE),t=localStorage.getItem(Ge.MAX_TOKENS);return{model:r||void 0,temperature:e?parseFloat(e):void 0,maxTokens:t?parseInt(t,10):void 0}}catch{return{}}}function Ds(r){try{r.model&&localStorage.setItem(Ge.MODEL,r.model),r.temperature!==void 0&&localStorage.setItem(Ge.TEMPERATURE,r.temperature.toString()),r.maxTokens!==void 0&&localStorage.setItem(Ge.MAX_TOKENS,r.maxTokens.toString())}catch(e){console.error("Failed to save LLM preferences:",e)}}function hh({onConfigChange:r,className:e}){const[t,d]=P.useState("gpt-4o"),[b,k]=P.useState(.7),[E,s]=P.useState(1e3),[a,u]=P.useState({}),[p,c]=P.useState(!1),[h,m]=P.useState(!1),[S,_]=P.useState(null),[n,o]=P.useState(""),[i,l]=P.useState("");P.useEffect(()=>{const C=an();C.model&&Bt[C.model]&&d(C.model),C.temperature!==void 0&&k(C.temperature),C.maxTokens!==void 0&&s(C.maxTokens)},[]);const g=C=>{d(C),Ds({model:C});const T=ah(C);T&&!a[T]?(_(T),m(!0)):x(C)},x=C=>{const T={model:C||t,temperature:b,maxTokens:E,apiKeys:a};Ds(T),de.configureLLM(T),r?.(T)},y=()=>{if(!S)return;if(!lh(n)){l("Please enter a valid API key");return}const C={...a,[S]:n};u(C),de.setApiKey(S,n),o(""),l(""),m(!1),_(null),x()},w={openai:at("openai"),anthropic:at("anthropic"),google:at("google"),deepseek:at("deepseek"),xai:at("xai")},v=Bt[t];return f.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[f.jsxs(Tc,{value:t,onValueChange:g,children:[f.jsx(Mc,{className:"w-[240px]",children:f.jsx(Pc,{placeholder:"Select a model"})}),f.jsxs(Bc,{children:[w.openai.length>0&&f.jsxs(rt,{children:[f.jsx(it,{children:"OpenAI"}),w.openai.map(C=>f.jsx(nt,{value:C.id,children:f.jsxs("div",{className:"flex items-center justify-between w-full",children:[f.jsx("span",{children:C.name}),a.openai&&f.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.anthropic.length>0&&f.jsxs(rt,{children:[f.jsx(it,{children:"Anthropic"}),w.anthropic.map(C=>f.jsx(nt,{value:C.id,children:f.jsxs("div",{className:"flex items-center justify-between w-full",children:[f.jsx("span",{children:C.name}),a.anthropic&&f.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.google.length>0&&f.jsxs(rt,{children:[f.jsx(it,{children:"Google"}),w.google.map(C=>f.jsx(nt,{value:C.id,children:f.jsxs("div",{className:"flex items-center justify-between w-full",children:[f.jsx("span",{children:C.name}),a.google&&f.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.deepseek.length>0&&f.jsxs(rt,{children:[f.jsx(it,{children:"DeepSeek"}),w.deepseek.map(C=>f.jsx(nt,{value:C.id,children:f.jsxs("div",{className:"flex items-center justify-between w-full",children:[f.jsx("span",{children:C.name}),a.deepseek&&f.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]}),w.xai.length>0&&f.jsxs(rt,{children:[f.jsx(it,{children:"xAI"}),w.xai.map(C=>f.jsx(nt,{value:C.id,children:f.jsxs("div",{className:"flex items-center justify-between w-full",children:[f.jsx("span",{children:C.name}),a.xai&&f.jsx(je,{className:"h-3 w-3 ml-2 text-green-500"})]})},C.id))]})]})]}),f.jsx(ie,{variant:"outline",size:"icon",onClick:()=>c(!0),title:"Model Settings",children:f.jsx(Ms,{className:"h-4 w-4"})}),f.jsx(xs,{open:p,onOpenChange:c,children:f.jsxs(ws,{className:"sm:max-w-[425px]",children:[f.jsxs(Cs,{children:[f.jsx(Es,{children:"Model Settings"}),f.jsxs(ks,{children:["Configure parameters for ",v?.name||"the selected model"]})]}),f.jsxs("div",{className:"space-y-4 py-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(ot,{children:"Current Model"}),f.jsxs("div",{className:"p-3 border rounded-lg bg-card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"font-medium",children:v?.name}),f.jsx(Ve,{variant:"secondary",children:v?.provider})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:v?.description}),f.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[f.jsxs("span",{children:["Context: ",v?.contextWindow.toLocaleString()," tokens"]}),v?.supportsStreaming&&f.jsx(Ve,{variant:"outline",className:"text-xs",children:"Streaming"})]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(ot,{htmlFor:"temperature",children:"Temperature"}),f.jsx("span",{className:"text-sm text-muted-foreground",children:b})]}),f.jsx(oh,{id:"temperature",min:0,max:2,step:.1,value:[b],onValueChange:C=>k(C[0]||.7),className:"w-full"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Controls randomness. Lower values make output more focused and deterministic."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(ot,{htmlFor:"maxTokens",children:"Max Tokens"}),f.jsx(ys,{id:"maxTokens",type:"number",min:1,max:v?.contextWindow||1e5,value:E,onChange:C=>s(parseInt(C.target.value)||1e3)}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum number of tokens to generate in the response."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(ot,{children:"API Keys"}),f.jsx("div",{className:"space-y-2",children:Object.entries(a).map(([C,T])=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[f.jsx("span",{className:"text-sm capitalize",children:C}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(je,{className:"h-4 w-4 text-green-500"}),f.jsxs("span",{className:"text-xs text-muted-foreground",children:[T.substring(0,6),"...",T.substring(T.length-4)]})]})]},C))})]}),f.jsx(ie,{onClick:()=>x(),className:"w-full",children:"Apply Settings"})]})]})}),f.jsx(xs,{open:h,onOpenChange:m,children:f.jsxs(ws,{className:"sm:max-w-[425px]",children:[f.jsxs(Cs,{children:[f.jsx(Es,{children:"API Key Required"}),f.jsxs(ks,{children:["Please enter your ",S," API key to use this model."]})]}),f.jsxs("div",{className:"space-y-4 py-4",children:[f.jsxs("div",{className:"flex items-center gap-2 p-3 border rounded-lg bg-amber-50 dark:bg-amber-950 border-amber-200 dark:border-amber-800",children:[f.jsx(Ae,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),f.jsx("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:"Your API key will be sent securely to the backend server."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(ot,{htmlFor:"apiKey",children:[f.jsx(Eo,{className:"h-4 w-4 inline mr-2"}),"API Key"]}),f.jsx(ys,{id:"apiKey",type:"password",placeholder:`Enter your ${S} API key`,value:n,onChange:C=>{o(C.target.value),l("")},onKeyDown:C=>{C.key==="Enter"&&y()}}),i&&f.jsx("p",{className:"text-sm text-red-500",children:i})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(ie,{variant:"outline",onClick:()=>{m(!1),o(""),l("")},className:"flex-1",children:"Cancel"}),f.jsx(ie,{onClick:y,className:"flex-1",children:"Save API Key"})]})]})]})})]})}const dh=js("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function hs({className:r,variant:e,...t}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:te(dh({variant:e}),r),...t})}function ds({className:r,...e}){return f.jsx("div",{"data-slot":"alert-description",className:te("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",r),...e})}var Xs="Progress",Ys=100,[uh,Ih]=Nt(Xs),[fh,ph]=uh(Xs),ln=P.forwardRef((r,e)=>{const{__scopeProgress:t,value:d=null,max:b,getValueLabel:k=_h,...E}=r;(b||b===0)&&!Ar(b)&&console.error(mh(`${b}`,"Progress"));const s=Ar(b)?b:Ys;d!==null&&!Dr(d,s)&&console.error(gh(`${d}`,"Progress"));const a=Dr(d,s)?d:null,u=It(a)?k(a,s):void 0;return f.jsx(fh,{scope:t,value:a,max:s,children:f.jsx(ue.div,{"aria-valuemax":s,"aria-valuemin":0,"aria-valuenow":It(a)?a:void 0,"aria-valuetext":u,role:"progressbar","data-state":dn(a,s),"data-value":a??void 0,"data-max":s,...E,ref:e})})});ln.displayName=Xs;var cn="ProgressIndicator",hn=P.forwardRef((r,e)=>{const{__scopeProgress:t,...d}=r,b=ph(cn,t);return f.jsx(ue.div,{"data-state":dn(b.value,b.max),"data-value":b.value??void 0,"data-max":b.max,...d,ref:e})});hn.displayName=cn;function _h(r,e){return`${Math.round(r/e*100)}%`}function dn(r,e){return r==null?"indeterminate":r===e?"complete":"loading"}function It(r){return typeof r=="number"}function Ar(r){return It(r)&&!isNaN(r)&&r>0}function Dr(r,e){return It(r)&&!isNaN(r)&&r<=e&&r>=0}function mh(r,e){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ys}\`.`}function gh(r,e){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ys} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var vh=ln,Sh=hn;function bh({className:r,value:e,...t}){return f.jsx(vh,{"data-slot":"progress",className:te("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",r),...t,children:f.jsx(Sh,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})})}function yh({isOpen:r,onClose:e,onImport:t}){const[d,b]=P.useState(!1),[k,E]=P.useState(0),[s,a]=P.useState("idle"),[u,p]=P.useState(""),[c,h]=P.useState(""),m=async o=>{const i=o.target.files;if(!(!i||i.length===0)){b(!0),a("importing"),p(""),h(""),E(0);try{const l=await bs.importFiles(i);if(l.length===0)throw new Error("No valid files found to import");E(100),a("success"),h(`Successfully imported ${l.length} file${l.length>1?"s":""}`),t(l),setTimeout(()=>{e(),n()},1500)}catch(l){a("error"),p(l.message||"Failed to import files")}finally{b(!1)}}},S=async()=>{b(!0),a("importing"),p(""),h(""),E(20);try{const o=await bs.importFolder();if(!o){n();return}E(100),a("success");const i=_(o);h(`Successfully imported ${i} file${i>1?"s":""} from "${o.name}"`),t([o]),setTimeout(()=>{e(),n()},1500)}catch(o){a("error"),p(o.message||"Failed to import folder")}finally{b(!1)}},_=o=>o.type==="file"?1:o.children.reduce((i,l)=>i+_(l),0),n=()=>{a("idle"),E(0),p(""),h("")};return f.jsx(xs,{open:r,onOpenChange:e,children:f.jsxs(ws,{className:"sm:max-w-[500px]",children:[f.jsxs(Cs,{children:[f.jsx(Es,{children:"Import Project"}),f.jsx(ks,{children:"Import files or an entire folder from your local file system"})]}),f.jsxs("div",{className:"space-y-4 py-4",children:[u&&f.jsxs(hs,{variant:"destructive",children:[f.jsx(Ae,{className:"h-4 w-4"}),f.jsx(ds,{children:u})]}),c&&f.jsxs(hs,{className:"border-green-500 bg-green-50 dark:bg-green-950",children:[f.jsx(ro,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),f.jsx(ds,{className:"text-green-900 dark:text-green-100",children:c})]}),s==="importing"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(bh,{value:k,className:"h-2"}),f.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Importing files..."})]}),s==="idle"&&f.jsxs(Ei,{defaultValue:"files",className:"w-full",children:[f.jsxs(Va,{className:"grid w-full grid-cols-2",children:[f.jsx(ur,{value:"files",children:"Import Files"}),f.jsx(ur,{value:"folder",children:"Import Folder"})]}),f.jsxs(fr,{value:"files",className:"space-y-4 mt-4",children:[f.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center hover:border-primary/50 transition-colors",children:[f.jsx("input",{type:"file",multiple:!0,onChange:m,className:"hidden",id:"file-input",accept:".js,.jsx,.ts,.tsx,.py,.java,.cpp,.c,.h,.cs,.go,.rb,.php,.html,.css,.scss,.sass,.less,.xml,.json,.yaml,.yml,.md,.mdx,.sql,.sh,.bash,.zsh,.fish,.ps1,.r,.R,.swift,.kt,.kts,.dart,.lua,.vim,.dockerfile,.rs,.toml,.ini,.cfg,.conf,.env"}),f.jsxs("label",{htmlFor:"file-input",className:"cursor-pointer flex flex-col items-center gap-3",children:[f.jsx(Ps,{className:"h-12 w-12 text-muted-foreground"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Click to select files"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Select multiple files to import"})]})]})]}),f.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Supported: Source code, configuration files, and text files (max 10MB each)"})]}),f.jsxs(fr,{value:"folder",className:"space-y-4 mt-4",children:[f.jsx("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:f.jsx(ie,{onClick:S,disabled:d,className:"w-full h-auto py-8 flex flex-col gap-3",variant:"outline",children:d?f.jsx(Ht,{className:"h-12 w-12 animate-spin"}):f.jsxs(f.Fragment,{children:[f.jsx($r,{className:"h-12 w-12"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Select a folder"}),f.jsx("p",{className:"text-sm font-normal text-muted-foreground",children:"Import an entire project directory"})]})]})})}),f.jsxs(hs,{children:[f.jsx(Ae,{className:"h-4 w-4"}),f.jsxs(ds,{children:[f.jsx("p",{className:"font-medium mb-1",children:"Browser Compatibility"}),f.jsx("p",{className:"text-xs",children:"Folder import requires a Chromium-based browser (Chrome, Edge, Brave, etc.) with File System Access API support."})]})]})]})]})]}),f.jsx("div",{className:"flex justify-end gap-2",children:f.jsx(ie,{variant:"outline",onClick:e,disabled:d,children:"Cancel"})})]})})}class xh extends On.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t),this.setState({error:e,errorInfo:t})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){if(this.state.hasError){if(this.props.fallback){const e=this.props.fallback;return f.jsx(e,{error:this.state.error,reset:this.handleReset})}return f.jsx("div",{className:"h-full flex items-center justify-center bg-background",children:f.jsxs("div",{className:"text-center p-8 max-w-md",children:[f.jsx(Ae,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Something went wrong"}),f.jsx("p",{className:"text-muted-foreground mb-4",children:this.state.error?.message||"An unexpected error occurred."}),!1,f.jsxs(ie,{onClick:this.handleReset,className:"mt-4",children:[f.jsx(Ur,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})}return this.props.children}}class wh{STORAGE_KEY="colony-chat-history";MAX_AGE_DAYS=90;getStorage(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(e){const t=JSON.parse(e);return t.sessions=t.sessions.map(d=>({...d,createdAt:new Date(d.createdAt),lastModified:new Date(d.lastModified),messages:d.messages.map(b=>({...b,timestamp:new Date(b.timestamp)}))})),t}}catch(e){console.error("Error loading chat history:",e)}return{sessions:[]}}setStorage(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Error saving chat history:",t)}}cleanOldSessions(e){const t=new Date;return t.setDate(t.getDate()-this.MAX_AGE_DAYS),e.filter(d=>d.lastModified>t)}saveChatSession(e){const t=this.getStorage(),d=t.sessions.findIndex(b=>b.id===e.id);d>=0?t.sessions[d]=e:t.sessions.push(e),t.sessions=this.cleanOldSessions(t.sessions),t.sessions.sort((b,k)=>k.lastModified.getTime()-b.lastModified.getTime()),this.setStorage(t)}loadChatSessions(){const e=this.getStorage(),t=this.cleanOldSessions(e.sessions);return t.length!==e.sessions.length&&(e.sessions=t,this.setStorage(e)),t.sort((d,b)=>b.lastModified.getTime()-d.lastModified.getTime())}deleteChatSession(e){const t=this.getStorage();t.sessions=t.sessions.filter(d=>d.id!==e),t.currentSessionId===e&&(t.currentSessionId=void 0),this.setStorage(t)}getCurrentSession(){const e=this.getStorage();return e.currentSessionId&&e.sessions.find(d=>d.id===e.currentSessionId)||null}setCurrentSession(e){const t=this.getStorage();t.currentSessionId=e,this.setStorage(t)}clearCurrentSession(){const e=this.getStorage();e.currentSessionId=void 0,this.setStorage(e)}createNewSession(e){const t={id:`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:e||`Chat ${new Date().toLocaleString()}`,createdAt:new Date,lastModified:new Date,messages:[]};return this.saveChatSession(t),this.setCurrentSession(t.id),t}}const We=new wh,Ch=P.createContext(void 0);function Eh({children:r}){const[e,t]=P.useState(()=>{const y=an();return{...ch(),...y}}),[d,b]=P.useState({}),[k,E]=P.useState(null),[s,a]=P.useState(0),[u,p]=P.useState({}),[c,h]=P.useState({}),[m,S]=P.useState({}),[_,n]=P.useState(!1),[o,i]=P.useState(!1);me("connected",()=>{n(!0),e.model&&(de.configureLLM(e),i(!0))}),me("disconnected",()=>{n(!1),i(!1)}),me("llm_config_update",y=>{t(y.config),i(!0)}),me("llm_stream",y=>{const{messageId:w,chunk:v}=y;w&&(v.isComplete?S(C=>({...C,[w]:!1})):(h(C=>({...C,[w]:(C[w]||"")+v.content})),S(C=>({...C,[w]:!0}))))}),me("agent_hierarchy",y=>{b(y.agents),E(y.rootAgentId)}),me("token_usage",y=>{const{agentId:w,tokensUsed:v}=y;p(C=>({...C,[w]:(C[w]||0)+v})),a(C=>C+v),b(C=>{const T=C[w];return T?{...C,[w]:{...T,contextSize:y.contextSize,maxContextSize:y.maxContextSize}}:C})});const l=y=>{const w={...e,...y};t(w),Ds(w),_&&(de.configureLLM(w),i(!0))},g=Object.values(d).filter(y=>y.status==="active"||y.status==="delegating");P.useEffect(()=>{if(_&&o){de.requestAgentHierarchy();const y=setInterval(()=>{de.requestAgentHierarchy()},5e3);return()=>clearInterval(y)}},[_,o]);const x={config:e,updateConfig:l,agents:d,rootAgentId:k,activeAgents:g,totalTokensUsed:s,agentTokenUsage:u,streamingMessages:c,isStreaming:m,isConnected:_,isConfigured:o};return f.jsx(Ch.Provider,{value:x,children:r})}function kh(){const[r,e]=P.useState(!1),[t,d]=P.useState("spec"),[b,k]=P.useState(0),[E,s]=P.useState([]),[a,u]=P.useState(!1),[p,c]=P.useState(!1),[h,m]=P.useState(null),[S,_]=P.useState(!1),[n,o]=P.useState([]);P.useEffect(()=>{de.connect();const w=We.getCurrentSession();if(w)s(w.messages.map(v=>({id:v.id,text:v.content,timestamp:new Date(v.timestamp).toLocaleTimeString(),sender:v.sender,agentId:v.agentId}))),m(w.id);else{const v=We.createNewSession();m(v.id)}return()=>{de.disconnect()}},[]),me("connected",()=>{u(!0),console.log("Connected to WebSocket server")}),me("disconnected",()=>{u(!1),console.log("Disconnected from WebSocket server")});const i=(w,v)=>{if(!w.trim()&&(!v||v.length===0))return;const C=`task-${Date.now()}`,T={id:Date.now().toString(),text:w,timestamp:new Date().toLocaleTimeString(),sender:"user",threadId:C};if(s(A=>[...A,T]),c(!0),de.sendPrompt(w),h){const A=We.getCurrentSession();A&&(A.messages.push({id:T.id,content:w,sender:"user",timestamp:new Date().toISOString()}),We.saveChatSession(A))}},l=w=>{if(s(w),h){const v=We.getCurrentSession();v&&(v.messages=w.map(C=>({id:C.id,content:C.text,sender:C.sender,timestamp:new Date().toISOString(),agentId:C.agentId})),v.lastModified=new Date,We.saveChatSession(v))}},g=w=>{c(w)},x=()=>{s([{id:"1",text:"Hello! I'm Colony AI. I can help you generate code for your project. What would you like me to create?",timestamp:new Date().toLocaleTimeString(),sender:"assistant",threadId:"welcome-thread"}]),setTimeout(()=>{k(65),setTimeout(()=>{d("test"),k(30),setTimeout(()=>{k(80),setTimeout(()=>{d("impl"),k(15)},2e3)},1500)},2e3)},1e3)},y=w=>{o(v=>[...v,...w])};return f.jsxs("div",{className:"h-screen bg-background flex flex-col",children:[f.jsxs("header",{className:"sticky top-0 z-50 w-full bg-background border-b border-border",children:[f.jsxs("div",{className:"h-16 flex items-center px-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(ie,{variant:"ghost",size:"lg",className:"p-2 hover:bg-card focus-visible:outline focus-visible:outline-2 focus-visible:outline-primary/60",onClick:()=>e(!0),children:f.jsx(Lo,{className:"h-6 w-6"})}),f.jsx("h1",{className:"text-foreground ml-2",style:{fontFamily:"Quicksand, sans-serif",fontSize:"28px",fontWeight:400,letterSpacing:"-0.5px"},children:"[Name]"})]}),f.jsxs("div",{className:"flex-1 flex justify-end items-center gap-4",children:[f.jsx(hh,{}),f.jsxs(ie,{size:"sm",onClick:()=>_(!0),className:"minimalist-button",children:[f.jsx(Jo,{className:"h-4 w-4 mr-1"}),"Import"]}),f.jsxs(ie,{size:"sm",className:"minimalist-button border-primary text-primary hover:bg-primary/5",children:[f.jsx(sa,{className:"h-4 w-4 mr-1"}),"Upgrade"]})]})]}),f.jsx(Dc,{currentPhase:t,progress:b})]}),f.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:f.jsx(_c,{messages:E,onSendMessage:i,onNewChat:x,currentPhase:t,isConnected:a,onMessagesUpdate:l,isLoading:p,onLoadingChange:g,importedProject:n})}),f.jsx(Ac,{isOpen:r,onClose:()=>e(!1)}),f.jsx(yh,{isOpen:S,onClose:()=>_(!1),onImport:y})]})}function Rh(){return f.jsx(xh,{children:f.jsx(Eh,{children:f.jsx(kh,{})})})}$n.createRoot(document.getElementById("root")).render(f.jsx(P.StrictMode,{children:f.jsx(Rh,{})}));
